(self.webpackChunkapp_studio_enterprise_schema_view=self.webpackChunkapp_studio_enterprise_schema_view||[]).push([[77],{54077:(be,is,v)=>{"use strict";v.r(is),v.d(is,{ConnectionPropertiesPageComponent:()=>St,ContainerPropertiesPageComponent:()=>Xi,CrtRelationshipDialogComponent:()=>es,EntityInGroupPropertiesDialogComponent:()=>vn,GroupContentListComponent:()=>yn,GroupContentListEventService:()=>Et,GroupPropertiesDialogComponent:()=>fn,GroupsPropertiesPageComponent:()=>qi,LookupDataService:()=>bt,PropertiesPageEventService:()=>un,RelatedListComponent:()=>Ki,RelationshipDeleteDialogService:()=>Xe,RelationshipDesignerComponent:()=>Cn,RelationshipDesignerModule:()=>bn,RelationshipDesignerService:()=>Ke,RelationshipDesignerTranslateLoader:()=>$l,RelationshipDiagramEventHandlerController:()=>xn,RelationshipDiagramEventService:()=>Ji});var a=v(97270),A=v(76696),ss=v(24677),o=v(99314),jn=v(56228),Ie=v(97800),It=v(26182),Be=v(55837),ge=v(98961),ee=v(14401),ne=v(73772),Me=v(61971),Pe=v(93895),Ee=v(64620),os=v(45202),K=v(44537),R=v(86731),co=v(98662),Q=v(27643),nt=v(69244),De=v(38628);class go{constructor(){this.caption="",this.documentation="",this.elements={},this.connections={},this.labels={}}}class Ge{constructor(t,e){this.x=t,this.y=e}}class Hc extends Ge{constructor(){super(...arguments),this.original=null}}var f=v(96590);let it=class{constructor(t){this.config=t}getElements(){return{}}};it=(0,a.Cg)([(0,a.Qj)(0,(0,f.Inject)("config")),(0,a.Sn)("design:paramtypes",[Object])],it);var ie=function(r){return r.connection="connection",r.defaultConnection="defaultConnection",r.label="label",r.root="root",r.shape="shape",r}(ie||{});(0,f.ngxTranslateExtract)("diagram.connections.connection"),(0,f.ngxTranslateExtract)("diagram.connections.defaultConnection");const po={connection:{caption:"connections.connection",order:{containers:["laneSet","lane","subProcessExpanded","eventSubProcessExpanded"],level:3},propertiesImage:"assets/images/SequenceFlowProperties.svg",type:ie.connection}},Fe={root:{id:"root1",type:ie.root}},V={label:{height:20,minHeight:20,type:ie.label,width:130,editStyle:{fontFamily:'"Open Sans", sans-serif',fontSize:12,fontWeight:"normal",lineHeight:1.2},padding:{paddingTop:1,paddingBottom:2,paddingLeft:2,paddingRight:2},minWidth:65,order:{level:10}}};let F=class{constructor(t={}){this.config=t,this.items=this.getItems()}getItems(){const t=this.config.customDiagramElements||{};return{...V,...po,...Fe,...t}}getConfig(t){return this.items[t.userTaskType||t.type]}};F=(0,a.Cg)([(0,a.Qj)(0,(0,f.Inject)("config")),(0,a.Sn)("design:paramtypes",[Object])],F);class Wc extends null{getItems(){return{...super.getItems(),someShape:{caption:"someShape",largeImage:"large-image.svg",smallImage:"small-image.svg",propertiesImage:"properties-image.svg",type:"someShape",height:31,width:31}}}}const Vc={shape:{caption:"shapes.shape",height:55,largeImage:v(22008),smallImage:v(60096),type:ie.shape,width:69}};var Mt=v(41327),ve=v(10018);const j={element:{deleteElementsExecuted:"commandStack.elements.delete.executed",paste:"elements.paste",updateLabel:"element.updateLabel",updateLabelExecuted:"commandStack.element.updateLabel.executed",mouseDown:"element.mousedown",doubleClick:"element.dblclick",update:"element.update",updated:"element.updated",typeUpdated:"element.typeUpdated",click:"element.click",updateExecuted:"commandStack.element.update.executed",validation:"element.validation",canUpdateType:"element.canUpdateType"},elements:{create:"elements.create",move:"elements.move",delete:"elements.delete",removing:"elements.removing",updatingTypeValidate:"elements.updatingTypeValidate",canCopy:"elements.canCopy",changed:"elements.changed"},directEditing:{activate:"directEditing.activate",complete:"directEditing.complete",cancel:"directEditing.cancel",resize:"directEditing.resize"},label:{createExecuted:"commandStack.label.create.executed",create:"label.create"},lane:{create:"lane.create",resize:"lane.resize",split:"lane.split"},diagram:{create:"diagram.create",changed:"diagram.changed",initialized:"diagram.initialized"},selection:{changed:"selection.changed"},shape:{createExecuted:"commandStack.shape.create.executed",moveExecuted:"commandStack.shape.move.executed",resizeExecuted:"commandStack.shape.resize.executed",deleteExecuted:"commandStack.shape.delete.executed",move:"shape.move.move",end:"shape.move.end",shapeMove:"shape.move",shapeCreate:"shape.create",shapeResize:"shape.resize",shapeDelete:"shape.delete"},import:{elementAdd:"import.element.add"},connection:{createExecuted:"commandStack.connection.create.executed",update:"connection.update",updateExecuted:"commandStack.connection.update.executed",moveExecuted:"commandStack.connection.move.executed",layoutExecuted:"commandStack.connection.layout.executed",reconnectEndExecuted:"commandStack.connection.reconnectEnd.executed",updateWaypointsExecuted:"commandStack.connection.updateWaypoints.executed",reconnectExecuted:"commandStack.connection.reconnect.executed",deleteExecuted:"commandStack.connection.delete.executed",changeDirection:"connection.changeDirection",changeDirectionExecuted:"commandStack.connection.changeDirection.executed",reconnect:"connection.reconnect",moveConnectionLabel:"connection.move.label",highlight:"commandStack.connection.highlight.executed"},connect:{move:"connect.move",hover:"connect.hover",end:"connect.end"},create:{move:"create.move",end:"create.end"}};var Te=function(r){return r.connection="connection",r.root="root",r.shape="shape",r.label="label",r}(Te||{});class M{static centerViewboxOnElement(t,e){const n=e.viewbox(),i=(0,ve.U7)(t),s={x:Math.round(i.x+i.width/2-n.outer.width/2),y:Math.round(i.y+i.height/2-n.outer.height/2),width:n.outer.width,height:n.outer.height};e.viewbox(s),e.zoom(n.scale)}static isLabel(t){return t.type===Te.label}static isRoot(t){return t.type===Te.root}static getCorrectSpaceToolDelta(t,e){const n=e.context,i=n.axis,s=n.minAllowedDelta;return s!==null&&(i==="x"&&t.x<s&&(t.x=s),i==="y"&&t.y<s&&(t.y=s)),t}static getOriginalWaypoint(t,e){return[e.y,e.y+e.height].includes(t.y)?{x:t.x,y:e.y+Math.round(e.height/2)}:{x:e.x+Math.round(e.width/2),y:t.y}}getContainersType(){return[]}setProcessRelativePosition(t,e){const n=(i,s)=>{s.id===Fe.root.id?(!Mt.A(i.rx)&&i.x&&(i.rx=i.x),!Mt.A(i.ry)&&i.y&&(i.ry=i.y)):(!Mt.A(i.rx)&&i.x&&s.x&&(i.rx=i.x-s.x),!Mt.A(i.ry)&&i.y&&s.y&&(i.ry=i.y-s.y))};Object.keys((0,f.toObject)(t.elements)).forEach(i=>{const s=t.elements[i],l=t.elements[s.parent];n(s,l||{id:"root1"})}),Object.keys((0,f.toObject)(t.labels)).forEach(i=>{const s=t.labels[i],l=t.connections[s.parent]||t.elements[s.parent];let c=l;if(l)this.isConnection(l)&&(c=t.elements[l.source]);else{const p=`Element with id "${l}" - not found in process "${t.id}"`;e.error(p,{loggerName:"setProcessRelativePosition"}),console.error(p)}n(s,c||{id:"root1"})})}isConnection(t){return Te.connection===t.type}isFlow(t){return Te.connection===t.type}findRealElementParent(t,e,n){for(const i of e)if(t.x>i.x&&t.x<i.x+i.width&&t.y>i.y&&t.y<i.y+i.height)return i;return n}getAllContainers(t){const e=this.getContainersType(),n=[];return t.forEach(i=>{if(e.includes(i.type)){const s=i.children?i.children.filter(l=>e.includes(l.type)):[];n.push({container:i,count:s.length})}},this),n.sort((i,s)=>i.count-s.count).map(i=>i.container)}}const d=f.Inject;var fe=function(r){return r[r.before=0]="before",r[r.after=1]="after",r[r.instead=2]="instead",r}(fe||{});function H(r,t,e=fe.instead){return(n,i,s)=>{s===void 0&&(s=Object.getOwnPropertyDescriptor(n,i));const l=s.value;return t.__instance__ instanceof t||(t.__instance__=new t),s.value=function(){const c=[].slice.call(arguments),p=[...c];let h;if(this.createFeatureContext instanceof Function&&p.unshift(this.createFeatureContext.call(this)),r(...c)){const m=t.__instance__;switch(e){case fe.before:return h=m[i].apply(m,[...p]),l.apply(this,[...c,h]);case fe.after:return h=l.apply(this,c),m[i].apply(m,[...p,h]);default:return m[i].apply(m,[...p])}}return l.apply(this,[...c,h])},s}}function ke(r,t=fe.before){return H(()=>!0,r,t)}function U(){return function(r,t,e){const n=e.value;e.value=function(){return this.isReadOnly?!1:n.apply(this,arguments)}}}var D=v(73308),Sn=v(35928),Qe=v(47868),ho=v(15192),w=v(96091),uo=v(38503),Pt=v(76340),mo=v(68887),st=v(93527),Dt=v(46715);let as=(()=>{class r{getFeatureValues(e){return(0,w.of)([]).subscribe(()=>e({}))}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac})}}return r})();const ot=new o.InjectionToken("DiagramFeaturesToken");let Zc=null;class wn{stopSync(){}startSync(){}subscribeServerChanges(){return[]}}let le=(()=>{class r{constructor(){this.error$=new w.Subject,this.updateElementCaption$=new w.Subject,this.updateConnectionCaption$=new w.Subject,this.updateCaption$=new w.Subject,this.changed$=new w.Subject,this.startLoading$=new w.Subject,this.endLoading$=new w.ReplaySubject(1)}init(){}bufferiseOps(e,n,i){}load(e,n){return(0,D.A)(function*(){return Promise.resolve(null)})()}getDiagramConfig(){return(0,D.A)(function*(){return Promise.resolve()})()}diagramInitialized(){}commit(e){return(0,D.A)(function*(){})()}undo(){}redo(){}clearCash(){}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac})}}return r})(),vo=(()=>{class r{get data(){return this.diagramData}set data(e){this.diagramData=e}get diagram(){return this.internalDiagram}set diagram(e){this.internalDiagram=e}getDiagramDataId(){return this.diagramData?this.diagramData.id:null}getDiagramDataCaption(){return this.diagramData?this.diagramData.caption:null}hasDiagramData(){return!!this.diagramData}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var Z=v(92272),je=v(15922);class Ue{constructor(t){this.utils=t}_setAbsolutePosition(t,e,n){if(n.includes(t.id)||Z.A(t.rx)||Z.A(t.ry))return;const i=t.parent;let s=e.elements[i]||e.connections[i];s?(this.utils.isConnection(s)&&(s=e.elements[s.source]),this._setAbsolutePosition(s,e,n),t.x=s.x+t.rx,t.y=s.y+t.ry):(t.x=t.rx,t.y=t.ry),n.push(t.id)}setRelativePosition(t,e=null){let n=e||t.labelTarget||t.parent;n.id===Fe.root.id?(t.rx=t.x,t.ry=t.y):(this.utils.isConnection(n)&&(n=n.source),t.rx=t.x-n.x,t.ry=t.y-n.y)}setShapeAbsolutePosition(t,e=null){let n=e||t.labelTarget||t.parent;n.id===Fe.root.id?(Z.A(t.rx)||(t.x=t.rx),Z.A(t.ry)||(t.y=t.ry)):(this.utils.isConnection(n)&&(n=n.source),Z.A(t.rx)||(t.x=n.x+t.rx),Z.A(t.ry)||(t.y=n.y+t.ry))}setAbsolutePosition(t){if(!t)return;const e=[];je.A(t.elements,n=>{this._setAbsolutePosition(n,t,e)}),je.A(t.labels,n=>{this._setAbsolutePosition(n,t,e)})}}let fo=(()=>{class r{generate(e,n,i,s="{prefix} {index}"){let l=0,c="",p;do l=l+1,c=s.replace("{prefix}",i).replace("{index}",l.toString()),p=e.find(h=>(h[n]||"").toLowerCase()===c.toLowerCase());while(p);return c}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac})}}return r})();const yo=["diagramContainer"],Co=["resetZoomButton"];let Tt=(()=>{class r{set _isReadOnly(e){this.isReadOnly=e==="true"}set _isStraightConnection(e){this.isStraightConnection=e==="true"}set _isRtl(e){this.isRtl=e==="rtl"}get diagramEventHandlerController(){return this.get("diagramEventHandlerController")}get _diagramLoader(){return this.get("diagramLoader")}get modeling(){return this.get("modeling")}constructor(e){this.injector=e,this._initScale=1,this._unloaded$=new w.Subject,this._defaultTool="arrow",this.isRtl=!1,this.destroyed$=new w.Subject,this.initScroll={x:0,y:0},this.loaded=new w.Subject,this.loading=!0,this.elementDblClick=new o.EventEmitter,this.elementSelected=new o.EventEmitter,this.diagramInitialized=new o.EventEmitter,this.afterViewInit=new o.EventEmitter,this.loadProgress$=new w.Subject,this.isReadOnly=!1,this.isStraightConnection=!1,this.injectDependencies()}_initDiagram(e){this.diagramContainer=new o.ElementRef(document.querySelector(".diagram-container")),this.diagram=new ho.A({canvas:{container:this.diagramContainer.nativeElement},keyboard:{bindTo:window},modules:[this.features,{loggerService:["value",this.loggerService]}],isReadOnly:this.isReadOnly,isStraightConnection:this.isStraightConnection,isRtl:this.isRtl,popupMenu:{scale:{min:1,max:1}},contextPad:{scale:{min:1,max:1}},initScroll:this.initScroll,initScale:this._initScale,...e}),this.diagramDataService.diagram=this.diagram,this.diagramEventHandlerController.service=this.service;const n=this.get("canvas"),i=this.get("editorActions"),s=this.get("elementFactory"),l=this.get("eventBus");l.fire("attach",{}),l.fire("editorActions.init",{editorActions:i});const c=s.createRoot({id:Fe.root.id});n.setRootElement(c),this.tool=this._defaultTool,this._serviceSubscriptions=this._subscribeService(),this.get("featureProvider").featureService=this.featureService}_setSelectedElement(e){if(e){const n=this.get("eventBus"),s=this.get("elementRegistry").get(e);s&&n.fire("element.click",{element:s})}}_subscribeLoadingData(){var e=this;const n=this.service.startLoading$.subscribe(s=>{this.dataId!==s&&(this.loading=!0)}),i=this.service.endLoading$.pipe((0,uo.p)(s=>s&&this.dataId!==s.id)).subscribe(function(){var s=(0,D.A)(function*(l){e._unloaded$.next(),yield e.loadDiagramData(l)});return function(l){return s.apply(this,arguments)}}());this._serviceSubscriptions.push(n,i),this.diagramInitialized.emit(),this.get("eventBus").fire(j.diagram.initialized)}_getCancellationToken(){const e=new w.Subject;return(0,w.merge)(this.destroyed$,this._unloaded$).subscribe(()=>{e.next(),e.complete()}),e}_subscribeService(){var e=this;const n=this.diagramEventHandlerController.subscribeServerChanges();return n.push(this.service.error$.pipe((0,Pt.Q)(this.destroyed$),(0,mo.B)(1e3)).subscribe(function(){var i=(0,D.A)(function*(s){yield e.notifyService.error({message:s,translate:!1});const l=e.diagramDataService.getDiagramDataId();e.loggerService.exception(s,{loggerName:"DiagramService"},{diagramDataId:l})});return function(s){return i.apply(this,arguments)}}()),this.service.updateCaption$.subscribe(i=>this._changeCaption(i))),n}_unsubscribeService(){this._serviceSubscriptions&&this._serviceSubscriptions.forEach(e=>e.unsubscribe())}unloadDiagramData(){this.diagram&&(this.get("directEditing").complete(),this._clearDiagram())}initDiagramData(e){var n=this;return(0,D.A)(function*(){n._initLocalStorage(),n._initZoomScroll(),n.diagramEventHandlerController.stopSync(),n.unloadDiagramData();const i=yield n._diagramLoader.load(n.diagramDataService.data,e,n.loadProgress$);if(e.isStopped)return;const s=i&&i[0];s&&(yield n.notifyService.show({message:s,translate:!1})),n.diagramEventHandlerController.startSync()})()}_changeCaption(e){this.caption=e.value}_initLocalStorage(){const e=this.get("localStorage");e.diagramId=this.diagramDataService.getDiagramDataId()}_initZoomScroll(){this.get("zoomScroll").initZoomScroll()}_subscribeDiagramChanges(){const e=this.get("eventBus");e.on(["create.end","connect.end","element.click","shape.move.end"],n=>{this._onSelectedElementChanged(n.element||n.context.shape||n.context.connection)}),e.on(["shape.replaced"],n=>Sn.A(()=>this._onSelectedElementChanged(n))),e.on(["selection.changed"],n=>{const i=n.newSelection,s=i.length===1&&i[0];s&&!this.loading&&this._onSelectedElementChanged(s)}),e.on(["tool-manager.update"],n=>this._onToolChanged(n.tool)),e.on(["element.dblclick"],()=>this._elementDblClick())}_elementDblClick(){this.elementDblClick.emit()}_onSelectedElementChanged(e){let n=null;const i={source:this,id:n};e&&e.type!==Fe.root.type&&(n=(e.labelTarget||e).id,i.id=n),this.elementSelected.emit(i),this.get("eventBus").fire("diagram.item.selected",{id:n})}_onToolChanged(e){this.tool=e||this._defaultTool}_getLocalizationObject(e){return{get:n=>{const i=n.split(".");let s=e;for(const l of i){if(!s||!s.hasOwnProperty(l))return n;s=s[l]}return s??n}}}_getDiagramLocalizableStrings(e){var n=this;return(0,D.A)(function*(){const i=n.translateService,s=i.getDefaultLang(),l=i.currentLang;let c,p;s===l?p=i.translations[l]?(0,w.of)({...i.translations[l],...i.translations[l]?.diagram}):i.getTranslation(l).pipe((0,st.T)(({diagram:m})=>m)):(c=i.translations?(0,w.zip)((0,w.of)(i.translations[s]),(0,w.of)(i.translations[l])):(0,w.zip)(i.getTranslation(s),i.getTranslation(l)),p=c.pipe((0,st.T)(([m,C])=>Qe.A(m?.diagram,C?.diagram))));const h=yield(0,w.lastValueFrom)(p.pipe((0,Dt.$)()),{defaultValue:null});return n._getLocalizationObject({...h,...e})})()}_reloadDiagram(){var e=this;return(0,D.A)(function*(){const n=yield e._getDiagramConfig();e.diagramDataService.hasDiagramData()&&e._clearDiagram(),e._destroyDiagram(),e._unsubscribeService(),e._initDiagram(n),e._subscribeLoadingData(),e._subscribeDiagramChanges(),e.diagramDataService.hasDiagramData()&&(yield e.initDiagramData(e._getCancellationToken()))})()}_clearDiagram(){this.diagramEventHandlerController.stopSync(),this.diagram.clear()}_destroyDiagram(){this.diagram&&(this.get("eventBus").fire("detach",{}),this.diagram.destroy())}_getDiagramConfig(){var e=this;return(0,D.A)(function*(){const n=yield e.service.getDiagramConfig();return{localizableStrings:yield e._getDiagramLocalizableStrings(n&&n.customLocalizableStrings),...n}})()}injectDependencies(){this.diagramDataService=this.injector.get(vo),this.service=this.injector.get(le),this.translateService=this.injector.get(R.c$),this.notifyService=this.injector.get(Q.FL),this.featureService=this.injector.get(as),this.loggerService=this.injector.get(f.LoggerService),this.features=this.injector.get(ot)}loadDiagramData(e){var n=this;return(0,D.A)(function*(){const i=n._getCancellationToken();if(!(n.destroyed$.isStopped||n._unloaded$.isStopped))if(n.diagramDataService.data=e,n.diagramDataService.hasDiagramData()){if(yield n.initDiagramData(i),i.isStopped)return;n.caption=n.diagramDataService.getDiagramDataCaption(),n.loading=!1,n.loaded.next(e.id),n._setSelectedElement(n.elementSelect)}else{n.loading=!1;const s=`Error. Diagram with id = "${e.id}" does not exists`;n.loaded.error(s)}})()}ngOnInit(){this.translateService.onLangChange.pipe((0,Pt.Q)(this.destroyed$)).subscribe(()=>{this.loading?this.service.endLoading$.pipe((0,Dt.$)()).subscribe(()=>this._reloadDiagram()):this._reloadDiagram()})}ngAfterViewInit(){var e=this;return(0,D.A)(function*(){const n=yield e._getDiagramConfig();e._initDiagram(n),e._subscribeLoadingData(),e._subscribeDiagramChanges(),e._initZoomScroll(),e.afterViewInit.emit()})()}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete(),this._unsubscribeService(),this.diagramDataService.hasDiagramData()&&this.unloadDiagramData(),this._destroyDiagram()}get(e){return this.diagram.get(e)}onHandClick(){this.get("toolManager").setActive(null),this.get("dragging").cancel()}onLassoClick(){this.get("lassoTool").toggle()}onSpaceClick(){this.get("spaceTool").toggle()}onUndoClick(){this.service.undo()}onRedoClick(){this.service.redo()}update(e){this.modeling.updateLabel(e.id,e.value)}static{this.\u0275fac=function(n){return new(n||r)(o.\u0275\u0275directiveInject(o.Injector))}}static{this.\u0275cmp=o.\u0275\u0275defineComponent({type:r,selectors:[["ts-app-diagram"]],viewQuery:function(n,i){if(n&1&&(o.\u0275\u0275viewQuery(yo,7,o.ElementRef),o.\u0275\u0275viewQuery(Co,7,o.ElementRef)),n&2){let s;o.\u0275\u0275queryRefresh(s=o.\u0275\u0275loadQuery())&&(i.diagramContainer=s.first),o.\u0275\u0275queryRefresh(s=o.\u0275\u0275loadQuery())&&(i.resetZoomButton=s.first)}},hostVars:1,hostBindings:function(n,i){n&2&&o.\u0275\u0275attribute("data-qa",i.caption)},inputs:{_isReadOnly:[o.\u0275\u0275InputFlags.None,"readonly","_isReadOnly"],_isStraightConnection:[o.\u0275\u0275InputFlags.None,"straightconnection","_isStraightConnection"],_isRtl:[o.\u0275\u0275InputFlags.None,"dir","_isRtl"],elementSelect:"elementSelect"},outputs:{elementDblClick:"elementDblClick",elementSelected:"elementSelected",diagramInitialized:"diagramInitialized",afterViewInit:"afterViewInit"},decls:2,vars:0,consts:[["diagramContainer",""],[1,"diagram-container"]],template:function(n,i){n&1&&o.\u0275\u0275element(0,"div",1,0)},styles:[`.diagram-container{position:relative;height:100%;width:100%;margin:0}.diagram-container svg{display:block}.djs-container{direction:ltr}.djs-tooltip{border-radius:4px;padding:8px;width:150px;opacity:.9;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);z-index:1010}.djs-palette{left:10px;top:10px;border-radius:4px;overflow:hidden;padding-top:6px;padding-bottom:6px}.djs-palette.open,.djs-palette.two-column.open{width:46px}.djs-palette .group{padding:0!important;width:100%}.djs-palette .entry{width:32px;height:32px;line-height:32px;margin-left:6px;cursor:pointer}.djs-palette .entry.active{border-radius:7px}.djs-palette .entry.create-menu:after{content:"";position:absolute;width:0;height:0;border-top:3px solid transparent;border-bottom:3px solid transparent;border-left:3px solid #006ce0;margin-top:13px;margin-left:-4px}.djs-context-pad.open{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;border-radius:4px;pointer-events:auto}.djs-context-pad.open .group{display:grid;grid-template-columns:auto auto;padding:3px}.djs-context-pad.open .group:not(:first-child){padding-left:0}.djs-context-pad.open.one-column-grid .group{grid-template-columns:auto}.djs-context-pad.open .entry{height:32px;width:32px;background:transparent;margin:0;box-shadow:none;border-radius:3px}.djs-context-pad.open .entry.entry-separator{height:0;margin-top:4px;margin-bottom:4px}.djs-context-pad.open .entry.noop-entry:hover{background:inherit!important}.djs-context-pad.open .entry img{padding:4px}.entry.entry-separator{height:0;margin-top:4px;margin-bottom:4px}@supports ((-webkit-backdrop-filter: none) or (backdrop-filter: none)){.djs-context-pad.open{-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);background:#ffffffc7}.djs-context-pad.open .entry{background:transparent}}.djs-context-pad{max-width:72px}.djs-element.djs-connection.djs-updating path,.djs-element.djs-connection.selected path,.djs-element.djs-connection.animated path{stroke:#1186d8!important}.djs-element.djs-connection.djs-updating path.connection-end-marker,.djs-element.djs-connection.selected path.connection-end-marker,.djs-element.djs-connection.animated path.connection-end-marker{fill:#1186d8!important}.djs-element.djs-connection.animated path.connection{stroke-width:3!important;stroke-dasharray:20,3;animation:dash 5s linear infinite}@keyframes dash{0%{stroke-dashoffset:115}}.djs-bendpoint .djs-visual{fill:#fff;stroke-width:1px;stroke:#1186d8}.djs-bendpoint.floating .djs-visual{display:none}.djs-bendpoints.hover .djs-visual{stroke:#8095b3}.djs-element.hover .djs-outline{stroke:#a7c6ff}.laneSet.hover .djs-visual,.lane.hover .djs-visual{opacity:initial}.djs-element.selected .djs-outline{stroke:#3168cc}.djs-segment-dragger .djs-visual{fill:transparent;stroke:transparent}.djs-snap-line{stroke-width:1px}.djs-popup{overflow-y:auto;overflow-x:hidden;max-height:calc(100% - 20px);opacity:0;transition:opacity .2s ease-out}.djs-popup .entry{display:flex;flex-direction:row-reverse;justify-content:flex-end;align-items:stretch;padding:5px 7px}.djs-popup .entry img{height:24px;width:24px}.djs-popup .djs-popup-header{display:flex;margin:0 9px}.djs-popup .djs-popup-header .entry.active{border:none}.djs-popup .djs-popup-header .entry:first-child{margin-left:0}.djs-popup .djs-popup-header .entry{height:34px;width:34px;padding:4px;margin:2px 1px 2px 4px}.djs-dragger .djs-visual rect{fill:none}.djs-direct-editing-parent:not(.djs-direct-editing-parent-no-border){display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;pointer-events:none}.djs-direct-editing-parent:not(.djs-direct-editing-parent-no-border) .djs-direct-editing-content{margin:0 auto;pointer-events:auto;text-align:center}.djs-direct-editing-content{-webkit-user-select:text!important;user-select:text!important;overflow:hidden;outline:none;resize:none}.djs-direct-editing-parent-no-border .djs-direct-editing-content{border:0}.djs-direct-editing-rotate-90{transform:rotate(-90deg);transition:transform .1s ease}.djs-direct-editing-rotate-90 .djs-direct-editing-content{border:none;transition:border .1s ease}.djs-direct-editing-rotate-0{transform:rotate(0)}.djs-text-hidden text{display:none}.djs-text-hidden foreignObject{display:none}.djs-direct-editing-resize-handle{display:none}.djs-shape.connect-ok.textAnnotation .djs-visual>:nth-child(1):not(path),.djs-shape.connect-not-ok.textAnnotation .djs-visual>:nth-child(1):not(path){fill:inherit!important}.djs-element.lane.hover:not(.selected) .djs-outline{stroke:none}.djs-element.laneSet.hover:not(.selected) .djs-outline{stroke:none}foreignObject.djs-label{overflow:visible}.foreign-text-container{display:flex;justify-content:center;height:100%}.laneSet .foreign-text-container,.lane .foreign-text-container{align-items:center}.eventSubProcessExpanded .foreign-text-container{height:initial;padding:5px}.foreign-text{text-align:center;box-sizing:border-box;outline:none;font-family:Open Sans,sans-serif;font-size:12px;font-weight:400;line-height:1.2;overflow-wrap:break-word;white-space:pre-line}.label .foreign-text{max-width:130px;-webkit-user-select:text;user-select:text}.textAnnotation .foreign-text{padding:12px;max-width:none;text-align:left;line-height:1.41667;word-wrap:break-word}.textAnnotation foreignObject{height:100%}.eventSubProcessExpanded .foreign-text,.laneSet .foreign-text,.lane .foreign-text{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}@supports (-webkit-line-clamp: 2){.eventSubProcessExpanded .foreign-text,.laneSet .foreign-text,.lane .foreign-text{vertical-align:center;overflow:hidden;text-overflow:ellipsis;white-space:initial;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}}.foreign-text-helper{max-width:128px;min-height:14.39px;width:-moz-fit-content;width:fit-content;margin:0 auto;overflow-wrap:break-word}.diagram-create-popup-menu{border-top:none!important}.diagram-create-popup-menu .entry{cursor:move}.djs-minimap{position:absolute;right:8px;bottom:11px;width:248px;height:33px;border-radius:4px;opacity:1;overflow:hidden;box-sizing:border-box;-webkit-user-select:none;user-select:none;transition:height .2s cubic-bezier(0,0,.2,1)}.djs-minimap .map-buttons{position:absolute;bottom:0;left:0;right:0;height:32px;display:flex;padding:0 5px;z-index:1}.djs-minimap .map-buttons .map-button{min-width:32px;height:32px;cursor:pointer;line-height:32px;font-size:16px;padding:0 8px;background-position:center;transition:background .8s}.djs-minimap .map-buttons .map-button:active{background-size:100%;transition:background 0s}.djs-minimap .map-buttons .map-button.preview-button{padding:0 12px 0 10px;margin:0 4px 0 0;min-width:40px}.djs-minimap .map-buttons .map-button.zoom-button{width:100%;height:100%;padding:0 16px 0 0;text-align:right}.djs-minimap .map-buttons .map-button.zoom-button:after{content:"";position:absolute;width:0;height:0;right:9px;top:16px}.djs-minimap .map{width:248px;height:148px;margin-bottom:32px;cursor:crosshair}.djs-minimap.open{transition:height .2s cubic-bezier(.18,.89,.32,1.28);height:180px}.djs-minimap.open .overlay{position:absolute;inset:0;pointer-events:none}.djs-minimap .viewport{fill:none;stroke:none}.djs-minimap .viewport-dom{position:absolute;border-radius:2px;box-sizing:border-box;cursor:move}.djs-minimap .cursor-crosshair{cursor:crosshair}.djs-minimap .cursor-move{cursor:move}.djs-popup.zoom{right:8px;bottom:47px;top:inherit!important;left:inherit!important}.djs-popup.zoom .entry{display:flex;flex-direction:row;justify-content:space-between;align-items:stretch}.djs-popup.zoom .entry.entry-separator{padding:0!important;margin:4px 10px!important}#canvas_svg_export{position:absolute;left:50px;top:50px;box-shadow:0 0 9px 2px #0000007a}#canvas_svg_export .close-button{position:absolute;right:8px;width:16px;height:16px;cursor:pointer}
`,`.djs-outline{fill:none;visibility:hidden}.djs-element.hover .djs-outline,.djs-element.selected .djs-outline{visibility:visible;shape-rendering:crispEdges;stroke-dasharray:3,3}.djs-element.selected .djs-outline{stroke:#88f;stroke-width:1px}.djs-element.hover .djs-outline{stroke:#f88;stroke-width:1px}svg.drop-not-ok{background:#f9dee5!important}.djs-connection.connect-ok .djs-visual>:nth-child(1),.djs-connection.drop-ok .djs-visual>:nth-child(1){stroke:#90dd5f!important}.djs-connection.connect-not-ok .djs-visual>:nth-child(1),.djs-connection.drop-not-ok .djs-visual>:nth-child(1){stroke:#e56283!important}.drop-not-ok,.connect-not-ok{cursor:not-allowed}.djs-element.attach-ok .djs-visual>:nth-child(1){stroke-width:5px!important;stroke:#ff7400b3!important}.djs-frame.connect-not-ok .djs-visual>:nth-child(1),.djs-frame.drop-not-ok .djs-visual>:nth-child(1){stroke-width:3px!important;stroke:#e56283!important;fill:none!important}.djs-lasso-overlay{fill:#ff7400;fill-opacity:.1;stroke-dasharray:5 1 3 1;stroke:#ff7400;shape-rendering:crispEdges;pointer-events:none}.djs-resize-overlay{fill:none;stroke-dasharray:5 1 3 1;stroke:#ff7400;pointer-events:none}.djs-resizer-hit{fill:none;pointer-events:all}.djs-resizer-visual{fill:#fff;stroke-width:1px;stroke:#000;shape-rendering:crispEdges;stroke-opacity:.2}.djs-cursor-resize-ns,.djs-resizer-n,.djs-resizer-s{cursor:ns-resize}.djs-cursor-resize-ew,.djs-resizer-e,.djs-resizer-w{cursor:ew-resize}.djs-cursor-resize-nwse,.djs-resizer-nw,.djs-resizer-se{cursor:nwse-resize}.djs-cursor-resize-nesw,.djs-resizer-ne,.djs-resizer-sw{cursor:nesw-resize}.djs-shape.djs-resizing>.djs-outline{visibility:hidden!important}.djs-shape.djs-resizing>.djs-resizer{visibility:hidden}.djs-dragger>.djs-resizer{visibility:hidden}marker.djs-dragger circle,marker.djs-dragger path,marker.djs-dragger polygon,marker.djs-dragger polyline,marker.djs-dragger rect{fill:#ff7400!important;stroke:none!important}marker.djs-dragger text,marker.djs-dragger tspan{fill:none!important;stroke:#ff7400!important}.djs-dragging{opacity:.3}.djs-dragging,.djs-dragging>*{pointer-events:none!important}.djs-dragging .djs-context-pad,.djs-dragging .djs-outline{display:none!important}.djs-visual,.djs-outline{pointer-events:none}.djs-element.attach-ok .djs-hit{stroke-width:60px!important}.djs-element>.djs-hit-all{pointer-events:all}.djs-element>.djs-hit-stroke,.djs-element>.djs-hit-click-stroke{pointer-events:stroke}.djs-drag-active .djs-element>.djs-hit-click-stroke{pointer-events:all}.djs-connection .djs-visual{stroke-width:2px;fill:none}.djs-cursor-grab{cursor:grab}.djs-cursor-grabbing{cursor:grabbing}.djs-cursor-crosshair{cursor:crosshair}.djs-cursor-move{cursor:move}.djs-cursor-resize-ns{cursor:ns-resize}.djs-cursor-resize-ew{cursor:ew-resize}.djs-snap-line{stroke:#ffc342;stroke:#ffc34280;stroke-linecap:round;stroke-width:2px;pointer-events:none}.djs-crosshair{stroke:#555;stroke-linecap:round;stroke-width:1px;pointer-events:none;shape-rendering:crispEdges;stroke-dasharray:5,5}.djs-palette{position:absolute;left:20px;top:20px;box-sizing:border-box;width:48px}.djs-palette .separator{margin:0 5px;padding-top:5px;border:none;border-bottom:solid 1px #DDD;clear:both}.djs-palette .entry:before{vertical-align:text-bottom}.djs-palette .djs-palette-toggle{cursor:pointer}.djs-palette .entry,.djs-palette .djs-palette-toggle{color:#333;font-size:30px;text-align:center}.djs-palette .entry{float:left}.djs-palette .entry img{max-width:100%}.djs-palette .djs-palette-entries:after{content:"";display:table;clear:both}.djs-palette .djs-palette-toggle:hover{background:#666}.djs-palette .entry:hover{color:#ff7400}.djs-palette .highlighted-entry{color:#ff7400!important}.djs-palette .entry,.djs-palette .djs-palette-toggle{width:46px;height:46px;line-height:46px;cursor:default}.djs-palette.two-column.open{width:94px}.djs-palette:not(.open) .djs-palette-entries{display:none}.djs-palette:not(.open){overflow:hidden}.djs-palette.open .djs-palette-toggle{display:none}.djs-overlay-context-pad{width:72px}.djs-context-pad{position:absolute;display:none;pointer-events:none}.djs-context-pad .entry{width:22px;height:22px;text-align:center;display:inline-block;font-size:22px;margin:0 2px 2px 0;border-radius:3px;cursor:default;background-color:#fefefe;box-shadow:0 0 2px 1px #fefefe;pointer-events:all}.djs-context-pad .entry:before{vertical-align:top}.djs-context-pad .entry:hover{background:#fffcb0}.djs-context-pad.open{display:block}.djs-popup .entry{line-height:20px;white-space:nowrap;cursor:default}.djs-popup .entry:before{vertical-align:middle;font-size:20px}.djs-popup .entry>span{vertical-align:middle;font-size:14px}.djs-popup .entry:hover,.djs-popup .entry.active:hover{background:#fffcb0}.djs-popup .entry.disabled{background:inherit}.djs-popup .djs-popup-header .entry{display:inline-block;padding:2px 3px;border:solid 1px transparent;border-radius:3px}.djs-popup .djs-popup-header .entry.active{color:#ff7400;border:solid 1px rgb(255,116,0);background-color:#f6f6f6}.djs-popup-body .entry{padding:4px 10px 4px 5px}.djs-popup-body .entry>span{margin-left:5px}.djs-popup-body{background-color:#fefefe}.djs-popup-header{border-bottom:1px solid #DDD}.djs-popup-header .entry{margin:1px 1px 1px 3px}.djs-popup-header .entry:last-child{margin-right:3px}.djs-popup,.djs-palette{background:#fafafa;border:solid 1px #CCC;border-radius:2px}.djs-shape,.djs-connection{touch-action:none}.djs-segment-dragger,.djs-bendpoint{display:none}.djs-segment-dragger .djs-visual{fill:#ffff7933;stroke-width:1px;stroke-opacity:1;stroke:#ffff794d}.djs-bendpoint .djs-visual{fill:#ffff79cc;stroke-width:1px;stroke-opacity:.5;stroke:#000}.djs-segment-dragger:hover,.djs-bendpoints.hover .djs-segment-dragger,.djs-bendpoints.selected .djs-segment-dragger,.djs-bendpoint:hover,.djs-bendpoints.hover .djs-bendpoint,.djs-bendpoints.selected .djs-bendpoint{display:block}.djs-drag-active .djs-bendpoints *{display:none}.djs-bendpoints:not(.hover) .floating{display:none}.djs-segment-dragger:hover .djs-visual,.djs-segment-dragger.djs-dragging .djs-visual,.djs-bendpoint:hover .djs-visual,.djs-bendpoint.floating .djs-visual{fill:#ff0;stroke-opacity:.5;stroke:#000}.djs-bendpoint.floating .djs-hit{pointer-events:none}.djs-segment-dragger .djs-hit,.djs-bendpoint .djs-hit{pointer-events:all;fill:none}.djs-segment-dragger.horizontal .djs-hit{cursor:ns-resize}.djs-segment-dragger.vertical .djs-hit{cursor:ew-resize}.djs-segment-dragger.djs-dragging .djs-hit{pointer-events:none}.djs-updating,.djs-updating>*{pointer-events:none!important}.djs-updating .djs-context-pad,.djs-updating .djs-outline,.djs-updating .djs-bendpoint,.connect-ok .djs-bendpoint,.connect-not-ok .djs-bendpoint,.drop-ok .djs-bendpoint,.drop-not-ok .djs-bendpoint{display:none!important}.djs-segment-dragger.djs-dragging,.djs-bendpoint.djs-dragging{display:block;opacity:1}.djs-segment-dragger.djs-dragging .djs-visual,.djs-bendpoint.djs-dragging .djs-visual{fill:#ff0;stroke-opacity:.5}.djs-tooltip-error{font-size:11px;line-height:18px;text-align:left;padding:5px;opacity:.7}.djs-tooltip-error>*{width:160px;background:#fcecf0;color:#9e4c4c;padding:3px 7px;border-radius:5px;border-left:solid 5px rgb(174,73,73)}.djs-tooltip-error:hover{opacity:1}.djs-search-container{position:absolute;top:20px;left:0;right:0;margin-left:auto;margin-right:auto;width:25%;min-width:300px;max-width:400px;z-index:10;font-size:1.05em;opacity:.9;background:#fafafa;border:solid 1px #CCC;border-radius:2px}.djs-search-container:not(.open){display:none}.djs-search-input input{font-size:1.05em;width:100%;padding:6px 10px;border:1px solid #ccc}.djs-search-input input:focus{outline:none;border-color:#52b415}.djs-search-results{position:relative;overflow-y:auto;max-height:200px}.djs-search-results:hover{cursor:pointer}.djs-search-result{width:100%;padding:6px 10px;background:#fff;border-bottom:solid 1px #AAA;border-radius:1px}.djs-search-highlight{color:#000}.djs-search-result-primary{margin:0 0 10px}.djs-search-result-secondary{font-family:monospace;margin:0}.djs-search-result:hover{background:#fdffd6}.djs-search-result-selected{background:#fffcb0}.djs-search-result-selected:hover{background:#f7f388}.djs-search-overlay{background:#ff0;opacity:.3}.djs-element-hidden,.djs-element-hidden .djs-hit,.djs-element-hidden .djs-outline,.djs-label-hidden .djs-label{display:none!important}
`],encapsulation:2})}}return r})();var xo=v(43537);let W=class extends xo.A{constructor(t,e){super(t),this.isReadOnly=!1,this.isReadOnly=e.isReadOnly}canConnect(t,e){return t.type!==ie.root&&t.type!==ie.connection&&e.type!==ie.root&&e.type!==ie.connection}addRule(t,e){super.addRule(t,e)}init(){super.addRule("connection.create",this.canConnectionCreate.bind(this)),super.addRule("connection.reconnect",this.canReconnect.bind(this)),super.addRule("elements.move",this.canElementMove.bind(this)),super.addRule("shape.create",this.canElementMove.bind(this)),super.addRule("elements.create",this.canElementMove.bind(this)),super.addRule("shape.resize",this.canElementResize.bind(this)),super.addRule("element.copy",this.canElementCopy.bind(this)),super.addRule("element.paste",this.canElementPaste.bind(this)),super.addRule("elements.delete",this.canElementsDelete.bind(this)),super.addRule("canOpenContextPad",this.canOpenContextPad.bind(this)),super.addRule("canShowConnectionOutline",this.canShowConnectionOutline.bind(this)),super.addRule("canConnectionSegmentMove",this.canConnectionSegmentMove.bind(this)),super.addRule("canLabelEdit",this.canLabelEdit.bind(this)),super.addRule("canShowPalette",this.canShowPalette.bind(this)),super.addRule("canShowLabelOutline",this.canShowLabelOutline.bind(this)),super.addRule("canElementMarkerUpdate",this.canElementMarkerUpdate.bind(this)),super.addRule("element.canUpdateType",this.canElementUpdateType.bind(this)),super.addRule("connection.updateWaypoints",this.canConnectionUpdateWaypoints.bind(this))}canElementMarkerUpdate(){return!0}canShowLabelOutline(){return!0}canConnectionSegmentMove(){return!0}canShowPalette(){return!0}canLabelEdit(){return!0}canShowConnectionOutline(){return!0}canOpenContextPad(){return!0}canConnectionCreate(t){return this.canConnect(t.target,t.source)}canReconnect(t){if(M.isRoot(t.target)||M.isRoot(t.source))return!1;switch(t.type){case"reconnectEnd":return this.canReconnectEnd(t);case"reconnectStart":return this.canReconnectStart(t);default:return this.canReconnectEnd(t)||this.canReconnectStart(t)}}canReconnectStart(t){return this.canConnect(t.target,t.source)}canReconnectEnd(t){return this.canConnect(t.target,t.source)}canElementMove(t){return!0}canElementResize(t){return!1}canElementCopy(t){return!0}canElementPaste(t){return!0}canElementsDelete(t){return!0}canElementUpdateType(t){return!0}canConnectionUpdateWaypoints(){return!1}};(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[]),(0,a.Sn)("design:returntype",void 0)],W.prototype,"canElementMarkerUpdate",null),(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[]),(0,a.Sn)("design:returntype",void 0)],W.prototype,"canConnectionSegmentMove",null),(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[]),(0,a.Sn)("design:returntype",void 0)],W.prototype,"canShowPalette",null),(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[]),(0,a.Sn)("design:returntype",void 0)],W.prototype,"canLabelEdit",null),(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[]),(0,a.Sn)("design:returntype",void 0)],W.prototype,"canShowConnectionOutline",null),(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[]),(0,a.Sn)("design:returntype",void 0)],W.prototype,"canOpenContextPad",null),(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object]),(0,a.Sn)("design:returntype",void 0)],W.prototype,"canConnectionCreate",null),(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object]),(0,a.Sn)("design:returntype",Boolean)],W.prototype,"canReconnect",null),(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object]),(0,a.Sn)("design:returntype",void 0)],W.prototype,"canElementMove",null),(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object]),(0,a.Sn)("design:returntype",void 0)],W.prototype,"canElementResize",null),(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object]),(0,a.Sn)("design:returntype",void 0)],W.prototype,"canElementCopy",null),(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object]),(0,a.Sn)("design:returntype",void 0)],W.prototype,"canElementPaste",null),(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object]),(0,a.Sn)("design:returntype",void 0)],W.prototype,"canElementsDelete",null),(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object]),(0,a.Sn)("design:returntype",void 0)],W.prototype,"canElementUpdateType",null),W=(0,a.Cg)([(0,a.Qj)(0,(0,f.Inject)("eventBus")),(0,a.Qj)(1,(0,f.Inject)("config")),(0,a.Sn)("design:paramtypes",[Object,Object])],W);var Oe=v(17521),bo=v(97317);const ae={Add:"add",Remove:"remove",Update:"update"},B={MIN:100,LOW:500,MEDIUM:1e3,HIGH:1500,MAX:5e3},te={Backspace:{code:"Backspace",keyCode:8},Tab:{code:"Tab",keyCode:9},Enter:{code:"Enter",keyCode:13},NumpadEnter:{code:"NumpadEnter",keyCode:13},Escape:{code:"Escape",keyCode:27},Space:{code:"Space",keyCode:32},PageUp:{code:"PageUp",keyCode:33},PageDown:{code:"PageDown",keyCode:34},End:{code:"End",keyCode:35},Home:{code:"Home",keyCode:36},ArrowLeft:{code:"ArrowLeft",keyCode:37},ArrowUp:{code:"ArrowUp",keyCode:38},ArrowRight:{code:"ArrowRight",keyCode:39},ArrowDown:{code:"ArrowDown",keyCode:40},Insert:{code:"Insert",keyCode:45},Delete:{code:"Delete",keyCode:46},ShiftLeft:{code:"ShiftLeft",keyCode:16},ShiftRight:{code:"ShiftRight",keyCode:16},ControlLeft:{code:"ControlLeft",keyCode:17},ControlRight:{code:"ControlRight",keyCode:17},AltLeft:{code:"AltLeft",keyCode:18},AltRight:{code:"AltRight",keyCode:18},CapsLock:{code:"CapsLock",keyCode:20},OSLeft:{code:"OSLeft",keyCode:91},OSRight:{code:"OSRight",keyCode:92},Digit0:{code:"Digit0",keyCode:48},Digit1:{code:"Digit1",keyCode:49},Digit2:{code:"Digit2",keyCode:50},Digit3:{code:"Digit3",keyCode:51},Digit4:{code:"Digit4",keyCode:52},Digit5:{code:"Digit5",keyCode:53},Digit6:{code:"Digit6",keyCode:54},Digit7:{code:"Digit7",keyCode:55},Digit8:{code:"Digit8",keyCode:56},Digit9:{code:"Digit9",keyCode:57},KeyA:{code:"KeyA",keyCode:65},KeyB:{code:"KeyB",keyCode:66},KeyC:{code:"KeyC",keyCode:67},KeyD:{code:"KeyD",keyCode:68},KeyE:{code:"KeyE",keyCode:69},KeyF:{code:"KeyF",keyCode:70},KeyG:{code:"KeyG",keyCode:71},KeyH:{code:"KeyH",keyCode:72},KeyI:{code:"KeyI",keyCode:73},KeyJ:{code:"KeyJ",keyCode:74},KeyK:{code:"KeyK",keyCode:75},KeyL:{code:"KeyL",keyCode:76},KeyM:{code:"KeyM",keyCode:77},KeyN:{code:"KeyN",keyCode:78},KeyO:{code:"KeyO",keyCode:79},KeyP:{code:"KeyP",keyCode:80},KeyQ:{code:"KeyQ",keyCode:81},KeyR:{code:"KeyR",keyCode:82},KeyS:{code:"KeyS",keyCode:83},KeyT:{code:"KeyT",keyCode:84},KeyU:{code:"KeyU",keyCode:85},KeyV:{code:"KeyV",keyCode:86},KeyW:{code:"KeyW",keyCode:87},KeyX:{code:"KeyX",keyCode:88},KeyY:{code:"KeyY",keyCode:89},KeyZ:{code:"KeyZ",keyCode:90},NumpadMultiply:{code:"NumpadMultiply",keyCode:106},NumpadAdd:{code:"NumpadAdd",keyCode:107},NumpadDecimal:{code:"NumpadDecimal",keyCode:108},NumpadSubtract:{code:"NumpadSubtract",keyCode:109},NumpadDivide:{code:"NumpadDivide",keyCode:111},F1:{code:"F1",keyCode:112},F2:{code:"F2",keyCode:113},F3:{code:"F3",keyCode:114},F4:{code:"F4",keyCode:115},F5:{code:"F5",keyCode:116},F6:{code:"F6",keyCode:117},F7:{code:"F7",keyCode:118},F8:{code:"F8",keyCode:119},F9:{code:"F9",keyCode:120},F10:{code:"F10",keyCode:121},F11:{code:"F11",keyCode:122},F12:{code:"F12",keyCode:123},F13:{code:"F13",keyCode:124},F14:{code:"F14",keyCode:125},F15:{code:"F15",keyCode:126},F16:{code:"F16",keyCode:127},F17:{code:"F17",keyCode:128},F18:{code:"F18",keyCode:129},F19:{code:"F19",keyCode:130},F20:{code:"F20",keyCode:131},F21:{code:"F21",keyCode:132},F22:{code:"F22",keyCode:133},F23:{code:"F23",keyCode:134},F24:{code:"F24",keyCode:135},NumLock:{code:"NumLock",keyCode:144},Semicolon:{code:"Semicolon",keyCode:186},Equal:{code:"Equal",keyCode:187},Comma:{code:"Comma",keyCode:188},Minus:{code:"Minus",keyCode:189},Period:{code:"Period",keyCode:190},Slash:{code:"Slash",keyCode:191},Backquote:{code:"Backquote",keyCode:192},IntlRo:{code:"IntlRo",keyCode:193},BracketLeft:{code:"BracketLeft",keyCode:219},Backslash:{code:"Backslash",keyCode:220},BracketRight:{code:"BracketRight",keyCode:221},Quote:{code:"Quote",keyCode:222},IntlYen:{code:"IntlYen",keyCode:255}};var kt=function(r){return r.Connection="connection",r.ConnectionEndMarker="connection-end-marker",r}(kt||{});let In=class extends bo.A{constructor(t,e,n){super(e),this.eventBus=t,this.canvas=e,this.diagramUtils=n,this._subscribeEvents()}_subscribeEvents(){this.eventBus.on([j.connect.move,j.connect.hover,j.connect.end],B.HIGH,t=>{this.onSnapping(t)})}canSetSnapping(t){const{source:e,target:n}=t;return n&&e&&!M.isRoot(n)&&!M.isRoot(e)&&!this.diagramUtils.isConnection(e)&&!this.diagramUtils.isConnection(n)&&!M.isLabel(e)&&!M.isLabel(n)}onSnapping(t){const e=t.context;this.canSetSnapping(e)&&this.setSnapping(t)}snapEvent(t,e){(0,Oe.CU)(t,"x",e.x),(0,Oe.CU)(t,"y",e.y)}};In=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("canvas")),(0,a.Qj)(2,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,M])],In);var Eo=v(81493);let Mn=class extends Eo.A{constructor(t,e,n){super(t,e),this.canvas=t,this.modeling=e,this.diagramUtils=n}createSingleCrossConnection(t,e){const n=t.source,i=e.target;if(n.outgoing.some(c=>c.target.id===i.id)||n.incoming.some(c=>c.source.id===i.id)||i.incoming.some(c=>c.source.id===n.id)||i.outgoing.some(c=>c.target.id===n.id)||i.outgoing.some(c=>c.source.id===n.id))return;const l=(0,Oe.jz)(i);this.modeling.reconnectEnd(t,i,l,{isUpdateConnectionType:!1})}createMultipleCrossConnections(t){const e=t.shape,n=[...e.incoming],i=[...e.outgoing];if(n.length<1||i.length<1)return;const s=i.filter(p=>this.isDiagramFlow(p)).sort((p,h)=>p.id>h.id?1:-1);if(s.length<1)return;const l=s[0];n.filter(p=>this.isDiagramFlow(p)).forEach(p=>this.createSingleCrossConnection(p,l))}isDiagramFlow(t){return this.diagramUtils.isFlow(t)}preExecute(t){const e=t.hints;e&&e.force||this.createMultipleCrossConnections(t),super.preExecute(t)}};Mn=(0,a.Cg)([(0,a.Qj)(0,(0,f.Inject)("canvas")),(0,a.Qj)(1,(0,f.Inject)("modeling")),(0,a.Qj)(2,(0,f.Inject)("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,Object])],Mn);var rs=v(64864),ls=v(23596),re=v(42127),Pn=v(62441),Le=v(78516);let Ot=class extends wn{constructor(t,e){super(),this.eventBus=t,this.diagramUtils=e,this._stopSync=0,this.sourceId=rs.q.create(),this.subscribeDiagramChanges()}getElement(t){const e=t.context.shape||t.context.element||t.context.connection;switch(!0){case M.isLabel(e):return this.getLabel(t);case this.diagramUtils.isConnection(e):return this.getConnection(t);default:return this.getShape(t)}}updateProperties(t,e){if(this._stopSync)return;const n=t.context,i=this.getElement(t),s={};if(e.forEach(l=>{const c=i[l],p=this.getOldValue(n,l);ls.A(p,c)||(s[l]=re.A(c))}),!Pn.A(s))switch(!0){case M.isLabel(i):this.service.bufferiseOps(ae.Update,["labels",i.id],s);break;case this.diagramUtils.isConnection(i):this.service.bufferiseOps(ae.Update,["connections",i.id],s);break;default:this.service.bufferiseOps(ae.Update,["elements",i.id],s)}}getShape(t){const e=t.context.shape||t.context.element;return{caption:e.caption,height:e.height,id:e.id,parent:e.parent&&e.parent.id,type:e.type,width:e.width,rx:e.rx,ry:e.ry,defaultParamValues:e.defaultParamValues,source:e.source}}getConnection(t){const e=t.context,n=e.connection||e.element,i=n.source||e.source,s=n.target||e.target;return{caption:n.caption,id:n.id,source:i.id,target:s.id,type:n.type,waypoints:n.waypoints}}getLabel(t){const e=t.context,n=e.shape,i=n.labelTarget||e.labelTarget;return{height:n.height,id:n.id,parent:i&&i.id,type:n.type,width:n.width,rx:n.rx,ry:n.ry}}addElement(t){const e=this.getElement(t);this.service.bufferiseOps(ae.Add,["elements"],{[e.id]:e})}subscribeDiagramChanges(){const t=this.eventBus;t.on([j.diagram.initialized],()=>{this.service.diagramInitialized()}),t.on([j.shape.createExecuted],e=>{if(!this._stopSync){const n=this.getElement(e);M.isLabel(n)?this.service.bufferiseOps(ae.Add,["labels"],{[n.id]:n}):this.addElement(e)}}),t.on([j.shape.deleteExecuted],e=>{if(!this._stopSync){const n=this.getElement(e);n.parent||(n.parent=e.context.oldParent.id),M.isLabel(n)?this.service.bufferiseOps(ae.Remove,["labels"],{[n.id]:n}):this.service.bufferiseOps(ae.Remove,["elements"],{[n.id]:n})}}),t.on([j.shape.moveExecuted],e=>{this.updateProperties(e,["parent","rx","ry"])}),t.on([j.shape.resizeExecuted],e=>{this.updateProperties(e,["rx","ry","width","height"])}),t.on([j.element.updateLabelExecuted],e=>{if(this._stopSync)return;const n=this.getElement(e);let i;this.diagramUtils.isConnection(n)?(i=this.getConnection(e),this.service.bufferiseOps(ae.Update,["connections",i.id],{caption:i.caption})):(i=this.getShape(e),this.service.bufferiseOps(ae.Update,["elements",i.id],{caption:i.caption}))}),t.on([j.element.updateExecuted],e=>{this.updateProperties(e,["width","height","type"])}),t.on([j.label.createExecuted],e=>{if(!this._stopSync){const n=this.getLabel(e);this.service.bufferiseOps(ae.Add,["labels"],{[n.id]:n})}}),t.on([j.connection.createExecuted],e=>{if(!this._stopSync){const n=this.getConnection(e);this.service.bufferiseOps(ae.Add,["connections"],{[n.id]:n})}}),t.on([j.connection.deleteExecuted],e=>{if(!this._stopSync){const n=this.getConnection(e);this.service.bufferiseOps(ae.Remove,["connections"],{[n.id]:n})}}),t.on([j.connection.reconnectExecuted],e=>{const n=e.context.hints.docking;this.updateProperties(e,[n,"type"])}),t.on([j.connection.updateWaypointsExecuted],e=>{this.updateProperties(e,["waypoints"])}),t.on([j.connection.layoutExecuted],e=>{this.updateProperties(e,["waypoints"])}),t.on([j.connection.moveExecuted],e=>{this.updateProperties(e,["waypoints"])}),t.on([j.connection.updateExecuted],e=>{this.updateProperties(e,["type"])}),t.on([j.connection.changeDirectionExecuted],e=>{this.updateProperties(e,["source","target","waypoints"])}),t.on([j.elements.changed],()=>{this.service.commit(this.sourceId).then()}),t.on(["undo"],()=>this.service.undo()),t.on(["redo"],()=>this.service.redo())}getOldValue(t,e){let n;switch(e){case"rx":case"ry":case"width":case"height":n=t.oldBounds[e];break;case"parent":n=Le.A(t,"oldParent.id");break;case"waypoints":n=Le.A(t,"oldWaypoints");break;case"source":n=Le.A(t,"oldSource.id");break;case"target":n=Le.A(t,"oldTarget.id");break;case"type":n=Le.A(t,"oldType");break;default:console.warn(`Unknown element property ${e}`)}return n}startSync(){this._stopSync=0}stopSync(){this._stopSync++}};Ot=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object])],Ot);var jo=v(6513);let Lt=class extends jo.A{constructor(t,e,n,i,s,l){super(t,e,n,i,s),this.eventBus=t,this.canvas=e,this.interactionEvents=n,this.bendpointMove=i,this.connectionSegmentMove=s,this.rules=l,t.on("element.marker.update",B.HIGH,this.onElementMarkerUpdate.bind(this))}onElementMarkerUpdate(t){this.rules.allowed("canElementMarkerUpdate")||(t.element={})}getConnectionBendpointsFilter(t,e,n){return e===0||e===n.length-1}};Lt=(0,a.Cg)([(0,a.Qj)(0,(0,f.Inject)("eventBus")),(0,a.Qj)(1,(0,f.Inject)("canvas")),(0,a.Qj)(2,(0,f.Inject)("interactionEvents")),(0,a.Qj)(3,(0,f.Inject)("bendpointMove")),(0,a.Qj)(4,(0,f.Inject)("connectionSegmentMove")),(0,a.Qj)(5,(0,f.Inject)("rules")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object,Object])],Lt);var Dn=v(69034),x=v(87004);let Tn=class extends Dn.A{constructor(t,e,n,i){super(t,e,n,i),this._canvas=t,this._eventBus=e,this._graphicsFactory=n,this._elementRegistry=i,e.on(["canvas.init"],s=>this.onInit(s))}onInit(t){const e=(0,x.vt)("defs");(0,x.BC)(t.svg,e)}zoom(t,e){const n=super.zoom(t,e);return this._eventBus.fire("zoom.changed",n),n}bringToFrontElement(t){const n=this._elementRegistry.getGraphics(t).parentNode,i=n.parentNode;i.removeChild(n),i.appendChild(n)}};Tn=(0,a.Cg)([(0,a.Qj)(0,d("config.canvas")),(0,a.Qj)(1,d("eventBus")),(0,a.Qj)(2,d("graphicsFactory")),(0,a.Qj)(3,d("elementRegistry")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object])],Tn);var So=v(17389);let kn=class extends So.A{constructor(t,e){super(t,e),this.eventBus=t}undo(){this.eventBus.fire("undo")}redo(){this.eventBus.fire("redo")}};kn=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("injector")),(0,a.Sn)("design:paramtypes",[Object,Object])],kn);var wo=v(28012);let On=class extends wo.A{constructor(t,e,n,i){super(t,e,n,i),this._injector=t,this._canvas=e,this._graphicsFactory=n,this._elementFactory=i}createNoopConnection(t,e){const n=(0,x.vt)("polyline");return(0,x.CF)(n,{stroke:"#8095b3",strokeWidth:2}),(0,x.CF)(n,{points:[t.x,t.y,e.x,e.y]}),n}};On=(0,a.Cg)([(0,a.Qj)(0,d("injector")),(0,a.Qj)(1,d("canvas")),(0,a.Qj)(2,d("graphicsFactory")),(0,a.Qj)(3,d("elementFactory")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object])],On);var Io=v(45041),cs=v(39732),Mo=v(3366),At=v(51807),O=v(76594),E=v(63030),Po=v(44156);let pe=class extends Po.A{constructor(t,e,n){super({style:re.A(V.label.editStyle)}),this.config=t,this.elements=e,this.diagramUtils=n,this.style=re.A(V.label.editStyle)}getElementLabelPosition(t,e){return e.delta?{x:Math.round(t.x+e.delta.x+e.width/2),y:Math.round(t.y+e.delta.y+e.height/2)}:{x:Math.round(t.x+t.width/2),y:Math.round(t.y+t.height+V.label.height/2)}}layoutToFirstLine(t,e){const i=t[0].textContent,s=super.layoutText(i,e);return s.element.children[0].textContent=i.substring(0,i.length-3)+"...",s}layoutRtlText(t,e){const n=t.element.children||[];n.length>1&&(t=this.layoutToFirstLine(n,e)),t.element.style.direction="rtl";const i=t.element.children||[];for(const s of i)s.style.direction="ltr";return t}getLabelPaddingTop(t,e){return 7}isIEOrEdge(){return/msie\s|trident\/|edge\//i.test(window.navigator.userAgent)}applySvgHelperContent(t,e){const n=this.isEmptyText(e)?"dummy":e;t.textContent=n}createForeignText(t,e,n){const i=document.createElement("div"),s=`color: ${Le.A(n,"style.fill","initial")}`;return i.setAttribute("class","foreign-text"),i.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),i.setAttribute("style",`width: ${e}px; ${s}`),i.textContent=t,i}createForeignTextContainer(t,e,n){const i=document.createElement("div");i.setAttribute("class","foreign-text-container"),i.setAttribute("xmlns","http://www.w3.org/1999/xhtml");const s=this.createForeignText(t,e,n);return i.append(s),i}createForeignObject(t,e){const n=document.createElementNS("http://www.w3.org/2000/svg","foreignObject"),i=t.height,s=t.width;n.setAttribute("height",i.toString()),n.setAttribute("width",s.toString());const l=this.createForeignTextContainer(t.text,t.width,e);return n.append(l),n}getTextLayout(t,e){const n=(0,O.kp)({},{},e.box);let i={height:n.height,width:n.width,text:t};if(e.needRecalcDimensions){const s=i.height===void 0?i.width:null,l=this.getHelperSvg(s);i={...this.getTextBBox(t,l),text:t},(0,E.TF)(l)}return i}getLabelOptions(t){return{box:{x:Math.round(t.width/2+t.x),y:Math.round(t.height/2+t.y),width:t.width||V.label.width,height:t.height},style:{direction:"ltr",...this.style}}}getHelperSvg(t){let e=document.getElementById("helper-svg");return e||(e=document.createElement("div"),e.setAttribute("id","helper-svg"),e.setAttribute("class","foreign-text foreign-text-helper"),t&&e.setAttribute("style",`max-width: ${t}px`),document.body.appendChild(e)),e}getTextBBox(t,e){this.applySvgHelperContent(e,t);const n=e.getBoundingClientRect();return{width:this.isEmptyText(t)?0:n.width,height:n.height}}getDimensions(t,e){return e.needRecalcDimensions=!0,this.layoutText(t,e).dimensions}createText(t,e){return super.createText(t,e)}layoutText(t,e){if(this.isIEOrEdge()){const s=super.layoutText(t,e);return this.config.isRtl?this.layoutRtlText(s,e):s}const n=this.getTextLayout(t,e),i=this.createForeignObject(n,e);return{dimensions:{width:n.width,height:n.height},element:i}}getConnectionLabelPosition(t,e){const n=Math.floor(t.length/2-1),i=t[n],s=t[n+1],l={x:Math.round((s.x-i.x)/2),y:Math.round((s.y-i.y)/2)},c=i.x+l.x;let p=i.y+l.y;return i.y===s.y&&(p+=Math.round(e.height/2)+5),{x:c,y:p}}getLabelBounds(t,e){const n=this.getLabelOptions(t),i=this.getDimensions(e,n);return{height:i.height,width:i.width,x:Math.round(t.x+t.width/2-i.width/2),y:Math.round(t.y)}}isEmptyText(t){return!t||!t.trim()}resetLabelPosition(t){const{width:i,height:s}=this.getLabelBounds(t,t.labelTarget.caption);t.width=i,t.height=s;const l=t.parent;t.x=Math.round(l.x+l.width/2-t.width/2),t.y=Math.round(l.y+l.height+V.label.height/2)-1*2-1}addLabel(t,e,n,i=e.caption){if(!this.isEmptyText(i)){const s=this.getLabelPosition(e,n);s.y+=this.getLabelPaddingTop(e,n.delta);const l={id:rs.q.create().toString(),getDimensions:!0,...At.A(n,["type","width","height"])};t.createLabel(e,s,l)}}getLabelPosition(t,e=V.label){return this.diagramUtils.isConnection(t)?this.getConnectionLabelPosition(t.waypoints,e):this.getElementLabelPosition(t,e)}};pe=(0,a.Cg)([(0,a.Qj)(0,d("config")),(0,a.Qj)(1,d("elements")),(0,a.Qj)(2,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,F,M])],pe);let Rt=class{constructor(t,e){this.modeling=t,this.diagramText=e}setText(t,e){const n=t.label||t,i=t.labelTarget||t;return i.caption=e,[n,i]}preExecute(t){const e=t.element;e&&!e.label&&!M.isLabel(e)&&this.diagramText.addLabel(this.modeling,e,V.label,t.text)}execute(t){t.oldText=t.element.caption||"";const e=(t.text||"").trim();return this.setText(t.element,e)}revert(t){return this.setText(t.element,t.oldText)}resizeShape(t,e){this.modeling.resizeShape(t,e,{height:0,width:0})}postExecute(t){const e=t.element.label;if(!e)return;const n=this.diagramText;if(n.isEmptyText(t.text))this.modeling.removeShape(e,{unsetLabel:!1});else{const i=e.labelTarget.caption;if(i){const s=t.newBounds||n.getLabelBounds(e,i);this.resizeShape(e,s)}}}};Rt=(0,a.Cg)([(0,a.Qj)(0,d("modeling")),(0,a.Qj)(1,d("diagramText")),(0,a.Sn)("design:paramtypes",[Object,pe])],Rt);var Do=v(34635);let Ln=class extends Do.A{constructor(t,e){super(t),this.canvas=t,this.diagramUtils=e,this.convertUtils=new Ue(e)}execute(t){const e=super.execute(t);return this.convertUtils.setRelativePosition(e,t.labelTarget),e}};Ln=(0,a.Cg)([(0,a.Qj)(0,d("canvas")),(0,a.Qj)(1,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object])],Ln);var To=v(2050);let zt=class extends To.A{constructor(t,e){super(t),this.canvas=t,this.diagramUtils=e,this.convertUtils=new Ue(e)}execute(t){const e=super.execute(t);return this.convertUtils.setRelativePosition(e),e}};zt=(0,a.Cg)([(0,a.Qj)(0,d("canvas")),(0,a.Qj)(1,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object])],zt);var ds=v(97970),Ae=v(65911);let _t=class extends ds.A{constructor(t){super(t)}execute(t){super.execute(t)}postExecute(t){const{connection:e,hints:n}=t;n&&n.docking&&(t.dockingOrPoints=n.docking==="source"?(0,Ae.pp)(e.source):(0,Ae.pp)(e.target)),super.postExecute(t)}};_t=(0,a.Cg)([(0,a.Qj)(0,d("modeling")),(0,a.Sn)("design:paramtypes",[Object])],_t);var ko=v(57261),Oo=v(45240);let An=class extends ko.A{constructor(t){super(t),this.modeling=t,this.postExecute=function(e){const n=e.movingShapes,i=e.delta;this.modeling.moveElements(n,i,void 0,{autoResize:!1,attach:!1})},this.preExecute=function(e){const n=e.resizingShapes,i=e.delta,s=e.direction;n.forEach(l=>{const c=(0,Oo.Ih)(l,s,i);this.modeling.resizeShape(l,c)})}}};An=(0,a.Cg)([(0,a.Qj)(0,d("modeling")),(0,a.Sn)("design:paramtypes",[Object])],An);var Lo=v(90006);let Nt=class extends Lo.A{constructor(t,e){super(t),this.modeling=t,this.canvas=e}getParent(t,e){const n=this.canvas.getRootElement();let i=super.getParent(t,e);return M.isLabel(i)&&(i=n),i}preExecute(t){super.preExecute(t)}};Nt=(0,a.Cg)([(0,a.Qj)(0,d("modeling")),(0,a.Qj)(1,d("canvas")),(0,a.Sn)("design:paramtypes",[Object,Object])],Nt);var Ao=v(12301);let Bt=class extends Ao.A{constructor(t,e,n,i){super(t),this.modeling=t,this.elementRegistry=e,this.canvas=n,this.diagramUtils=i}setParent(t){const e=t.newParent;e&&(this.diagramUtils.isFlow(e)&&(t.targetConnection=e,t.newParent=this.getRealParent(t)),M.isLabel(e)&&(t.newParent=this.getRealParent(t)))}getRealParent(t){const e=this.diagramUtils.getAllContainers(this.elementRegistry.getAllElements()),n=this.canvas.getRootElement(),i=t.shapes[0];return this.diagramUtils.findRealElementParent({x:i.x,y:i.y},e,n)}postExecute(t){this.setParent(t),super.postExecute(t)}};Bt=(0,a.Cg)([(0,a.Qj)(0,d("modeling")),(0,a.Qj)(1,d("elementRegistry")),(0,a.Qj)(2,d("canvas")),(0,a.Qj)(3,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,M])],Bt);const Ro={CENTER:"center",RIGHT:"right",LEFT:"left"},zo={TOP:"top",CENTER:"center",BOTTOM:"bottom"};let se=class extends Mo.A{constructor(t,e,n,i,s,l,c,p,h){super(t,e,n,i),this.eventBus=t,this.elementFactory=e,this.commandStack=n,this.canvas=i,this.registry=s,this.diagramText=l,this.elements=c,this.rules=p,this.diagramUtils=h,this.convertUtils=new Ue(h)}addShapeHandlers(t){t[j.shape.shapeCreate]=zt}addLabelHandlers(t){t[j.label.create]=Ln}getLabelPositionByX(t,e){return t.horizontalAlignment===Ro.CENTER?t.x:t.x+e.width/2}getLabelPositionByY(t,e){return t.verticalAlignment===zo.CENTER?t.y:t.y+e.height/2}getLabelPosition(t,e,n){let i,s;if(this.needResetLabelPosition(t,e)){const l=this.diagramText.getLabelPosition(e,n),c=this.getFixedLabelPosition(l,n,e);i=!Z.A(t.x)&&Z.A(t.y)?this.getLabelPositionByX(t,n):c.x,s=!Z.A(t.y)&&Z.A(t.x)?this.getLabelPositionByY(t,n):c.y}else i=this.getLabelPositionByX(t,n),s=this.getLabelPositionByY(t,n);return{x:Math.round(i),y:Math.round(s)}}getLabelSize(t,e){let n;if(t.width&&t.height)n={width:t.width,height:t.height};else{const i=t.caption||e.caption,s=this.diagramText.getLabelBounds(t,i);n={width:s.width,height:s.height}}return n}addElementHandlers(t){t[j.element.updateLabel]=Rt}addConnectionHandlers(t){t[j.connection.update]=_t,t[j.connection.reconnect]=_t}getFixedLabelPosition(t,e,n){const l=t.x,c=this.diagramUtils.isConnection(n)?t.y:t.y+e.height/2-1*2-1;return{x:Math.round(l),y:Math.round(c)}}needResetLabelPosition(t,e){return Z.A(t.x)||Z.A(t.y)}getElement(t){return typeof t=="string"?this.registry.get(t):t}addElementsHandlers(t){t[j.elements.create]=Nt,t[j.elements.move]=Bt}getLabelAttributes(t,e,n,i){return{id:e.id,type:t.type,width:n.width,height:n.height,caption:t.caption,backgroundStyle:t.backgroundStyle,style:t.style,hidden:i?.hidden,tooltip:t.tooltip,tooltipConfig:t.tooltipConfig}}getElementAttributes(t,e,n){const{caption:i,type:s}=e,l=e.width||n.width,c=e.height||n.height,p=e.largeImage||n.largeImage,h=e.name;return{id:t,type:s,width:l,height:c,largeImage:p,name:h,caption:i&&i.toString(),tooltip:e.tooltip,tooltipConfig:e.tooltipConfig}}centerViewbox(t){M.centerViewboxOnElement(t,this.canvas)}getElementPosition(t,e){const{x:n=0,y:i=0}=t,s=t.width||e.width,l=t.height||e.height;return{x:Math.round(n+s/2),y:Math.round(i+l/2)}}createDiagramLabel(t){const e=re.A(t.value),n=this.registry.get(e.parent);if(n){this.convertUtils.setShapeAbsolutePosition(e,n);const i=this.getLabelSize(e,n);e.height=e.height||i.height;const s=this.getLabelPosition(e,n,i),l=this.getLabelAttributes(e,t,i,n);return this.createLabel(n,s,l,n)}}createDiagramElement(t,e){if(this.registry.get(t))return;const n=this.elements.items.root.id,i=re.A(e[t]),s=i.parent||n;let l=this.registry.get(s);l||(this.createDiagramElement(s,e),l=this.registry.get(s)),this.convertUtils.setShapeAbsolutePosition(i,l);const c=this.elements.getConfig(i),p=this.getElementAttributes(t,i,c),h=this.getElementPosition(i,c);this.createShape(p,h,l,0,{generateUniqueCaption:!1})}getHandlers(){const t=super.getHandlers(this);return t.spaceTool=An,this.addLabelHandlers(t),this.addShapeHandlers(t),this.addElementHandlers(t),this.addElementsHandlers(t),this.addConnectionHandlers(t),t}moveConnection(t,e,n,i){super.moveConnection(t,e,t.parent,n,i)}createShape(t,e,n,i,s){return super.createShape(t,e,n,i,s)}pasteElements(t,e,n){super.pasteElements(t,e,n)}moveShape(t,e,n=null,i=null,s=null){super.moveShape(t,e,n,i,s)}updateWaypoints(t,e,n={}){const i=this.getElement(t);i&&(cs.A(n,{doUpdateLabelPosition:!0}),super.updateWaypoints(i,e,n))}reconnect(t,e,n,i,s){s&&s.docking==="target"&&cs.A(s,{isUpdateConnectionType:!0});const l=this.getElement(t),c=this.getElement(e),p=this.getElement(n);l&&(c||p)&&super.reconnect(l,c,p,i,s)}reconnectStart(t,e,n,i={}){if(!n){const s=this.getElement(t),l=s.waypoints[0];n=l.original||M.getOriginalWaypoint(l,s.source)}super.reconnectStart(t,e,n,i)}reconnectEnd(t,e,n,i={}){if(!n){const s=this.getElement(t),l=s.waypoints,c=l[l.length-1];n=c.original||M.getOriginalWaypoint(c,s.target)}super.reconnectEnd(t,e,n,i)}createLabel(t,e,n,i){if(this.registry.get(n.id))return;const s=super.createLabel(t,e,n,i);return s.parent=t,s}removeConnection(t){const e=this.getElement(t);e&&super.removeConnection(e)}connect(t,e,n,i){const s=this.canvas.getRootElement();return n=n||{},this.createConnection(t,e,n,s,i)}createConnection(t,e,n,i,s,l){if(typeof n=="object"&&(l=s,s=i,i=n,n=void 0),!this.registry.get(i.id))return s=s||this.canvas.getRootElement(),super.createConnection(t,e,n,i,s,l)}updateLabel(t,e,n=null){const i=this.getElement(t);i&&this.commandStack.execute(j.element.updateLabel,{element:i,text:e,newBounds:n})}moveConnectionLabel(t,e){const n={connection:t,hints:e};this.eventBus.fire(j.connection.moveConnectionLabel,{context:n})}removeElementChildren(t){const e=t.children;for(e.length&&this.eventBus.fire(j.elements.removing,{elements:e});e.length>0;){const n=e[0];this.removeShape(n,{force:!0})}}resizeShape(t,e,n,i){super.resizeShape(t,e,n,i)}removeShape(t,e){super.removeShape(t,e)}removeElements(t,e=!1){(e||this.rules.allowed(j.elements.delete,{elements:t}))&&super.removeElements(t)}clearDiagram(){const t=this.registry.getAllElements();super.removeElements(t)}layoutConnection(t,e){super.layoutConnection(t,e)}};se=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("elementFactory")),(0,a.Qj)(2,d("commandStack")),(0,a.Qj)(3,d("canvas")),(0,a.Qj)(4,d("elementRegistry")),(0,a.Qj)(5,d("diagramText")),(0,a.Qj)(6,d("elements")),(0,a.Qj)(7,d("rules")),(0,a.Qj)(8,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object,Object,F,Object,M])],se);let Gt=class extends Io.A{constructor(t,e,n,i,s,l,c){super(t,e,n,i,c,l),this.rules=s;const p=this.start;this.start=(h,m,C)=>{this.rules.allowed("canConnectionSegmentMove")&&p.call(this,h,m,C)}}};Gt=(0,a.Cg)([(0,a.Qj)(0,d("injector")),(0,a.Qj)(1,d("eventBus")),(0,a.Qj)(2,d("canvas")),(0,a.Qj)(3,d("dragging")),(0,a.Qj)(4,d("rules")),(0,a.Qj)(5,d("modeling")),(0,a.Qj)(6,d("graphicsFactory")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object,se,Object])],Gt);const gs=".entry";let Ft=class{constructor(t,e,n,i){this.eventBus=t,this.overlays=e,this.rules=n,this.canvas=i,this._providers=[],this.current=null,this.init()}init(){this.eventBus.on("selection.changed",t=>{const e=t.newSelection;e.length===1?this.open(e[0]):this.close()}),this.eventBus.on("elements.delete",t=>{const e=t.elements;(0,O.jJ)(e,n=>{this.isOpen(n)&&this.close()})}),this.eventBus.on("element.changed",t=>{const e=t.element,n=this.current;n&&n.element===e&&this.open(e,!0)}),this.eventBus.on("canvas.viewbox.changing",()=>{this.isOpen()&&(0,O.kp)(this.current.pad.html.style,{visibility:"hidden"})}),this.eventBus.on("canvas.viewbox.changed",()=>{const t=this.current&&this.current.element;t&&this.open(t,!0)}),this.eventBus.on("diagram.clear",()=>{this.close()})}canOpen(t){return this.rules.allowed("canOpenContextPad",{})}getSeparatorConfig(){return{className:"entry-separator"}}getNoopConfig(){return{noop:{className:"noop-entry"}}}sliceObj(t,e,n){return Object.keys(t).slice(e,n).reduce((i,s)=>(i[s]=t[s],i),{})}addNoopEntry(t){const e=Object.keys(t);return e.length<=2||e[1]==="setup"?t:{...this.sliceObj(t,0,1),...this.getNoopConfig(),...this.sliceObj(t,1,e.length)}}addSeparators(t){const e=Object.keys(t);return e.length<=1?t:e.length===2?e[1]==="setup"?t:(this.oneColumnMode=!0,{...this.sliceObj(t,0,1),separator1:this.getSeparatorConfig(),...this.sliceObj(t,1,e.length)}):{...this.sliceObj(t,0,2),separator1:this.getSeparatorConfig(),separator2:this.getSeparatorConfig(),...this.sliceObj(t,2,e.length)}}fixConnectToolPosition(t){const e=Object.keys(t);if(e.length<=2)return t;const n=e.indexOf("connect");if(n<0||n%2===0)return t;const i=e[n-1];return{...this.sliceObj(t,0,n-1),connect:t.connect,[i]:t[i],...this.sliceObj(t,n+1,e.length)}}fixEntries(t){return this.oneColumnMode=!1,t=this.addNoopEntry(t),t=this.addSeparators(t),t=this.fixConnectToolPosition(t),t}trigger(t,e,n=!1){const{entries:i,element:s}=this.current,l=e.delegateTarget||e.target;if(!l)return e.preventDefault();const c=(0,E.CF)(l,"data-action"),h=i[c].action,m=e.originalEvent||e;if((0,O.Tn)(h)){if(t==="click")return h(m,s,n)}else if(h[t])return h[t](m,s,n);e.preventDefault()}getConnectionBBox(t){const e=(0,ve.U7)(t);return{x:e.x,y:e.y,width:e.width,height:e.height}}getElementBBox(t){return{x:t.x,y:t.y,width:t.width,height:t.height}}getPadPosition(t){const e={left:9,top:-6},n=this.canvas.viewbox(),i=t.waypoints?this.getConnectionBBox(t):this.getElementBBox(t),s=i.x+i.width+e.left-n.x,l=i.y+e.top-n.y,c=n.scale;return{x:Math.round(s*c),y:Math.round(l*c)}}getEntryControl(t,e){const{className:n,title:i,imageUrl:s}=e,l=(0,E.zm)(`<div class="entry" draggable="true" data-action="${t}"></div>`);if(n){const c=(0,E.Ly)(l);((0,O.cy)(n)?n:n.split(/\s+/g)).forEach(h=>{c.add(h)})}return i&&(0,E.CF)(l,"title",i),s&&l.appendChild((0,E.zm)('<img src="'+s+'">')),l}addEntriesContainer(t){const e=(0,E.zm)('<div class="group"></div>');return(0,O.jJ)(t,(n,i)=>{const s=this.getEntryControl(i,n);e.appendChild(s)}),e}getPad(t){if(this.isOpen())return this.current.pad;const e=(0,E.zm)('<div class="djs-context-pad"></div>');E.Mm.bind(e,gs,"click",s=>{this.trigger("click",s)}),E.Mm.bind(e,gs,"dragstart",s=>{this.trigger("dragstart",s)}),E.f0.bind(e,"mousedown",s=>{s.stopPropagation()});const n=this.getPadPosition(t);(0,O.kp)(e.style,{position:"absolute",left:n.x+"px",top:n.y+"px",visibility:"visible"});const i={html:e};return this.eventBus.fire("contextPad.create",{element:t,pad:i}),i}getEntries(t){const e={};return(0,O.jJ)(this._providers,n=>{const i=n.getContextPadEntries(t);(0,O.jJ)(i,(s,l)=>{e[l]=s})}),this.fixEntries(e)}registerProvider(t){this._providers.push(t)}open(t,e=!1){if(!e&&this.isOpen(t)||(this.close(),!this.canOpen(t)))return;const n=this.getEntries(t);if(Pn.A(n))return;const i=this.addEntriesContainer(n),s=this.getPad(t),l=s.html;l.appendChild(i),(0,E.Ly)(l).add("open"),(0,E.Ly)(l).toggle("one-column-grid",this.oneColumnMode),this.canvas.getContainer().appendChild(l),this.current={element:t,pad:s,entries:n},this.eventBus.fire("contextPad.open",{current:this.current})}isOpen(t){return this.current&&(!t||this.current.element===t)}close(){this.isOpen()&&((0,E.TF)(this.current.pad.html),this.eventBus.fire("contextPad.close",{current:this.current}),this.current.pad.html=null,this.current=null)}};Ft=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("overlays")),(0,a.Qj)(2,d("rules")),(0,a.Qj)(3,d("canvas")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object])],Ft);var Rn=v(70669),_o=v(7034);let Qt=class extends _o.A{constructor(t,e,n,i,s,l,c,p,h,m){super(t,e,n,i,s,l,c,p),this.canvas=t,this.create=e,this.clipboard=n,this.elementFactory=i,this.eventBus=s,this.modeling=l,this.mouse=c,this.rules=p,this.diagramText=h,this.config=m,this.init()}_onPasteElement(t){Object.assign(t.hints,{generateUniqueCaption:!1,isElementCopyPaste:!0})}onCopyElement({element:t,descriptor:e}){this.copyProperties.forEach(n=>e[n]=(0,Rn.A)(t[n]))}init(){this.copyProperties=["type","caption"],this.eventBus.on("copyPaste.pasteElements",t=>this._onPasteElement(t)),this.eventBus.on("copyPaste.copyElement",t=>this.onCopyElement(t))}resetLabelsPosition(t){const e=t.filter(n=>M.isLabel(n));e.length===1&&t.length===2&&this.diagramText.resetLabelPosition(e[0])}_createElements(t){const e=super._createElements(t);return this.resetLabelsPosition(e),e}createShape(t){const e=t.id,n=super.createShape(t);return n.sourceId=e,n}};Qt=(0,a.Cg)([(0,a.Qj)(0,d("canvas")),(0,a.Qj)(1,d("create")),(0,a.Qj)(2,d("clipboard")),(0,a.Qj)(3,d("elementFactory")),(0,a.Qj)(4,d("eventBus")),(0,a.Qj)(5,d("modeling")),(0,a.Qj)(6,d("mouse")),(0,a.Qj)(7,d("rules")),(0,a.Qj)(8,d("diagramText")),(0,a.Qj)(9,d("config")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,Object,Object])],Qt);let at=class{constructor(t,e){this.eventBus=t,this.canvas=e}getEntry(t,e){const n=(0,O.gH)({id:e}),i=(0,O.I6)(t,n);if(!i)throw new Error("entry not found");return i}createContainer(){const e=this.canvas.getContainer().getBoundingClientRect(),i=(0,E.P)(`[data-action="${this.paletteEntryId}"]`).getBoundingClientRect(),s={x:12,y:-5},l={x:i.left+i.width+s.x-e.left,y:i.top+s.y-e.top},c=(0,E.zm)('<div class="djs-popup diagram-create-popup-menu">');return(0,O.kp)(c.style,{position:"absolute",left:l.x+"px",top:l.y+"px",visibility:"hidden"}),c}alignPosition(t){const n=this.canvas.getContainer().getBoundingClientRect(),i=t.getBoundingClientRect(),s=10,l=i.top+i.height-(n.top+n.height)+s;if(l>0){let c=i.top-n.top-l;c=c>s?c:s,(0,O.kp)(t.style,{top:c+"px"})}}entryAction(t,e,n){n.preventDefault();const i=n.delegateTarget||n.target,s=(0,E.CF)(i,"data-id"),l=this.getEntry(t,s),c=l.action[e];c&&c.call(null,n,l)}attachContainer(t,e){const n=this.canvas.getContainer();E.Mm.bind(e,".entry","dragstart",this.entryAction.bind(this,t,"dragstart")),E.Mm.bind(e,".entry","click",this.entryAction.bind(this,t,"click")),n.appendChild(e),this.alignPosition(e),(0,O.kp)(e.style,{visibility:"visible","z-index":1e3,opacity:1}),this.subscribeEvents(),e.onwheel=i=>this.onWheel(i)}createEntriesContainer(t){const e=(0,E.zm)('<div class="djs-popup-body">');return(0,O.jJ)(t,n=>{const i=this.createEntry(n);e.appendChild(i)}),e}createEntry(t){if(!t.id)throw new Error("every entry must have the id property set");const e=(0,E.zm)('<div class="entry" draggable="true"></div>');(0,E.Ly)(e).add("entry"),(0,E.CF)(e,"data-id",t.id);const i=(0,E.zm)("<span>");return i.textContent=t.label,e.appendChild(i),e.appendChild((0,E.zm)('<img src="'+t.imageUrl+'" />')),e}subscribeEvents(){const t=this.eventBus;t.once("contextPad.close",this.close.bind(this)),t.once("popupMenu.open",this.close.bind(this)),t.once("canvas.viewbox.changing",this.close.bind(this)),t.once("commandStack.changed",this.close.bind(this)),t.once("element.mousedown",B.HIGH,this.close.bind(this)),t.once("keyboard.keydown",B.HIGH,this.close.bind(this))}unsubscribeEvents(){const t=this.eventBus;t.off("contextPad.close",this.close.bind(this)),t.off("popupMenu.open",this.close.bind(this)),t.off("canvas.viewbox.changed",this.close.bind(this)),t.off("commandStack.changed",this.close.bind(this)),t.off("element.mousedown",this.close.bind(this)),t.off("keyboard.keydown",this.close.bind(this))}open(t,e,n){if(this.isOpen()&&(this.close(),t.type===this.currentElement.type))return;this.currentElement=t,this.paletteEntryId=e,this.eventBus.fire("createPopupMenu.open",{paletteEntryId:e});const i=this.createContainer(),s=this.createEntriesContainer(n);i.appendChild(s),this.attachContainer(n,i),this.container=i}close(){if(!this.isOpen())return;const t=this.paletteEntryId;this.eventBus.fire("createPopupMenu.close",{paletteEntryId:t}),this.unsubscribeEvents(),(0,E.TF)(this.container),this.container=null}isOpen(){return!!this.container}onWheel(t){const e=t.wheelDeltaY||-(t.deltaY*25);this.container.scrollTop-=e,t.stopPropagation(),t.returnValue=!1}};at=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("canvas")),(0,a.Sn)("design:paramtypes",[Object,Object])],at);var No=v(20990);let zn=class extends No.A{constructor(t,e){super(e,t),this.injector=t}_registerDefaultActions(){super._registerDefaultActions.call(this,this.injector);const t=this.injector.get("elementRegistry",!1),e=this.injector.get("selection",!1);t&&e&&super._registerAction("selectAll",()=>{const n=t.getAllElements();return e.select(n),n})}};zn=(0,a.Cg)([(0,a.Qj)(0,d("injector")),(0,a.Qj)(1,d("eventBus")),(0,a.Sn)("design:paramtypes",[Object,Object])],zn);var Bo=v(15176),Go=v(71679),_n=v.n(Go);class ps extends Bo.A{constructor(){super(),_n().config({disableDefaultAlphabetLength:!0}),_n().characters("0123456789abcdefghijklmnopqrstuvwxyz")}generateId(t){return t+"_"+_n().generate()}create(t,e){return e=Object.assign({},e),e.type||(e.type=t),e.id||(e.id=this.generateId(e.type)),super.create(t,e)}}var Fo=v(54343);let rt=class extends Fo.A{constructor(t){super(),this.injector=t}getAllElements(){const e=this.injector.get("canvas",!1).getRootElement();return super.filter(n=>n!==e)}getAll(){return this.getAllElements()}getGraphics(t,e){return super.getGraphics(t,e)}get(t){return super.get(t)}};rt=(0,a.Cg)([(0,a.Qj)(0,d("injector")),(0,a.Sn)("design:paramtypes",[Object])],rt),(0,f.ngxTranslateExtract)("diagram.elementTools.connect.connect"),(0,f.ngxTranslateExtract)("diagram.elementTools.remove"),(0,f.ngxTranslateExtract)("diagram.elementTools.changeType");const Qo="assets/images/icon_tools_del.svg",Uo="assets/images/icon_tools_setup.svg",Ho="assets/images/icon_tools_arrow.svg";let lt=class{constructor(t,e){this.elements=t,this.config=e,this.addItems=this.getAddItems(),this.tools=this.getTools()}getAddItems(){return[]}getTools(){const t=this.config.localizableStrings;return{connect:{imageUrl:Ho,title:t.get("elementTools.connect.connect")},setup:{imageUrl:Uo,title:t.get("elementTools.changeType")},delete:{imageUrl:Qo,title:t.get("elementTools.remove")}}}};lt=(0,a.Cg)([(0,a.Qj)(0,d("elements")),(0,a.Qj)(1,d("config")),(0,a.Sn)("design:paramtypes",[F,Object])],lt);var Wo=v(77117),hs=v(34495);function ct(r){const t=te[r.code];return t?t.keyCode:r.keyCode}function Vo(r){if(r.ctrlKey||r.metaKey||r.altKey)return!1;const t=r.which||r.keyCode;return t>47&&t<58||t>64&&t<91||t>95&&t<112||t>185&&t<193||t>218&&t<223}function ye(r,t,e={}){return!Z.A(e.ctrl)&&e.ctrl!==(0,hs.nM)(r)||!Z.A(e.shift)&&e.shift!==(0,hs.Tu)(r)?!1:ct(r)===t.keyCode}function Zo(r){return ct(r)===te.Enter.keyCode}function Yo(r,t){r.shiftKey||(r.stopPropagation(),r.preventDefault(),r.ctrlKey||r.altKey?document.execCommand("insertText",!1,`
`):t())}class $o extends Wo.A{registerBindings(t,e){const s=(l,c)=>{e.isRegistered(l)&&t.addListener(c)};s("stepZoom",l=>{const c=l.keyEvent;if(ye(c,te.Equal,{ctrl:!0})||ye(c,te.NumpadAdd,{ctrl:!0}))return e.trigger("stepZoom",{value:1}),!0}),s("undo",l=>{const c=l.keyEvent;if(ye(c,te.KeyZ,{ctrl:!0,shift:!1}))return e.trigger("undo"),!0}),s("redo",l=>{const c=l.keyEvent;if(ye(c,te.KeyY,{ctrl:!0})||ye(c,te.KeyZ,{ctrl:!0,shift:!0}))return e.trigger("redo"),!0}),s("copy",l=>{const c=l.keyEvent;if(ye(c,te.KeyC,{ctrl:!0}))return e.trigger("copy"),!0}),s("paste",l=>{const c=l.keyEvent;if(ye(c,te.KeyV,{ctrl:!0}))return e.trigger("paste"),!0}),s("selectAll",l=>{const c=l.keyEvent;if(ye(c,te.KeyA,{ctrl:!0}))return e.trigger("selectAll"),!0}),super.registerBindings(t,e)}}var Jo=v(40406);let Nn=class extends Jo.A{constructor(t,e,n,i,s,l){super(t,e,n,i,s,l),this.eventBus=t,this.canvas=e,this.dragging=n,this.elementRegistry=i,this.selection=s,this.toolManager=l}select(t,e){const n=(0,ve.rx)(t,e),i=(0,O.zu)(n),s=i.filter(l=>M.isLabel(l)&&i.includes(l.parent)||!M.isLabel(l));this.selection.select(s)}};Nn=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("canvas")),(0,a.Qj)(2,d("dragging")),(0,a.Qj)(3,d("elementRegistry")),(0,a.Qj)(4,d("selection")),(0,a.Qj)(5,d("toolManager")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object,Object])],Nn);var Ut=v(86218),us=v(23527);let dt=class{constructor(t,e,n,i,s){this.elementRegistry=t,this.diagramModeling=e,this.elements=n,this.eventBus=i,this.logger=s,this.errors=[],this.loadRenderInterval=500}createElement(t,e){this.diagramModeling.createDiagramElement(t,e)}createLabel(t,e){this.diagramModeling.createDiagramLabel({value:t,id:e})}createConnection(t,e){const n=re.A(t),{source:i,target:s}=n,l=this.elementRegistry,c=l.get(i),p=l.get(s),h=this.getConnectionAttributes(e,n);this.diagramModeling.connect(c,p,h,t.hints||{})}addOriginalToWaypoint(t,e){if(!t.original){const n=this.elementRegistry.get(e);n&&(t.original=M.getOriginalWaypoint(t,n))}}addOriginalToConnection(t){const e=t.waypoints;if(e&&e.length>1){const n=e[0];this.addOriginalToWaypoint(n,t.source);const i=e[e.length-1];this.addOriginalToWaypoint(i,t.target)}}getConnectionAttributes(t,e){const{waypoints:n,name:i,type:s=ie.connection}=e;this.addOriginalToConnection(e);let{caption:l,documentation:c}=e;return l=l&&l.toString(),c=c&&c.toString(),{id:t,waypoints:n,name:i,caption:l,documentation:c,type:s}}load(t,e,n){var i=this;return(0,D.A)(function*(){i.errors=[];const s=[...Ut.A(t.elements,(c,p)=>({handler:()=>i.createElement(p,t.elements),id:p})),...Ut.A(t.connections,(c,p)=>({handler:()=>i.createConnection(c,p),id:p})),...Ut.A(t.labels,(c,p)=>({handler:()=>i.createLabel(c,p),id:p}))];let l=Number(new Date);try{for(let c=0,p=s.length;c<p&&!e.isStopped;c++){try{s[c].handler()}catch(m){i.errors.push(s[c].id+" "+m.toString()),console.error(m)}if(Number(new Date)-l>i.loadRenderInterval){const m=Math.round(c/p*100);n.next(m),yield new Promise(C=>us.A(C,0)),l=Number(new Date)}}return i.errors.length&&i.logger.exception(`Error when loading process with ID: ${t.id}`,{loggerName:"DiagramLoader"},i.errors),i.errors}finally{n.next(0),e.isStopped||i.eventBus.fire("diagram.loaded")}})()}};dt=(0,a.Cg)([(0,a.Qj)(0,d("elementRegistry")),(0,a.Qj)(1,d("modeling")),(0,a.Qj)(2,d("elements")),(0,a.Qj)(3,d("eventBus")),(0,a.Qj)(4,d("loggerService")),(0,a.Sn)("design:paramtypes",[Object,se,F,Object,f.LoggerService])],dt);let Ht=(()=>{class r extends f.LocalStorageService{constructor(){super({prefix:"bpmonline-designer.diagram",storageType:"localStorage"}),this.diagramId=""}set(e,n,i=!0){return i&&(e+="."+this.diagramId),super.set(e,n)}get(e,n=!0){return n&&(e+="."+this.diagramId),super.get(e)}remove(...e){return e&&(e=e.map(n=>n+"."+this.diagramId)),super.remove(...e)}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac})}}return r})();var Ko=v(22185),ms=v.n(Ko),Xo=v(12266);const Wt=50,qo={min:.2,max:4},ea=10,ta=.1;let Bn=class{constructor(t,e,n,i,s,l,c,p){this.eventBus=t,this.canvas=e,this.elementRegistry=n,this.zoomScroll=i,this.localStorage=s,this.popupMenu=l,this.config=c,this.diagramUtils=p,this.openStateKey="minimap-state",this.loadMiniMapRenderInterval=50,this._onElementAdded=this.onElementAdded.bind(this),this._onElementRemoved=this.onElementRemoved.bind(this),this._onElementsChanged=this.onElementsChanged.bind(this),this._onElementUpdateId=this.onElementUpdateId.bind(this),this.init()}init(){const t=this.getOpenState();this._state={isOpen:t,isDragging:!1,initialDragPosition:null,offsetViewport:null,cachedViewbox:null,dragger:null,svgClientRect:null,parentClientRect:null,zoomDelta:0,data:null},this.createComponent(),this.registerPopupMenu(),this.subscribeEvents()}getOpenState(){return this.localStorage.get(this.openStateKey,!1)}setOpenState(t){(0,O.kp)(this._state,{isOpen:t}),this.localStorage.set(this.openStateKey,t,!1),t?((0,E.Ly)(this.parent).add("open"),(0,E.CF)(this.mapButtons.preview,"title",this.config.localizableStrings.get("miniMapClose"))):((0,E.Ly)(this.parent).remove("open"),(0,E.CF)(this.mapButtons.preview,"title",this.config.localizableStrings.get("miniMapOpen")))}createComponent(){this.parent=document.createElement("div"),(0,E.Ly)(this.parent).add("djs-minimap"),E.f0.bind(this.parent,"mousedown",e=>e.stopPropagation());const t=this.canvas.getContainer();this.isOpen()&&(0,E.Ly)(this.parent).add("open"),t.appendChild(this.parent),this.initButtons(),this.map=document.createElement("div"),(0,E.Ly)(this.map).add("map"),this.parent.appendChild(this.map),this.svg=(0,x.vt)("svg"),(0,x.CF)(this.svg,{width:"100%",height:"100%"}),(0,x.BC)(this.map,this.svg),this.elementsGroup=(0,x.vt)("g"),(0,x.BC)(this.svg,this.elementsGroup),this.viewportGroup=(0,x.vt)("g"),(0,x.BC)(this.svg,this.viewportGroup),this.viewport=(0,x.vt)("rect"),(0,x.Ly)(this.viewport).add("viewport"),(0,x.BC)(this.viewportGroup,this.viewport),this.viewportDom=document.createElement("div"),(0,E.Ly)(this.viewportDom).add("viewport-dom"),this.parent.appendChild(this.viewportDom),this.overlay=document.createElement("div"),(0,E.Ly)(this.overlay).add("overlay"),this.parent.appendChild(this.overlay)}initButtons(){const t=document.createElement("div");(0,E.Ly)(t).add("map-buttons"),this.mapButtons={},this.getMapButtonsConfig().forEach(n=>{const i=document.createElement("div");if(["map-button",...n.classes].forEach(s=>(0,E.Ly)(i).add(s)),n.title){let s=this.config.localizableStrings.get(n.title);n.shortcut&&(s+=` (${n.shortcut})`),(0,E.CF)(i,"title",s)}n.caption&&(i.textContent=n.caption),this.subscribeUserEvent(i,"click",n.click),this.mapButtons[n.id]=i,t.appendChild(i)}),this.parent.appendChild(t)}getMapButtonsConfig(){return[{id:"preview",classes:["material-icons","preview-button"],title:this.isOpen()?"miniMapClose":"miniMapOpen",caption:"icon_preview_16",click:()=>this.preview()},{id:"fitToView",classes:["material-icons","fit-to-view-button"],title:"fitToView",shortcut:"Ctrl+0",caption:"icon_fullscreen_16",click:()=>this.fitToView()},{id:"resetView",classes:["reset-view-button"],title:"resetView",caption:"1:1",click:()=>this.resetView()},{id:"zoomOut",classes:["material-icons","zoom-out-button"],title:"zoomOut",shortcut:"Ctrl+-",caption:"icon_zoom_out_16",click:()=>this.zoomScroll.zoomOut()},{id:"zoomIn",classes:["material-icons","zoom-in-button"],title:"zoomIn",shortcut:"Ctrl++",caption:"icon_zoom_in_16",click:()=>this.zoomScroll.zoomIn()},{id:"zoom",classes:["zoom-button"],caption:"100%",click:()=>this.togglePopupMenu()}]}subscribeEvents(){let t=!0;this.eventBus.on("diagram.loaded",()=>{t?(t=!1,this.isOpen()&&this.open().then(()=>{this.onDiagramLoaded().then()})):this.onDiagramLoaded().then()}),this.subscribeUserEvent(this.svg,"click",e=>this.onSvgClick(e)),E.f0.bind(this.viewportDom,"mousedown",e=>this.onMousedown(!1,e)),E.f0.bind(this.svg,"mousedown",e=>this.onMousedown(!0,e)),this.subscribeUserEvent(this.parent,"wheel",e=>this.onParentWheel(e)),this.eventBus.on("canvas.viewbox.changed",()=>this.onViewBoxChanged()),this.eventBus.on("canvas.resized",()=>this.onCanvasResized()),this.eventBus.on("zoom.changed",(e,n)=>this._onZoomChanged(n)),this.eventBus.on("keyboard.keydown",e=>this.onKeyDown(e)),this.eventBus.on("diagram.clear",()=>this.onClear())}onDiagramLoaded(){var t=this;return(0,D.A)(function*(){t.isOpen()&&(yield t.loadData(),t.subscribeElementEvents())})()}onSvgClick(t){this.setViewboxCenteredAroundClickEvent(t)}onViewBoxChanged(){this._state.isDragging||this.update()}onCanvasResized(){document.body.contains(this.parent)&&(this._state.isDragging||this.update(),this._state._svgClientRect=this.svg.getBoundingClientRect())}onKeyDown({keyEvent:t}){if(t.ctrlKey&&ct(t)===te.Digit0.keyCode)return this.fitToView(),!1}onClear(){this.isOpen()&&this.unsubscribeElementEvents(),this.elementRegistry.getAllElements().forEach(t=>this.removeElement(t))}subscribeUserEvent(t,e,n){E.f0.bind(t,e,i=>{i.preventDefault(),i.stopPropagation(),n.call(this,i)})}onParentWheel(t){if(!t.ctrlKey||(this.updateSvgClientRect(),!this.isPointInside(t,this._state._svgClientRect)))return;const{deltaMode:e,deltaX:n,deltaY:i}=t,s=e===0?.02:.32,l=Math.sqrt(Math.pow(i,2)+Math.pow(n,2))*Math.sign(i)*-s;if(this._state.zoomDelta+=l,Math.abs(this._state.zoomDelta)>ta){const c=l>0?1:-1,p=Math.log(this.canvas.zoom())/Math.log(10),h=this.getStepSize(qo,ea*2),m=Math.round(p/h)*h+h*c,C=Math.pow(10,m);this.zoomScroll.setZoom(C),this._state.zoomDelta=0;const y=this.mapMousePositionToDiagramPoint(t);this.setViewboxCenteredAroundPoint(y),this.update()}}update(){if(!this.isOpen())return;const t=this.canvas.viewbox(),e=t.inner,n=t.outer;if(!this.validViewbox(t))return;let i,s,l,c;const p=n.width-e.width,h=n.height-e.height;e.width<n.width?(i=e.x-p/2,l=n.width,e.x+e.width<n.width&&(i=Math.min(0,e.x))):(i=e.x,l=e.width),e.height<n.height?(s=e.y-h/2,c=n.height,e.y+e.height<n.height&&(s=Math.min(0,e.y))):(s=e.y,c=e.height),i=i-Wt,s=s-Wt,l=l+Wt*2,c=c+Wt*2,this.lastViewbox={x:i,y:s,width:l,height:c},(0,x.CF)(this.svg,{viewBox:i+", "+s+", "+l+", "+c}),(0,x.CF)(this.viewport,{x:t.x,y:t.y,width:t.width,height:t.height});const m=this.map.getBoundingClientRect();this._state._parentClientRect=m;const C=this.viewport.getBoundingClientRect(),y={top:C.top-m.top,left:C.left-m.left,width:C.width,height:C.height};(0,O.kp)(this.viewportDom.style,{top:y.top+"px",left:y.left+"px",width:y.width+"px",height:y.height+"px"});const b=this.getOverlayClipPath(m,y);(0,O.kp)(this.overlay.style,{clipPath:b})}setViewboxCenteredAroundClickEvent(t){this.updateSvgClientRect();const e=this.mapMousePositionToDiagramPoint(t);this.setViewboxCenteredAroundPoint(e),this.update()}onMousedown(t,e){if(e.button!==0)return;this.updateSvgClientRect(),t&&this.setViewboxCenteredAroundClickEvent(e);const n=this.mapMousePositionToDiagramPoint(e),i=this.canvas.viewbox(),s=this.getOffsetViewport(n,i),l=this.viewportDom.getBoundingClientRect(),c={x:e.clientX-l.left+1,y:e.clientY-l.top+1};(0,O.kp)(this._state,{cachedViewbox:i,initialDragPosition:{x:e.clientX,y:e.clientY},isDragging:!0,offsetViewport:s,offsetViewportDom:c,viewportClientRect:this.viewport.getBoundingClientRect(),parentClientRect:this.map.getBoundingClientRect()}),E.f0.bind(document,"mousemove",this.onMousemove.bind(this)),E.f0.bind(document,"mouseup",this.onMouseup.bind(this))}updateSvgClientRect(){(!this._state._svgClientRect||this.isZeroDimensional(this._state._svgClientRect))&&(this._state._svgClientRect=this.svg.getBoundingClientRect())}onMousemove(t){if(this._state.isDragging){this.updateSvgClientRect();const e=this._state.offsetViewportDom,n=this._state.viewportClientRect,i=this._state.parentClientRect;(0,O.kp)(this.viewportDom.style,{top:t.clientY-e.y-i.top+"px",left:t.clientX-e.x-i.left+"px"});const s=this.getOverlayClipPath(i,{top:t.clientY-e.y-i.top,left:t.clientX-e.x-i.left,width:n.width,height:n.height});(0,O.kp)(this.overlay.style,{clipPath:s});const l=this.mapMousePositionToDiagramPoint(t);this.setViewboxCenteredAroundPoint({x:l.x-this._state.offsetViewport.x,y:l.y-this._state.offsetViewport.y})}}onMouseup(t){if(this._state.isDragging){const e=this._state.initialDragPosition;e.x===t.clientX&&e.y===t.clientY&&this.setViewboxCenteredAroundClickEvent(t),this.update(),(0,O.kp)(this._state,{cachedViewbox:null,initialDragPosition:null,isDragging:!1,offsetViewport:null,offsetViewportDom:null}),E.f0.unbind(document,"mousemove",this.onMousemove.bind(this)),E.f0.unbind(document,"mouseup",this.onMouseup.bind(this))}}_onZoomChanged(t){this.mapButtons.zoom.textContent=Math.round(t*100)+"%"}updateElement(t){try{t.parent!==void 0&&t.parent!==null&&(this.removeElement(t),this.addElement(t))}catch(e){console.warn(`Minimap#updateElement error: ${e}`)}}addElement(t){if(this.removeElement(t),t.hidden)return;let e,n,i;const s=this.createElement(t);if(s){const l=(0,E.P)("#"+ms()(t.parent.id),this.elementsGroup),c=this.elementRegistry.getGraphics(t),p=this.elementRegistry.getGraphics(t.parent),h=this.getIndexOfChildInParentChildren(c,p);return h!=="undefined"?l?l.childNodes.length>h?this.insertChildAtIndex(s,l,h):this.insertChildAtIndex(s,l,l.childNodes.length-1):this.elementsGroup.appendChild(s):this.elementsGroup.appendChild(s),this.diagramUtils.isConnection(t)?(e=t.parent,n=0,i=0,typeof e.x<"u"&&typeof e.y<"u"&&(n=-e.x,i=-e.y),(0,x.CF)(s,{transform:"translate("+n+" "+i+")",strokeWidth:"4"})):(n=t.x,i=t.y,l&&(e=t.parent,typeof e.x<"u"&&typeof e.y<"u"&&(n-=e.x,i-=e.y)),(0,x.CF)(s,{transform:"translate("+n+" "+i+")"})),t.children&&t.children.length&&t.children.forEach(m=>{this.addElement(m)}),s}}removeElement(t){const e=this.svg.getElementById(t.id);e&&(0,x.TF)(e)}createElement(t){const e=this.elementRegistry.getGraphics(t);if(e){const n=(0,Xo.P)(e);if(n){const i=(0,x.o8)(n);return(0,x.CF)(i,{id:t.id}),i}}}getOffsetViewport(t,e){return{x:t.x-(e.x+e.width/2),y:t.y-(e.y+e.height/2)}}mapMousePositionToDiagramPoint({clientX:t,clientY:e}){const n={x:t-this._state._svgClientRect.left,y:e-this._state._svgClientRect.top},i=this.svg.getBoundingClientRect(),s=this.fitAspectRatio(this.lastViewbox,i.width/i.height),l=this.mapPosition(n.x,0,i.width,s.x,s.x+s.width),c=this.mapPosition(n.y,0,i.height,s.y,s.y+s.height);return{x:l,y:c}}setViewboxCenteredAroundPoint(t){const e=this.canvas.viewbox(),n=e.width,i=e.height;this.canvas.viewbox({x:t.x-n/2,y:t.y-i/2,width:n,height:i})}fitAspectRatio(t,e){const n=t.width/t.height,i=(0,O.kp)({},{x:t.x,y:t.y,width:t.width,height:t.height});if(n>e){const s=i.width*(1/e),l=i.y-(s-i.height)/2;(0,O.kp)(i,{y:l,height:s})}else if(n<e){const s=i.height*e,l=i.x-(s-i.width)/2;(0,O.kp)(i,{x:l,width:s})}return i}mapPosition(t,e,n,i,s){const l=n-e,c=s-i;return(t-e)*c/l+i}getIndexOfChildInParentChildren(t,e){const n=(0,E.P)(".djs-children",e.parentNode);if(!n)return;const i=[].slice.call(n.childNodes);let s=-1;return i.forEach(function(l,c){(0,E.P)(".djs-element",l)===t&&(s=c)}),s}insertChildAtIndex(t,e,n){const s=[].slice.call(e.childNodes)[n];e.insertBefore(t,s.nextSibling)}isZeroDimensional(t){return t.width===0&&t.height===0}isPointInside(t,e){return t.x>e.left&&t.x<e.left+e.width&&t.y>e.top&&t.y<e.top+e.height}getStepSize(t,e){const n=Math.log(t.min)/Math.log(10),i=Math.log(t.max)/Math.log(10);return(Math.abs(n)+Math.abs(i))/e}getOverlayClipPath(t,e){return`polygon(${[[e.left,e.top],[e.left+e.width,e.top],[e.left+e.width,e.top+e.height],[e.left,e.top+e.height],[e.left,t.height],[t.width,t.height],[t.width,0],[0,0],[0,t.height],[e.left,t.height]].map(([i,s])=>`${i}px ${s}px`).join(", ")})`}validViewbox(t){return(0,O.Si)(t,e=>(0,O.Gv)(e)?this.validViewbox(e):(0,O.Et)(e)&&isFinite(e))}subscribeElementEvents(){this.eventBus.on(["shape.added","connection.added"],B.MIN,this._onElementAdded),this.eventBus.on(["shape.removed","connection.removed"],B.MIN,this._onElementRemoved),this.eventBus.on(["elements.changed"],B.MIN,this._onElementsChanged),this.eventBus.on(["element.updateId"],B.MIN,this._onElementUpdateId)}unsubscribeElementEvents(){this.eventBus.off(["shape.added","connection.added"],this._onElementAdded),this.eventBus.off(["shape.removed","connection.removed"],this._onElementRemoved),this.eventBus.off(["elements.changed"],this._onElementsChanged),this.eventBus.off(["element.updateId"],this._onElementUpdateId)}onElementAdded({element:t}){this.addElement(t),this.update()}onElementRemoved({element:t}){this.removeElement(t),this.update()}onElementsChanged({elements:t}){t.forEach(e=>this.updateElement(e)),this.update()}onElementUpdateId({element:t,newId:e}){try{const n=(0,E.P)("#"+ms()(t.id),this.elementsGroup);n&&(n.id=e)}catch(n){console.warn(`Minimap#updateElementId error: ${n}`)}}registerPopupMenu(){this.popupMenu.registerProvider("zoom",this),this.eventBus.on("minimap.open",()=>this.popupMenu.close()),this.eventBus.on("minimap.close",()=>this.popupMenu.close())}delay(t=0){return new Promise(e=>us.A(e,t))}loadData(){var t=this;return(0,D.A)(function*(){yield t.delay();let e=Number(new Date);const n=t.elementRegistry.getAllElements();for(let i=0,s=n.length;i<s;i++){try{t.addElement(n[i])}catch(c){console.error(c)}Number(new Date)-e>t.loadMiniMapRenderInterval&&(yield t.delay(),e=Number(new Date))}})()}open(){var t=this;return(0,D.A)(function*(){t.setOpenState(!0),yield t.loadData(),t.update(),t.subscribeElementEvents(),t.eventBus.fire("minimap.open")})()}close(){this.isOpen()&&(this.setOpenState(!1),this.unsubscribeElementEvents(),this.eventBus.fire("minimap.close"))}isOpen(){return this._state.isOpen}resetView(){var t=this;return(0,D.A)(function*(){yield t.zoomScroll.animateResetView()})()}fitToView(){this.zoomScroll.fitToView()}preview(){this.isOpen()?this.close():this.open()}togglePopupMenu(){if(this.popupMenu.isOpen()){this.popupMenu.close();return}this.popupMenu.open({},"zoom",{cursor:{}})}getEntries(){var t=this;return[...[25,50,75,100,200,300].map(n=>({id:`zoom-${n}`,label:`${n}%`,action:function(){var i=(0,D.A)(function*(){yield t.zoomScroll.animateZoom(n/100)});return function(){return i.apply(this,arguments)}}()})),{id:"separator-1",className:"entry-separator",disabled:!0},{id:"reset-view",label:this.config.localizableStrings.get("resetView"),action:()=>this.resetView()},{id:"fit-into-view",label:this.config.localizableStrings.get("fitToView"),action:()=>this.fitToView()}]}};Bn=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("canvas")),(0,a.Qj)(2,d("elementRegistry")),(0,a.Qj)(3,d("zoomScroll")),(0,a.Qj)(4,d("localStorage")),(0,a.Qj)(5,d("popupMenu")),(0,a.Qj)(6,d("config")),(0,a.Qj)(7,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,M])],Bn);var na=v(35797);let Vt=class extends na.A{constructor(t){super(t),this.modeling=t}moveShape(t,e){const n=t.allShapes;Object.values(n).forEach(i=>{this.modeling.moveShape(i,e,!1,{recurse:!1,layout:!1},null),this.moveConnectionLabel(i,e)})}moveConnectionLabel(t,e){(t.outgoing||[]).forEach(i=>{this.modeling.moveConnectionLabel(i,{delta:e})})}moveRecursiveShape(t,e){const n=this.getClosure(t.children);this.moveShape(n,e),this.moveConnectionLabel(t,e)}};Vt=(0,a.Cg)([(0,a.Qj)(0,d("modeling")),(0,a.Sn)("design:paramtypes",[se])],Vt);var ia=v(18587);let Gn=class extends ia.A{constructor(t,e){super(t,e),this.eventBus=t,this.canvas=e,t.on("diagram.init",B.LOW,()=>{this.updateEntries()})}updateEntries(){const t=this.getEntries();(0,O.jJ)(t,function(e,n){const i=(0,E.P)(`[data-action="${n}"]`);e.hasOwnProperty("menu")&&(0,E.Ly)(i).add("create-menu")})}getEntries(){return super.getEntries()}};Gn=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("canvas")),(0,a.Sn)("design:paramtypes",[Object,Object])],Gn);let Zt=class{constructor(t,e,n,i,s,l,c,p,h,m,C){this.create=t,this.elementFactory=e,this.palette=n,this.featureProvider=i,this.canvas=s,this.elements=l,this.paletteElements=c,this.rules=p,this.eventBus=h,this.createPopupMenu=m,this.config=C,this.dataActionPrefix="create-",this.init()}init(){this.rules.allowed("canShowPalette")&&(this.palette.registerProvider(this),this.subscribeEvents())}subscribeEvents(){this.eventBus.on("createPopupMenu.open",t=>this.activateEntry(t)),this.eventBus.on("createPopupMenu.close",t=>this.deactivateEntry(t))}getCreateShapeConfig(t){const e=this.elements.getConfig(t),{type:n,width:i,height:s}=e;return{type:n,width:i,height:s}}createActionClick(t,e){const n=this.getCreateShapeConfig(t),i=this.elementFactory.createShape(n);this.create.start(e,i),this.createPopupMenu.close()}openCreateMenu(t,e,n){this.createPopupMenu.open(t,e,n)}getCreateMenuEntries(t){return t.menu.map(e=>this.elements.items[e]).filter(e=>e).map(e=>({action:{dragstart:this.createActionClick.bind(this,e)},id:e.userTaskType||e.type,imageUrl:e.smallImage,label:this.config.localizableStrings.get(e.caption)}))}activateEntry({paletteEntryId:t}){const e=(0,E.P)(`[data-action="${t}"]`);(0,E.Ly)(e).add("active")}deactivateEntry({paletteEntryId:t}){const e=(0,E.P)(`[data-action="${t}"]`);(0,E.Ly)(e).remove("active")}getPaletteEntries(){const t={};return Object.values(this.paletteElements.getElements()).forEach(e=>{const n=this.dataActionPrefix+e.type,i={group:"elements",action:{dragstart:this.createActionClick.bind(this,e)},...e};if(e.menu){const s=this.getCreateMenuEntries(e);s.length?i.action.click=this.openCreateMenu.bind(this,e,n,s):delete i.menu}t[n]=i}),t}};Zt=(0,a.Cg)([(0,a.Qj)(0,d("create")),(0,a.Qj)(1,d("elementFactory")),(0,a.Qj)(2,d("palette")),(0,a.Qj)(3,d("featureProvider")),(0,a.Qj)(4,d("canvas")),(0,a.Qj)(5,d("elements")),(0,a.Qj)(6,d("paletteElements")),(0,a.Qj)(7,d("rules")),(0,a.Qj)(8,d("eventBus")),(0,a.Qj)(9,d("createPopupMenu")),(0,a.Qj)(10,d("config")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object,F,it,Object,Object,at,Object])],Zt);let Fn=class{constructor(t,e,n,i,s){this.config=t,this.toolManager=e,this.dragging=n,this.lassoTool=i,this.spaceTool=s}getPaletteToolsConfig(){return{arrow:{icon:"icon_arrow_select_24",title:"arrow",click:()=>{this.toolManager.setActive(null),this.dragging.cancel()}},lasso:{icon:"icon_sellect_24",title:"lasso",click:()=>{this.lassoTool.toggle()}},space:{icon:"icon_move_24",title:"space",click:()=>{this.spaceTool.toggle()}}}}getPaletteTools(t=!0){const e={},n=this.getPaletteToolsConfig();return Object.keys(n).forEach(i=>{const{icon:s,title:l,click:c}=n[i];e[i]={group:"tools",html:`<div class="entry material-icons">${s}</div>`,title:this.config.localizableStrings.get(l),action:{click:c}}}),t?{...e,separator:{separator:!0}}:e}};Fn=(0,a.Cg)([(0,a.Qj)(0,d("config")),(0,a.Qj)(1,d("toolManager")),(0,a.Qj)(2,d("dragging")),(0,a.Qj)(3,d("lassoTool")),(0,a.Qj)(4,d("spaceTool")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object])],Fn);var sa=v(6226);let Qn=class extends sa.A{constructor(t,e,n){super(t,e,n),this.contextPadItemWidth=32,this.padding=10}subscribeEvents(){this.preventScrollParent(this.getContainer());const t=this._eventBus;t.once("createPopupMenu.open",this.close.bind(this)),t.once("element.mousedown",B.HIGH,this.close.bind(this)),t.once("keyboard.keydown",B.HIGH,this.close.bind(this))}unsubscribeEvents(){const t=this._eventBus;t.off("createPopupMenu.open",this.close.bind(this)),t.off("element.mousedown",this.close.bind(this)),t.off("keyboard.keydown",this.close.bind(this))}fixContainerPosition(t,e){const i=this._canvas.getContainer().getBoundingClientRect(),s=t.getBoundingClientRect(),l=i.y+this.padding;if(s.top<l){const c=this.padding,p=e.x-this.contextPadItemWidth-s.width-this.padding;(0,O.kp)(t.style,{top:`${c}px`,left:`${p}px`})}}getContainer(){return this._current.container}preventScrollParent(t){t.onwheel=e=>this.onWheel(e)}open(t,e,n){super.open(t,e,n);const i=this.getContainer();this.fixContainerPosition(i,n),this.subscribeEvents(),(0,O.kp)(i.style,{opacity:1})}close(){super.close(),this.unsubscribeEvents()}onWheel(t){const e=t.wheelDeltaY||-(t.deltaY*25);this._current.container.scrollTop-=e,t.stopPropagation(),t.returnValue=!1}};Qn=(0,a.Cg)([(0,a.Qj)(0,d("config.popupMenu")),(0,a.Qj)(1,d("eventBus")),(0,a.Qj)(2,d("canvas")),(0,a.Sn)("design:paramtypes",[Object,Object,Object])],Qn);var Yt=v(95820),oa=v(97975),he=v(19187);const ce={Connection:{Fill:"none",MarkerShape:"M-10,3 L2,0 L-10,-3 Z",MarkerfillOpacity:1,StrokeLinejoin:"round",StrokeWidth:1,PathStrokeWidth:2}},Ce={arrowHoverStrokeColor:"#1186D8",arrowStrokeColor:"#8095b3",connectionMarkerFillColor:"#FFFF",connectionMarkerStrokeColor:"#60779F",connectionStrokeColor:"#8095B3"};class He{get endMarker(){const t=(0,x.vt)("path");return(0,x.CF)(t,{d:ce.Connection.MarkerShape,"fill-opacity":ce.Connection.MarkerfillOpacity,fill:Ce.arrowStrokeColor,stroke:Ce.arrowStrokeColor,strokeLinejoin:ce.Connection.StrokeLinejoin,strokeWidth:ce.Connection.StrokeWidth,class:kt.ConnectionEndMarker}),t}_getLastSegment(t){const e=t.length;return{a:t[e-2],b:t[e-1]}}_getFirstSegment(t){return{a:t[1],b:t[0]}}_angle(t){const e=t.b.y-t.a.y,n=t.b.x-t.a.x;return Math.atan2(e,n)}_renderMarker(t,e,n,i){t&&(this._transformMarker(t,i,n),(0,x.BC)(e,t))}_transformMarker(t,e,n){(0,x.pd)(t,(0,x.uK)(Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),n.x,n.y))}renderMarkers(t,e){const n=e.waypoints,i=this._getLastSegment(n),s=this._angle(i),l=this._getFirstSegment(n),c=this._angle(l),p=this.startMarker(e);this._renderMarker(p,t,l.b,c),this._renderMarker(this.endMarker,t,i.b,s)}startMarker(t){return null}getConnectionAttributes(t){return{class:kt.Connection,fill:ce.Connection.Fill,stroke:Ce.connectionStrokeColor,strokeLinejoin:ce.Connection.StrokeLinejoin,strokeWidth:ce.Connection.PathStrokeWidth}}drawConnection(t,e,n){n.itemName&&(0,x.CF)(e,{"data-item-marker":n.itemName});const i=(0,x.vt)("g"),s=this.getConnectionAttributes(n.type),l=n.waypoints,c=["m"+l[0].x+","+l[0].y];for(let h=1;h<l.length;h++)c.push("L"+l[h].x+","+l[h].y);const p=(0,x.vt)("path");return(0,x.CF)(p,{d:c.join(" ")}),(0,x.CF)(p,s),(0,x.BC)(i,p),this.renderMarkers(i,n),(0,x.BC)(e,i),i}}class vs{drawConnection(t,e,n){}}(0,a.Cg)([H(()=>!0,He),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object,Object,Object]),(0,a.Sn)("design:returntype",Object)],vs.prototype,"drawConnection",null);var aa=v(2245),ra=v(30721),la=v(59684),ca=v(49096);const Yc=4,$c=4,da=5,fs=3.5,ga=1,ys=16.8699;let $t=class{constructor(t,e,n,i,s,l,c){this.eventBus=t,this.directEditing=e,this.canvas=n,this.modeling=i,this.diagramText=s,this.selection=l,this.rules=c,this.directEditing.registerProvider(this),this.rules.allowed("canLabelEdit")?this.subscribeEvents():this.subscribeSelectionEvents()}clearLabelTargetsCaption(t){const e=ra.A(Ut.A(t.elements,n=>n.labelTarget));je.A(e,n=>this.clearElementCaption(n))}clearElementCaption(t){t.caption="",this.eventBus.fire(j.element.updateLabelExecuted,{context:{element:t,text:""}})}onKeyDown({keyEvent:t}){const e=this.selection.get(),n=e.length===1&&e[0];if(n){if(ct(t)===te.Enter.keyCode)return Sn.A(()=>this.editElementLabel(n)),!1;if(Vo(t))return n.needClearCaption=!0,this.editElementLabel(n),!1}}_copySelectedLabelText(){const t=this.selection.get(),e=t.length===1&&t[0];if(!e)return;const n=e.labelTarget.caption,i=s=>{(s.clipboardData||window.clipboardData).setData("text",n),s.preventDefault()};document.addEventListener("copy",i,!1),document.execCommand("copy"),document.removeEventListener("copy",i,!1)}_selectLabelText(t){const e=document.createRange(),n=document.querySelector(`[data-element-id="${t.id}"] .foreign-text`);e.selectNodeContents(n);const i=window.getSelection();i.removeAllRanges(),i.addRange(e)}showElementLabel(t){const e=t.active&&t.active.element.label;e&&this.canvas.removeMarker(e,"djs-element-hidden")}subscribeSelectionEvents(){this.eventBus.on(["element.dblclick"],({element:t})=>{t.type===Te.label&&this._selectLabelText(t)}),this.eventBus.on(["keyboard.keydown"],({keyEvent:t})=>{ye(t,te.KeyC,{ctrl:!0})&&this._copySelectedLabelText()})}subscribeEvents(){this.eventBus.on(["element.dblclick"],t=>this.editElementLabel(t.element)),this.eventBus.on(["canvas.viewbox.changing","element.mousedown","popupMenu.open"],()=>{this.directEditing.isActive()&&this.directEditing.complete()}),this.eventBus.on(["drag.init"],t=>{if(this.directEditing.isActive()){this.directEditing.complete();const e=t.shape;e&&e.x&&e.y&&this.selection.select(e)}}),this.eventBus.on(["create.end"],B.LOW,t=>this.onCreateEnd(t)),this.eventBus.on(["connect.end"],B.LOW,t=>{const e=t.context.connection;this.editElementLabel(e)}),this.eventBus.on(["directEditing.activate"],t=>{const e=t.active.element.label;e&&this.canvas.addMarker(e,"djs-element-hidden")}),this.eventBus.on(["directEditing.complete","directEditing.cancel"],t=>this.showElementLabel(t)),this.eventBus.on([j.element.deleteElementsExecuted],t=>this.clearLabelTargetsCaption(t.context)),this.eventBus.on(["keyboard.keydown"],t=>this.onKeyDown(t))}onCreateEnd(t){const e=t.shape;t.context.canExecute&&this.editElementLabel(e)}editElementLabel(t){t.constructor!==ca.bL&&this.directEditing.activate(t.labelTarget||t)}getPadding(t,e){return la.A(t,n=>n*e)}getBoxBounds(t){let e;const n=this.canvas,i=n.zoom(),s=V.label.width*i,l=this.getPadding(V.label.padding,i),c=l.paddingTop,p=l.paddingBottom,h=t.label,m=1;if(h){const y=n.getAbsoluteBBox(h);e={height:y.height+c+p,width:s,minHeight:V.label.minHeight,x:Math.round(y.x+y.width/2-s/2),y:Math.round(y.y-c)}}else{const y=this.diagramText.style,I=y.fontSize*y.lineHeight*i+c+p+m*2,P={height:I/i,width:s/i},L=this.diagramText.getLabelPosition(t,P),G=n.getAbsoluteBBox(L);e={height:I,width:s,x:Math.round(G.x-s/2),y:Math.round(G.y-c-m)}}const C=t.width?t.width+(fs+m)*2:V.label.minWidth;return e.minWidth=C*i,e}getTextStyle(t,e,n){const i=e.fontSize*t;return{...e,fontSize:`${i}px`,padding:`${n.paddingTop}px ${n.paddingRight}px ${n.paddingBottom}px ${n.paddingLeft}px`}}getElementStyle(t){const e=this.canvas.zoom(),n=re.A(this.diagramText.style),i=V.label.padding;return this.getTextStyle(e,n,this.getPadding(i,e))}activate(t){const e=this.getBoxBounds(t),n=this.getElementStyle(t),i=["djs-direct-editing-parent"];let s;return t.needClearCaption?(s="",t.needClearCaption=!1):s=t.caption||"",{autoResize:!0,bounds:e,centerVertically:!0,options:{autoResize:!0,classList:i},style:n,text:s}}update(t,e,n){this.modeling.updateLabel(t,e)}};$t=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("directEditing")),(0,a.Qj)(2,d("canvas")),(0,a.Qj)(3,d("modeling")),(0,a.Qj)(4,d("diagramText")),(0,a.Qj)(5,d("selection")),(0,a.Qj)(6,d("rules")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,se,Object,Object,Object])],$t);var pa=v(22170);let Un=class extends pa.A{constructor(t,e,n,i){super(t,e,n),this.eventBus=e,this.modeling=n,this.diagramText=i,this.subscribeEvents()}onMoveConnectionLabel(t){const e=t.context,i=e.connection.label;if(i){const s=e.hints.delta;this.modeling.moveShape(i,s)}}onReconnectStart(t){const{connection:e,hints:n,newSource:i,oldSource:s}=t.context,l=e.label,c=n&&n.doUpdateLabelPosition;if(l&&c){const p={x:i.x-s.x,y:i.y-s.y};this.modeling.moveShape(l,p)}}subscribeEvents(){this.eventBus.on([j.connection.moveConnectionLabel],this.onMoveConnectionLabel.bind(this)),super.postExecute(["connection.updateWaypoints"],this.onUpdateWaypoints.bind(this)),super.postExecute(["connection.layout"],this.onConnectionLayout.bind(this)),super.postExecute(["connection.reconnectStart"],this.onReconnectStart.bind(this)),super.postExecute(["shape.replace"],t=>{const e=t.context.newShape;this.modeling.updateLabel(e,e.caption)})}onConnectionLayout(t){const n=t.context.connection,i=n.label;if(!this.canMoveLabel(t,i))return;const s=this.getLabelOffset(n.waypoints,i);this.modeling.moveShape(i,s)}getLabelOffset(t,e){const n=this.diagramText.getConnectionLabelPosition(t,e);return{x:n.x-e.x-Math.round(e.width/2),y:n.y-e.y-Math.round(e.height/2)}}canMoveLabel(t,e){const{connection:n,hints:i,oldWaypoints:s,newSource:l}=t.context,c=i&&i.doUpdateLabelPosition;return e&&(!ls.A(n.waypoints,s)||l)&&c!==!1}onUpdateWaypoints(t){const e=t.context,n=e.connection,i=n.label;if(!this.canMoveLabel(t,i))return;const s=this.getLabelOffset(n.waypoints,i),l=this.getLabelOffset(e.oldWaypoints,i),c={x:s.x-l.x,y:s.y-l.y};this.modeling.moveShape(i,c)}};Un=(0,a.Cg)([(0,a.Qj)(0,d("injector")),(0,a.Qj)(1,d("eventBus")),(0,a.Qj)(2,d("modeling")),(0,a.Qj)(3,d("diagramText")),(0,a.Sn)("design:paramtypes",[Object,Object,se,pe])],Un);var X=v(9619);class ha{constructor(t){this._parent=t.useRtl?(0,E.zm)('<div><textarea rows="1" dir="rtl" style="direction: rtl;" class="djs-direct-editing-content"></textarea></div>'):(0,E.zm)('<div><textarea rows="1" class="djs-direct-editing-content"></textarea></div>'),this.container=t.container,this._textArea=(0,E.P)(".djs-direct-editing-content",this._parent),this.keyHandler=t.keyHandler||(()=>{}),this._mousedown=e=>{e.stopPropagation()},this.resizeHandler=t.resizeHandler||(()=>{}),this.autoResize=this.autoResize.bind(this)}create(t,e,n,i){const s=this._parent,l=this._textArea,c=this.container;i=this._options=i||{},e=this._style=e||{};const p=At.A(e,["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);X.A(s.style,{boxSizing:"border-box",left:t.x+"px",outline:"none",overflow:"visible",position:"absolute",textAlign:"center",top:t.y+"px",wordWrap:"normal",width:t.width+"px"},p);const h=At.A(e,["borderLeft","fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return X.A(l.style,{boxSizing:"border-box",outline:"none",wordWrap:"break-word",width:t.minWidth+"px",maxHeight:t.maxHeight+"px",maxWidth:(t.maxWidth||t.width)+"px",minHeight:t.minHeight+"px",minWidth:t.minWidth+"px"},h),i.centerVertically&&X.A(l.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},h),l.value=n,E.f0.bind(l,"keydown",this.keyHandler),E.f0.bind(l,"mousedown",this._mousedown),E.f0.bind(l,"paste",this._handlePaste),E.f0.bind(l,"keydown",this.autoResize),E.f0.bind(l,"blur",this.blur),s.className="djs-direct-editing-parent",i.classList&&s.classList.add(...i.classList),c.appendChild(s),this._textArea.selectionStart=n.length,this._textArea.selectionEnd=n.length,this._textArea.focus(),n&&this.resizeWidth(),this.resizeHeight(),s}resizeHeight(){this._textArea.style.height="auto",this._textArea.style.height=this._textArea.scrollHeight+"px"}resizeWidth(){this._textArea.style.width="auto",this._textArea.style.width=this._textArea.scrollWidth+"px"}autoResize(){Sn.A(()=>{if(this._textArea.scrollHeight>0){const t=this._textArea.getBoundingClientRect();this.resizeWidth(),this.resizeHeight(),this.resizeHandler({dx:0,dy:this._textArea.scrollHeight-t.height,height:t.height,width:t.width})}})}destroy(){const t=this._parent,e=this._textArea;e.value="",t.removeAttribute("style"),e.removeAttribute("style"),E.f0.unbind(e,"keydown",this.keyHandler),E.f0.unbind(e,"mousedown",this._mousedown),E.f0.unbind(e,"keydown",this.autoResize),E.f0.unbind(e,"blur",this.blur),(0,E.TF)(t)}getValue(){return this._textArea.value}}let Jt=class{constructor(t,e,n,i,s,l,c){this._eventBus=t,this._canvas=e,this._elementRegistry=n,this._graphicsFactory=i,this._diagramText=s,this.config=l,this._providers=[],this._textbox=c||new ha({useRtl:l.isRtl}),this._textbox.container=e.getContainer(),this._textbox.keyHandler=this._handleKey.bind(this),this._textbox.blur=this._blur.bind(this),this._textbox.resizeHandler=this.handleResize.bind(this),this._eventBus.on("diagram.destroy",1e3,this.deactivate,this)}_handleKey(t){if(ct(t)===te.Escape.keyCode){t.stopPropagation(),t.preventDefault(),this.cancel();return}Zo(t)&&Yo(t,()=>this.complete())}_blur(){this.complete()}_fire(t,e){e=e||{active:this.active},this._eventBus.fire("directEditing."+t,e)}handleResize(t){this._fire("resize",t)}getNewBounds(){const t=this.activeTextbox.getBoundingClientRect();return{x:t.top,y:t.left,width:t.width,height:t.height}}registerProvider(t){this._providers.push(t)}isActive(){return!!this.active}cancel(){this.active&&this.close("cancel")}animate(t){const e=this.activeTextbox.classList;if(!(e&&e.contains("djs-direct-editing-rotate-90")))return;const i="djs-direct-editing-rotate-0";t?e.add(i):e.remove(i)}deactivate(){this._textbox.destroy(),this._fire("deactivate",null),this.active=null}close(t){this.animate(!1),this._fire(t,null),this.deactivate()}complete(){const t=this.active;if(!t)return;const e=this.getValue();t.provider.update(t.element,e,this.getNewBounds()),this.close("complete")}getValue(){return this._textbox.getValue()}activate(t){this.isActive()&&this.cancel();let e=null;this.initialHeight=t.height,this.initialWidth=t.width;const n=this._providers.find(i=>(e=i.activate(t),e?i:null));return e&&(this.activeTextbox=this._textbox.create(e.bounds,e.style,e.text,e.options),this.active={element:t,context:e,provider:n},this.animate(!0),this._fire("activate",null)),!!e}};Jt=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("canvas")),(0,a.Qj)(2,d("elementRegistry")),(0,a.Qj)(3,d("graphicsFactory")),(0,a.Qj)(4,d("diagramText")),(0,a.Qj)(5,d("config")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object])],Jt);var Cs;let ue=class{constructor(t,e,n,i){this.elements=t,this.styles=e,this.diagramText=n,this.eventBus=i}updateClass(t,e){const n=this.elements.getConfig(e),i=t.parentElement||t.parentNode,s=i.classList;(0,je.A)(this.elements.items,l=>{s.remove(l.type),s.remove(l.userTaskType)}),i.classList.add(n.userTaskType||n.type)}createText(t,e,n){const i=this.diagramText.createText(e,n);return(0,x.Ly)(i).add("djs-label"),n.className&&(0,x.Ly)(i).add(n.className),(0,x.BC)(t,i),i}drawRect(t,e,n,i,s,l){(0,aa.A)(s)&&(l=s,s=0),s=s||0,l=this.styles.computeStyle(l,{fill:"none",stroke:"#EBEBEB",strokeWidth:1});const c=(0,x.vt)("rect");return(0,x.CF)(c,{height:n-s*2,rx:i,ry:i,width:e-s*2,x:s,y:s}),(0,x.CF)(c,l),(0,x.BC)(t,c),c}draw(t,e){return this.updateClass(t,e),null}};ue=(0,a.Cg)([(0,a.Qj)(0,d("elements")),(0,a.Qj)(1,d("styles")),(0,a.Qj)(2,d("diagramText")),(0,a.Qj)(3,d("eventBus")),(0,a.Sn)("design:paramtypes",[Object,typeof(Cs=typeof he.A<"u"&&he.A)=="function"?Cs:Object,pe,Object])],ue);const xs={ELLIPSE:"ellipse",RECTANGLE:"rect"};let ua=(()=>{class r{static{this.xmlns="http://www.w3.org/2000/svg"}static createFeFlood(e,n="#000",i=0){return this.createElement(e,{"flood-color":n,"flood-opacity":i||0,result:"colorResult"},"feFlood")}static createFeComposite(e){return this.createElement(e,{operator:"in",in:"colorResult",in2:"blurResult",result:"shadowResult"},"feComposite")}static createFeGaussianBlur(e,n=0){return this.createElement(e,{result:"blurResult",in:"offsetResult",stdDeviation:n},"feGaussianBlur")}static createFeBlend(e){return this.createElement(e,{in:"SourceGraphic",in2:"shadowResult",mode:"normal"},"feBlend")}static setAttribute(e,n){const i=Object.keys(n);for(const s of i)e.setAttribute(s.toString(),n[s])}static createElement(e,n,i){let s;return n&&n.id&&(s=e.getElementById(n.id)),s||(s=document.createElementNS(this.xmlns,i)),n&&this.setAttribute(s,n),s}static createFilter(e,n){return this.createElement(e,{id:n,width:"200%",height:"200%"},"filter")}static createFeOffset(e,n=0,i=0){return this.createElement(e,{result:"offsetResult",in:"SourceAlpha",dx:n,dy:i},"feOffset")}static addDefs(){const e=document.querySelector("svg"),n=e.getElementsByTagName("defs")[0];if(n==null){const i=document.createElementNS(this.xmlns,"defs");return e.appendChild(i)}return n}static createShadowFilter(e){const n=document.querySelector("svg"),i=e.name;if(!i)throw new Error("ArgumentNullOrEmptyException");const s=n.getElementById(i),l="url(#"+i+")";if(s)return l;const c=this.addDefs(),p=this.createFilter(n,i),h=this.createFeOffset(n,e.offsetX,e.offsetY);p.appendChild(h);const m=this.createFeGaussianBlur(n,e.blur);p.appendChild(m);const C=this.createFeFlood(n,e.color,e.opacity);p.appendChild(C);const y=this.createFeComposite(n);p.appendChild(y);const b=this.createFeBlend(n);return p.appendChild(b),c.appendChild(p),l}}return r})();class bs extends ue{getEllipseBackgroundConfig(t){const n=t.backgroundStyle.padding||0,i=Math.round(Math.max(t.width,t.height)/2),s=Math.round(t.height/2);return{rx:i+n,ry:s+n,cx:Math.round(t.width/2),cy:Math.round(t.height/2-1)}}getLabelBackgroundConfig(t){const e=t.backgroundStyle,i=(e&&e.type)===xs.ELLIPSE?this.getEllipseBackgroundConfig(t):this.getDefaultBackgroundConfig(t),s=e&&e.fill;X.A(i,s?{fill:s}:{style:"fill: transparent;"});const l=e&&e.filter;if(l){const c=ua.createShadowFilter(l);X.A(i,{filter:c})}return i}setLabelBackground(t,e){const n=e.backgroundStyle,i=n&&n.type||xs.RECTANGLE,s=(0,x.vt)(i),l=this.getLabelBackgroundConfig(e);(0,x.CF)(s,l),(0,x.BC)(t,s)}getDefaultBackgroundConfig(t){return{height:t.height,width:t.width}}getLabelText(t){return t.caption||t.labelTarget&&t.labelTarget.caption||""}getDrawOptions(t){const e=t.caption?0:3,n={box:{height:t.height,width:t.width+e,x:t.x,y:t.y},fitBox:!1,style:{...this.diagramText.style,direction:"ltr"}};return X.A(n.style,t.style),n}draw(t,e){super.draw(t,e),this.setLabelBackground(t,e);const n=this.getLabelText(e),i=this.getDrawOptions(e),s=this.diagramText.createText(n,i);return(0,x.Ly)(s).add("djs-label"),(0,x.BC)(t,s),s}}let We=class{constructor(t,e){this.renderingLabel=t,this.renderingShape=e}create(t){return t===ie.label?this.renderingLabel:this.renderingShape}};We=(0,a.Cg)([(0,a.Qj)(0,d("renderingLabel")),(0,a.Qj)(1,d("renderingShape")),(0,a.Sn)("design:paramtypes",[bs,ue])],We);var Es,js;let Ve=class extends oa.A{constructor(t,e,n,i,s){super(t),this.eventBus=t,this.styles=e,this.diagramText=n,this.renderingFactory=i,this.elementRegistry=s}setDataItemMarker(t,e){let n=e.itemName;if(e.type===ie.label){const i=e.labelTarget.itemName;n=n||i&&i+"_label"}n&&t.setAttributeNS(null,"data-item-marker",n)}canRender(){return!0}drawShape(t,e){return this.setDataItemMarker(t,e),this.renderingFactory.create(e.type).draw(t,e)}drawConnection(t,e){return super.drawConnection(t,e)}createFeatureContext(){return{styles:this.styles,diagramText:this.diagramText,elementRegistry:this.elementRegistry}}};(0,a.Cg)([ke(vs,fe.instead),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object,Object]),(0,a.Sn)("design:returntype",void 0)],Ve.prototype,"drawConnection",null),Ve=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("styles")),(0,a.Qj)(2,d("diagramText")),(0,a.Qj)(3,d("renderingShapeFactory")),(0,a.Qj)(4,d("elementRegistry")),(0,a.Sn)("design:paramtypes",[typeof(Es=typeof Yt.A<"u"&&Yt.A)=="function"?Es:Object,typeof(js=typeof he.A<"u"&&he.A)=="function"?js:Object,Object,We,Object])],Ve);let Kt=class{constructor(t,e,n,i,s){this.eventBus=t,this.canvas=e,this.elementRegistry=n,this.config=i,this.diagramUtils=s,this.highlightClassName="animated",this.subscribeEvents()}get supportHighlight(){return this.config.isReadOnly}onSelectionChanged(t){const{newSelection:e,oldSelection:n}=t;n.forEach(i=>this.changeConnectionSelection(i,!1)),e.forEach(i=>this.changeConnectionSelection(i,!0))}changeConnectionSelection(t,e){const n=this.elementRegistry.filter(i=>i.source===t||i.target===t);n.forEach(i=>{e?this.canvas.addMarker(i,this.highlightClassName):this.canvas.removeMarker(i,this.highlightClassName)}),this.bringToFront(n,t)}bringToFrontElement(t){this.canvas.bringToFrontElement(t)}subscribeEvents(){this.supportHighlight&&this.eventBus.on(["selection.changed"],B.LOW,t=>this.onSelectionChanged(t))}bringToFront(t,e){t.forEach(i=>this.bringToFrontElement(i)),this.elementRegistry.filter(i=>!this.diagramUtils.isConnection(i)).forEach(i=>this.bringToFrontElement(i)),this.bringToFrontElement(e)}};Kt=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("canvas")),(0,a.Qj)(2,d("elementRegistry")),(0,a.Qj)(3,d("config")),(0,a.Qj)(4,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,M])],Kt);var ma=v(19506);let Xt=class extends ma.A{constructor(t,e,n,i,s,l,c,p){super(n,e,t,i,s,l),this.elements=c,this.diagramUtils=p,this.AXIS_TO_DIMENSION={x:"width",y:"height"}}_excludeLabelsWithoutTargets(t){return t.filter(e=>e.type===Te.label?t.some(n=>n.id===e.labelTarget.id):!0)}calculateAdjustments(t,e,n,i){const s=[],l=[];return t.forEach(c=>{const p=c[e],h=p+c[this.AXIS_TO_DIMENSION[e]];if(c.parent&&!c.waypoints){if(!this.canResizeShape(c,i,e)&&(n>0&&p>i||n<0&&h<i))return s.push(c);if(this.canResizeShape(c,i,e)||p<i&&h>i&&this._rules.allowed("shape.resize",{shape:c}))return l.push(c)}}),{movingShapes:this._excludeLabelsWithoutTargets(s),resizingShapes:this._excludeLabelsWithoutTargets(l)}}init(t,e){const n=super.init(t,e);return n&&(e.minAllowedDelta=this.getMinAllowedDelta(e.resizingShapes,e.direction,e.movingShapes),e.spaceToolConstraints=null),n}getDelta(t){const e=super.getDelta(t);return M.getCorrectSpaceToolDelta(e,t)}canResizeShape(t,e,n){return!1}getMinAllowedDelta(t,e,n){return null}};Xt=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("dragging")),(0,a.Qj)(2,d("canvas")),(0,a.Qj)(3,d("modeling")),(0,a.Qj)(4,d("rules")),(0,a.Qj)(5,d("toolManager")),(0,a.Qj)(6,d("elements")),(0,a.Qj)(7,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object,Object,F,M])],Xt);var va=v(7264);class fa extends va.A{getDelta(t){const e=super.getDelta(t);return M.getCorrectSpaceToolDelta(e,t)}}var Ss=v(40127),ya=v(436),Ca=v(56165),Hn=v(38486),xa=v(46347),ws,Is,Ms;const ba={min:.2,max:4};let Wn=class extends ya.A{constructor(t,e,n,i,s,l){super(t,e,n),this.config=t,this.eventBus=e,this.canvas=n,this.createPopupMenu=i,this.popupMenu=s,this.localStorage=l,this.cancelAnimation$=new w.Subject,this.eventBus.on(["canvas.viewbox.changed"],B.MEDIUM,c=>{this.onCanvasViewBoxChanged(c)})}cancelAnimation(){this.cancelAnimation$.next(!0)}_handleWheel(t){if(this.cancelAnimation(),this.createPopupMenu.isOpen()){this.createPopupMenu.onWheel(t);return}if(this.popupMenu.isOpen()){this.popupMenu.onWheel(t);return}super._handleWheel(t)}onCanvasViewBoxChanged(t){const e=this.canvas.scroll();e.x=Math.round(e.x)||0,e.y=Math.round(e.y)||0;const n=this.getInitScroll();e.x!==n.x||e.y!==n.y?this.localStorage.set("scroll",e):this.localStorage.remove("scroll");const i=t.viewbox.scale;i&&i!==this.getInitScale()?this.localStorage.set("scale",i):this.localStorage.remove("scale")}getInitScale(){return this.config&&this.config.initScale||1}getInitScroll(){return this.config&&this.config.initScroll||{x:0,y:0}}getScale(){return this.canvas.viewbox().scale}getScroll(){return this.canvas.scroll()}setZoom(t){const e=this.canvas.viewbox().outer,n={x:e.width/2,y:e.height/2};this.canvas.zoom((0,Ca.N)(ba,t),n)}setScroll(t){const e=this.getScroll();this.canvas.scroll({dx:-e.x+t.x,dy:-e.y+t.y})}animateZoomScroll({toScale:t,toScroll:e,fromScale:n=null,fromScroll:i=null,stepCount:s=20,stepPeriod:l=1}){var c=this;return(0,D.A)(function*(){if(c.cancelAnimation(),n=n||c.getScale(),i=i||c.getScroll(),n===t&&i.x===e.x&&i.y===e.y)return;const p=(t-n)/s,h=(e.x-i.x)/s,m=(e.y-i.y)/s;return new Promise(C=>{(0,w.interval)(l).pipe((0,Hn.s)(s+1),(0,Pt.Q)(c.cancelAnimation$),(0,xa.j)(()=>{c.eventBus.fire("animateZoomScroll.done"),C()})).subscribe(y=>{c.setZoom(n+p*y),c.setScroll({x:i.x+h*y,y:i.y+m*y})})})})()}animateZoom(t){var e=this;return(0,D.A)(function*(){const n=e.getScroll();yield e.animateZoomScroll({toScale:t,toScroll:n,stepCount:5,stepPeriod:1})})()}initZoomScroll(t=null,e=0){const n=t||this.localStorage.get("scroll")||this.getInitScroll(),i=e||this.localStorage.get("scale")||this.getInitScale();this.getScale()!==i&&this.setZoom(i);const l=this.getScroll();(l.x!==n.x||l.y!==n.y)&&this.setScroll(n)}animateResetView(){var t=this;return(0,D.A)(function*(){yield t.animateZoomScroll({toScale:t.getInitScale(),toScroll:t.getInitScroll()})})()}fitToView(){this.cancelAnimation(),this.canvas.zoom("fit-viewport",null);const t=this.getInitScroll();this.canvas.scroll({dx:t.x,dy:t.y})}zoomOut(t=.1){this.cancelAnimation(),this.setZoom(this.getScale()-t)}zoomIn(t=.1){this.cancelAnimation(),this.setZoom(this.getScale()+t)}};Wn=(0,a.Cg)([(0,a.Qj)(0,d("config")),(0,a.Qj)(1,d("eventBus")),(0,a.Qj)(2,d("canvas")),(0,a.Qj)(3,d("createPopupMenu")),(0,a.Qj)(4,d("popupMenu")),(0,a.Qj)(5,d("localStorage")),(0,a.Sn)("design:paramtypes",[Object,typeof(ws=typeof Yt.A<"u"&&Yt.A)=="function"?ws:Object,typeof(Is=typeof Dn.A<"u"&&Dn.A)=="function"?Is:Object,at,typeof(Ms=typeof Ss.A<"u"&&Ss.A)=="function"?Ms:Object,Ht])],Wn);class qt{constructor(t){this.context=t,this.modeling=t.modeling,this.localizableStrings=t.localizableStrings,this.canvas=t.canvas,this.contextPad=t.contextPad,this.popupMenu=t.popupMenu,this.connect=t.connect,this.create=t.create,this.elementFactory=t.elementFactory,this.elements=t.elements,this.elementToolsConfig=t.elementToolsConfig}getAddItemsConfig(t){const e=this.elementToolsConfig.addItems,n={};return e.forEach(i=>{const s=this.addElementDragStart.bind(this,i);n["add."+i.type]={action:{dragstart:s},imageUrl:i.image,title:i.title}}),n}getDragStartShapeConfig(t){const e=this.elements.getConfig(t);return{type:t.type,width:e.width,height:e.height,caption:""}}addElementDragStart(t,e,n){const i=this.getDragStartShapeConfig(t),s=this.elementFactory.createShape(i);this.create.start(e,s,{source:n})}getDeleteConfig(t){return{delete:{action:{click:()=>{this.modeling.removeElements([t])}},...this.elementToolsConfig.tools.delete}}}getSetupConfig(){return{setup:{action:{click:(t,e)=>{const n=this.getPopupMenuPosition(t,e);this.popupMenu.open(e,"setup",n)}},...this.elementToolsConfig.tools.setup}}}getPopupMenuPosition(t,e){const n=this.canvas.getContainer().getBoundingClientRect(),i=this.contextPad.getPad(e).html.getBoundingClientRect();return{cursor:{x:t.clientX,y:t.clientY},x:i.left+i.width+3-n.left,y:i.top-1-n.top}}getConnectConfig(){return{connect:{action:{dragstart:(t,e,n)=>{this.connect.start(t,e,n)}},...this.elementToolsConfig.tools.connect}}}hasSetupMenu(t){return!this.popupMenu.isEmpty(t,"setup")}hasConnectConfig(t){return t.type&&t.type!==ie.connection}hasAddItemsMenu(t){return!0}hasDeleteAction(t){return!0}getContextPadEntries(t){const e={};return this.hasDeleteAction(t)&&Object.assign(e,this.getDeleteConfig(t)),this.hasSetupMenu(t)&&Object.assign(e,this.getSetupConfig()),this.hasAddItemsMenu(t)&&Object.assign(e,this.getAddItemsConfig(t)),this.hasConnectConfig(t)&&Object.assign(e,this.getConnectConfig()),e}}class Vn extends qt{getContextPadEntries(){return{}}}class Zn{constructor(t){this.context=t}getElementToolsFeature(t){return M.isLabel(t)?new Vn(this.context):new qt(this.context)}}let gt=class{constructor(t,e,n,i,s,l,c,p,h,m){this.elements=h,this.elementToolsConfig=m;const C=p.localizableStrings;e.registerProvider(this);const y={modeling:n,localizableStrings:C,contextPad:e,canvas:c,popupMenu:l,elementFactory:i,create:s,connect:t,elements:h,elementToolsConfig:m};this.initializeElementToolsFactory(y)}initializeElementToolsFactory(t){this.toolsFactory=new Zn(t)}getContextPadEntries(t){return this.toolsFactory.getElementToolsFeature(t).getContextPadEntries(t)}};gt=(0,a.Cg)([(0,a.Qj)(0,d("connect")),(0,a.Qj)(1,d("contextPad")),(0,a.Qj)(2,d("modeling")),(0,a.Qj)(3,d("elementFactory")),(0,a.Qj)(4,d("create")),(0,a.Qj)(5,d("popupMenu")),(0,a.Qj)(6,d("canvas")),(0,a.Qj)(7,d("config")),(0,a.Qj)(8,d("elements")),(0,a.Qj)(9,d("elementToolsConfig")),(0,a.Sn)("design:paramtypes",[Object,Object,se,Object,Object,Object,Object,Object,F,Object])],gt);class Ps{constructor(){this._featureService=new w.ReplaySubject(1)}set featureService(t){this._featureService.next(t)}getFeatureServiceValues(t){return this._featureService.subscribe(e=>{e.getFeatureValues(n=>{t(n)})})}}class Ds{findIntersectSegment(t,e){const n={x1:e.x,y1:e.y,x2:e.x+e.width,y2:e.y+e.height};let i=-1,s;const l=t.waypoints;for(let c=0;c<l.length-1;c++){const p={x1:l[c].x,y1:l[c].y,x2:l[c+1].x,y2:l[c+1].y},h=n,m={x1:Math.min(p.x1,p.x2)-1,y1:Math.min(p.y1,p.y2)-1,x2:Math.max(p.x1,p.x2)+1,y2:Math.max(p.y1,p.y2)+1},C=Math.max(0,Math.min(m.x2,h.x2)-Math.max(m.x1,h.x1)),y=Math.max(0,Math.min(m.y2,h.y2)-Math.max(m.y1,h.y1)),b=C*y;(b>i||i<0)&&(i=b,s=p)}return s}getAlignDelta(t,e){let n=0,i=0;const s=(0,Ae.pp)(e);return t.x1===t.x2?n=t.x1-s.x:i=t.y1-s.y,{x:n,y:i}}isForbiddenType(t){return M.isLabel(t)}canSplit(t){return t&&t.length===1&&!this.isForbiddenType(t[0])}splitConnection({connection:t,shapes:e,modeling:n}){if(t&&this.canSplit(e)){const i=e[0],s=t.target,l=this.findIntersectSegment(t,i),c=this.getAlignDelta(l,i);n.moveShape(i,c);const p=(0,Oe.jz)(i);n.reconnectEnd(t,i,p,{isUpdateConnectionType:!1}),n.connect(i,s,{})}}}var Ea=v(10033),pt=v(74419);let ht=class extends Ea.A{constructor(t,e){super(),this.connectionDocking=t,this.config=e}isStraightConnection(t,e,n){return!0}isShapeCenter(t,e){const{height:n,width:i,x:s,y:l}=e,c=Math.floor(t.x-s-i/2),p=Math.floor(t.y-l-n/2);return c===0&&p===0}getPreferredDirectionWithPoint(t,e){const n=e.x+e.width/2,i=e.y+e.height/2,s=t.x-n,l=t.y-i;let c;return s<0?l<0?c=-s>-l?"l":"t":c=-s>l?"l":"b":l<0?c=s>-l?"r":"t":c=s>l?"r":"b",c}getBoundingRect(t){const n=t.y-10,i=t.x+t.width+10,s=t.y+t.height+10,l=t.x-10;return{top:n,right:i,bottom:s,left:l}}findSourceLayout(t,e,n,i){let s;const l=this.getBoundingRect(t),c=this.getBoundingRect(e);switch(n){case"t":s=c.top<=l.bottom?"t":"b";break;case"b":s=c.bottom<=l.top?"t":"b";break;case"l":s=l.right<=c.left?"r":"l";break;case"r":s=c.right<=l.left?"l":"r";break}return s===n&&(i==="h"&&["r","l"].includes(n)&&(l.top>c.bottom?s="t":l.bottom<c.top||l.bottom>=c.bottom?s="b":s="t"),i==="v"&&["t","b"].includes(n)&&(l.left>c.right?s="l":l.right>=c.right||l.right<c.left?s="r":s="l")),s}getPreferredLayouts(t,e,n,i={}){const s=(0,Ae.pp)(t),l=(0,Ae.pp)(e),c=Math.abs(s.x-l.x),p=Math.abs(s.y-l.y),h=c<p?"v":"h";let m;const C=i.connectionStart;if(C)this.isShapeCenter(C,t)||(m=this.getPreferredDirectionWithPoint(C,t));else{const I=n&&n[0],P=I&&(I.original||M.getOriginalWaypoint(I,t));I&&!this.isShapeCenter(P,t)&&(m=this.getPreferredDirectionWithPoint(I,t))}let y;const b=i.connectionEnd;if(b)this.isShapeCenter(b,e)||(y=this.getPreferredDirectionWithPoint(b,e));else{const I=n&&n.slice(-1)[0],P=I&&(I.original||M.getOriginalWaypoint(I,e));I&&!this.isShapeCenter(P,e)&&(y=this.getPreferredDirectionWithPoint(I,e))}return!m&&y&&(m=this.findSourceLayout(t,e,y,h)),m&&!y&&(y=this.findSourceLayout(e,t,m,h)),!m&&!y?[`${h}:${h}`]:[`${m}:${y}`]}layoutConnection(t,e={}){const n=e.source||t.source,i=e.target||t.target;e.startChanged&&!e.connectionStart&&(e.connectionStart=(0,Ae.pp)(n)),e.endChanged&&!e.connectionEnd&&(e.connectionEnd=(0,Ae.pp)(i));const s=t.waypoints,l=e.connectionStart||s&&s.length&&s[0].original,c=e.connectionEnd||s&&s.length&&s[s.length-1].original;let p;!e.shapeMoving&&!e.startChanged&&!e.endChanged?(e.preferredLayouts=this.getPreferredLayouts(n,i,s,e),p=pt.Z9(n,i,l,c,e)):p=pt.WI(n,i,l,c,s,e),this.isStraightConnection(n,i,t)&&p.length>2&&p.splice(1,p.length-2);const m=Object.assign(t);return m.waypoints=pt.d7(p),this.connectionDocking.getCroppedWaypoints(m,n,i)}};ht=(0,a.Cg)([(0,a.Qj)(0,d("connectionDocking")),(0,a.Qj)(1,d("config")),(0,a.Sn)("design:paramtypes",[Object,Object])],ht);class Ts{constructor(t,e){this.eventBus=t,this.outlineFactory=e,t.on("shape.added",B.LOW,this.onShapeAdded.bind(this)),t.on("shape.changed",B.LOW,this.onShapeChanged.bind(this)),t.on("connection.added",this.onConnectionAdded.bind(this)),t.on("connection.changed",this.onConnectionChanged.bind(this))}onShapeAdded(t){this.onUpdateOutline(t)}onShapeChanged(t){this.onUpdateOutline(t)}onConnectionAdded(t){this.onUpdateOutline(t)}onConnectionChanged(t){this.onUpdateOutline(t)}onUpdateOutline(t){const e=t.element;this.outlineFactory.getOutline(e).draw(e,t.gfx)}}class Re{constructor(t){this.config=t}findOutline(t){return(0,E.P)("."+this.config.outlineClassName,t)}getOutline(t){let e=this.findOutline(t);if(!e){const n=t;e=this.createOutline(n)}return e}createOutline(t){const e=this.getSvgName(),n=(0,x.vt)(e),i=this.getCreateOutlineConfig();return(0,x.CF)(n,i),(0,x.BC)(t,n),n}getSvgName(){return"rect"}getCreateOutlineConfig(){return{...this.config.outlineStyle,shapeRendering:"geometricPrecision"}}draw(t,e){const n=this.getOutline(e);this.updateOutline(n,t)}erase(t,e){const n=this.findOutline(e);n&&n.remove()}}class ja extends Re{getCreateOutlineConfig(){const t=super.getCreateOutlineConfig();return X.A(t,{cx:10,cy:10,r:30})}getSvgName(){return"circle"}updateOutline(t,e){const n=e.width/2;(0,x.CF)(t,{cx:n,cy:n,r:n+this.config.offset})}}class Yn extends Re{getCreateOutlineConfig(){const t=super.getCreateOutlineConfig();return X.A(t,{x:10,y:10,width:100,height:100})}updateOutline(t,e){const n=(0,ve.U7)(e,!1),i=this.config.offset;(0,x.CF)(t,{height:n.height+i*2,width:n.width+i*2,x:n.x-i,y:n.y-i})}draw(t,e){this.config.rules.allowed("canShowConnectionOutline")&&super.draw(t,e)}}class $n extends Re{getCreateOutlineConfig(){const t=super.getCreateOutlineConfig();return X.A(t,{x:10,y:10,width:100,height:100,rx:5})}updateOutline(t,e){const n=this.config.offset;(0,x.CF)(t,{x:-n,y:-n,width:e.width+n*2,height:e.height+n*2})}}class Sa extends Re{getCreateOutlineConfig(){const t=super.getCreateOutlineConfig();return X.A(t,{x:10,y:10,width:100,height:100})}updateOutline(t,e){this.config.rules.allowed("canShowLabelOutline")&&(0,x.CF)(t,{x:-2,y:-2,width:e.width+2*2,height:e.height+2})}draw(t,e){this.config.rules.allowed("canShowLabelOutline")&&super.draw(t,e)}}let ze=class{constructor(t,e,n,i){this.styles=t,this.rules=e,this.elements=n,this.diagramUtils=i,this.config=this.getConfig()}getConfig(){const t="djs-outline",e={...this.styles.cls(t,["no-fill"],null),strokeDasharray:"4,2",strokeWidth:"1px"};return{outlineClassName:t,outlineStyle:e,offset:fs,elements:this.elements,rules:this.rules}}getOutline(t){switch(!0){case M.isLabel(t):return new Sa(this.config);case this.diagramUtils.isConnection(t):return new Yn(this.config);default:return new $n(this.config)}}};ze=(0,a.Cg)([(0,a.Qj)(0,d("styles")),(0,a.Qj)(1,d("rules")),(0,a.Qj)(2,d("elements")),(0,a.Qj)(3,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,F,M])],ze);let en=class extends Ts{constructor(t,e){super(t,e),this.outlineFactory=e}};en=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("outlineFactory")),(0,a.Sn)("design:paramtypes",[Object,ze])],en);class wa extends Re{constructor(){super(...arguments),this._factor45Angle=Math.sqrt(1/2)}getDefaultHeight(){return 55}getCreateOutlineConfig(){const t=this._factor45Angle,e=this.getDefaultHeight()/2,n=super.getCreateOutlineConfig();return X.A(n,{x:10,y:10,width:100,height:100,transform:`matrix(${t} -${t} ${t} ${t} 0 ${e})`})}updateOutline(t,e){const n=this._factor45Angle,i=e.height/2,s=this.config.offset;(0,x.CF)(t,{x:-s,y:-s,width:e.width*n+s*2,height:e.height*n+s*2,transform:`matrix(${n} -${n} ${n} ${n} 0 ${i})`})}}let Jn=class extends Ts{constructor(t,e,n){super(t,e),this.outlineFactory=e,this.registry=n,this.notValidElements=new Set,t.on(["element.validation"],this.onElementIsValidChanged.bind(this))}onElementIsValidChanged(t){const e=t.id;t.isValid?this.removeElement(e):this.addElement(e)}addElement(t){if(!this.notValidElements.has(t)&&this.registry.get(t)){this.notValidElements.add(t);const e=this.registry.get(t),n=this.registry.getGraphics(e);this.onUpdateOutline({element:e,gfx:n})}}removeElement(t){if(this.notValidElements.has(t)){this.notValidElements.delete(t);const e=this.registry.get(t),n=this.registry.getGraphics(e);this.outlineFactory.getOutline(e).erase(e,n)}}onUpdateOutline(t){const e=t.element;this.notValidElements.has(e.id)&&super.onUpdateOutline(t)}};Jn=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("validationOutlineFactory")),(0,a.Qj)(2,d("elementRegistry")),(0,a.Sn)("design:paramtypes",[Object,ze,Object])],Jn);class ks extends ue{getSizeConfig(t){const e=this.elements.getConfig(t);return this.styles.style({height:t.height||e.height,width:t.width||e.width})}getImageSource(t){const e=this.elements.getConfig(t);return t.largeImage||e.largeImage}draw(t,e){super.draw(t,e);const n=this.elements.getConfig(e);if(!n)throw new Error(`Element type ${e.type} not supported`);const i=(0,x.vt)("image"),s=this.getSizeConfig(e),l=this.getImageSource(e);return(0,x.CF)(i,s),i.setAttributeNS("http://www.w3.org/1999/xlink","href",l),i.setAttributeNS(null,"type",n.type),i.setAttributeNS(null,"preserveAspectRatio","none"),(0,x.BC)(t,i),i}}let tn=class{constructor(t){this.popupMenu=t,this.popupMenu.registerProvider("setup",this)}getPopupMenuEntries(t){return{}}getHeaderEntries(t){return[]}};tn=(0,a.Cg)([(0,a.Qj)(0,d("popupMenu")),(0,a.Sn)("design:paramtypes",[Object])],tn);class ut{constructor(t,e){this.width=t,this.height=e}}var Ia=v(41666),Ma=v(20418),Pa=v(39255),Da=v(54100),Ta=v(95576),ka=v(85284),Oa=v(26316),La=v(78768),Aa=v(54559),Os=v(46902),Ra=v(50317),za=v(50101),_a=v(77648),Na=v(79691),Ba=v(85868),Ga=v(73229),Fa=v(25342),Qa=v(88729),Ua=v(56773),Ha=v(28400),Wa=v(23550),Va=v(64916),Za=v(32959),Ya=v(81284);let Kn=class{constructor(t,e){this.eventBus=t,this.canvas=e,this._isOpen=!1,this._init()}_init(){this._popupContainer=(0,E.zm)('<div class="djs-diagram-popup"></div>');const t=this.canvas.getContainer();this._popup=t.appendChild(this._popupContainer),this._subscribeEvents()}_subscribeEvents(){this._subscribeEventBusEvents(),this._subscribeDomEvents()}_subscribeDomEvents(){this._popup.onwheel=t=>this._onWheel(t)}_onWheel(t){const e=t.wheelDeltaY||-(t.deltaY*25);this._popup.scrollTop-=e,t.stopPropagation(),t.returnValue=!1}_onViewBoxChanged(){this._state&&this._state.parentContainer&&this.open({parentContainer:this._state.parentContainer,html:this._state.html,width:this._state.width,options:this._state.options})}_subscribeEventBusEvents(){this.eventBus.on(["canvas.resized","zoom.changed","selection.changed"],()=>this.close()),this.eventBus.on("popup.open",t=>this.open(t)),this.eventBus.on("canvas.viewbox.changing",()=>this.hide()),this.eventBus.on("canvas.viewbox.changed",()=>this._onViewBoxChanged())}getPopupPosition(t){const{parentContainer:e}=t,{e:n,f:i}=e.getCTM(),{height:s}=e.getBoundingClientRect(),l=5,c=i+s+l,{width:p}=e.getBoundingClientRect(),h=t.options?.direction||"right";let m=n;return h==="right"&&(m+=p-t.width),h==="left"&&(m-=p),{x:m,y:c}}open(t){if(!t.width)throw new Error("width must be > 0");this._state={parentContainer:t.parentContainer,html:t.html,width:t.width,options:t.options};const{x:e,y:n}=this.getPopupPosition(t);return(0,X.A)(this._popupContainer.style,{left:`${e}px`,top:`${n}px`,visibility:"visible",width:`${t.width}px`}),this._isOpen=!0,this._popupContainer.innerHTML=t.html,this._popupContainer}close(){this._isOpen&&(this.hide(),this._state={})}hide(){(0,X.A)(this._popupContainer.style,{visibility:"hidden"}),this._popupContainer.innerHTML=""}};Kn=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("canvas")),(0,a.Sn)("design:paramtypes",[Object,Object])],Kn);var $a=v(38134);class Ja extends $a.A{addDragger(t,e,n){const i=super.addDragger(t,e,n);return i.classList.add(t.type),i}}let Xn=class{constructor(t,e,n){this.eventBus=t,this.Tooltips=e,this.canvas=n,this.tooltipTimeout=400,t.on("element.hover",this.onElementHover.bind(this)),this.Tooltips._updateRoot=()=>{}}onElementHover(t){clearTimeout(this.timeoutHandle),this.timeoutHandle=setTimeout(()=>{const{element:e,gfx:n}=t;this.elementId!==e.id&&this.tooltipId&&this.removeTooltip(),e.tooltip&&!this.tooltipId&&this.addTooltip(n,e)},this.tooltipTimeout)}removeTooltip(){this.Tooltips.remove(this.tooltipId),this.tooltipId=null}addTooltip(t,e){this.elementId=e.id;const n=e.tooltipConfig||{};this.tooltipId=this.Tooltips.add({position:{x:0,y:0},type:n.type,html:this.getTemplate(e.tooltip)}),this.setPosition(t,e)}getTemplate(t){return`<div class="tooltip">${t}</div>`}getDiagramSize(){const e=this.canvas.getContainer().getBoundingClientRect();return{width:e.width,height:e.height}}getHtmlContainer(){return this.Tooltips.get(this.tooltipId).htmlContainer}setPosition(t,e){const{a:n,e:i,f:s}=t.getCTM();let l=i+e.width*n,c=s+e.height*n;const p=this.getDiagramSize(),h=this.getHtmlContainer(),{width:m,height:C}=h.getBoundingClientRect();l+m>p.width&&(l=i-m),c+C>p.height&&(c=s-C),Object.assign(h.style,{left:l+"px",top:c+"px"})}};Xn=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("tooltips")),(0,a.Qj)(2,d("canvas")),(0,a.Sn)("design:paramtypes",[Object,Object,Object])],Xn);const _e={__depends__:[Ia.A,Ma.A,Pa.A,Da.A,Ta.A,Oa.A,La.A,Aa.A,Ra.A,za.A,_a.A,Va.A,Na.A,Os.A,Ba.A,Ua.A,Ya.A,Lt,Za.A,ka.A,Gt,Ha.A],__init__:["canvas","commandStack","contextPad","contextPadProvider","copyPaste","labelSupport","diagramLoader","diagramRenderer","diagramRules","diagramEventHandlerController","diagramText","directEditing","editorActions","elementFactory","elementRegistry","keyboardBindings","labelEdit","layouter","localStorage","outline","resize","resizeHandles","resizePreview","setupMenuProvider","handTool","spaceToolPreview","bendpointMove","bendpoints","featureProvider","connectionPreview","connectionSegmentMove","paletteProvider","paletteElements","elementToolsConfig","createPopupMenu","palette","connectionHighlight","minimap","diagramPopup","lassoTool","diagramUtils","diagramPaletteTools","diagramTooltips"],canvas:["type",Tn],commandStack:["type",kn],connectionDocking:["type",Wa.A],contextPad:["type",Ft],contextPadProvider:["type",gt],copyPaste:["type",Qt],labelSupport:["type",Un],diagramLoader:["type",dt],diagramRenderer:["type",Ve],diagramRules:["type",W],diagramEventHandlerController:["type",wn],directEditing:["type",Jt],editorActions:["type",zn],elementFactory:["type",ps],elementRegistry:["type",rt],keyboardBindings:["type",$o],localStorage:["type",Ht],modeling:["type",se],outline:["type",en],resize:["type",Ga.A],resizeHandles:["type",Fa.A],resizePreview:["type",Qa.A],setupMenuProvider:["type",tn],handTool:["type",Os.A],spaceToolPreview:["type",fa],bendpoints:["type",Lt],featureProvider:["type",Ps],connectionPreview:["type",On],popupMenu:["type",Qn],connectionSegmentMove:["type",Gt],labelEdit:["type",$t],diagramText:["type",pe],outlineFactory:["type",ze],renderingShapeFactory:["type",We],renderingLabel:["type",bs],renderingShape:["type",ks],layouter:["type",ht],elements:["type",F],paletteProvider:["type",Zt],splitConnectionHelper:["type",Ds],spaceTool:["type",Xt],paletteElements:["type",it],elementToolsConfig:["type",lt],createPopupMenu:["type",at],palette:["type",Gn],replaceMenuGroups:["type",function(){return{}}],zoomScroll:["type",Wn],connectionHighlight:["type",Kt],minimap:["type",Bn],diagramPopup:["type",Kn],lassoTool:["type",Nn],previewSupport:["type",Ja],diagramUtils:["type",M],diagramPaletteTools:["type",Fn],diagramTooltips:["type",Xn]};let mt=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=o.\u0275\u0275defineNgModule({type:r})}static{this.\u0275inj=o.\u0275\u0275defineInjector({providers:[le,as,{provide:ot,useValue:_e},f.LoggerService],imports:[A.CommonModule,R.h.forChild(),Q.kt]})}}return r})();(function(){(typeof ngJitMode>"u"||ngJitMode)&&o.\u0275\u0275setNgModuleScope(mt,{declarations:[Tt],imports:[A.CommonModule,R.h,Q.kt],exports:[Tt]})})();class Ka extends ps{generateId(t){return f.IdGenerator.generateUUID()}}class Jc extends null{getConnectionAttributes(t,e){return{...super.getConnectionAttributes(t,e),itemName:e.itemName,order:this.elements.items.connection.order}}}let Ls=class extends Ot{constructor(t,e,n,i,s,l){super(t,l),this.eventBus=t,this.graphicsFactory=e,this.elementRegistry=n,this.modeling=i,this.selection=s,this.diagramUtils=l}onItemNameChanged({id:t,name:e}){const n=this.elementRegistry.getGraphics(t),i=this.elementRegistry.get(t);i.itemName=e,this.graphicsFactory.update(this.diagramUtils.isConnection(i)?"connection":"shape",i,n)}onElementCaptionChanged({id:t,caption:e}){const n=this.elementRegistry.get(t);if(n){const i=n.caption,s=e&&e.trim();i!==s&&this.modeling.updateLabel(n,e)}}getPasteElementConfig(t){const e=this.getFlowElementConfigFromShape(t);return Object.assign(e,{sourceId:t.sourceId})}findElements(t){const e=[];return t.forEach(n=>{const i=this.elementRegistry.get(n);i&&e.push(i)}),e}getFlowElementConfigFromShape(t){return{itemName:t.itemName,id:t.id,caption:t.caption,parentId:t.parent.id,position:{x:t.rx,y:t.ry}}}addElement(t){const e=t.context,n=e.shape||e.element||e.connection;e.hints.isElementCopyPaste?this.service.pasteElement(this.getPasteElementConfig(n)):super.addElement(t)}subscribeServerDiagramChanges(){const t=this.service;this.eventBus.on([j.elements.removing],e=>{const n=e.elements.map(i=>i.id);return t.removing(n)}),this.eventBus.on([j.element.doubleClick],e=>{t.elementDoubleClick(e.element.itemName)}),this.eventBus.on(["diagram.item.selected"],e=>{const n=e.id,i=n&&this.elementRegistry.get(n);t.selectionChanged(i&&this.getFlowElementConfigFromShape(i))})}getShape(t){const e=super.getShape(t),n=t.context.shape||t.context.element;return e.type=n.userTaskType||n.type,e}subscribeServerChanges(){this.subscribeServerDiagramChanges();const t=this.service;return[t.elementIsValidChanged$.subscribe(e=>this.eventBus.fire(j.element.validation,e)),t.elementNameChanged$.subscribe(({id:e,name:n})=>{this.onItemNameChanged({id:e,name:n})}),t.elementCaptionChanged$.subscribe(({id:e,caption:n})=>{this.onElementCaptionChanged({id:e,caption:n})}),t.elementRemoved$.subscribe(e=>{const n=this.findElements(e);this.modeling.removeElements(n,!0)}),t.elementUpdateType$.subscribe(({id:e,config:n})=>{const i=this.elementRegistry.get(e);this.diagramUtils.isConnection(i)||this.modeling.updateElementType({id:e,config:n,force:!0})}),t.elementSelected$.subscribe(({id:e})=>{const n=this.elementRegistry.get(e);n?this.selection.select(n,!1):this.selection.select([],!1)}),t.elementCenterViewBox$.subscribe(({id:e})=>{const n=this.elementRegistry.get(e);n&&this.modeling.centerViewbox(n)}),t.elementMarkersChanged$.subscribe(({id:e,markers:n})=>{const i=this.elementRegistry.get(e);this.modeling.updateElementMarkers(i,n)})]}};Ls=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("graphicsFactory")),(0,a.Qj)(2,d("elementRegistry")),(0,a.Qj)(3,d("modeling")),(0,a.Qj)(4,d("selection")),(0,a.Qj)(5,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object,Object])],Ls);class Xa extends lt{getAddItems(){const t=this.config.customElementToolsConfig?this.config.customElementToolsConfig.addItems||[]:[];return[...super.getAddItems(),...t]}getTools(){const t=this.config.customElementToolsConfig?this.config.customElementToolsConfig.tools||[]:[];return{...super.getTools(),...t}}}let Kc=null;var k=function(r){return r.relationshipItem="relationship-item",r.relationshipContainer="relationship-container",r.connection="connection",r.parentConnection="parent-connection",r.indirectConnection="indirect-connection",r}(k||{});class T extends M{static isFlowNode(t){return[k.relationshipContainer,k.relationshipItem].includes(t?.type)}static isRelationshipContainer(t){return t?.type===k.relationshipContainer}static isRootItem(t){return T.isRelationshipContainer(t)||t?.single===!0}static isRelationshipItem(t){return t?.type===k.relationshipItem}static isIndirectConnection(t){return t?.type===k.indirectConnection}static isHorizontalConnection(t){return t?.type===k.connection&&t.position===0}isFlow(t){const e=[k.connection,k.indirectConnection];return super.isFlow(t)||e.includes(t?.type)}isConnection(t){const e=[k.connection,k.indirectConnection];return super.isConnection(t)||e.includes(t?.type)}}let qn=class extends qt{constructor(t,e){super(t),this.context=t,this.config=e}hasAddItemsMenu(t){return T.isFlowNode(t)}hasConnectConfig(t){return T.isFlowNode(t)}hasDeleteAction(t){return this.context.rules.canDelete(t)}getAddItemsConfig(t){return{add:{action:{click:(e,n)=>{const i=this.getPopupMenuPosition(e,n);this.popupMenu.open(n,"add",i)}},...this.elementToolsConfig.tools.add}}}};qn=(0,a.Cg)([(0,a.Qj)(1,d("config")),(0,a.Sn)("design:paramtypes",[Object,Object])],qn);let ei=class extends Zn{constructor(t,e){super(t),this.context=t,this.config=e}getElementToolsFeature(t){return M.isLabel(t)?new Vn(this.context):new qn(this.context,this.config)}};ei=(0,a.Cg)([(0,a.Qj)(1,d("config")),(0,a.Sn)("design:paramtypes",[Object,Object])],ei);let Ne=class extends rt{constructor(t,e){super(t),this.injector=t,this.utils=e}getChildren(t){return this.getAllElements().filter(e=>e.parent?.id===t.id)}getFlowNodes(){return this.getAllElements().filter(T.isFlowNode)}getContainers(){return this.getAllElements().filter(T.isRelationshipContainer)}getFlows(){return this.getAllElements().filter(t=>this.utils.isFlow(t))}getElementFlows(t){return this.getAllElements().filter(e=>this.utils.isFlow(e)).filter(e=>e.source.id===t.id||e.target.id===t.id)}};Ne=(0,a.Cg)([(0,a.Qj)(0,(0,f.Inject)("injector")),(0,a.Qj)(1,(0,f.Inject)("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,T])],Ne);let q=class{constructor(t,e,n){this.elements=t,this.registry=e,this.localStorage=n}static{this.canMove=!1}static getSpacing(t){switch(t){case k.relationshipItem:return{x:100,y:70};case k.relationshipContainer:return{x:70,y:100};case"scroll":return{x:50,y:50};default:return{x:10,y:8}}}setExpandedContainersIds(t){t.length>0?this.localStorage.set("expanded-containers",t.join(",")):this.localStorage.remove("expanded-containers")}getExpandedContainersIds(){return(this.localStorage.get("expanded-containers")||"").split(",")}getElementSize(t){const e=this.elements.getConfig(t);return t.collapsed===!1?{width:t.expandedWidth||e.width,height:t.expandedHeight||e.height*2}:{width:e.width,height:e.height}}saveContainersState(){const t=this.registry.getContainers().filter(e=>e.collapsed===!1).map(e=>e.id);this.setExpandedContainersIds(t)}loadContainersState(t){const e=this.getExpandedContainersIds().filter(n=>t.elements[n]?.hasChildren);e.map(n=>t.elements[n]).forEach(n=>n.collapsed=!1),this.setExpandedContainersIds(e)}};q=(0,a.Cg)([(0,a.Qj)(0,(0,f.Inject)("elements")),(0,a.Qj)(1,(0,f.Inject)("elementRegistry")),(0,a.Qj)(2,(0,f.Inject)("localStorage")),(0,a.Sn)("design:paramtypes",[F,Ne,Ht])],q);let vt=class extends W{constructor(t,e,n,i){super(t,e),this.eventBus=t,this.utils=n,this.elementRegistry=i}getCountConnection(t,e,n){return this.elementRegistry.filter(s=>s!==n&&(s.source===t&&s.target===e||s.source===e&&s.target===t)).length}canRead(t){return t.canRead!==!1}canConnect(t,e){let n=super.canConnect(t,e);return n&&(n=(!t||this.canRead(t))&&(!e||this.canRead(e))),n}canConnectionCreate(t){const e=t.source,n=t.target,i=t.connection;return super.canConnectionCreate(t)&&e!==n&&e.parent!==n&&e!==n.parent&&!this.utils.isConnection(e)&&!this.utils.isConnection(n)&&this.getCountConnection(e,n,i)<2}canReconnectEnd(t){const e=super.canReconnectEnd(t),{hover:n,connection:i}=t,s=i.source,l=n||t.target;return e&&this.canConnectionCreate({source:s,target:l,connection:i})}canReconnectStart(t){const e=super.canReconnectStart(t),{hover:n,connection:i}=t,s=n||t.source,l=i.target;return e&&this.canConnectionCreate({source:s,target:l,connection:i})}canShowPalette(){return!1}canElementMove(t){return q.canMove}canElementCopy(t){return!1}canElementPaste(t){return!1}canElementUpdateType(t){return!1}canLabelEdit(){return!1}canShowConnectionOutline(){return!1}canConnectionSegmentMove(){return!1}canElementsDelete(t){let e=super.canElementsDelete(t);const n=t.elements;return e=e&&n.every(i=>this.canDelete(i)),e?e=this.eventBus.fire("elements.removing",{elements:n}):this.eventBus.fire("elements.noAccessMessage",{elements:n}),e}canDelete(t){const e=this.canEdit(t);if(!e)return!1;if(this.utils.isFlow(t))return e;if(!this.elementRegistry.getElementFlows(t).every(s=>this.canEdit(s)))return!1;if(T.isRelationshipContainer(t))return this.elementRegistry.getChildren(t).every(c=>this.canEdit(c));if(T.isRelationshipItem(t)){const s=t;return s.single?!0:this.canRead(s.parent)}return!0}canEdit(t){if(T.isRoot(t))return!1;if(this.utils.isFlow(t)){const n=t;return this.canConnect(n.source,n.target)}return this.canRead(t)}};vt=(0,a.Cg)([(0,a.Qj)(0,(0,f.Inject)("eventBus")),(0,a.Qj)(1,(0,f.Inject)("config")),(0,a.Qj)(2,(0,f.Inject)("diagramUtils")),(0,a.Qj)(3,(0,f.Inject)("elementRegistry")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object])],vt);let ti=class extends gt{constructor(t,e,n,i,s,l,c,p,h,m,C,y){super(t,e,n,i,s,l,c,p,h,m),this.elements=h,this.elementToolsConfig=m,this.registry=C,this.rules=y,this.config=p;const b=this.config.localizableStrings,I={modeling:n,localizableStrings:b,contextPad:e,canvas:c,popupMenu:l,elementFactory:i,create:s,connect:t,elements:h,elementToolsConfig:m,registry:C,rules:y};this.initializeElementToolsFactory(I)}initializeElementToolsFactory(t){this.toolsFactory=new ei(t,this.config)}};ti=(0,a.Cg)([(0,a.Qj)(0,d("connect")),(0,a.Qj)(1,d("contextPad")),(0,a.Qj)(2,d("modeling")),(0,a.Qj)(3,d("elementFactory")),(0,a.Qj)(4,d("create")),(0,a.Qj)(5,d("popupMenu")),(0,a.Qj)(6,d("canvas")),(0,a.Qj)(7,d("config")),(0,a.Qj)(8,d("elements")),(0,a.Qj)(9,d("elementToolsConfig")),(0,a.Qj)(10,d("elementRegistry")),(0,a.Qj)(11,d("diagramRules")),(0,a.Sn)("design:paramtypes",[Object,Object,se,Object,Object,Object,Object,Object,F,Object,Object,vt])],ti);let nn=class extends Xa{constructor(t,e){super(t,e),this.elements=t,this.config=e,this.innerTools=this.getInnerTools()}getInnerTools(){return{...this.config?.customElementToolsConfig?.innerTools||{}}}};nn=(0,a.Cg)([(0,a.Qj)(0,d("elements")),(0,a.Qj)(1,d("config")),(0,a.Sn)("design:paramtypes",[F,Object])],nn);class qa extends Re{getCreateOutlineConfig(){const t=super.getCreateOutlineConfig();return Object.assign(t,{x:10,y:10,width:100,height:100,rx:8,ry:8})}updateOutline(t,e){const n=this.config.offset;(0,x.CF)(t,{x:-n,y:-n,rx:8,ry:8,width:e.width+n*2,height:e.height+n*2})}}let sn=class extends ze{constructor(t,e,n,i){super(t,e,n,i),this.styles=t,this.rules=e,this.elements=n,this.diagramUtils=i,this.flowNodeConfig=this.getFlowNodeConfig(),this.flowConfig=this.getFlowConfig()}getFlowConfig(){const t=this.getConfig();return t.outlineStyle.stroke="#b033d3",t}getFlowNodeConfig(){const t=this.getConfig();return t.offset=1.5,t.outlineStyle.strokeDasharray="none",t.outlineStyle.strokeWidth="3px",t}getOutline(t){switch(!0){case T.isFlowNode(t):return new qa(this.flowNodeConfig);case this.diagramUtils.isFlow(t):return new Yn(this.flowConfig);default:return super.getOutline(t)}}};sn=(0,a.Cg)([(0,a.Qj)(0,d("styles")),(0,a.Qj)(1,d("rules")),(0,a.Qj)(2,d("elements")),(0,a.Qj)(3,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,F,M])],sn);var de=v(52965),As;let on=class extends ue{constructor(t,e,n,i,s){super(t,e,n,i),this.elements=t,this.styles=e,this.diagramText=n,this.eventBus=i,this.canvas=s,this._groupsOverflowAmount=3,this._commentIconBase64="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMCIgaGVpZ2h0PSIxMCIgdmlld0JveD0iMCAwIDEwIDEwIj48ZGVmcz48c3R5bGU+LmEsLmJ7ZmlsbDpub25lO30uYXtzdHJva2U6I2ZmZjtzdHJva2UtbWl0ZXJsaW1pdDoxMDt9PC9zdHlsZT48L2RlZnM+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMjkgMC4wMjkpIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjQ3MSAwLjQ3MSkiPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTQxMy4yNSwzODAuNzM1aC0ydjJsLTMtMmgtNHYtNmg5WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDIyLjI1IC0zNzQuNzM1KSIvPjwvZz48L2c+PHJlY3QgY2xhc3M9ImIiIHdpZHRoPSIxMCIgaGVpZ2h0PSIxMCIvPjwvc3ZnPg=="}_createAdditionalGroupsIcon(t,e,n){const i=(0,x.vt)("rect",{stroke:"gray","stroke-width":1,fill:"#ffffff",height:18,width:18,x:t.x-20,y:t.y,rx:10,ry:10});(0,x.BC)(e,i);const s=`+${n.length-this._groupsOverflowAmount}`,l={box:{height:18,width:18},style:{fill:"#60779F !important"},className:"show-all-group-caption"},c=this.createText(e,s,l);return(0,de.pd)(c,t.x-20,t.y,0),c}_getAdditionalGroupsHtml(t){let e='<div class="additional-groups">';for(const n of t){let i="",s="",l="";n.itemComment&&(i=" has-comment",s=`<div class="additional-group-comment">${n.itemComment}</div>`,l='<div class="comment-icon-gray"></div>'),e+=`
				<div class="additional-group-container">
					<div class="additional-group-container-header">
						<div class="circle" style="background-color:${n.color}"></div>
						<div class="additional-group-name${i}">${n.caption}</div>
						${l}
					</div>
					${s}
				</div>`}return e+="</div>"}_drawCommentIcon(t,e,n){const i=(0,x.vt)("rect",{fill:n.color,height:10,rx:5,ry:5,width:15,x:e.x,y:e.y});(0,x.BC)(t,i),(0,de.pd)(i,-5,0,0);const s=this._commentIconBase64,l=this.styles.style({height:10,width:10}),c=(0,x.vt)("image",l);c.setAttributeNS("http://www.w3.org/1999/xlink","href",s),c.setAttributeNS(null,"preserveAspectRatio","xMidYMid meet"),(0,x.BC)(t,c),(0,de.pd)(c,e.x,e.y,0)}_addCommentListener(t,e,n){t.addEventListener("click",()=>{const i=`<div class="group-item-comment">
							 	<h4 class="caption">
									<span class="circle" style="background-color:${n.color}"></span>
									${n.caption}
								</h4>
							 	<p class="item-comment">${n.itemComment}</p>
							 </div>`;this.eventBus.fire("popup.open",{parentContainer:e,html:i,width:278,options:{direction:"right"}})})}draw(t,e){const n=(0,x.vt)("g",{class:"group-container"});(0,x.BC)(t,n);const i=e.groups||[];if(i.length===0)return;const s=5,l=100,c=16,p=c/2,h={x:e.width,y:e.height-c/2},m=i.length,C=m>this._groupsOverflowAmount,y=(C?this._groupsOverflowAmount:m)-1;if(C){const b=this._createAdditionalGroupsIcon(h,n,i),I=this._getAdditionalGroupsHtml(i);b.addEventListener("click",()=>{const P=this.canvas.viewbox();this.eventBus.fire("popup.open",{parentContainer:b,html:I,width:Math.round(e.width*P.scale)})}),h.x-=s+15}for(let b=0;b<=y;b++){const I=i[b],L=I.itemComment?"group-item has-item-comment":"group-item",G=(0,x.vt)("g",{class:L});(0,x.BC)(n,G),h.x-=l+s;const J=(0,x.vt)("rect",{fill:I.color,height:c,rx:p,ry:p,width:l,x:h.x,y:h.y});(0,x.BC)(G,J);const z=I.caption,tt=I.itemComment?l-24:l-10,wt={box:{height:c,width:tt},className:"group-caption"},En=this.createText(G,z,wt);if((0,de.pd)(En,h.x+5,h.y,0),I.itemComment){const oe={x:h.x+l-17,y:h.y+4};this._drawCommentIcon(G,oe,I),this._addCommentListener(G,En,I)}}return n}};on=(0,a.Cg)([(0,a.Qj)(0,d("elements")),(0,a.Qj)(1,d("styles")),(0,a.Qj)(2,d("diagramText")),(0,a.Qj)(3,d("eventBus")),(0,a.Qj)(4,d("canvas")),(0,a.Sn)("design:paramtypes",[Object,typeof(As=typeof he.A<"u"&&he.A)=="function"?As:Object,pe,Object,Object])],on);let an=class{constructor(t,e,n){this.modeling=t,this.elements=e,this.elementToolsConfig=n,this.containerClassName="toggle-container",this.rectClassName="toggle-rect",this.imageClassName="toggle-image"}toggle(t){this.modeling.toggleCollapse(t)}onClick(t,e){e.stopPropagation(),this.toggle(t)}clear(t){const e=(0,E.P)("."+this.containerClassName,t);e&&(0,E.TF)(e)}draw(t,e){this.clear(t);const n=e.collapsed?8:24,i={height:30,width:30+n,class:this.containerClassName},s=(0,x.vt)("g",i);(0,x.BC)(t,s);const c=this.elements.getConfig(e).height-i.height;(0,de.pd)(s,e.width-i.width,c,0);const p={height:i.height,width:i.width,fill:"transparent",class:this.rectClassName},h=(0,x.vt)("rect",p);(0,x.BC)(s,h),E.f0.bind(s,"click",this.onClick.bind(this,e));const m={height:6,width:10,class:this.imageClassName},C=(0,x.vt)("image",m),y=this.elementToolsConfig.innerTools.toggle,b=e.collapsed?y?.expandImageUrl||v(65070):y?.collapseImageUrl||v(34035);C.setAttributeNS("http://www.w3.org/1999/xlink","href",b),(0,x.BC)(s,C);const I=i.width-m.width-n,P=i.height/2-m.height/2;(0,de.pd)(C,I,P,0)}};an=(0,a.Cg)([(0,a.Qj)(0,(0,f.Inject)("modeling")),(0,a.Qj)(1,(0,f.Inject)("elements")),(0,a.Qj)(2,(0,f.Inject)("elementToolsConfig")),(0,a.Sn)("design:paramtypes",[Object,Object,nn])],an);let ni=class extends en{constructor(t,e,n,i,s){super(t,e),this.outlineFactory=e,this.diagramText=n,this.relationshipRenderingGroup=i,this.relationshipToggleTools=s}drawGroups(t,e){T.isRelationshipItem(e)&&e.canRead!==!1&&this.relationshipRenderingGroup.draw(t,e)}drawToggleTools(t,e){e.hasChildren?this.relationshipToggleTools.draw(t,e):this.relationshipToggleTools.clear(t)}onShapeAdded(t){super.onShapeAdded(t),this.drawGroups(t.gfx,t.element),this.drawToggleTools(t.gfx,t.element)}onShapeChanged(t){super.onShapeChanged(t),this.drawToggleTools(t.gfx,t.element)}};ni=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("outlineFactory")),(0,a.Qj)(2,d("diagramText")),(0,a.Qj)(3,d("relationshipRenderingGroup")),(0,a.Qj)(4,d("relationshipToggleTools")),(0,a.Sn)("design:paramtypes",[Object,sn,pe,on,an])],ni);var ii=v(19239);let si=class{constructor(t,e,n){this.config=t,this.modeling=e,this.popupMenu=n,this.popupMenu.registerProvider("add",this)}createHeaderEntry(t,e){const n=t.entitySchemaData;return{id:n.name,className:"add-item-button-tool",label:n.caption,action:()=>{this.modeling.addNewConnection({source:e,targetType:t.type}),this.popupMenu.close()}}}getPopupMenuEntries(t){return{}}getHeaderEntries(t){const e=[],n=[k.relationshipContainer,k.relationshipItem];return(0,ii.A)(this.config.customDiagramElements,i=>{n.includes(i.type)&&e.push(this.createHeaderEntry(i,t))}),e}};si=(0,a.Cg)([(0,a.Qj)(0,d("config")),(0,a.Qj)(1,d("modeling")),(0,a.Qj)(2,d("popupMenu")),(0,a.Sn)("design:paramtypes",[Object,Object,Object])],si);let ft=class{constructor(t,e,n,i,s,l){this.sizeUtils=t,this.diagramUtils=e,this.modeling=n,this.registry=i,this.canvas=s,this.eventBus=l}elementTreeExists(t,e){return t.some(n=>n.some(i=>i.id===e.id))}fillTreeLevel(t,e,n,i){const l=this.getElementChildren(e,n).filter(c=>!this.elementTreeExists(i,c));l.forEach(c=>{this.addTreeElement(t,c,i)}),l.forEach(c=>{this.fillTreeLevel(t+1,c,n,i)})}addTreeElement(t,e,n){e.level=t;const i=Math.abs(t),s=n[i]=n[i]||[];s.map(c=>c.id).includes(e.id)||s.push(e)}getDirectConnections(t){let e=[];return t.connections&&(e=Object.values(t.connections).filter(n=>n.type===k.connection&&n.position!==0)),e}getHorizontalConnections(t){let e=[];return t.connections&&(e=Object.values(t.connections).filter(n=>n.type===k.connection&&n.position===0)),e}getLevelWidth(t){if(!t?.length)return 0;const e=t[t.length-1];return e.x+this.getElementWidth(e)}getElementWidth(t){return this.sizeUtils.getElementSize(t).width}getElementHeight(t){return this.sizeUtils.getElementSize(t).height}getElementChildren(t,e){const n=this.getDirectConnections(e).filter(i=>i.source===t.id).map(i=>e.elements[i.target]);return Array.from(new Set(n))}getTreeWidth(t){let e=0;return t.forEach(n=>{const i=this.getLevelWidth(n);e<i&&(e=i)}),e}getTreeBottomY(t){const n=t[t.length-1][0];return n.y+this.getElementHeight(n)}fixTreePositionX(t,e){const n=this.getTreeWidth(e);e.forEach(i=>{const s=this.getLevelWidth(i),l=(n-s)/2;i.forEach(c=>{c.x+=l,Object.values(t.elements).filter(h=>String(h.parent)===c.id).forEach(h=>h.x+=l)})})}getContainerChildren(t,e){return Object.values(e.elements).filter(n=>String(n.parent)===t.id)}fillContainerTreePosition(t,e){const n=this.getContainerChildren(t,e);if(t.hasChildren=n.length>0,t.hasChildren){const i=q.getSpacing(k.relationshipContainer),s=i.x,l=i.y,c=this.buildTree(e,n);this.fillTreePosition(e,c,t.x+s,t.y+l);const p=this.getTreeWidth(c),h=this.getTreeBottomY(c);t.expandedWidth=p-t.x+s,t.expandedHeight=h-t.y+l,this.fixTreePositionX(e,c)}}fillTreePosition(t,e,n=0,i=0){const s=q.getSpacing(k.relationshipItem);let l=i;for(const c of e){let p=n,h=0;for(const y of c){y.x=p,y.y=l,this.fillContainerTreePosition(y,t),p+=this.getElementWidth(y)+s.x;const b=this.getElementHeight(y);h=Math.max(h,b)}const m=Object.values(t.elements).filter(T.isRootItem),C=this.getHorizontalElements(t,m);this.fixOnlyChildByParents(t,c,C),l+=h+s.y}}fixOnlyChildByParents(t,e,n){let i=0,s=0,l=!1;const c=Object.values(t.elements),p=this.getDirectConnections(t);do{for(const h of e){const m=p.filter(y=>y.target===h.id);if(m.length===1){const y=m[0];if(!n.includes(y.target)){const b=y.source,I=c.find(L=>L.id===b);if(!this.hasLevelIntercept(I.x,h,e)){const L=I.x||0;L!==h.x&&(this.changeElementX(h,L,t),s++)}}}}l=i!==s,i=s}while(s<e.length&&l)}changeElementX(t,e,n){const i=e-t.x;t.x=e,T.isRelationshipContainer(t)&&this.getContainerChildren(t,n).forEach(l=>l.x+=i)}hasLevelIntercept(t,e,n){const i=n.map(m=>({id:m.id,x:m.id===e.id?t:m.x,type:m.type,width:this.getElementWidth(m)}));if(i.find(m=>m.id!==e.id&&m.x===e.x))return!0;i.sort((m,C)=>m.x-C.x);const l=i.findIndex(m=>m.id===e.id),c=i[l-1],p=q.getSpacing(k.relationshipItem);if(c){const m=c.x+c.width+p.x;if(t<=m)return!0}const h=i[l+1];if(h){const m=i[l];if(m.x+m.width+p.x>=h.x)return!0}return!1}getHorizontalElements(t,e){const n=new Set;return this.getHorizontalConnections(t).forEach(s=>{n.add(s.source),n.add(s.target)}),Array.from(n).filter(s=>e.find(l=>l.id===s))}buildSubTree(t,e,n,i,s,l){this.addTreeElement(s,t.elements[e],i),n.push(e),this.getDirectConnections(t).filter(c=>(l<0?c.target:c.source)===e).map(c=>l<0?c.source:c.target).filter(c=>!n.includes(c)).forEach(c=>{this.buildSubTree(t,c,n,i,s+l,l)})}mergeTrees(t){const e=this.flat(t).map(c=>c.level),n=Math.min(...e),i=Math.max(...e),s=-n;t.forEach(c=>{c.forEach(p=>{p.forEach(h=>{h.levelFixed||(h.level+=s,h.levelFixed=!0)})})});const l=new Array(i-n+1).fill(0).map(()=>[]);return t.forEach(c=>{c.forEach(p=>{p.forEach(h=>{const m=h.level,C=l[m];C.every(y=>y.id!==h.id)&&C.push(h)})})}),l}flat(t){return t.flat(1/0)}addSingleItems(t,e,n){const i=this.flat(n).map(s=>s.id);e.filter(s=>!i.includes(s.id)).forEach(s=>{this.addTreeElement(0,s,n),this.fillTreeLevel(1,s,t,n)})}buildTree(t,e){let n=[];const i=this.getHorizontalElements(t,e);if(i.length>0){const s=[],l=[...i];i.forEach(c=>{let p=!1;const h=[];this.buildSubTree(t,c,l,h,0,-1);const m=this.flat(h);if(m.length>1){const b=Math.min(...m.map(I=>I.level));h.reverse(),h.forEach((I,P)=>{I.forEach(L=>L.level=b+P)}),s.push(h),p=!0}const C=[];this.buildSubTree(t,c,l,C,0,1),(this.flat(C).length>1||!p)&&s.push(C)}),n=this.mergeTrees(s),this.addSingleItems(t,e,n)}else{const s=this.getDirectConnections(t),l=e.filter(c=>s.every(p=>p.target!==c.id));for(const c of l)this.addTreeElement(0,c,n),this.fillTreeLevel(1,c,t,n)}return n}getElements(){const t={};return this.registry.getFlowNodes().forEach(n=>{const i=this.sizeUtils.getElementSize(n);t[n.id]={id:n.id,originalId:n.originalId,type:n.type,parent:n.parent?.id,collapsed:n.collapsed,single:n.single,canRead:n.canRead,...i}}),t}getConnections(){const t={};return this.registry.getFlows().forEach(n=>{const i=n.realTarget||n.target,s=n.realSource||n.source;t[n.id]={id:n.id,originalId:n.originalId,type:n.type,target:i.id,source:s.id,position:n.position}}),t}getDiagramData(){const t={};return t.elements=this.getElements(),t.connections=this.getConnections(),t}fixElementsPosition(t){this.registry.getFlowNodes().forEach(n=>{const i=t.elements[n.id],s={x:i.x-n.x,y:i.y-n.y};(s.x||s.y)&&this.modeling.moveShape(n,s)})}hideConnections(){this.registry.getFlows().forEach(e=>{e.hidden=!0})}updateAllConnections(t){const e=Object.values(t.connections),n=e.filter(s=>!T.isIndirectConnection(s));this.updateConnections(n);const i=e.filter(T.isIndirectConnection);this.updateConnections(i)}updateConnections(t){t.forEach(({id:e,source:n,target:i})=>{const s=this.registry.get(e);let l=this.registry.get(n),c=this.registry.get(i);[l,c]=this.modeling.updateConnectionInfo(s,s.parent,l,c),s.source=l,s.target=c,this.modeling.layoutConnection(s,{}),this.canvas.bringToFrontElement(s);const p=s.labels[0];if(p){const{id:h,caption:m}=p;this.modeling.removeShape(p),this.modeling.createDiagramLabel({id:h,value:{caption:m,parent:e}})}})}calculateElementsPosition(t){const e=Object.values(t.elements).filter(T.isRootItem),n=this.buildTree(t,e);this.fillTreePosition(t,n)}updateElements(){this.hideConnections();const t=this.getDiagramData();this.calculateElementsPosition(t),this.fixElementsPosition(t),this.updateAllConnections(t)}};ft=(0,a.Cg)([(0,a.Qj)(0,d("relationshipSizeUtils")),(0,a.Qj)(1,d("diagramUtils")),(0,a.Qj)(2,d("modeling")),(0,a.Qj)(3,d("elementRegistry")),(0,a.Qj)(4,d("canvas")),(0,a.Qj)(5,d("eventBus")),(0,a.Sn)("design:paramtypes",[q,T,Object,Ne,Object,Object])],ft);class er extends Kt{constructor(){super(...arguments),this.highlightClassName="highlight"}get supportHighlight(){return!0}bringToFront(){}}let oi=class extends Ft{constructor(t,e,n,i,s){super(t,e,n,i),this.eventBus=t,this.overlays=e,this.rules=n,this.canvas=i,this.utils=s,this.oneColumnMode=!0,this.elementDataActionAttributeName="data-action"}canOpen(t){return t.canRead===!1||this.utils.isFlow(t)&&(t.source.canRead===!1||t.target.canRead===!1)?!1:super.canOpen(t)}fixEntries(t){return t}addEntriesContainer(t){const e=super.addEntriesContainer(t);return this.sortContainersEntries(e)}sortContainersEntries(t){return this.getSortedContainersEntries(t).forEach(n=>{t.removeChild(n),t.appendChild(n)}),t}getSortedContainersEntries(t){const e=this.getEntriesOrder(),n=Array.from(t.children);return n.sort((i,s)=>{const l=i.getAttribute(this.elementDataActionAttributeName),c=s.getAttribute(this.elementDataActionAttributeName),p=e.get(l),h=e.get(c);return p>h?1:-1}),n}getEntriesOrder(){const t="add",e="connect",n="delete";return new Map([[t,0],[e,1],[n,2]])}};oi=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("overlays")),(0,a.Qj)(2,d("rules")),(0,a.Qj)(3,d("canvas")),(0,a.Qj)(4,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object])],oi);let ai=class extends se{constructor(t,e,n,i,s,l,c,p,h,m){super(t,e,n,i,s,l,c,p,h),this.eventBus=t,this.elementFactory=e,this.commandStack=n,this.canvas=i,this.registry=s,this.diagramText=l,this.elements=c,this.rules=p,this.diagramUtils=h,this.sizeUtils=m,this.convertUtils=new Ue(h)}getElementAttributes(t,e,n){const i=super.getElementAttributes(t,e,n),{subCaption:s,collapsed:l,groups:c,info:p,expandedWidth:h,expandedHeight:m,hidden:C,originalId:y,hasChildren:b,single:I,canRead:P,position:L}=e;return{...i,subCaption:s,collapsed:l,groups:c,info:p,expandedWidth:h,expandedHeight:m,hidden:C,originalId:y,hasChildren:b,single:I,canRead:P,position:L}}createDiagramElement(t,e){const n=e[t],i=e[n.parent];i&&i.collapsed&&(n.hidden=!0);const{width:s,height:l}=this.sizeUtils.getElementSize(n);n.width=s,n.height=l,super.createDiagramElement(t,e)}removeConnection(t,e={}){super.removeConnection(t);const n=this.getElement(t);this.eventBus.fire("diagram.connection.delete",{element:n},e)}createConnection(t,e,n,i,s,l){if(typeof n=="object"&&(l=s,s=i,i=n,n=void 0),i?.type!==k.parentConnection)return[t,e,s]=this.updateConnectionInfo(i,s,t,e),super.createConnection(t,e,n,i,s,l)}updateConnectionInfo(t,e,n,i){let s;switch(t.hidden=!1,t.type){case k.connection:[n,i].every(T.isRelationshipItem)&&(e=n.parent,e.collapsed&&(t.hidden=!0));break;case k.indirectConnection:if(t.realSource=n,t.realTarget=i,[n,i]=[n,i].map(l=>l.hidden?l.parent:l),s=t.hidden,n.id===i.id?(n=t.realSource,i=t.realTarget,t.hidden=!0):t.hidden=!1,t.hidden!==s&&t.label){const l=this.registry.getGraphics(t.label),c=t.hidden?"none":"block";(0,x.CF)(l,"display",c)}break;default:break}return[n,i,e]}addNewConnection(t){this.eventBus.fire("diagram.connection.adding",t)}getHandlers(){return super.getHandlers()}positionViewboxRelativeToElement(t){const e=this.canvas.viewbox(),n=(0,ve.U7)(t),i={x:Math.round(n.x+n.width/2-e.outer.width/2),y:n.y-130,width:e.outer.width,height:e.outer.height};this.canvas.viewbox(i),this.canvas.zoom(e.scale)}};ai=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("elementFactory")),(0,a.Qj)(2,d("commandStack")),(0,a.Qj)(3,d("canvas")),(0,a.Qj)(4,d("elementRegistry")),(0,a.Qj)(5,d("diagramText")),(0,a.Qj)(6,d("elements")),(0,a.Qj)(7,d("rules")),(0,a.Qj)(8,d("diagramUtils")),(0,a.Qj)(9,d("relationshipSizeUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object,Object,F,Object,T,q])],ai);var tr=v(40969);let ri=class extends tr.A{constructor(t,e,n){super(t,e),this.eventBus=t,this.registry=e,this.selection=n}updateContainments(){}update(t,e,n){super.update(t,e,n),e?.hidden&&this.selection.deselect(e)}};ri=(0,a.Cg)([(0,a.Qj)(0,(0,f.Inject)("eventBus")),(0,a.Qj)(1,(0,f.Inject)("elementRegistry")),(0,a.Qj)(2,(0,f.Inject)("selection")),(0,a.Sn)("design:paramtypes",[Object,Object,Object])],ri);var nr=v(44394),rn=v(78626);let li=class extends nr.A{constructor(t,e,n,i){super(t,e,i),this.elementRegistry=t,this.eventBus=e,this.sizeUtils=n,this.config=i}snapValue(t,e,n=rn.E){let i=0;e&&e.offset&&(i=e.offset),t+=i,t=(0,rn.y)(t,n);let s,l;return e&&e.min&&(s=e.min,(0,O.Et)(s)&&(s=(0,rn.y)(s+i,n,"ceil"),t=Math.max(t,s))),e&&e.max&&(l=e.max,(0,O.Et)(l)&&(l=(0,rn.y)(l+i,n,"floor"),t=Math.min(t,l))),t-=i,t}};li=(0,a.Cg)([(0,a.Qj)(0,(0,f.Inject)("elementRegistry")),(0,a.Qj)(1,(0,f.Inject)("eventBus")),(0,a.Qj)(2,(0,f.Inject)("relationshipSizeUtils")),(0,a.Qj)(3,(0,f.Inject)("config")),(0,a.Sn)("design:paramtypes",[Object,Object,q,Object])],li);let ci=class{constructor(t,e,n){this.eventBus=t,this.canvas=e,this.elementRegistry=n,this.SHOW_GROUPS_CLASS="show-groups",this.FADE_ITEM_CLASS="fade-item",this.subscribeEvents()}subscribeEvents(){this.eventBus.on("selection.changed",this.onSelectionChanged.bind(this)),this.eventBus.on("relationshipGroup.highlight.changed",this.onGroupHighlightChanged.bind(this))}onGroupHighlightChanged(t){const e=t.id;this.clearHighlights(),e&&this.highlightItemsByGroupId(e)}onSelectionChanged(t){this.clearHighlights();const e=t.newSelection;if(e.length===1){const n=e[0];T.isRelationshipItem(n)&&n.groups?.length&&this.showGroupsByItem(n)}}removeMarkers(t){this.canvas.removeMarker(t,this.SHOW_GROUPS_CLASS),this.canvas.removeMarker(t,this.FADE_ITEM_CLASS)}showGroupsByItem(t){const e=t.groups,n=this.getAllItems(),i=this.getGroupIds(e);n.forEach(s=>{this.getGroupIds(s.groups).some(p=>i.includes(p))?this.showItemGroups(s):this.fadeItem(s)})}getAllItems(){return this.elementRegistry.filter(t=>T.isRelationshipItem(t))}getGroupIds(t){return t.map(e=>e.id)}showItemGroups(t){this.addMarker(t,this.SHOW_GROUPS_CLASS)}addMarker(t,e){this.canvas.addMarker(t,e)}fadeItem(t){this.addMarker(t,this.FADE_ITEM_CLASS)}clearHighlights(){this.getAllItems().forEach(t=>{this.removeMarkers(t)})}highlightItemsByGroupId(t){this.getAllItems().forEach(n=>{n.groups.some(s=>t===s.id)?this.showItemGroups(n):this.fadeItem(n)})}};ci=(0,a.Cg)([(0,a.Qj)(0,(0,f.Inject)("eventBus")),(0,a.Qj)(1,(0,f.Inject)("canvas")),(0,a.Qj)(2,(0,f.Inject)("elementRegistry")),(0,a.Sn)("design:paramtypes",[Object,Object,Object])],ci);let di=class extends ht{constructor(t,e,n,i,s){super(t,s),this.connectionDocking=t,this.elements=e,this.registry=n,this.sizeUtils=i,this.config=s}getRelationItemConnectPoint(t,e){const n=this.elements.getConfig(t),i=T.isIndirectConnection(e)||t.collapsed===!1,s=i?t.width:n.imageWidth,l=i?t.height:n.imageHeight;return{x:t.x+s/2,y:t.y+l/2}}getLines(t){const e=[];for(let n=0;n<t.length-1;n++){const i=t[n],s=t[n+1],l=i.x<=s.x&&i.y<=s.y?{first:{x:i.x,y:i.y},second:{x:s.x,y:s.y}}:{first:{x:s.x,y:s.y},second:{x:i.x,y:i.y}};e.push(l)}return e}intersect(t,e,n,i,s,l,c,p){const h=Math.max(t,s),m=Math.min(i,p),C=Math.min(n,c),y=Math.max(e,l),b=C-h,I=m-y;return b<=0||I<=0?0:b*I}intersectElements(t,e){const i=this.getLines(t);for(const s of i)for(const l of e){const{width:c,height:p}=this.elements.getConfig(l),h=s.first.x,m=s.first.y,C=s.second.x+.01,y=s.second.y+.01,b=l.x+2,I=l.y+2,P=l.x+c-2,L=l.y+p-2;if(this.intersect(h,m,C,y,b,I,P,L))return!0}return!1}samePoint(t,e){return t.x===e.x&&t.y===e.y}similarLines(t,e){const n=this.getLines(t);for(const i of e){const s=this.getLines(i.waypoints);if(JSON.stringify(n)===JSON.stringify(s)||(s.reverse(),JSON.stringify(n)===JSON.stringify(s)))return!0}return!1}intersectPoints(t,e){const n=this.getLines(t);for(const i of n)for(const s of e){const l=this.getLines(s.waypoints);for(const c of l)if(this.samePoint(i.first,c.first)||this.samePoint(i.first,c.second)||this.samePoint(i.second,c.first)||this.samePoint(i.second,c.second))return!0}return!1}buildWaypoints(t,e,n,i,s,l){const c=pt.Z9(e,n,i,s,l),p=Object.assign(t);return p.waypoints=pt.d7(c),this.connectionDocking.getCroppedWaypoints(p,e,n)}getLayouts(t=!1){return[...t?["v:v","h:h"]:["h:h","v:v"],"h:v","v:h","b:b","t:t","l:l","r:r","l:t","l:r","l:b","t:l","t:r","t:b","r:l","r:t","r:b","b:l","b:t","b:r"]}indirectConnectionLayouts(){return this.getLayouts()}horizontalConnectionLayouts(){return this.getLayouts()}directConnectionLayouts(){return this.getLayouts(!0)}buildSmartConnection(t,e,n,i,s,l,c,p){let h;const m=this.registry.getFlowNodes().filter(P=>P.hidden!==!0),C=this.registry.getFlows().filter(P=>P.hidden!==!0&&P.id!==t.id);let y=0;const b=[];l.preferredLayouts=[""],h=this.buildWaypoints(t,e,n,i,s,l),b.push({waypoints:h,weight:0});do{const P=c[y];l.preferredLayouts=[P],h=this.buildWaypoints(t,e,n,i,s,l);const L=this.intersectElements(h,m);let G=!1,J=!1;if(!L&&(G=this.similarLines(h,C),!G&&(!p||(J=this.intersectPoints(h,C),!J))))break;const z=+!L+ +!G+ +!J;b.push({waypoints:h,weight:z,layout:P}),y++}while(y<c.length);return y===c.length&&(b.length===1?h=b[0].waypoints:(b.sort((P,L)=>P.weight-L.weight),h=b.slice(-1)[0].waypoints)),h}buildConnection(t,e,n,i,s,l){return this.buildWaypoints(t,e,n,i,s,l)}layoutConnection(t,e={}){const n=e.source||t.source,i=e.target||t.target,s=n&&this.getRelationItemConnectPoint(n,t),l=i&&this.getRelationItemConnectPoint(i,t);let c,p=!0;switch(!0){case T.isIndirectConnection(t):c=this.indirectConnectionLayouts();break;case T.isHorizontalConnection(t):c=this.horizontalConnectionLayouts();break;default:p=!1,c=this.directConnectionLayouts();break}return this.buildSmartConnection(t,n,i,s,l,e,c,p)}};di=(0,a.Cg)([(0,a.Qj)(0,d("connectionDocking")),(0,a.Qj)(1,d("elements")),(0,a.Qj)(2,d("elementRegistry")),(0,a.Qj)(3,d("relationshipSizeUtils")),(0,a.Qj)(4,d("config")),(0,a.Sn)("design:paramtypes",[Object,F,Ne,q,Object])],di);var ir=v(79950);let gi=class extends dt{constructor(t,e,n,i,s,l,c,p,h,m){super(t,e,n,i,m),this.elementRegistry=t,this.diagramModeling=e,this.elements=n,this.eventBus=i,this.sizeUtils=s,this.canvas=l,this.localStorage=c,this.zoomScroll=p,this.builder=h}fixData(t){t.elements=t.elements||{},t.connections=t.connections||{},t.labels=t.labels||{},t.groups=t.groups||{}}fixIds(t){["elements","connections","labels","groups"].forEach(e=>{let n=t[e]||{};n instanceof Array&&(n=t[e]=ir.A.keyBy(n,"id")),Object.keys(n).forEach(i=>{n[i].id!==i&&(n[i].id=i)})})}fixConnectionsDefaults(t){Object.values(t.connections).forEach(e=>{e.type=e.type??k.connection,e.position=e.relationshipType?.position??-1})}formatUniqId(...t){return t.join("_")}fixParents(t){const{elements:e,connections:n,labels:i}=t,s=[],l=[],c=[],p=[];Object.values(n).forEach(z=>{const tt=e[z.source],wt=e[z.target];switch(z.originalId=z.id,z.type){case k.connection:T.isRelationshipContainer(tt)||T.isRelationshipContainer(wt)?s.push(z):l.push(z);break;case k.parentConnection:c.push(z);break;default:p.push(z)}});const h=this.fixItems(c,e),m=this.fixSingleItems(e,n),y=[...this.fixContainers(h,e),...h,...m],b=this.fixItemsConnections(l,h),I=this.fixItemsConnections(l,m),P=this.fixConnections(p,y),L=this.fixConnections(c,y),G=[...s,...b,...I,...L,...P];this.sortConnectionsOrder(G);const J=this.fixLabels(i,G);t.elements={},t.connections={},t.labels={},y.forEach(z=>t.elements[z.id]=z),G.forEach(z=>t.connections[z.id]=z),J.forEach(z=>t.labels[z.id]=z)}sortConnectionsOrder(t){t.sort((e,n)=>this.getConnectionOrder(e)-this.getConnectionOrder(n))}getConnectionOrder(t){let e;return T.isIndirectConnection(t)?e=3:T.isHorizontalConnection(t)?e=1:e=2,e}fixSingleItemIncludeIntoContainer(t,e){const n=Object.values(t).filter(T.isRelationshipItem),i=Object.values(e);return n.forEach(s=>{const c=i.filter(p=>s.id===p.target).every(p=>!(p.relationshipType?.includeIntoContainer??!0));s.single=c}),n.filter(s=>s.single)}fixContainers(t,e){const n=Object.values(e).filter(T.isRelationshipContainer);return n.forEach(i=>{i.originalId=i.id,i.hasChildren=t.some(s=>s.parent===i.id)}),n}fixItems(t,e){const n=[];return Array.from(new Set(t.map(s=>s.target))).forEach(s=>{t.filter(c=>c.target===s).forEach(({source:c})=>{const p=Object.assign({},e[s],{id:this.formatUniqId(s,c),originalId:s,parent:c});n.push(p)})}),n}fixSingleItems(t,e){return this.fixSingleItemIncludeIntoContainer(t,e),this.fixSingleItemOriginal(t)}fixSingleItemOriginal(t){const n=Object.values(t).filter(T.isRelationshipItem).filter(i=>i.single);return n.forEach(i=>{i.originalId=i.id}),n}fixItemsConnections(t,e){const n=[];return t.forEach(i=>{const{id:s,source:l,target:c,position:p}=i;e.filter(m=>m.originalId===l).forEach(m=>{const C=m.parent,y=e.find(b=>b.originalId===c&&b.parent===C);if(y){const b=Object.assign({},i,{id:this.formatUniqId(s,C),originalId:s,source:m.id,target:y.id,position:p});n.push(b)}})}),n}fixConnections(t,e){const n=[];return t.forEach(i=>{const{id:s,source:l,target:c,position:p}=i;e.filter(m=>m.originalId===l).forEach(m=>{e.filter(y=>y.originalId===c).forEach(y=>{const b=Object.assign({},i,{id:this.formatUniqId(s,m.id,y.id),originalId:s,source:m.id,target:y.id,position:p});n.push(b)})})}),n}fixLabels(t,e){const n=[];return Object.values(t).forEach(i=>{e.filter(l=>l.originalId===i.parent).forEach(l=>{const c=Object.assign({},i,{id:this.formatUniqId(i.id,l.id),originalId:i.id,parent:l.id});n.push(c)})}),n}mapGroupInfo(t){Object.values(t.elements).filter(e=>T.isRelationshipItem(e)).forEach(e=>{const i=(e.groups||[]).map(s=>{const l=typeof s=="object",c=l?s.id:s,p=l?s.comment:null;return{id:c,itemComment:p}});e.groups=i.map(s=>Object.assign({itemComment:s.itemComment},t.groups[s.id]))})}setContainersCollapsed(t){const e=Object.values(t.elements);e.filter(n=>T.isRelationshipContainer(n)).forEach(n=>{const i=e.filter(s=>s.parent===n.id);t.rootElementId&&i.some(s=>s.recordId===t.rootElementId)?n.collapsed=!1:n.collapsed=n.collapsed??!0})}getConnectionAttributes(t,e){return{...super.getConnectionAttributes(t,e),realSource:e.realSource,realTarget:e.realTarget,position:e.position}}load(t,e,n){var i=()=>super.load,s=this;return(0,D.A)(function*(){return s.fixData(t),s.fixIds(t),s.fixConnectionsDefaults(t),s.fixParents(t),s.mapGroupInfo(t),s.setContainersCollapsed(t),s.sizeUtils.loadContainersState(t),s.builder.calculateElementsPosition(t),i().call(s,t,e,n)})()}};gi=(0,a.Cg)([(0,a.Qj)(0,d("elementRegistry")),(0,a.Qj)(1,d("modeling")),(0,a.Qj)(2,d("elements")),(0,a.Qj)(3,d("eventBus")),(0,a.Qj)(4,d("relationshipSizeUtils")),(0,a.Qj)(5,d("canvas")),(0,a.Qj)(6,d("localStorage")),(0,a.Qj)(7,d("zoomScroll")),(0,a.Qj)(8,d("builder")),(0,a.Sn)("design:paramtypes",[Object,se,F,Object,q,Object,Ht,Object,ft,f.LoggerService])],gi);var sr=v(6587);class or extends sr.A{}const ln={Connection:{PathStrokeWidth:1,MarkerFillColor:"#4E7BD8",MarkerStrokeColor:"#4E7BD8",StrokeColor:"#4E7BD8"}}.Connection;class pi extends He{updateDataItemMarker(t,e,n){const i=n.source,s=n.target;if(i&&s){const l=i.id+"_"+s.id,c=t.elementRegistry.getGraphics(n);(0,x.CF)(c,"data-item-marker",l)}}get endMarker(){const t=(0,x.vt)("path");return(0,x.CF)(t,{d:ce.Connection.MarkerShape,"fill-opacity":ce.Connection.MarkerfillOpacity,fill:ln.MarkerFillColor,stroke:ln.MarkerStrokeColor,strokeLinejoin:ce.Connection.StrokeLinejoin,strokeWidth:ce.Connection.StrokeWidth,class:kt.ConnectionEndMarker}),t}getConnectionAttributes(t){const e=super.getConnectionAttributes(t);return Object.assign(e,{stroke:ln.StrokeColor,strokeWidth:ln.PathStrokeWidth})}drawConnection(t,e,n){const i=super.drawConnection(t,e,n);return this.updateDataItemMarker(t,e,n),i}}class ar extends pi{startMarker(){return this.endMarker}}class rr extends pi{getConnectionAttributes(t){const e=super.getConnectionAttributes(t);return Object.assign(e,{strokeDasharray:"8 8"})}}class Rs{drawConnection(t,e,n){}}(0,a.Cg)([H(cr,pi),H(lr,rr),H(dr,ar),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object,Object,Object]),(0,a.Sn)("design:returntype",Object)],Rs.prototype,"drawConnection",null);function lr(r,t,e){return T.isIndirectConnection(e)}function cr(r,t,e){return zs(e)&&e.position!==0}function dr(r,t,e){return zs(e)&&e.position===0}function zs(r){return r.type===k.connection}class _s extends Ve{drawConnection(t,e){return super.drawConnection(t,e)}}(0,a.Cg)([ke(Rs,fe.instead),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object,Object]),(0,a.Sn)("design:returntype",void 0)],_s.prototype,"drawConnection",null);var Ns;let cn=class extends ue{constructor(t,e,n,i,s,l){super(t,e,n,l),this.elements=t,this.styles=e,this.diagramText=n,this.sizeUtils=i,this.elementRegistry=s,this.eventBus=l,this._borderRadius=8}drawItemBackground(t,e){const n=this.elements.getConfig(e),i=T.isRoot(e.parent)?n.fill:n.fillInParent,{width:s,height:l}=this.sizeUtils.getElementSize(e);this.drawRect(t,s,l,this._borderRadius,0,{fill:i,stroke:"none"})}drawImage(t,e){const n=this.elements.getConfig(e),i=this.styles.style({height:n.imageHeight,width:n.imageWidth,rx:this._borderRadius,ry:this._borderRadius}),s=(0,x.vt)("image",i),l=e.canRead===!1?n.largeImageNoAccess:e.largeImage||n.largeImage;return s.setAttributeNS("http://www.w3.org/1999/xlink","href",l),s.setAttributeNS(null,"type",n.type),s.setAttributeNS(null,"preserveAspectRatio","xMidYMid meet"),(0,x.BC)(t,s),s}drawImageBorder(t,e){const n=this.elements.getConfig(e),i=n.height,{imageWidth:s=i,imageHeight:l=i}=n;this.drawRect(t,s,l,this._borderRadius,0,{fill:"none",stroke:n.stroke})}drawText(t,e){const n=this.elements.getConfig(e),i=10,s=10,l=10,c=20,p=90,h=e.subCaption;if(h){const y={box:{height:c,width:n.width-n.imageWidth-s},className:"sub-caption"},b=this.createText(t,h,y);(0,de.pd)(b,n.imageWidth+i,l,0)}const m=e.canRead===!1?n.captionNoAccess:e.caption||"#"+e.id;if(m){const y={box:{height:c,width:n.width-n.imageWidth-s},className:"caption"},b=this.createText(t,m,y);(0,de.pd)(b,n.imageWidth+i,30,0)}const C=e.canRead===!1?"":e.info;if(C){const b=(e.collapsed&&e.expandedWidth?e.expandedWidth:e.width)-n.width+p,I=e.collapsed?p:b,P={box:{height:c,width:I},className:"info"},L=this.createText(t,C,P);(0,de.pd)(L,n.width-p-s,l,0)}}drawItemBorder(t,e){const n=this.elements.getConfig(e),{width:i,height:s}=this.sizeUtils.getElementSize(e);this.drawRect(t,i,s,this._borderRadius,0,{fill:"none",stroke:n.stroke})}updateDataItemMarker(t){const e=t.caption;if(e){const n=this.elementRegistry.getGraphics(t);(0,x.CF)(n,"data-item-marker",e)}}getLockImage(){return"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmEsLmJ7ZmlsbDpub25lO30uYntzdHJva2U6IzU0NjU3ZDtzdHJva2UtbWl0ZXJsaW1pdDoxMDt9LmN7c3Ryb2tlOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiLz48cmVjdCBjbGFzcz0iYiIgd2lkdGg9IjExIiBoZWlnaHQ9IjkiIHJ4PSIyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyLjUgNS41KSIvPjxnIGNsYXNzPSJiIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3IDkpIj48cmVjdCBjbGFzcz0iYyIgd2lkdGg9IjIiIGhlaWdodD0iMiIvPjxyZWN0IGNsYXNzPSJhIiB4PSIwLjUiIHk9IjAuNSIgd2lkdGg9IjEiIGhlaWdodD0iMSIvPjwvZz48cGF0aCBjbGFzcz0iYiIgZD0iTS0yNzguNTgxLDM3OC4yNjR2LTIuNWExLjUsMS41LDAsMCwxLDEuNS0xLjVoMmExLjUsMS41LDAsMCwxLDEuNSwxLjV2Mi41IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyODQuMDgxIC0zNzIuNzY0KSIvPjwvc3ZnPg=="}drawLockImage(t,e){const l=this.elements.getConfig(e),c=this.styles.style({height:16,width:16,class:"lock-image"}),p=(0,x.vt)("image",c);p.setAttributeNS("http://www.w3.org/1999/xlink","href",this.getLockImage()),p.setAttributeNS(null,"type",l.type),p.setAttributeNS(null,"preserveAspectRatio","none"),(0,x.BC)(t,p);const h=l.width-16-26,m=l.height-16-13;(0,de.pd)(p,h,m,0)}draw(t,e){super.draw(t,e),this.drawItemBackground(t,e);const n=this.drawImage(t,e);return this.drawImageBorder(t,e),this.drawText(t,e),this.drawItemBorder(t,e),this.updateDataItemMarker(e),e.canRead===!1&&((t.parentElement||t.parentNode).classList.add("no-access"),this.drawLockImage(t,e)),n}};cn=(0,a.Cg)([(0,a.Qj)(0,d("elements")),(0,a.Qj)(1,d("styles")),(0,a.Qj)(2,d("diagramText")),(0,a.Qj)(3,d("relationshipSizeUtils")),(0,a.Qj)(4,d("elementRegistry")),(0,a.Qj)(5,d("eventBus")),(0,a.Sn)("design:paramtypes",[F,typeof(Ns=typeof he.A<"u"&&he.A)=="function"?Ns:Object,Object,q,rt,Object])],cn);let hi=class extends We{constructor(t,e,n){super(t,e),this.renderingLabel=t,this.renderingShape=e,this.relationshipRenderingItem=n}create(t){return T.isFlowNode({type:t})?this.relationshipRenderingItem:super.create(t)}};hi=(0,a.Cg)([(0,a.Qj)(0,d("renderingLabel")),(0,a.Qj)(1,d("renderingShape")),(0,a.Qj)(2,d("relationshipRenderingItem")),(0,a.Sn)("design:paramtypes",[Object,Object,cn])],hi);var ui=v(29086);let mi=class extends ui.A{constructor(t,e,n,i,s){super(t),this.eventBus=t,this.modeling=e,this.sizeUtils=n,this.builder=i,this.registry=s,this.subscribeEvents()}subscribeEvents(){this.postExecuted(["shape.toggleCollapse"],B.LOW,t=>{this.sizeUtils.saveContainersState();const e=t.context.shape;this.resizeContainer(e)})}resizeContainer(t){const{width:e,height:n}=this.sizeUtils.getElementSize(t),{x:i,y:s}=t,l={x:i,y:s,width:e,height:n};if(this.modeling.resizeShape(t,l,null,{autoResize:!0}),this.builder.updateElements(),t.collapsed){const c=this.registry.getGraphics(t);this.eventBus.fire("element.out",{gfx:c,element:t})}}};mi=(0,a.Cg)([(0,a.Qj)(0,(0,f.Inject)("eventBus")),(0,a.Qj)(1,(0,f.Inject)("modeling")),(0,a.Qj)(2,(0,f.Inject)("relationshipSizeUtils")),(0,a.Qj)(3,(0,f.Inject)("builder")),(0,a.Qj)(4,(0,f.Inject)("elementRegistry")),(0,a.Sn)("design:paramtypes",[Object,Object,q,ft,Ne])],mi);const vi={..._e,diagramRules:["type",vt],renderingShapeFactory:["type",hi],relationshipRenderingItem:["type",cn],relationshipRenderingGroup:["type",on],outlineFactory:["type",sn],layouter:["type",di],outline:["type",ni],selection:["type",or],diagramRenderer:["type",_s],diagramUtils:["type",T],modeling:["type",ai],diagramLoader:["type",gi],contextPadProvider:["type",ti],relationshipGroupHighlight:["type",ci],relationshipToggleTools:["type",an],relationshipToggleHandler:["type",mi],relationshipSizeUtils:["type",q],elementToolsConfig:["type",nn],builder:["type",ft],addMenuProvider:["type",si],connectionHighlight:["type",er],contextPad:["type",oi],graphicsFactory:["type",ri],elementRegistry:["type",Ne],gridSnapping:["type",li]};vi.__depends__=[..._e.__depends__],vi.__init__=[..._e.__init__,"relationshipGroupHighlight","relationshipToggleHandler","relationshipSizeUtils","builder","addMenuProvider","gridSnapping"];const Bs=vi;var g=function(r){return r.textAnnotation="textAnnotation",r.conditionalConnection="conditionalConnection",r.connection="connection",r.associationOneWay="associationOneWay",r.associationTwoWay="associationTwoWay",r.defaultConnection="defaultConnection",r.association="association",r.dataObjectReference="dataObjectReference",r.dataInput="dataInput",r.dataOutput="dataOutput",r.dataStoreReference="dataStoreReference",r.lane="lane",r.laneSet="laneSet",r.label="label",r.exclusiveGateway="exclusiveGateway",r.parallelGateway="parallelGateway",r.inclusiveGateway="inclusiveGateway",r.eventBasedGateway="eventBasedGateway",r.exclusiveEventBasedGateway="exclusiveEventBasedGateway",r.complexGateway="complexGateway",r.startEvent="startEvent",r.startEventMessage="startEventMessage",r.startEventTimer="startEventTimer",r.startEventConditional="startEventConditional",r.startEventSignal="startEventSignal",r.startEventMultiple="startEventMultiple",r.startEventParallel="startEventParallel",r.startEventEscalation="startEventEscalation",r.startEventError="startEventError",r.startEventCompensation="startEventCompensation",r.startEventMessageNonInterrupting="startEventMessageNonInterrupting",r.startEventTimerNonInterrupting="startEventTimerNonInterrupting",r.startEventEscalationNonInterrupting="startEventEscalationNonInterrupting",r.startEventSignalNonInterrupting="startEventSignalNonInterrupting",r.startEventMultipleNonInterrupting="startEventMultipleNonInterrupting",r.startEventParallelNonInterrupting="startEventParallelNonInterrupting",r.startEventConditionalNonInterrupting="startEventConditionalNonInterrupting",r.boundaryInterruptingEventMessage="boundaryInterruptingEventMessage",r.boundaryInterruptingEventTimer="boundaryInterruptingEventTimer",r.boundaryInterruptingEventError="boundaryInterruptingEventError",r.boundaryInterruptingEventEscalation="boundaryInterruptingEventEscalation",r.boundaryInterruptingEventCompensation="boundaryInterruptingEventCompensation",r.boundaryInterruptingEventConditional="boundaryInterruptingEventConditional",r.boundaryInterruptingEventSignal="boundaryInterruptingEventSignal",r.boundaryInterruptingEventMultiple="boundaryInterruptingEventMultiple",r.boundaryInterruptingEventParallel="boundaryInterruptingEventParallel",r.boundaryNonInterruptingEventMessage="boundaryNonInterruptingEventMessage",r.boundaryNonInterruptingEventTimer="boundaryNonInterruptingEventTimer",r.boundaryNonInterruptingEventEscalation="boundaryNonInterruptingEventEscalation",r.boundaryNonInterruptingEventConditional="boundaryNonInterruptingEventConditional",r.boundaryNonInterruptingEventSignal="boundaryNonInterruptingEventSignal",r.boundaryNonInterruptingEventMultiple="boundaryNonInterruptingEventMultiple",r.boundaryNonInterruptingEventParallel="boundaryNonInterruptingEventParallel",r.intermediateThrowEvent="intermediateThrowEvent",r.intermediateThrowEventMessage="intermediateThrowEventMessage",r.intermediateThrowEventEscalation="intermediateThrowEventEscalation",r.intermediateThrowEventCompensate="intermediateThrowEventCompensate",r.intermediateThrowEventLink="intermediateThrowEventLink",r.intermediateThrowEventSignal="intermediateThrowEventSignal",r.intermediateThrowEventMultiple="intermediateThrowEventMultiple",r.intermediateCatchEvent="intermediateCatchEvent",r.intermediateCatchEventMessage="intermediateCatchEventMessage",r.intermediateCatchEventTimer="intermediateCatchEventTimer",r.intermediateCatchEventConditional="intermediateCatchEventConditional",r.intermediateCatchEventLink="intermediateCatchEventLink",r.intermediateCatchEventSignal="intermediateCatchEventSignal",r.intermediateCatchEventMultiple="intermediateCatchEventMultiple",r.intermediateCatchEventParallel="intermediateCatchEventParallel",r.endEvent="endEvent",r.endEventMessage="endEventMessage",r.endEventEscalation="endEventEscalation",r.endEventError="endEventError",r.endEventCompensate="endEventCompensate",r.endEventSignal="endEventSignal",r.endEventTerminate="endEventTerminate",r.endEventMultiple="endEventMultiple",r.endEventCancel="endEventCancel",r.markerAdHoc="AdHoc",r.markerCollapsed="Collapsed",r.markerCompensation="Compensation",r.markerLoop="Loop",r.markerParallelMultiInstance="ParallelMultiInstance",r.markerSequenceMultiInstance="SequenceMultiInstance",r.root="root",r.subProcessCollapsed="subProcessCollapsed",r.task="task",r.userTask="userTask",r.manualTask="manualTask",r.businessRuleTask="businessRuleTask",r.serviceTask="serviceTask",r.scriptTask="scriptTask",r.receiveTask="receiveTask",r.sendTask="sendTask",r.callActivity="callActivity",r.subProcessExpanded="subProcessExpanded",r.eventSubProcessExpanded="eventSubProcessExpanded",r}(g||{});const gr={textAnnotation:{height:36,type:g.textAnnotation,propertiesImage:"assets/images/AnnotateProperties.svg",width:160,label:{editStyle:{textAlign:"left",lineHeight:1.41667,fitBox:!0,overflowWrap:"break-word"},editClassList:["djs-direct-editing-parent-no-border"],style:{align:"left",fitBox:!0,overflowWrap:"break-word",padding:10},padding:{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}}}};var S=function(r){return r.cancelEventDefinition="cancelEventDefinition",r.compensateEventDefinition="compensateEventDefinition",r.conditionalEventDefinition="conditionalEventDefinition",r.errorEventDefinition="errorEventDefinition",r.escalationEventDefinition="escalationEventDefinition",r.linkEventDefinition="linkEventDefinition",r.messageEventDefinition="messageEventDefinition",r.signalEventDefinition="signalEventDefinition",r.terminateEventDefinition="terminateEventDefinition",r.timerEventDefinition="timerEventDefinition",r}(S||{});(0,f.ngxTranslateExtract)("diagram.boundaryEvents.boundaryInterruptingEventMessage"),(0,f.ngxTranslateExtract)("diagram.boundaryEvents.boundaryInterruptingEventTimer"),(0,f.ngxTranslateExtract)("diagram.boundaryEvents.boundaryInterruptingEventError"),(0,f.ngxTranslateExtract)("diagram.boundaryEvents.boundaryInterruptingEventEscalation"),(0,f.ngxTranslateExtract)("diagram.boundaryEvents.boundaryInterruptingEventCompensation"),(0,f.ngxTranslateExtract)("diagram.boundaryEvents.boundaryInterruptingEventConditional"),(0,f.ngxTranslateExtract)("diagram.boundaryEvents.boundaryInterruptingEventSignal"),(0,f.ngxTranslateExtract)("diagram.boundaryEvents.boundaryInterruptingEventMultiple"),(0,f.ngxTranslateExtract)("diagram.boundaryEvents.boundaryInterruptingEventParallel"),(0,f.ngxTranslateExtract)("diagram.boundaryEvents.boundaryNonInterruptingEventMessage"),(0,f.ngxTranslateExtract)("diagram.boundaryEvents.boundaryNonInterruptingEventTimer"),(0,f.ngxTranslateExtract)("diagram.boundaryEvents.boundaryNonInterruptingEventEscalation"),(0,f.ngxTranslateExtract)("diagram.boundaryEvents.boundaryNonInterruptingEventConditional"),(0,f.ngxTranslateExtract)("diagram.boundaryEvents.boundaryNonInterruptingEventSignal"),(0,f.ngxTranslateExtract)("diagram.boundaryEvents.boundaryNonInterruptingEventMultiple"),(0,f.ngxTranslateExtract)("diagram.boundaryEvents.boundaryNonInterruptingEventParallel");const pr={boundaryInterruptingEventMessage:{caption:"boundaryEvents.boundaryInterruptingEventMessage",height:31,largeImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventMessageLarge.svg",smallImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventMessageSmall.svg",propertiesImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventMessageProperties.svg",type:g.boundaryInterruptingEventMessage,width:31,eventDefinition:[S.messageEventDefinition],eventAttributes:{cancelActivity:!0}},boundaryInterruptingEventTimer:{caption:"boundaryEvents.boundaryInterruptingEventTimer",height:31,largeImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventTimerLarge.svg",smallImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventTimerSmall.svg",propertiesImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventTimerProperties.svg",type:g.boundaryInterruptingEventTimer,width:31,eventDefinition:[S.timerEventDefinition],eventAttributes:{cancelActivity:!0}},boundaryInterruptingEventError:{caption:"boundaryEvents.boundaryInterruptingEventError",height:31,largeImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventErrorLarge.svg",smallImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventErrorSmall.svg",propertiesImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventErrorProperties.svg",type:g.boundaryInterruptingEventError,width:31,eventDefinition:[S.errorEventDefinition],eventAttributes:{cancelActivity:!0}},boundaryInterruptingEventEscalation:{caption:"boundaryEvents.boundaryInterruptingEventEscalation",height:31,largeImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventEscalationLarge.svg",smallImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventEscalationSmall.svg",propertiesImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventEscalationProperties.svg",type:g.boundaryInterruptingEventEscalation,width:31,eventDefinition:[S.escalationEventDefinition],eventAttributes:{cancelActivity:!0}},boundaryInterruptingEventCompensation:{caption:"boundaryEvents.boundaryInterruptingEventCompensation",height:31,largeImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventCompensationLarge.svg",smallImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventCompensationSmall.svg",propertiesImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventCompensationProperties.svg",type:g.boundaryInterruptingEventCompensation,width:31,eventDefinition:[S.compensateEventDefinition],eventAttributes:{cancelActivity:!0}},boundaryInterruptingEventConditional:{caption:"boundaryEvents.boundaryInterruptingEventConditional",height:31,largeImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventConditionalLarge.svg",smallImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventConditionalSmall.svg",propertiesImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventConditionalPropeties.svg",type:g.boundaryInterruptingEventConditional,width:31,eventDefinition:[S.conditionalEventDefinition],eventAttributes:{cancelActivity:!0}},boundaryInterruptingEventSignal:{caption:"boundaryEvents.boundaryInterruptingEventSignal",height:31,largeImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventSignalLarge.svg",smallImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventSignalSmall.svg",propertiesImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventSignalProperties.svg",type:g.boundaryInterruptingEventSignal,width:31,eventDefinition:[S.signalEventDefinition],eventAttributes:{cancelActivity:!0}},boundaryInterruptingEventMultiple:{caption:"boundaryEvents.boundaryInterruptingEventMultiple",height:31,largeImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventMultipleLarge.svg",smallImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventMultipleSmall.svg",propertiesImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventMultipleProperties.svg",type:g.boundaryInterruptingEventMultiple,width:31,eventDefinition:[S.cancelEventDefinition,S.terminateEventDefinition],eventAttributes:{cancelActivity:!0,parallelMultiple:!1}},boundaryInterruptingEventParallel:{caption:"boundaryEvents.boundaryInterruptingEventParallel",height:31,largeImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventParallelLarge.svg",smallImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventParallelSmall.svg",propertiesImage:"assets/images/BoundaryEvent/BoundaryInterruptingEventParallelProperties.svg",type:g.boundaryInterruptingEventParallel,width:31,eventDefinition:[S.cancelEventDefinition,S.terminateEventDefinition],eventAttributes:{cancelActivity:!0,parallelMultiple:!0}},boundaryNonInterruptingEventMessage:{caption:"boundaryEvents.boundaryNonInterruptingEventMessage",height:31,largeImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventMessageLarge.svg",smallImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventMessageSmall.svg",propertiesImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventMessageProperties.svg",type:g.boundaryNonInterruptingEventMessage,width:31,eventDefinition:[S.messageEventDefinition],eventAttributes:{cancelActivity:!1}},boundaryNonInterruptingEventTimer:{caption:"boundaryEvents.boundaryNonInterruptingEventTimer",height:31,largeImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventTimerLarge.svg",smallImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventTimerSmall.svg",propertiesImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventTimerProperties.svg",type:g.boundaryNonInterruptingEventTimer,width:31,eventDefinition:[S.timerEventDefinition],eventAttributes:{cancelActivity:!1}},boundaryNonInterruptingEventEscalation:{caption:"boundaryEvents.boundaryNonInterruptingEventEscalation",height:31,largeImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventEscalationLarge.svg",smallImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventEscalationSmall.svg",propertiesImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventEscalationProperties.svg",type:g.boundaryNonInterruptingEventEscalation,width:31,eventDefinition:[S.escalationEventDefinition],eventAttributes:{cancelActivity:!1}},boundaryNonInterruptingEventConditional:{caption:"boundaryEvents.boundaryNonInterruptingEventConditional",height:31,largeImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventConditionalLarge.svg",smallImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventConditionalSmall.svg",propertiesImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventConditionalProperties.svg",type:g.boundaryNonInterruptingEventConditional,width:31,eventDefinition:[S.conditionalEventDefinition],eventAttributes:{cancelActivity:!1}},boundaryNonInterruptingEventSignal:{caption:"boundaryEvents.boundaryNonInterruptingEventSignal",height:31,largeImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventSignalLarge.svg",smallImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventSignalSmall.svg",propertiesImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventSignalProperties.svg",type:g.boundaryNonInterruptingEventSignal,width:31,eventDefinition:[S.signalEventDefinition],eventAttributes:{cancelActivity:!1}},boundaryNonInterruptingEventMultiple:{caption:"boundaryEvents.boundaryNonInterruptingEventMultiple",height:31,largeImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventMultipleLarge.svg",smallImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventMultipleSmall.svg",propertiesImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventMultipleProperties.svg",type:g.boundaryNonInterruptingEventMultiple,width:31,eventDefinition:[S.cancelEventDefinition,S.terminateEventDefinition],eventAttributes:{cancelActivity:!1,parallelMultiple:!1}},boundaryNonInterruptingEventParallel:{caption:"boundaryEvents.boundaryNonInterruptingEventParallel",height:31,largeImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventParallelLarge.svg",smallImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventParallelSmall.svg",propertiesImage:"assets/images/BoundaryEvent/BoundaryNonInterruptingEventParallelProperties.svg",type:g.boundaryNonInterruptingEventParallel,width:31,eventDefinition:[S.cancelEventDefinition,S.terminateEventDefinition],eventAttributes:{cancelActivity:!1,parallelMultiple:!0}}};(0,f.ngxTranslateExtract)("diagram.dataObjects.dataObjectReference"),(0,f.ngxTranslateExtract)("diagram.dataObjects.dataInput"),(0,f.ngxTranslateExtract)("diagram.dataObjects.dataOutput"),(0,f.ngxTranslateExtract)("diagram.dataObjects.dataStoreReference");const hr={dataObjectReference:{caption:"dataObjects.dataObjectReference",largeImage:"assets/images/DataObjects/DataObject.svg",smallImage:"assets/images/DataObjects/DataObjectSmall.svg",propertiesImage:"assets/images/DataObjects/DataObjectProperties.svg",type:g.dataObjectReference,width:31,height:41},dataInput:{caption:"dataObjects.dataInput",largeImage:"assets/images/DataObjects/DataObjectIn.svg",smallImage:"assets/images/DataObjects/DataObjectInSmall.svg",propertiesImage:"assets/images/DataObjects/DataObjectInProperties.svg",type:g.dataInput,width:31,height:41},dataOutput:{caption:"dataObjects.dataOutput",largeImage:"assets/images/DataObjects/DataObjectOut.svg",smallImage:"assets/images/DataObjects/DataObjectOutSmall.svg",propertiesImage:"assets/images/DataObjects/DataObjectOutProperties.svg",type:g.dataOutput,width:31,height:41},dataStoreReference:{caption:"dataObjects.dataStoreReference",largeImage:"assets/images/DataObjects/DataStore.svg",smallImage:"assets/images/DataObjects/DataStore.svg",propertiesImage:"assets/images/DataObjects/DataStoreProperties.svg",type:g.dataStoreReference,width:31,height:41}};(0,f.ngxTranslateExtract)("diagram.endEvents.endEvent"),(0,f.ngxTranslateExtract)("diagram.endEvents.endEventMessage"),(0,f.ngxTranslateExtract)("diagram.endEvents.endEventEscalation"),(0,f.ngxTranslateExtract)("diagram.endEvents.endEventError"),(0,f.ngxTranslateExtract)("diagram.endEvents.endEventCompensate"),(0,f.ngxTranslateExtract)("diagram.endEvents.endEventSignal"),(0,f.ngxTranslateExtract)("diagram.endEvents.endEventTerminate"),(0,f.ngxTranslateExtract)("diagram.endEvents.endEventMultiple"),(0,f.ngxTranslateExtract)("diagram.endEvents.endEventCancel");const ur={endEvent:{caption:"endEvents.endEvent",height:31,largeImage:"assets/images/EndEvent/EndEventLarge.svg",smallImage:"assets/images/EndEvent/EndEventSmall.svg",propertiesImage:"assets/images/EndEvent/EndEventProperties.svg",type:g.endEvent,width:31},endEventMessage:{caption:"endEvents.endEventMessage",height:31,largeImage:"assets/images/EndEvent/EndEventMessageLarge.svg",smallImage:"assets/images/EndEvent/EndEventMessageSmall.svg",propertiesImage:"assets/images/EndEvent/EndEventMessageProperties.svg",type:g.endEventMessage,width:31,eventDefinition:[S.messageEventDefinition]},endEventEscalation:{caption:"endEvents.endEventEscalation",height:31,largeImage:"assets/images/EndEvent/EndEventEscalationLarge.svg",smallImage:"assets/images/EndEvent/EndEventEscalationSmall.svg",propertiesImage:"assets/images/EndEvent/EndEventEscalationProperties.svg",type:g.endEventEscalation,width:31,eventDefinition:[S.escalationEventDefinition]},endEventError:{caption:"endEvents.endEventError",height:31,largeImage:"assets/images/EndEvent/EndEventErrorLarge.svg",smallImage:"assets/images/EndEvent/EndEventErrorSmall.svg",propertiesImage:"assets/images/EndEvent/EndEventErrorProperties.svg",type:g.endEventError,width:31,eventDefinition:[S.errorEventDefinition]},endEventCompensate:{caption:"endEvents.endEventCompensate",height:31,largeImage:"assets/images/EndEvent/EndEventCompensationLarge.svg",smallImage:"assets/images/EndEvent/EndEventCompensationSmall.svg",propertiesImage:"assets/images/EndEvent/EndEventCompensationProperties.svg",type:g.endEventCompensate,width:31,eventDefinition:[S.compensateEventDefinition]},endEventSignal:{caption:"endEvents.endEventSignal",height:31,largeImage:"assets/images/EndEvent/EndEventSignalLarge.svg",smallImage:"assets/images/EndEvent/EndEventSignalSmall.svg",propertiesImage:"assets/images/EndEvent/EndEventSignalProperties.svg",type:g.endEventSignal,width:31,eventDefinition:[S.signalEventDefinition]},endEventTerminate:{caption:"endEvents.endEventTerminate",height:31,largeImage:"assets/images/EndEvent/EndEventTerminateLarge.svg",smallImage:"assets/images/EndEvent/EndEventTerminateSmall.svg",propertiesImage:"assets/images/EndEvent/EndEventTerminateProperties.svg",type:g.endEventTerminate,width:31,eventDefinition:[S.terminateEventDefinition]},endEventMultiple:{caption:"endEvents.endEventMultiple",height:31,largeImage:"assets/images/EndEvent/EndEventMultipleLarge.svg",smallImage:"assets/images/EndEvent/EndEventMultipleSmall.svg",propertiesImage:"assets/images/EndEvent/EndEventMultipleProperties.svg",type:g.endEventMultiple,width:31,eventDefinition:[S.cancelEventDefinition,S.terminateEventDefinition,S.messageEventDefinition]},endEventCancel:{caption:"endEvents.endEventCancel",height:31,largeImage:"assets/images/EndEvent/EndEventCancelLarge.svg",smallImage:"assets/images/EndEvent/EndEventCancelSmall.svg",propertiesImage:"assets/images/EndEvent/EndEventCancelProperties.svg",type:g.endEventCancel,width:31,eventDefinition:[S.cancelEventDefinition]}};(0,f.ngxTranslateExtract)("diagram.gateways.exclusiveGateway"),(0,f.ngxTranslateExtract)("diagram.gateways.parallelGateway"),(0,f.ngxTranslateExtract)("diagram.gateways.inclusiveGateway"),(0,f.ngxTranslateExtract)("diagram.gateways.eventBasedGateway"),(0,f.ngxTranslateExtract)("diagram.gateways.complexGateway");const mr={exclusiveGateway:{caption:"gateways.exclusiveGateway",height:55,largeImage:"assets/images/GatewayLarge.svg",smallImage:"assets/images/GatewaySmall.svg",type:g.exclusiveGateway,width:55},parallelGateway:{caption:"gateways.parallelGateway",height:55,largeImage:"assets/images/ParallelGatewayLarge.svg",smallImage:"assets/images/ParallelGatewaySmall.svg",type:g.parallelGateway,width:55},inclusiveGateway:{caption:"gateways.inclusiveGateway",height:55,largeImage:"assets/images/InclusiveGatewayLarge.svg",smallImage:"assets/images/InclusiveGatewaySmall.svg",type:g.inclusiveGateway,width:55},eventBasedGateway:{caption:"gateways.eventBasedGateway",height:55,largeImage:"assets/images/EventBasedGatewayLarge.svg",smallImage:"assets/images/EventBasedGatewaySmall.svg",type:g.eventBasedGateway,width:55},complexGateway:{caption:"gateways.complexGateway",height:55,largeImage:"assets/images/MultipleGatewayLarge.svg",smallImage:"assets/images/MultipleGatewaySmall.svg",type:g.complexGateway,width:55}};(0,f.ngxTranslateExtract)("diagram.intermediateEvents.intermediateThrowEvent"),(0,f.ngxTranslateExtract)("diagram.intermediateEvents.intermediateThrowEventMessage"),(0,f.ngxTranslateExtract)("diagram.intermediateEvents.intermediateThrowEventEscalation"),(0,f.ngxTranslateExtract)("diagram.intermediateEvents.intermediateThrowEventCompensate"),(0,f.ngxTranslateExtract)("diagram.intermediateEvents.intermediateThrowEventLink"),(0,f.ngxTranslateExtract)("diagram.intermediateEvents.intermediateThrowEventSignal"),(0,f.ngxTranslateExtract)("diagram.intermediateEvents.intermediateThrowEventMultiple"),(0,f.ngxTranslateExtract)("diagram.intermediateEvents.intermediateCatchEventMessage"),(0,f.ngxTranslateExtract)("diagram.intermediateEvents.intermediateCatchEventTimer"),(0,f.ngxTranslateExtract)("diagram.intermediateEvents.intermediateCatchEventConditional"),(0,f.ngxTranslateExtract)("diagram.intermediateEvents.intermediateCatchEventLink"),(0,f.ngxTranslateExtract)("diagram.intermediateEvents.intermediateCatchEventSignal"),(0,f.ngxTranslateExtract)("diagram.intermediateEvents.intermediateCatchEventMultiple"),(0,f.ngxTranslateExtract)("diagram.intermediateEvents.intermediateCatchEventParallel");const vr={intermediateThrowEvent:{caption:"intermediateEvents.intermediateThrowEvent",height:31,largeImage:"assets/images/IntermediateEvent/IntermediateEventLarge.svg",smallImage:"assets/images/IntermediateEvent/IntermediateEventSmall.svg",propertiesImage:"assets/images/IntermediateEvent/IntermediateEventProperties.svg",type:g.intermediateThrowEvent,width:31},intermediateThrowEventMessage:{caption:"intermediateEvents.intermediateThrowEventMessage",height:31,largeImage:"assets/images/IntermediateEvent/IntermediateEventThrowingMessageLarge.svg",smallImage:"assets/images/IntermediateEvent/IntermediateEventThrowingMessageSmall.svg",propertiesImage:"assets/images/IntermediateEvent/IntermediateEventThrowingMessageProperties.svg",type:g.intermediateThrowEventMessage,width:31,eventDefinition:[S.messageEventDefinition]},intermediateThrowEventEscalation:{caption:"intermediateEvents.intermediateThrowEventEscalation",height:31,largeImage:"assets/images/IntermediateEvent/IntermediateEventThrowingEscalationLarge.svg",smallImage:"assets/images/IntermediateEvent/IntermediateEventThrowingEscalationSmall.svg",propertiesImage:"assets/images/IntermediateEvent/IntermediateEventThrowingEscalationProperties.svg",type:g.intermediateThrowEventEscalation,width:31,eventDefinition:[S.escalationEventDefinition]},intermediateThrowEventCompensate:{caption:"intermediateEvents.intermediateThrowEventCompensate",height:31,largeImage:"assets/images/IntermediateEvent/IntermediateEventThrowingCompensationLarge.svg",smallImage:"assets/images/IntermediateEvent/IntermediateEventThrowingCompensationSmall.svg",propertiesImage:"assets/images/IntermediateEvent/IntermediateEventThrowingCompensationProperties.svg",type:g.intermediateThrowEventCompensate,width:31,eventDefinition:[S.compensateEventDefinition]},intermediateThrowEventLink:{caption:"intermediateEvents.intermediateThrowEventLink",height:31,largeImage:"assets/images/IntermediateEvent/IntermediateEventThrowingLinkLarge.svg",smallImage:"assets/images/IntermediateEvent/IntermediateEventThrowingLinkSmall.svg",propertiesImage:"assets/images/IntermediateEvent/IntermediateEventThrowingLinkProperties.svg",type:g.intermediateThrowEventLink,width:31,eventDefinition:[S.linkEventDefinition]},intermediateThrowEventSignal:{caption:"intermediateEvents.intermediateThrowEventSignal",height:31,largeImage:"assets/images/IntermediateEvent/IntermediateEventThrowingSignalLarge.svg",smallImage:"assets/images/IntermediateEvent/IntermediateEventThrowingSignalSmall.svg",propertiesImage:"assets/images/IntermediateEvent/IntermediateEventThrowingSignalProperties.svg",type:g.intermediateThrowEventSignal,width:31,eventDefinition:[S.signalEventDefinition]},intermediateThrowEventMultiple:{caption:"intermediateEvents.intermediateThrowEventMultiple",height:31,largeImage:"assets/images/IntermediateEvent/IntermediateEventThrowingMultipleLarge.svg",smallImage:"assets/images/IntermediateEvent/IntermediateEventThrowingMultipleSmall.svg",propertiesImage:"assets/images/IntermediateEvent/IntermediateEventThrowingMultipleProperties.svg",type:g.intermediateThrowEventMultiple,width:31,eventDefinition:[S.terminateEventDefinition,S.cancelEventDefinition]},intermediateCatchEventMessage:{caption:"intermediateEvents.intermediateCatchEventMessage",height:31,largeImage:"assets/images/IntermediateEvent/IntermediateEventCatchingMessageLarge.svg",smallImage:"assets/images/IntermediateEvent/IntermediateEventCatchingMessageSmall.svg",propertiesImage:"assets/images/IntermediateEvent/IntermediateEventCatchingMessageProperties.svg",type:g.intermediateCatchEventMessage,width:31,eventDefinition:[S.messageEventDefinition]},intermediateCatchEventTimer:{caption:"intermediateEvents.intermediateCatchEventTimer",height:31,largeImage:"assets/images/IntermediateEvent/IntermediateEventCatchingTimerLarge.svg",smallImage:"assets/images/IntermediateEvent/IntermediateEventCatchingTimerSmall.svg",propertiesImage:"assets/images/IntermediateEvent/IntermediateEventCatchingTimerProperties.svg",type:g.intermediateCatchEventTimer,width:31,eventDefinition:[S.timerEventDefinition]},intermediateCatchEventConditional:{caption:"intermediateEvents.intermediateCatchEventConditional",height:31,largeImage:"assets/images/IntermediateEvent/IntermediateEventCatchingConditionalLarge.svg",smallImage:"assets/images/IntermediateEvent/IntermediateEventCatchingConditionalSmall.svg",propertiesImage:"assets/images/IntermediateEvent/IntermediateEventCatchingConditionalProperties.svg",type:g.intermediateCatchEventConditional,width:31,eventDefinition:[S.conditionalEventDefinition]},intermediateCatchEventLink:{caption:"intermediateEvents.intermediateCatchEventLink",height:31,largeImage:"assets/images/IntermediateEvent/IntermediateEventCatchingLinkLarge.svg",smallImage:"assets/images/IntermediateEvent/IntermediateEventCatchingLinkSmall.svg",propertiesImage:"assets/images/IntermediateEvent/IntermediateEventCatchingLinkProperties.svg",type:g.intermediateCatchEventLink,width:31,eventDefinition:[S.linkEventDefinition]},intermediateCatchEventSignal:{caption:"intermediateEvents.intermediateCatchEventSignal",height:31,largeImage:"assets/images/IntermediateEvent/IntermediateEventCatchingSignalLarge.svg",smallImage:"assets/images/IntermediateEvent/IntermediateEventCatchingSignalSmall.svg",propertiesImage:"assets/images/IntermediateEvent/IntermediateEventCatchingSignalProperties.svg",type:g.intermediateCatchEventSignal,width:31,eventDefinition:[S.signalEventDefinition]},intermediateCatchEventMultiple:{caption:"intermediateEvents.intermediateCatchEventMultiple",height:31,largeImage:"assets/images/IntermediateEvent/IntermediateEventCatchingMultipleLarge.svg",smallImage:"assets/images/IntermediateEvent/IntermediateEventCatchingMultipleSmall.svg",propertiesImage:"assets/images/IntermediateEvent/IntermediateEventCatchingMultipleProperties.svg",type:g.intermediateCatchEventMultiple,width:31,eventDefinition:[S.terminateEventDefinition,S.cancelEventDefinition]},intermediateCatchEventParallel:{caption:"intermediateEvents.intermediateCatchEventParallel",height:31,largeImage:"assets/images/IntermediateEvent/IntermediateEventCatchingParallelLarge.svg",smallImage:"assets/images/IntermediateEvent/IntermediateEventCatchingParallelSmall.svg",propertiesImage:"assets/images/IntermediateEvent/IntermediateEventCatchingParallelProperties.svg",type:g.intermediateCatchEventParallel,width:31,eventDefinition:[S.terminateEventDefinition,S.cancelEventDefinition]}};var Ze=function(r){return r.adHocSubProcess="adHocSubProcess",r.association="association",r.boundaryEvent="boundaryEvent",r.bounds="Bounds",r.documentation="documentation",r.bpmn2="bpmn2:",r.bpmnLabel="BPMNLabel",r.bpmnDiagram="BPMNDiagram",r.bpmndi="bpmndi:",r.bpmnEdge="BPMNEdge",r.bpmnPlane="BPMNPlane",r.bpmnShape="BPMNShape",r.businessRuleTask="businessRuleTask",r.callActivity="callActivity",r.cancelEventDefinition="cancelEventDefinition",r.collaboration="collaboration",r.compensateEventDefinition="compensateEventDefinition",r.conditionalEventDefinition="conditionalEventDefinition",r.conditionExpression="conditionExpression",r.childLaneSet="childLaneSet",r.dataInput="dataInput",r.dataInputAssociation="dataInputAssociation",r.dataInputRefs="dataInputRefs",r.dataObject="dataObject",r.dataObjectReference="dataObjectReference",r.dataOutput="dataOutput",r.dataOutputAssociation="dataOutputAssociation",r.dataOutputRefs="dataOutputRefs",r.dataStore="dataStore",r.dataStoreReference="dataStoreReference",r.definitions="definitions",r.diagramMetaData="diagramMetaData",r.endEvent="endEvent",r.error="error",r.errorEventDefinition="errorEventDefinition",r.escalationEventDefinition="escalationEventDefinition",r.eventDefinition="EventDefinition",r.extensionElements="extensionElements",r.flowNodeRef="flowNodeRef",r.incoming="incoming",r.inputSet="inputSet",r.intermediateCatchEvent="intermediateCatchEvent",r.intermediateThrowEvent="intermediateThrowEvent",r.ioSpecification="ioSpecification",r.isExpanded="isExpanded",r.isMarkerVisible="isMarkerVisible",r.lane="lane",r.laneSet="laneSet",r.linkEventDefinition="linkEventDefinition",r.manualTask="manualTask",r.messageEventDefinition="messageEventDefinition",r.multiInstanceLoopCharacteristics="multiInstanceLoopCharacteristics",r.outgoing="outgoing",r.outputSet="outputSet",r.participant="participant",r.process="process",r.property="property",r.receiveTask="receiveTask",r.scriptTask="scriptTask",r.sendTask="sendTask",r.serviceTask="serviceTask",r.sequenceFlow="sequenceFlow",r.signalEventDefinition="signalEventDefinition",r.sourceRef="sourceRef",r.subProcess="subProcess",r.standardLoopCharacteristics="standardLoopCharacteristics",r.startEvent="startEvent",r.task="task",r.targetRef="targetRef",r.targetRefPlaceholder="__targetRef_placeholder",r.terminateEventDefinition="terminateEventDefinition",r.text="text",r.textAnnotation="textAnnotation",r.timerEventDefinition="timerEventDefinition",r.tFormalExpression="tFormalExpression",r.userTask="userTask",r.waypoint="waypoint",r.eventBasedGateway="eventBasedGateway",r.complexGateway="complexGateway",r.inclusiveGateway="inclusiveGateway",r.parallelGateway="parallelGateway",r.exclusiveGateway="exclusiveGateway",r}(Ze||{});(0,f.ngxTranslateExtract)("diagram.lanes.lane"),(0,f.ngxTranslateExtract)("diagram.lanes.laneSet");const Gs={lane:{caption:"lanes.lane",headerWidth:30,height:150,minHeight:150,minWidth:300,propertiesImage:"assets/images/LaneSetProperties.svg",parents:[Ze.laneSet,Ze.process,Ze.subProcess],type:g.lane,width:600,order:{level:-1},padding:5,label:{editClassList:["djs-direct-editing-rotate-90"],style:{size:{width:100},align:"center-middle"},padding:{paddingTop:8,paddingBottom:8,paddingLeft:6,paddingRight:6}}},laneSet:{caption:"lanes.laneSet",headerWidth:30,height:250,minHeight:150,minWidth:330,propertiesImage:"assets/images/LaneSetProperties.svg",type:g.laneSet,width:600,order:{level:-2},padding:5,label:{editClassList:["djs-direct-editing-rotate-90"],style:{size:{width:100},align:"center-middle"},padding:{paddingTop:8,paddingBottom:8,paddingLeft:6,paddingRight:6}}}};(0,f.ngxTranslateExtract)("diagram.markers.adHoc"),(0,f.ngxTranslateExtract)("diagram.markers.compensation"),(0,f.ngxTranslateExtract)("diagram.markers.loop"),(0,f.ngxTranslateExtract)("diagram.markers.parallelMultiInstance"),(0,f.ngxTranslateExtract)("diagram.markers.sequenceMultiInstance");const Ye={AdHoc:{largeImage:"assets/images/Markers/AdhocLarge.svg",order:3,selectedImage:"assets/images/Markers/AdhocSelected.svg",smallImage:"assets/images/Markers/AdhocSmall.svg",caption:"markers.adHoc",type:g.markerAdHoc},Collapsed:{order:2,smallImage:"assets/images/Markers/MarkerCollapsed.svg",type:g.markerCollapsed},Compensation:{largeImage:"assets/images/Markers/CompensationLarge.svg",order:0,selectedImage:"assets/images/Markers/CompensationSelected.svg",smallImage:"assets/images/Markers/CompensationSmall.svg",caption:"markers.compensation",type:g.markerCompensation},Loop:{largeImage:"assets/images/Markers/LoopEntriesLarge.svg",order:1,selectedImage:"assets/images/Markers/LoopEntriesSelected.svg",smallImage:"assets/images/Markers/LoopEntriesSmall.svg",caption:"markers.loop",type:g.markerLoop},ParallelMultiInstance:{largeImage:"assets/images/Markers/ParallelMultiInstanceLarge.svg",order:1,selectedImage:"assets/images/Markers/ParallelMultiInstanceSelected.svg",smallImage:"assets/images/Markers/ParallelMultiInstanceSmall.svg",caption:"markers.parallelMultiInstance",type:g.markerParallelMultiInstance},SequenceMultiInstance:{largeImage:"assets/images/Markers/SequenceMultiInstanceLarge.svg",order:1,selectedImage:"assets/images/Markers/SequenceMultiInstanceSelected.svg",smallImage:"assets/images/Markers/SequenceMultiInstanceSmall.svg",caption:"markers.sequenceMultiInstance",type:g.markerSequenceMultiInstance}},N={AdHoc:{markers:[Ye.AdHoc],type:"AdHoc"},Compensation:{markers:[Ye.Compensation],type:"Compensation"},Loops:{markers:[Ye.Loop,Ye.ParallelMultiInstance,Ye.SequenceMultiInstance],type:"Loops"}};(0,f.ngxTranslateExtract)("diagram.startEvents.startEvent"),(0,f.ngxTranslateExtract)("diagram.startEvents.startEventMessage"),(0,f.ngxTranslateExtract)("diagram.startEvents.startEventTimer"),(0,f.ngxTranslateExtract)("diagram.startEvents.startEventConditional"),(0,f.ngxTranslateExtract)("diagram.startEvents.startEventSignal"),(0,f.ngxTranslateExtract)("diagram.startEvents.startEventMultiple"),(0,f.ngxTranslateExtract)("diagram.startEvents.startEventParallel"),(0,f.ngxTranslateExtract)("diagram.startEvents.startEventEscalation"),(0,f.ngxTranslateExtract)("diagram.startEvents.startEventError"),(0,f.ngxTranslateExtract)("diagram.startEvents.startEventCompensation"),(0,f.ngxTranslateExtract)("diagram.startEvents.startEventMessageNonInterrupting"),(0,f.ngxTranslateExtract)("diagram.startEvents.startEventTimerNonInterrupting"),(0,f.ngxTranslateExtract)("diagram.startEvents.startEventEscalationNonInterrupting"),(0,f.ngxTranslateExtract)("diagram.startEvents.startEventSignalNonInterrupting"),(0,f.ngxTranslateExtract)("diagram.startEvents.startEventMultipleNonInterrupting"),(0,f.ngxTranslateExtract)("diagram.startEvents.startEventParallelNonInterrupting"),(0,f.ngxTranslateExtract)("diagram.startEvents.startEventConditionalNonInterrupting");const fr={startEvent:{caption:"startEvents.startEvent",height:31,largeImage:"assets/images/StartEvent/StartEventLarge.svg",smallImage:"assets/images/StartEvent/StartEventSmall.svg",propertiesImage:"assets/images/StartEvent/StartEventPropertiesl.svg",type:g.startEvent,width:31},startEventMessage:{caption:"startEvents.startEventMessage",height:31,largeImage:"assets/images/StartEvent/StartEventMessageLarge.svg",smallImage:"assets/images/StartEvent/StartEventMessageSmall.svg",propertiesImage:"assets/images/StartEvent/StartEventMessageProperties.svg",type:g.startEventMessage,width:31,eventDefinition:[S.messageEventDefinition]},startEventTimer:{caption:"startEvents.startEventTimer",height:31,largeImage:"assets/images/StartEvent/StartEventTimerLarge.svg",smallImage:"assets/images/StartEvent/StartEventTimerSmall.svg",propertiesImage:"assets/images/StartEvent/StartEventTimerProperties.svg",type:g.startEventTimer,width:31,eventDefinition:[S.timerEventDefinition]},startEventConditional:{caption:"startEvents.startEventConditional",height:31,largeImage:"assets/images/StartEvent/StartEventConditionalLarge.svg",smallImage:"assets/images/StartEvent/StartEventConditionalSmall.svg",propertiesImage:"assets/images/StartEvent/StartEventConditionalProperties.svg",type:g.startEventConditional,width:31,eventDefinition:[S.conditionalEventDefinition]},startEventSignal:{caption:"startEvents.startEventSignal",height:31,largeImage:"assets/images/StartEvent/StartEventSignalLarge.svg",smallImage:"assets/images/StartEvent/StartEventSignalSmall.svg",propertiesImage:"assets/images/StartEvent/StartEventSignalProperties.svg",type:g.startEventSignal,width:31,eventDefinition:[S.signalEventDefinition]},startEventMultiple:{caption:"startEvents.startEventMultiple",height:31,largeImage:"assets/images/StartEvent/StartEventMultipleLarge.svg",smallImage:"assets/images/StartEvent/StartEventMultipleSmall.svg",propertiesImage:"assets/images/StartEvent/StartEventMultipleProperties.svg",type:g.startEventMultiple,width:31,eventDefinition:[S.cancelEventDefinition,S.terminateEventDefinition]},startEventParallel:{caption:"startEvents.startEventParallel",height:31,largeImage:"assets/images/StartEvent/StartEventParallelLarge.svg",smallImage:"assets/images/StartEvent/StartEventParallelSmall.svg",propertiesImage:"assets/images/StartEvent/StartEventParallelProperties.svg",type:g.startEventParallel,width:31,eventDefinition:[S.cancelEventDefinition,S.terminateEventDefinition]},startEventEscalation:{caption:"startEvents.startEventEscalation",largeImage:"assets/images/StartEvent/StartEventEscalationLarge.svg",smallImage:"assets/images/StartEvent/StartEventEscalationSmall.svg",propertiesImage:"assets/images/StartEvent/StartEventEscalationProperties.svg",type:g.startEventEscalation,width:31,height:31,eventDefinition:[S.escalationEventDefinition]},startEventError:{caption:"startEvents.startEventError",largeImage:"assets/images/StartEvent/StartEventErrorLarge.svg",smallImage:"assets/images/StartEvent/StartEventErrorSmall.svg",propertiesImage:"assets/images/StartEvent/StartEventErrorProperties.svg",type:g.startEventError,width:31,height:31,eventDefinition:[S.errorEventDefinition]},startEventCompensation:{caption:"startEvents.startEventCompensation",largeImage:"assets/images/StartEvent/StartEventCompensationLarge.svg",smallImage:"assets/images/StartEvent/StartEventCompensationSmall.svg",propertiesImage:"assets/images/StartEvent/StartEventCompensationProperties.svg",type:g.startEventCompensation,width:31,height:31,eventDefinition:[S.compensateEventDefinition]},startEventMessageNonInterrupting:{caption:"startEvents.startEventMessageNonInterrupting",largeImage:"assets/images/StartEvent/StartEventMessageNonInterruptingLarge.svg",smallImage:"assets/images/StartEvent/StartEventMessageNonInterruptingSmall.svg",propertiesImage:"assets/images/StartEvent/StartEventMessageNonInterruptingProperties.svg",type:g.startEventMessageNonInterrupting,isInterrupting:!1,width:31,height:31,eventDefinition:[S.messageEventDefinition]},startEventTimerNonInterrupting:{caption:"startEvents.startEventTimerNonInterrupting",largeImage:"assets/images/StartEvent/StartEventTimerNonInterruptingLarge.svg",smallImage:"assets/images/StartEvent/StartEventTimerNonInterruptingSmall.svg",propertiesImage:"assets/images/StartEvent/StartEventTimerNonInterruptingProperties.svg",type:g.startEventTimerNonInterrupting,isInterrupting:!1,width:31,height:31,eventDefinition:[S.timerEventDefinition]},startEventEscalationNonInterrupting:{caption:"startEvents.startEventEscalationNonInterrupting",largeImage:"assets/images/StartEvent/StartEventEscalationNonInterruptingLarge.svg",smallImage:"assets/images/StartEvent/StartEventEscalationNonInterruptingSmall.svg",propertiesImage:"assets/images/StartEvent/StartEventEscalationNonInterruptingProperties.svg",type:g.startEventEscalationNonInterrupting,isInterrupting:!1,width:31,height:31,eventDefinition:[S.escalationEventDefinition]},startEventSignalNonInterrupting:{caption:"startEvents.startEventSignalNonInterrupting",largeImage:"assets/images/StartEvent/StartEventSignalNonInterruptingLarge.svg",smallImage:"assets/images/StartEvent/StartEventSignalNonInterruptingSmall.svg",propertiesImage:"assets/images/StartEvent/StartEventSignalNonInterruptingProperties.svg",type:g.startEventSignalNonInterrupting,isInterrupting:!1,width:31,height:31,eventDefinition:[S.signalEventDefinition]},startEventMultipleNonInterrupting:{caption:"startEvents.startEventMultipleNonInterrupting",largeImage:"assets/images/StartEvent/StartEventMultipleNonInterruptingLarge.svg",smallImage:"assets/images/StartEvent/StartEventMultipleNonInterruptingSmall.svg",propertiesImage:"assets/images/StartEvent/StartEventMultipleNonInterruptingProperties.svg",type:g.startEventMultipleNonInterrupting,isInterrupting:!1,width:31,height:31,eventDefinition:[S.cancelEventDefinition,S.terminateEventDefinition]},startEventParallelNonInterrupting:{caption:"startEvents.startEventParallelNonInterrupting",largeImage:"assets/images/StartEvent/StartEventParallelNonInterruptingLarge.svg",smallImage:"assets/images/StartEvent/StartEventParallelNonInterruptingSmall.svg",propertiesImage:"assets/images/StartEvent/StartEventParallelNonInterruptingProperties.svg",type:g.startEventParallelNonInterrupting,isInterrupting:!1,width:31,height:31,eventDefinition:[S.cancelEventDefinition,S.terminateEventDefinition]},startEventConditionalNonInterrupting:{caption:"startEvents.startEventConditionalNonInterrupting",largeImage:"assets/images/StartEvent/StartEventConditionalNonInterruptingLarge.svg",smallImage:"assets/images/StartEvent/StartEventConditionalNonInterruptingSmall.svg",propertiesImage:"assets/images/StartEvent/StartEventConditionalNonInterruptingProperties.svg",type:g.startEventConditionalNonInterrupting,isInterrupting:!1,width:31,height:31,eventDefinition:[S.conditionalEventDefinition]}};(0,f.ngxTranslateExtract)("diagram.tasks.subProcessCollapsed"),(0,f.ngxTranslateExtract)("diagram.tasks.subProcessExpanded"),(0,f.ngxTranslateExtract)("diagram.tasks.eventSubProcessExpanded"),(0,f.ngxTranslateExtract)("diagram.tasks.task"),(0,f.ngxTranslateExtract)("diagram.tasks.userTask"),(0,f.ngxTranslateExtract)("diagram.tasks.manualTask"),(0,f.ngxTranslateExtract)("diagram.tasks.businessRuleTask"),(0,f.ngxTranslateExtract)("diagram.tasks.serviceTask"),(0,f.ngxTranslateExtract)("diagram.tasks.scriptTask"),(0,f.ngxTranslateExtract)("diagram.tasks.receiveTask"),(0,f.ngxTranslateExtract)("diagram.tasks.sendTask"),(0,f.ngxTranslateExtract)("diagram.tasks.callActivity");const yr={subProcessCollapsed:{caption:"tasks.subProcessCollapsed",height:55,largeImage:"assets/images/SubProcessCollapsedLarge.svg",smallImage:"assets/images/SubProcessCollapsedSmall.svg",propertiesImage:"assets/images/SubProcessCollapsedProperties.svg",type:g.subProcessCollapsed,width:69,markerGroups:[N.AdHoc,N.Loops,N.Compensation]},task:{caption:"tasks.task",height:55,largeImage:"assets/images/TaskLarge.svg",smallImage:"assets/images/TaskSmall.svg",type:g.task,width:69,markerGroups:[N.Loops,N.Compensation]},userTask:{caption:"tasks.userTask",height:55,largeImage:"assets/images/UserTaskLarge.svg",smallImage:"assets/images/UserTaskSmall.svg",type:g.userTask,width:69,markerGroups:[N.Loops,N.Compensation]},manualTask:{caption:"tasks.manualTask",height:55,largeImage:"assets/images/ManualTaskLarge.svg",smallImage:"assets/images/ManualTaskSmall.svg",type:g.manualTask,width:69,markerGroups:[N.Loops,N.Compensation]},businessRuleTask:{caption:"tasks.businessRuleTask",height:55,largeImage:"assets/images/BusinessRuleTaskLarge.svg",smallImage:"assets/images/BusinessRuleTaskSmall.svg",type:g.businessRuleTask,width:69,markerGroups:[N.Loops,N.Compensation]},serviceTask:{caption:"tasks.serviceTask",height:55,largeImage:"assets/images/ServiceTaskLarge.svg",smallImage:"assets/images/ServiceTaskSmall.svg",type:g.serviceTask,width:69,markerGroups:[N.Loops,N.Compensation]},scriptTask:{caption:"tasks.scriptTask",height:55,largeImage:"assets/images/ScriptTaskLarge.svg",smallImage:"assets/images/ScriptTaskSmall.svg",type:g.scriptTask,width:69,markerGroups:[N.Loops,N.Compensation]},receiveTask:{caption:"tasks.receiveTask",height:55,largeImage:"assets/images/ReceiveTaskLarge.svg",smallImage:"assets/images/ReceiveTaskSmall.svg",type:g.receiveTask,width:69,markerGroups:[N.Loops,N.Compensation]},sendTask:{caption:"tasks.sendTask",height:55,largeImage:"assets/images/SendTaskLarge.svg",smallImage:"assets/images/SendTaskSmall.svg",type:g.sendTask,width:69,markerGroups:[N.Loops,N.Compensation]},callActivity:{caption:"tasks.callActivity",height:55,largeImage:"assets/images/CallActivityLarge.svg",smallImage:"assets/images/CallActivitySmall.svg",type:g.callActivity,width:69,markerGroups:[N.Loops,N.Compensation]},subProcessExpanded:{caption:"tasks.subProcessExpanded",headerWidth:30,height:190,minHeight:150,minWidth:330,smallImage:"assets/images/SubProcessExpandedSmall.svg",propertiesImage:"assets/images/SubProcessExpandedProperties.svg",type:g.subProcessExpanded,order:{level:-2},width:350,padding:5,margin:10,stroke:"#BEBEBE",cornerRadius:5,label:{style:{align:"middle-center"}},markerGroups:[N.AdHoc,N.Loops,N.Compensation]},eventSubProcessExpanded:{caption:"tasks.eventSubProcessExpanded",headerWidth:30,height:190,width:350,minHeight:150,minWidth:330,smallImage:"assets/images/EventSubProcessExpandedPalette.svg",propertiesImage:"assets/images/EventSubProcessExpandedProperties.svg",type:g.eventSubProcessExpanded,order:{level:-2},padding:5,margin:10,cornerRadius:5,fill:"rgba(36, 89, 196, 0.12)",stroke:"#2459C4",strokeDasharray:"1 2",label:{style:{align:"middle-center",padding:5}},markerGroups:[],startEvent:g.startEventSignal}};(0,f.ngxTranslateExtract)("diagram.connections.association"),(0,f.ngxTranslateExtract)("diagram.connections.associationOneWay"),(0,f.ngxTranslateExtract)("diagram.connections.associationTwoWay");const Cr={association:{caption:"connections.association",type:g.association,smallImage:"assets/images/Association/NoDirections.svg",propertiesImage:"assets/images/Association/OneDirectionsProperties.svg"},associationOneWay:{caption:"connections.associationOneWay",type:g.associationOneWay,smallImage:"assets/images/Association/OneDirections.svg",propertiesImage:"assets/images/Association/OneDirectionsProperties.svg"},associationTwoWay:{caption:"connections.associationTwoWay",type:g.associationTwoWay,smallImage:"assets/images/Association/Bidirections.svg",propertiesImage:"assets/images/Association/OneDirectionsProperties.svg"}};(0,f.ngxTranslateExtract)("diagram.connections.conditionalConnection");const xr={connection:{caption:"connections.connection",order:{containers:["laneSet","lane","subProcessExpanded","eventSubProcessExpanded"],level:3},smallImage:"assets/images/SequenceFlowSmall.svg",type:g.connection},conditionalConnection:{caption:"connections.conditionalConnection",order:{containers:["laneSet","lane","subProcessExpanded","eventSubProcessExpanded"],level:3},smallImage:"assets/images/ConditionalSequenceFlow.svg",propertiesImage:"assets/images/ConditionalSequenceFlowProperties.svg",type:g.conditionalConnection},defaultConnection:{caption:"connections.defaultConnection",order:{containers:["laneSet","lane","subProcessExpanded","eventSubProcessExpanded"],level:3},smallImage:"assets/images/DefaultSequenceFlow.svg",propertiesImage:"assets/images/DefaultSequenceFlowProperties.svg",type:g.defaultConnection}};class Y extends F{getItems(){return{...super.getItems(),...fr,...vr,...ur,...yr,...mr,...xr,...Cr,...Gs,...hr,...gr,...pr}}}let xe=class{constructor(t){this.config=t;const e=g;this.eventSubProcess={startEvent:{elements:[e.startEventError,e.startEventEscalation,e.startEventCompensation,e.startEventMessageNonInterrupting,e.startEventTimerNonInterrupting,e.startEventEscalationNonInterrupting,e.startEventConditionalNonInterrupting,e.startEventSignalNonInterrupting,e.startEventMultipleNonInterrupting,e.startEventParallelNonInterrupting]}},this.groups={endEvent:{canBeTransformed:[e.startEvent,e.intermediateThrowEvent],elements:[e.endEvent,e.endEventSignal,e.endEventMessage,e.endEventEscalation,e.endEventError,e.endEventCompensate,e.endEventTerminate,e.endEventMultiple,e.endEventCancel]},flow:{elements:[e.connection,e.conditionalConnection,e.defaultConnection]},gateway:{elements:[e.exclusiveGateway,e.parallelGateway,e.inclusiveGateway,e.eventBasedGateway,e.complexGateway,e.exclusiveEventBasedGateway]},intermediateCatchEvent:{canBeTransformed:[e.startEvent,e.endEvent],elements:[e.intermediateCatchEventSignal,e.intermediateCatchEventMessage,e.intermediateCatchEventTimer,e.intermediateCatchEventConditional,e.intermediateCatchEventLink,e.intermediateCatchEventMultiple,e.intermediateCatchEventParallel]},intermediateEvent:{elements:[Ze.intermediateCatchEvent]},intermediateThrowEvent:{canBeTransformed:[e.startEvent,e.endEvent],elements:[e.intermediateThrowEvent,e.intermediateThrowEventSignal,e.intermediateThrowEventMessage,e.intermediateThrowEventEscalation,e.intermediateThrowEventCompensate,e.intermediateThrowEventLink,e.intermediateThrowEventMultiple]},boundaryEvents:{elements:[e.boundaryInterruptingEventMessage,e.boundaryInterruptingEventTimer,e.boundaryInterruptingEventError,e.boundaryInterruptingEventEscalation,e.boundaryInterruptingEventConditional,e.boundaryInterruptingEventSignal,e.boundaryInterruptingEventMultiple,e.boundaryInterruptingEventParallel,e.boundaryNonInterruptingEventMessage,e.boundaryNonInterruptingEventTimer,e.boundaryNonInterruptingEventEscalation,e.boundaryNonInterruptingEventConditional,e.boundaryNonInterruptingEventSignal,e.boundaryNonInterruptingEventMultiple,e.boundaryNonInterruptingEventParallel]},participants:{elements:[e.laneSet,e.lane]},startEvent:{canBeTransformed:[e.endEvent,e.intermediateThrowEvent],elements:[e.startEvent,e.startEventMessage,e.startEventTimer,e.startEventConditional,e.startEventSignal,e.startEventMultiple,e.startEventParallel,...this.eventSubProcess.startEvent.elements]},task:{elements:[e.task,e.userTask,e.receiveTask,e.sendTask,e.manualTask,e.businessRuleTask,e.serviceTask,e.scriptTask,e.subProcessCollapsed,e.subProcessExpanded,e.eventSubProcessExpanded,e.callActivity]},association:{elements:[e.association,e.associationOneWay,e.associationTwoWay]},withoutConnect:{elements:[e.connection,e.endEvent,e.endEventMessage,e.endEventEscalation,e.endEventError,e.endEventCompensate,e.endEventSignal,e.endEventTerminate,e.endEventMultiple,e.endEventCancel,e.defaultConnection,e.conditionalConnection,e.association,e.associationOneWay,e.associationTwoWay,e.eventSubProcessExpanded,e.label]},dataObjects:{elements:[e.dataObjectReference,e.dataInput,e.dataOutput]},dataStores:{elements:[e.dataStoreReference]},textAnnotation:{elements:[e.textAnnotation]},containers:{elements:[e.laneSet,e.lane,e.subProcessExpanded,e.eventSubProcessExpanded]}},this.groups.withoutAnnotation={elements:[...this.groups.flow.elements,e.textAnnotation,...this.groups.association.elements,e.label]},this.groups.connection={elements:[...this.groups.flow.elements,...this.groups.association.elements]},this.groups.flowNode=[...this.groups.intermediateThrowEvent.elements,...this.groups.intermediateCatchEvent.elements,...this.groups.endEvent.elements,...this.groups.startEvent.elements,...this.groups.task.elements,...this.groups.gateway.elements];const n=this.config&&this.config.customDiagramElements;n&&(this.groups.task.elements=this.getUserTasks(n))}getUserTasks(t){const e=this.getAvailableCustomElements(t,n=>n.type===g.userTask,n=>n.userTaskType);return this.getUniqueElements(this.groups.task.elements.concat(e))}getUniqueElements(t){const e=new Set(t);return[...Array.from(e)]}getAvailableCustomElements(t,e,n){return Object.values(t).filter(i=>e(i)&&i.showInReplaceMenu).map(i=>n(i))}};xe=(0,a.Cg)([(0,a.Qj)(0,(0,f.Inject)("config")),(0,a.Sn)("design:paramtypes",[Object])],xe);let fi=class extends it{constructor(t,e){super(t),this.config=t,this.diagramGroups=e}getElements(){const t=this.config.localizableStrings;return{...super.getElements(),[g.task]:{type:g.task,imageUrl:"assets/images/TaskPalette.svg",title:t.get("tasks.task"),menu:[...this.diagramGroups.groups.task.elements]},[g.subProcessExpanded]:{type:g.subProcessExpanded,imageUrl:"assets/images/SubProcessExpandedPalette.svg",title:t.get("tasks.subProcessExpanded")},[g.startEvent]:{type:g.startEvent,imageUrl:"assets/images/StartEvent/StartEventPalette.svg",title:t.get("startEvents.startEvent")},[g.intermediateThrowEvent]:{type:g.intermediateThrowEvent,imageUrl:"assets/images/IntermediateEvent/IntermediateEventPalette.svg",title:t.get("intermediateEvents.intermediateThrowEvent")},[g.endEvent]:{type:g.endEvent,imageUrl:"assets/images/EndEvent/EndEventPalette.svg",title:t.get("endEvents.endEvent")},[g.exclusiveGateway]:{type:g.exclusiveGateway,imageUrl:"assets/images/GatewayPalette.svg",title:t.get("gateways.exclusiveGateway")},[g.laneSet]:{type:g.laneSet,imageUrl:"assets/images/LaneSetPalette.svg",title:t.get("lanes.laneSet")},[g.dataObjectReference]:{type:g.dataObjectReference,imageUrl:"assets/images/DataObjects/DataObjectPalette.svg",title:t.get("dataObjects.dataObjectReference")},[g.dataStoreReference]:{type:g.dataStoreReference,imageUrl:"assets/images/DataObjects/DataStorePalette.svg",title:t.get("dataObjects.dataStoreReference")},[g.textAnnotation]:{type:g.textAnnotation,group:"tools",imageUrl:"assets/images/AnnotatePalette.svg",title:t.get("paletteProvider.textAnnotation")}}}};fi=(0,a.Cg)([(0,a.Qj)(0,(0,f.Inject)("config")),(0,a.Qj)(1,(0,f.Inject)("groups")),(0,a.Sn)("design:paramtypes",[Object,xe])],fi);var br=function(r){return r.OneWay="One",r.TwoWay="Both",r.NoDirection="None",r}(br||{});const qc={},ed=null;var Er=v(66310),jr=v(29488),Sr=v(28024),Fs=v(11345);class u extends M{static isBoundaryEvent(t){return[g.boundaryInterruptingEventMessage,g.boundaryInterruptingEventTimer,g.boundaryInterruptingEventError,g.boundaryInterruptingEventEscalation,g.boundaryInterruptingEventConditional,g.boundaryInterruptingEventSignal,g.boundaryInterruptingEventMultiple,g.boundaryInterruptingEventParallel,g.boundaryNonInterruptingEventMessage,g.boundaryNonInterruptingEventTimer,g.boundaryNonInterruptingEventEscalation,g.boundaryNonInterruptingEventConditional,g.boundaryNonInterruptingEventSignal,g.boundaryNonInterruptingEventMultiple,g.boundaryNonInterruptingEventParallel].includes(t.type)}static isTaskElement(t){return[g.task,g.userTask,g.receiveTask,g.sendTask,g.manualTask,g.businessRuleTask,g.serviceTask,g.scriptTask,g.subProcessCollapsed,g.subProcessExpanded,g.eventSubProcessExpanded,g.callActivity].includes(t.type)}static isEventElement(t){return this.isEndEvent(t)||this.isStartEvent(t)||this.isIntermediateThrowEvent(t)||this.isIntermediateCatchEvent(t)||this.isIntermediateEvent(t)||this.isBoundaryEvent(t)}static isEndEvent(t){return[g.endEvent,g.endEventSignal,g.endEventMessage,g.endEventEscalation,g.endEventError,g.endEventCompensate,g.endEventTerminate,g.endEventMultiple,g.endEventCancel].includes(t.type)}static isStartEvent(t){return[g.startEvent,g.startEventMessage,g.startEventTimer,g.startEventConditional,g.startEventSignal,g.startEventMultiple,g.startEventParallel,g.startEventEscalation,g.startEventError,g.startEventCompensation,g.startEventMessageNonInterrupting,g.startEventTimerNonInterrupting,g.startEventEscalationNonInterrupting,g.startEventConditionalNonInterrupting,g.startEventSignalNonInterrupting,g.startEventMultipleNonInterrupting,g.startEventParallelNonInterrupting].includes(t.type)}static isIntermediateThrowEvent(t){return[g.intermediateThrowEvent,g.intermediateThrowEventSignal,g.intermediateThrowEventMessage,g.intermediateThrowEventEscalation,g.intermediateThrowEventCompensate,g.intermediateThrowEventLink,g.intermediateThrowEventMultiple].includes(t.type)}static isIntermediateCatchEvent(t){return[g.intermediateCatchEventSignal,g.intermediateCatchEventMessage,g.intermediateCatchEventTimer,g.intermediateCatchEventConditional,g.intermediateCatchEventLink,g.intermediateCatchEventMultiple,g.intermediateCatchEventParallel].includes(t.type)}static isIntermediateEvent(t){return t.type===g.intermediateCatchEvent}static getSubProcessType(t){const e=t.isExpanded==="true";let n;return Le.A(t,"triggeredByEvent")==="true"?n=g.eventSubProcessExpanded:n=e?g.subProcessExpanded:g.subProcessCollapsed,n}static isFlowNode(t){return this.isIntermediateThrowEvent(t)||this.isIntermediateCatchEvent(t)||this.isStartEvent(t)||this.isEndEvent(t)||this.isTaskElement(t)||this.isGateway(t)}static isGateway(t){return[g.exclusiveGateway,g.parallelGateway,g.inclusiveGateway,g.eventBasedGateway,g.complexGateway,g.exclusiveEventBasedGateway].includes(t.type)}static isAssociation(t){return[g.association,g.associationOneWay,g.associationTwoWay].includes(t.type)}static isDataStore(t){return t.type===g.dataStoreReference}static isDataElement(t){return this.isDataObject(t)||this.isDataStore(t)}static isAnnotationElement(t){return t.type===g.textAnnotation}static isAssociativeElement(t){return this.isDataElement(t)||this.isAnnotationElement(t)}static isDataObject(t){return[g.dataObjectReference,g.dataInput,g.dataOutput].includes(t.type)}static getMarkerGroupsForElement(t,e){return this.isTaskElement(t)?e.getConfig(t).markerGroups||[]:[]}static getAllChildren(t){let e=[];return(0,f.toArray)(t.children).forEach(n=>{e.push(n),e=e.concat(this.getAllChildren(n))}),e}static getChildLanes(t){return this.getAllChildren(t).filter(e=>e.type===g.lane)}static getSelfAndAllChildren(t){const e=this.getAllChildren(t);return e.push(t),e}static isAssociationElement(t){return t.type===g.association}static isContainer(t){return[g.laneSet,g.lane,g.subProcessExpanded,g.eventSubProcessExpanded].includes(t.type)}static isSubProcessExpanded(t){return t.type===g.subProcessExpanded}static isLane(t){return t.type===g.lane}static isLaneSet(t){return t.type===g.laneSet}static isParticipants(t){return[g.laneSet,g.lane].includes(t.type)}static isIntersect(t,e){if(t&&e){const n=Math.max(t.x,e.x),i=Math.min(t.x+t.width,e.x+e.width),s=Math.max(t.y,e.y),l=Math.min(t.y+t.height,e.y+e.height);return n<i&&s<l}return!1}static selfAndAllLanes(t){return(0,ve.cZ)(t,!1).filter(e=>e.type===g.lane||e.type===g.laneSet)}static getMovableElements(t){return t.filter(e=>e.type!==g.label)}static createByPathIfNotExist(t,e,n={_attributes:{id:f.IdGenerator.generate()}}){Er.A(t,e)||jr.A(t,e,n)}static getParticipantMinResizeBox(t,e,n=[],i){const s={width:i.items.lane.minWidth,height:i.items.lane.minHeight};let l=this.getParticipantChildren(t);l=Sr.A(l,...n);const c=(0,Fs.uR)(l,i.items.lane.padding);return(0,Fs.Cw)(e,t,s,c)}static getParticipantChildren(t){let e=[];return t.children.forEach(n=>{this.isLane(n)?e=e.concat(this.getParticipantChildren(n)):n.waypoints||e.push(n)},this),e}static isSubProcessCollapsed(t){return t.type===g.subProcessCollapsed}static isEventSubProcessExpanded(t){return t&&t.type===g.eventSubProcessExpanded}static isDirectionalDataObject(t){return t.type===g.dataInput||t.type===g.dataOutput}static hasNoConnections(t){return t.incoming.length===0&&t.outgoing.length===0}static isEmbeddedLabelElement(t){return[g.laneSet,g.lane,g.textAnnotation,g.subProcessExpanded,g.eventSubProcessExpanded].includes(t.type)}getContainersType(){return[g.laneSet,g.lane,g.subProcessExpanded,g.eventSubProcessExpanded]}isFlow(t){const e=[g.conditionalConnection,g.defaultConnection];return super.isFlow(t)||e.includes(t.type)}isConnection(t){const e=[g.conditionalConnection,g.defaultConnection,g.association,g.associationOneWay,g.associationTwoWay];return super.isConnection(t)||e.includes(t.type)}getPool(t){do{if(this.isConnection(t)&&(t=t.target),t.type===g.label&&(t=t.labelTarget),t.type===g.laneSet||t.type===g.root)return t;t=t.parent}while(t);return null}getPoolId(t,e){let n=t;do{if(this.isConnection(n)){const i=n;if(n=e.find(s=>s.id===i.target),!n)return console.error(`target element "${i.target}" for connection "${i.id}" not found`),null}if(n?.type===g.label&&(n=e.find(i=>i.id===n.parent)),n?.type===g.laneSet||n?.type===g.root)return n.id;n=e.find(i=>i.id===n?.parent)}while(n);return null}isOrphanElement(t){return!u.isBoundaryEvent(t)&&!u.isContainer(t)&&!this.isConnection(t)&&!u.isLabel(t)}}let td=null;function nd(r){switch(toObject(r).type){case ProcessElementType.eventSubProcessExpanded:case ProcessElementType.subProcessExpanded:case ProcessElementType.subProcessCollapsed:return!0;default:return!1}}function yi(r){return r.type!==r.oldType&&(u.isEventSubProcessExpanded(r)||u.isSubProcessExpanded(r))}function Qs(r){const t=r.oldType;return r.type!==t&&(t===g.eventSubProcessExpanded||t===g.subProcessExpanded)}let Ci=class extends ui.A{constructor(t,e,n){super(t,n),this.spaceTool=e,this.diagramUtils=n,super.postExecuted("shape.delete",B.LOW,i=>{const s=i.context,l=s.hints,c=l&&l.nested;s.shape.type===g.lane&&!c&&l.layout!==!1&&this.compensate(s.shape,s.oldParent)})}compensate(t,e){const n=this.diagramUtils.getPool(e),i=(0,ve.cZ)(n,!1),s=t.height,l=this.spaceTool.calculateAdjustments(i,"y",s,t.y+10);(!e.children||!e.children.length)&&(l.movingShapes=[],l.resizingShapes=[]),this.spaceTool.makeSpace(l.movingShapes,l.resizingShapes,{x:0,y:-s},"s")}};Ci=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("spaceTool")),(0,a.Qj)(2,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,u])],Ci);var wr=v(59617),Ir=v(44548);let xi=class extends Ir.A{constructor(t,e){super(t),this.elements=e,this.defaultOrderLevel=5,this.preExecute.call(this,[j.element.update],i=>this.onElementUpdateHandler(i))}onElementUpdateHandler(t){const e=t.context,n=e.element||e.connection,i=e.type;if(i===n.type)return;const s=X.A({},n,{type:i,userTaskType:e.userTaskType}),l=this.getOrdering(s,n.parent);l&&(l.parent!==void 0&&(e.parent=l.parent),e.parentIndex=l.index)}getLevel(t){const n=this.elements.getConfig(t).order;return!n&&u.isFlowNode(t)?this.defaultOrderLevel:n?n.level:1}getOrdering(t,e){let n=0;if(e.children){const i=this.getLevel(t),s=e.children.indexOf(t);n=wr.A(e.children,l=>i<this.getLevel(l)),s>-1&&s<n&&(n-=1)}return{index:n,parent:e}}};xi=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("elements")),(0,a.Sn)("design:paramtypes",[Object,Y])],xi);class Us extends ht{isStraightConnection(t,e,n){if(this.config.isStraightConnection)return!0;const i=u.isAnnotationElement(e)||u.isAnnotationElement(t);return u.isDataObject(t)||u.isDataObject(e)||u.isAssociation(n)||i}}let bi=class extends In{constructor(t,e,n,i,s,l){super(t,e,l),this.eventBus=t,this.canvas=e,this.elementRegistry=n,this.rules=i,this.layouter=s,this.diagramUtils=l,this.subscribeEvents()}_snapBoundaryEvent(t){const e=this._nearestBoundaryPoint(t);this.snapEvent(t,e)}subscribeEvents(){const t=this.rules;this.eventBus.on([j.create.move,j.create.end,j.shape.move,j.shape.end],B.HIGH,e=>{t.allowed("canElementDock",e.context)&&this._snapBoundaryEvent(e)})}_getSnappingSidePoint(t,e,n,i){return t-e<e+n-t?e+i:e+n-i}_nearestBoundaryPoint(t){const i=t.context.target,s={x:i.x,y:i.y},l=t.x>=i.x&&t.x,c=t.y>=i.y&&t.y;if(l&&(s.x=t.x+-5,t.y<i.y&&(s.y=i.y+-5)),c&&(s.y=t.y+-5,t.x<i.x&&(s.x=i.x+-5)),l&&c){const p=t.x-i.x,h=i.x+i.width-t.x,m=t.y-i.y,C=i.y+i.height-t.y,y=Math.min(p,h),b=Math.min(m,C);y<b?s.x=this._getSnappingSidePoint(t.x,i.x,i.width,-5):s.y=this._getSnappingSidePoint(t.y,i.y,i.height,-5)}return s}snapBendpoint(t,e,n){const i=(0,Oe.jz)(t),s=10,l=Math.abs(e-i.x)<=s,c=Math.abs(n-i.y)<=s;return{x:l?i.x:e,y:c?i.y:n}}canSetSnapping(t){const{target:e}=t;return super.canSetSnapping(t)&&!u.isParticipants(e)&&!u.isEventSubProcessExpanded(e)&&!u.isStartEvent(e)}setSnapping(t){const{x:e,y:n,context:i}=t,{source:s,target:l,hover:c}=i;i.sourcePosition=(0,Oe.jz)(s);const p=u.isAssociativeElement(s)||u.isAssociativeElement(l)?(0,Oe.jz)(c):this.snapBendpoint(l,e,n);this.snapEvent(t,p)}};bi=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("canvas")),(0,a.Qj)(2,d("elementRegistry")),(0,a.Qj)(3,d("rules")),(0,a.Qj)(4,d("layouter")),(0,a.Qj)(5,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Us,M])],bi);var Mr=v(75933);let Ei=class{constructor(t){this.elements=t}getRectangleSize(t,e){const n=this.elements.getConfig(t),i=n.height/n.width,s=this.getElementSize(t,e),l=Math.round(s.width*i),c=l<s.height?new ut(s.width,l):new ut(Math.round(s.height/i),s.height);return c.width>t.width&&c.height>0?c:null}getMargin(t){return this.elements.getConfig(t).margin}getElementSize(t,e){const n=this.getMargin(t),i=e.x-t.x-n,s=e.y-t.y-n;return new ut(i,s)}getMaxRightBottomPoint(t){const e=this.getDefaultSize(t.type),n=this.getMargin(t);let i=t.x+e.width+n,s=t.y+e.height+n;const l=t.parent;return u.isRoot(l)||(i=Math.min(i,l.x+l.width),s=Math.min(s,l.y+l.height)),new Ge(i,s)}isIntersects(t,e){return e.x+e.width>t.leftTopPoint.x&&e.x<t.rightBottomPoint.x&&e.y+e.height>t.leftTopPoint.y&&e.y<t.rightBottomPoint.y}needCheckIntersection(t,e){return t.id!==e.id&&(t.parent===e.parent||u.isLabel(e)&&t!==e.parent)}getBoundingPoints(t,e){const n=[],i=this.getMaxRightBottomPoint(t),l={leftTopPoint:new Ge(t.x,t.y),rightBottomPoint:i};e.forEach(p=>{this.needCheckIntersection(t,p)&&this.isIntersects(l,p)&&n.push(new Ge(p.x,p.y))}),n.push(i);const c=new Ge(t.x,i.y);return n.push(c),n.sort((p,h)=>h.x-p.x)}getElementMaxSize(t,e){const n=this.getBoundingPoints(t,e);let i=0,s;for(;n.length>1;){const l=n.shift(),c=Mr.A(n,h=>h.y).y,p=this.getRectangleSize(t,new Ge(l.x,c));if(p){const h=p.width*p.height;h>i&&(s=p,i=h)}}return s||(s=new ut(t.width,t.height)),s}getDefaultSize(t){const e=this.elements.items[t];return new ut(e.width,e.height)}};Ei=(0,a.Cg)([(0,a.Qj)(0,d("elements")),(0,a.Sn)("design:paramtypes",[Y])],Ei),(0,f.ngxTranslateExtract)("diagram.elementTools.annotate");const Pr="assets/images/icon_tools_annotate.svg";class $e extends qt{constructor(t){super(t),this.context=t,this.diagramGroups=t.groups}getDragStartShapeConfig(t){const e=super.getDragStartShapeConfig(t);return e.userTaskType=t.userTaskType,e}getAnnotateConfig(){return{annotate:{title:this.localizableStrings.get("elementTools.annotate"),imageUrl:Pr,action:{dragstart:this.addElementDragStart.bind(this,{type:g.textAnnotation})}}}}hasConnectConfig(t){return t.type&&!this.diagramGroups.groups.withoutConnect.elements.includes(t.type)}hasAddItemsMenu(t){return u.isTaskElement(t)||u.isGateway(t)||u.isStartEvent(t)||u.isIntermediateThrowEvent(t)||u.isIntermediateCatchEvent(t)||u.isBoundaryEvent(t)}hasAnnotateConfig(t){return t.type&&!this.diagramGroups.groups.withoutAnnotation.elements.includes(t.type)}supportAnnotate(){return!Z.A(this.elements.items[g.textAnnotation])}getContextPadEntries(t){const e=super.getContextPadEntries(t);return this.hasAnnotateConfig(t)&&this.supportAnnotate()&&Object.assign(e,this.getAnnotateConfig()),e}}class Dr extends $e{hasSetupMenu(t){return!1}}class Tr extends $e{hasSetupMenu(t){const e=t.target||{},n=t.source||{};return!(u.isAnnotationElement(e)||u.isAnnotationElement(n))}}class kr extends $e{hasAddItemsMenu(t){return!1}}const Or="assets/images/icon_tools_add_above.svg",Lr="assets/images/icon_tools_add_below.svg";(0,f.ngxTranslateExtract)("diagram.elementTools.lanes.addLaneAbove"),(0,f.ngxTranslateExtract)("diagram.elementTools.lanes.addLaneBelow");class Hs extends $e{hasSetupMenu(t){return!1}hasConnectConfig(){return!1}hasAnnotateConfig(){return!1}hasAddItemsMenu(t){return!0}getAddItemsConfig(t){return{addLaneAbove:{action:{click:()=>{this.modeling.addLane(t,-this.elements.items.lane.height)}},imageUrl:Or,title:this.localizableStrings.get("elementTools.lanes.addLaneAbove")},addLaneBelow:{action:{click:()=>{this.modeling.addLane(t,this.elements.items.lane.height)}},imageUrl:Lr,title:this.localizableStrings.get("elementTools.lanes.addLaneBelow")}}}}(0,f.ngxTranslateExtract)("diagram.elementTools.lanes.divide");const Ar="assets/images/icon_tools_split_lane.svg";class Rr extends Hs{getAddItemsConfig(t){const e=super.getAddItemsConfig(t);if(t.children&&t.children.some(i=>u.isLane(i)))return e;const n={splitLane:{action:{click:()=>{this.modeling.splitLane(t)}},imageUrl:Ar,title:this.localizableStrings.get("elementTools.lanes.divide")}};return Object.assign(e,n),e}}class zr extends $e{hasDeleteAction(t){return!u.isEventSubProcessExpanded(t.parent)}}class _r extends Zn{constructor(t){super(t),this.context=t}getElementToolsFeature(t){switch(!0){case u.isLabel(t):return new Vn(this.context);case u.isLaneSet(t):return new Hs(this.context);case u.isLane(t):return new Rr(this.context);case u.isEventSubProcessExpanded(t):return new kr(this.context);case u.isStartEvent(t):return new zr(this.context);case u.isAssociationElement(t):return new Tr(this.context);case u.isAnnotationElement(t):return new Dr(this.context);default:return new $e(this.context)}}}let ji=class extends gt{constructor(t,e,n,i,s,l,c,p,h,m,C){super(t,e,n,i,s,l,c,p,m,C),this.elements=m,this.elementToolsConfig=C;const y=p.localizableStrings;e.registerProvider(this);const b={modeling:n,localizableStrings:y,contextPad:e,canvas:c,popupMenu:l,elementFactory:i,create:s,connect:t,groups:h,elements:m,elementToolsConfig:C};this.toolsFactory=new _r(b)}};ji=(0,a.Cg)([(0,a.Qj)(0,d("connect")),(0,a.Qj)(1,d("contextPad")),(0,a.Qj)(2,d("modeling")),(0,a.Qj)(3,d("elementFactory")),(0,a.Qj)(4,d("create")),(0,a.Qj)(5,d("popupMenu")),(0,a.Qj)(6,d("canvas")),(0,a.Qj)(7,d("config")),(0,a.Qj)(8,d("groups")),(0,a.Qj)(9,d("elements")),(0,a.Qj)(10,d("elementToolsConfig")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,xe,Y,Object])],ji);class yt extends Ds{isForbiddenType(t){return super.isForbiddenType(t)||u.isStartEvent(t)||u.isEndEvent(t)||u.isAnnotationElement(t)||u.isDataStore(t)||u.isDataObject(t)}}let Si=class extends $t{constructor(t,e,n,i,s,l,c,p){super(t,e,n,i,s,l,c),this.eventBus=t,this.directEditing=e,this.canvas=n,this.modeling=i,this.diagramText=s,this.selection=l,this.rules=c,this.elements=p}updateLabelParent(t){const e=t.context.shape;u.isLabel(e)&&(e.parent=e.labelTarget)}getAnnotationBounds(t){let e;const n=this.canvas,i=n.zoom(),s=t.width*i,l=10*i,c=5*i,p=t.label;if(p){const h=n.getAbsoluteBBox(p);e={height:h.height+l+c,width:s,x:Math.round(h.x+h.width/2-s/2),y:Math.round(h.y-l)}}else{const h=t.height*i,m={height:h,width:s},C=this.diagramText.getLabelPosition(t,m),y=n.getAbsoluteBBox(C),b=s-ys*i;e={height:h,width:s,x:Math.round(y.x-s/2+2*i),y:Math.round(y.y-h*i/2+5*i),minWidth:b,maxWidth:b}}return e}getLaneSetBounds(t){const e=this.canvas,n=e.zoom(),i=e.getAbsoluteBBox(t),s=Gs.lane.headerWidth*n;return{height:s,width:i.height,x:Math.round(i.x-i.height/2+s/2),y:Math.round(i.y+i.height/2-s/2),minWidth:V.label.minWidth*n}}_getSubProcessExpandedBounds(t){const e=this.canvas,n=e.zoom(),i=e.getAbsoluteBBox(t),s=V.label.height*n,l=this.getPadding(V.label.padding,n);return{height:s,width:i.width-l.paddingLeft-l.paddingRight,x:i.x+l.paddingLeft,y:i.y+l.paddingTop,minWidth:i.width-l.paddingLeft-l.paddingRight}}showElementLabel(t){super.showElementLabel(t);const e=t.active&&t.active.element;e&&u.isEmbeddedLabelElement(e)&&this.canvas.removeMarker(e,"djs-text-hidden")}subscribeEvents(){super.subscribeEvents(),this.eventBus.on(["commandStack.shape.move.executed"],t=>this.updateLabelParent(t)),this.eventBus.on(["directEditing.activate"],t=>{const e=t.active.element.label;e&&this.canvas.addMarker(e,"djs-element-hidden");const n=t.active&&t.active.element;n&&u.isEmbeddedLabelElement(n)&&this.canvas.addMarker(n,"djs-text-hidden")})}editElementLabel(t){u.isAssociation(t)||super.editElementLabel(t)}onCreateEnd(t){const e=t.shape;(t.context.canExecute||u.isAnnotationElement(e))&&this.editElementLabel(e)}getBoxBounds(t){switch(!0){case u.isParticipants(t):return this.getLaneSetBounds(t);case u.isSubProcessExpanded(t):case u.isEventSubProcessExpanded(t):return this._getSubProcessExpandedBounds(t);case u.isAnnotationElement(t):return this.getAnnotationBounds(t);default:return super.getBoxBounds(t)}}getElementStyle(t){const e=this.canvas.zoom(),n=this.elements.getConfig(t);let i=re.A(this.diagramText.style),s;switch(!0){case u.isAnnotationElement(t):i={...i,...n.label.editStyle},s=n.label.padding;break;case u.isParticipants(t):s=n.label.padding;break;default:s=V.label.padding;break}return this.getTextStyle(e,i,this.getPadding(s,e))}activate(t){const e=super.activate(t),n=this.elements.getConfig(t);return u.isEmbeddedLabelElement(t)&&(e.options.classList=n.label.editClassList),e}update(t,e,n){!(this.diagramText.isEmptyText(e)&&this.diagramText.isEmptyText(t.caption))&&t.caption!==e.trim()&&(u.isAnnotationElement(t)?this.modeling.updateLabel(t,e,n):super.update(t,e,n))}};Si=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("directEditing")),(0,a.Qj)(2,d("canvas")),(0,a.Qj)(3,d("modeling")),(0,a.Qj)(4,d("diagramText")),(0,a.Qj)(5,d("selection")),(0,a.Qj)(6,d("rules")),(0,a.Qj)(7,d("elements")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Y])],Si);class Nr extends pe{getAnnotationLabelPosition(t,e){return{x:Math.round(t.x+t.width/2+8),y:Math.round(t.y+e.height/2+5)}}getLabelPaddingTop(t,e){return this.diagramUtils.isConnection(t)||e?0:super.getLabelPaddingTop(t,e)}getLabelPosition(t,e){switch(e=e||this.elements.items.label,!0){case this.diagramUtils.isConnection(t):return this.getConnectionLabelPosition(t.waypoints,e);case u.isAnnotationElement(t):case t.type===g.subProcessExpanded:case t.type===g.eventSubProcessExpanded:return this.getAnnotationLabelPosition(t,e);default:return super.getLabelPosition(t,e)}}}let wi=class extends Jt{constructor(t,e,n,i,s,l,c){super(t,e,n,i,s,l,c),this.eventBus=t,this.canvas=e,this.elementRegistry=n,this.graphicsFactory=i,this.diagramText=s}_resizeAnnotation(t){const e=this.elementRegistry.getGraphics(this.active.element.id),n=this.active.element,i=this.canvas.zoom();n.previewHeight=n.previewHeight||n.height,n.previewHeight+=t.dy/i,n.height=n.previewHeight,this.eventBus.fire("shape.changed",{element:n,gfx:e}),this.graphicsFactory.update("shape",n,e)}handleResize(t){u.isAnnotationElement(this.active.element)&&this._resizeAnnotation(t),super.handleResize(t)}complete(){const t=this.active;if(!t)return;const e=t.element,n=this.getValue();let i=this.getNewBounds();if(u.isAnnotationElement(e)){const s=this.canvas.zoom(),l=this.activeTextbox.getBoundingClientRect();i={width:l.width/s,height:l.height/s+ys+ga,x:e.x,y:e.y},delete e.previewHeight,t.element.height=this.initialHeight,t.element.width=this.initialWidth}t.provider.update(t.element,n,i),this.close("complete")}};wi=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("canvas")),(0,a.Qj)(2,d("elementRegistry")),(0,a.Qj)(3,d("graphicsFactory")),(0,a.Qj)(4,d("diagramText")),(0,a.Qj)(5,d("config")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object])],wi);let Ii=class extends Rt{constructor(t,e,n){super(t,e),this.modeling=t,this.diagramText=e,this.elements=n}preExecute(t){const e=t.element;if(e&&!e.label)switch(!0){case u.isEmbeddedLabelElement(e):e.caption=t.text;break;case u.isLabel(e):break;default:this.diagramText.addLabel(this.modeling,e,this.elements.items.label,t.text);break}}execute(t){t.oldText=t.element.caption||"";const e=(t.text||"").trim();return this.setText(t.element,e)}revert(t){return this.setText(t.element,t.oldText)}postExecute(t){t.element&&u.isAnnotationElement(t.element)?t.newBounds&&this.resizeShape(t.element,t.newBounds):super.postExecute(t)}};Ii=(0,a.Cg)([(0,a.Qj)(0,d("modeling")),(0,a.Qj)(1,d("diagramText")),(0,a.Qj)(2,d("elements")),(0,a.Sn)("design:paramtypes",[Object,pe,Y])],Ii);function Br(r,t,e,n){return u.isAssociation(n)&&Gr(r,t,e)}function Gr(r,t,e){const{diagramGroups:n}=r,i=[...n.groups.dataObjects.elements,...n.groups.textAnnotation.elements,...n.groups.dataStores.elements];return!(i.includes(t.type)||i.includes(e.type))}function Fr(r,t,e,n){return!u.isAssociation(n)&&Ws(r,t,e)}function Ws(r,t,e){const{diagramGroups:n}=r,i=[...n.groups.dataObjects.elements,...n.groups.dataStores.elements];return i.includes(t.type)||i.includes(e.type)}function Vs(r,t={},e={}){const{diagramGroups:n}=r,i=n.groups.textAnnotation.elements;return i.includes(e.type)||i.includes(t.type)}function Qr(r,t){return r&&r.outgoing&&r.outgoing.length&&r.outgoing.some(e=>e.id!==t.id&&(e.type===g.conditionalConnection||e.type===g.defaultConnection))}function Mi(r,t=null){return r&&Ur(r.type)&&t!==g.defaultConnection}function Pi(r){return r&&[g.eventBasedGateway,g.parallelGateway].includes(r.type)}function Zs(r,t=null){switch(!0){case Pi(r):return g.connection;case Mi(r,t):return g.conditionalConnection;default:return null}}function Ur(r){return[g.inclusiveGateway,g.exclusiveGateway].includes(r)}function Hr(r,t={},e={},n){return Vs(r,t,e)||Ws(r,t,e)?!1:n.type!==g.defaultConnection&&(Qr(t,n)||Mi(t,n.type))}class Wr{updateConnectionType(t,e,n,i){i.type=g.connection}}class Vr{updateConnectionType(t,e,n,i){i.type=g.conditionalConnection}}class Ys{changeLineToStraight(t){if(!u.isAssociation(t)&&t.waypoints){const e=(0,Rn.A)(t.waypoints);t.waypoints=[].concat([e.shift()],[e.pop()])}}updateConnectionType(t,e,n,i){this.changeLineToStraight(i),i.type=g.association}}class Zr extends Ys{updateConnectionType(t,e,n,i){this.changeLineToStraight(i),i.type=g.associationOneWay}}class Di{updateConnectionType(t,e,n,i){Pi(e)&&(i.type=g.connection)}}(0,a.Cg)([H(Hr,Vr),H(Br,Wr),H(Fr,Zr),H(Vs,Ys),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object]),(0,a.Sn)("design:returntype",void 0)],Di.prototype,"updateConnectionType",null);class Yr{createShape(t,e,n,i,s,l){e.type=g.boundaryInterruptingEventSignal}}class $r{createShape(t,e,n,i,s,l){e.type=g.intermediateThrowEventSignal}}class Jr{createShape(t,e,n,i,s,l={generateUniqueCaption:!0}){if(typeof s=="object"&&(l=s||l),l.generateUniqueCaption===!1)return;const c=t.elementRegistry,p=c.injector.get("config").localizableStrings,h=t.elements.getConfig(e),m=p.get(h.caption);if(m!==h.caption){const C=c.getAllElements();e.caption=fo.prototype.generate(C,"caption",m)}}}function Kr(r,t,e,n){return t.type===g.intermediateThrowEvent&&n&&u.isTaskElement(n)&&!u.isEventSubProcessExpanded(n)}function Xr(r,t){return u.isParticipants(t)}function qr(r,t,e,n){return t.type===g.intermediateThrowEvent&&n&&u.isEventSubProcessExpanded(n)}class $s{createShape(t,e,n,i,s,l){}}(0,a.Cg)([H(Kr,Yr),H(Xr,Jr),H(qr,$r),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Number,Object]),(0,a.Sn)("design:returntype",void 0)],$s.prototype,"createShape",null);class el{execute(t){const e=t.connection,n=e.target,i=e.source;return e.source=n,e.target=i,e.waypoints=e.waypoints.reverse(),e}}class tl{execute(t){const e=t.connection;return t.oldType=e.type,e.type=t.type,t.oldDocumentation=e.documentation,e.documentation=t.documentation,e}}let Ti=class extends zt{constructor(t,e,n,i,s){super(t,s),this.modeling=e,this.elementRegistry=n,this.splitConnectionHelper=i,this.diagramUtils=s}getRealParent(t){const e=this.diagramUtils.getAllContainers(this.elementRegistry.getAllElements()),n=this.canvas.getRootElement();return this.diagramUtils.findRealElementParent({x:t.x,y:t.y},e,n)}execute(t){const e=super.execute(t),n=e.parent;return n&&this.diagramUtils.isFlow(n)&&(t.targetConnection=n,e.parent=this.getRealParent(e)),e}postExecute(t){t.targetConnection&&this.splitConnectionHelper.splitConnection({connection:t.targetConnection,shapes:[t.shape],modeling:this.modeling})}};Ti=(0,a.Cg)([(0,a.Qj)(0,d("canvas")),(0,a.Qj)(1,d("modeling")),(0,a.Qj)(2,d("elementRegistry")),(0,a.Qj)(3,d("splitConnectionHelper")),(0,a.Qj)(4,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,yt,M])],Ti);var nl=v(76935);let ki=class extends nl.A{constructor(t,e){super(t),this.modeling=t,this.diagramUtils=e,this._helper=new Vt(t),this.convertUtils=new Ue(e)}postExecute(t){if(t.hints.recalcShapePosition){const n=t.delta,i=t.shape;this._helper.moveRecursiveShape(i,n)}else super.postExecute(t)}execute(t){const e=super.execute(t),n=t.oldBounds;return n.rx=e.rx,n.ry=e.ry,u.isLabel(e)&&(t.oldParent=e.labelTarget),this.convertUtils.setRelativePosition(e),e}};ki=(0,a.Cg)([(0,a.Qj)(0,d("modeling")),(0,a.Qj)(1,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object])],ki);let Oi=class extends Bt{constructor(t,e,n,i,s,l){super(t,e,n,l),this.modeling=t,this.elementRegistry=e,this.canvas=n,this.splitConnectionHelper=i,this.diagramGroups=s,this.diagramUtils=l}changeType(t){const e=t.newParent,n=t.shapes;!e||!n||!n.length||n.forEach(i=>{i.type===g.intermediateThrowEvent&&u.isEventSubProcessExpanded(e)&&this.modeling.updateElement(i,{type:g.intermediateThrowEventSignal})})}_getShapesWithChangedParent(t,e){let n=t.filter(i=>i.parent.id!==e.id);if(!u.isEventSubProcessExpanded(e)){let i=!1;if(this.diagramUtils.isFlow(e)){const s=e.source,l=e.target;i=u.isEventSubProcessExpanded(s.parent)&&u.isEventSubProcessExpanded(l.parent)}n=n.filter(s=>u.isEventSubProcessExpanded(s.parent)&&!i||!u.isEventSubProcessExpanded(s.parent)&&i)}return n}getConnectionsToRemove(t){const e=t.newParent,n=t.shapes;if(!e||!n||!n.length)return[];const s=this.elementRegistry.getAllElements().filter(h=>this.diagramUtils.isFlow(h)),l=this._getShapesWithChangedParent(n,e),c=(h,m=l)=>m.some(C=>C.id===h.id||C.children&&c(h,C.children));return s.filter(h=>{const m=h.source,C=h.target;if(c(m)&&c(C)||!c(m)&&!c(C))return!1;const y=c(m)?C:m;return!(u.isDataElement(y)||u.isAnnotationElement(y)||y.parent.id===e.id)})}postExecute(t){const e=this.getConnectionsToRemove(t);super.postExecute(t),this.changeType(t),this.modeling.removeElements(e),this.splitConnectionHelper.splitConnection({connection:t.targetConnection,shapes:t.shapes,modeling:this.modeling})}};Oi=(0,a.Cg)([(0,a.Qj)(0,d("modeling")),(0,a.Qj)(1,d("elementRegistry")),(0,a.Qj)(2,d("canvas")),(0,a.Qj)(3,d("splitConnectionHelper")),(0,a.Qj)(4,d("groups")),(0,a.Qj)(5,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,yt,xe,M])],Oi);var il=v(80841);let dn=class extends ds.A{constructor(t){super(t),this.modeling=t}fixDockingPointPadding(t){const{newTarget:e,newSource:n,dockingOrPoints:i,hints:s}=t;if(!s)return;let l;switch(s.docking){case"target":l=e;break;case"source":l=n;break;default:return}const c=il.A(i)?i[i.length-1]:i,p=1;l.x>=c.x?c.x=l.x+p:c.x>=l.x+l.width&&(c.x=l.x+l.width-p),l.y>=c.y?c.y=l.y+p:c.y>=l.y+l.height&&(c.y=l.y+l.height-p)}execute(t){const e=t.connection;t.oldType=e.type;const n=t.hints;n&&n.docking==="target"?n.isUpdateConnectionType&&this.updateConnectionType(e.source,t.newTarget,e):this.updateConnectionType(t.newSource,e.target,e),this.fixDockingPointPadding(t),super.execute(t)}createFeatureContext(){return this.modeling.createFeatureContext()}updateConnectionType(t,e,n){}};(0,a.Cg)([ke(Di),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object,Object,Object]),(0,a.Sn)("design:returntype",void 0)],dn.prototype,"updateConnectionType",null),dn=(0,a.Cg)([(0,a.Qj)(0,d("modeling")),(0,a.Sn)("design:paramtypes",[Object])],dn);var sl=v(38226);let Li=class extends sl.A{constructor(t,e){super(t),this.modeling=t,this.diagramUtils=e,this._helper=new Vt(t),this.convertUtils=new Ue(e)}execute(t){const e=super.execute(t),n=t.oldBounds;return n.rx=e.rx,n.ry=e.ry,this.convertUtils.setRelativePosition(e),e}postExecute(t){const e=t.shape,n=t.hints;n&&n.externalUpdate||(super.postExecute(t),u.isEventSubProcessExpanded(e)&&(this.modeling.recalculateChildrenPosition(e),this.modeling.recalculateConnection(e)))}};Li=(0,a.Cg)([(0,a.Qj)(0,d("modeling")),(0,a.Qj)(1,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object])],Li);class ol{preExecute(t,e){const n=e.element,i=t.modeling;i.removeElementChildren(n),i.updateLabel(n,n.caption)}}class Js{preExecute(t,e){}}(0,a.Cg)([H(al,ol),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object,Object]),(0,a.Sn)("design:returntype",void 0)],Js.prototype,"preExecute",null);function al(r,t){return Qs(t)}var rl=v(6958);let gn=class{constructor(t,e,n,i,s,l){this.modeling=t,this.rules=e,this.eventBus=n,this.elementRegistry=i,this.elementSizeUtils=s,this.elements=l}_removeUnsupportedMarkers(t,e){const n=u.getMarkerGroupsForElement({type:e},this.elements);Object.keys(t).forEach(i=>{n.find(s=>s.type===i)||delete t[i]})}isChangingType(t){return(t.oldType||t.element.type)!==t.type||t.oldUserTaskType!==t.userTaskType}isChangingExpandedState(t){const e=Qs(t),n=yi(t);return e!==n&&(e||n)}removeNotAllowedConnections(t){const e=t.incoming.filter(s=>!this.rules.allowed("connection.reconnect",{source:s.source,target:t,connection:s})),n=t.outgoing.filter(s=>!this.rules.allowed("connection.reconnect",{source:t,target:s.target,connection:s})),i=e.concat(n);je.A(i,s=>this.modeling.removeConnection(s))}updateElementSize(t){const e=t.element;let n;yi(t)?n=this.elementSizeUtils.getElementMaxSize(e,this.elementRegistry.getAll()):n=this.elementSizeUtils.getDefaultSize(e.type),e.width=n.width,e.height=n.height}updateConnectionType(t){t.outgoing.forEach(n=>{const i=Zs(t,n.type);i&&n.type!==i&&this.modeling.updateConnection(n.id,{type:i})})}createFeatureContext(){return{modeling:this.modeling}}preExecute(t){const{element:e,type:n,markers:i,documentation:s,userTaskType:l}=t;t.oldMarkers=re.A(e.markers),t.oldDocumentation=re.A(e.documentation),t.oldType=e.type,t.oldUserTaskType=e.userTaskType,t.oldBounds=At.A(e,["width","height"]),i&&this.isChangingType(t)&&this._removeUnsupportedMarkers(e.markers,n),e.type=n,e.userTaskType=l,e.markers=i,e.documentation=s,this.isChangingType(t)&&this.isChangingExpandedState(t)&&this.updateElementSize(t),this.removeNotAllowedConnections(e)}postExecute(t){const e=this.modeling,n=t.element;this.modeling.recalculateConnection(n),this.eventBus.fire(j.element.updated,n),yi(t)&&!t.externalUpdate&&(e.removeElementChildren(n),e.createStartEventSignal(n)),this.isChangingType(t)&&(this.updateConnectionType(n),this.eventBus.fire(j.element.typeUpdated,n))}execute(t){if(this.isChangingType(t)){const e=t.element,n=t.parentIndex,i=t.newParent||e.parent;(0,rl.WQ)(i.children,e,n)}return t.element}revert(t){return t.element}};(0,a.Cg)([ke(Js,fe.after),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object]),(0,a.Sn)("design:returntype",void 0)],gn.prototype,"preExecute",null),gn=(0,a.Cg)([(0,a.Qj)(0,d("modeling")),(0,a.Qj)(1,d("rules")),(0,a.Qj)(2,d("eventBus")),(0,a.Qj)(3,d("elementRegistry")),(0,a.Qj)(4,d("elementSizeUtils")),(0,a.Qj)(5,d("elements")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object,Y])],gn);var Ks=v(77629);let Ai=class{constructor(t,e,n,i){this.modeling=t,this.spaceTool=e,this.elementRegistry=n,this.elements=i}_tryAddFirstLane(t,e,n){if(!t.length){const i=this.elements.items.lane.headerWidth,s=this.modeling.createShape({type:g.lane},{height:e.height,width:e.width-i,x:e.x+i,y:e.y},n);return(0,f.toArray)(n.children).map(c=>c).forEach(c=>{c!==s&&this.modeling.moveShape(c,{x:0,y:0},s)}),s}}_createLane(t,e,n,i){const s=this.elements.items.lane.headerWidth;return this.modeling.createShape({type:g.lane},{height:Math.abs(n),width:t.type===g.laneSet?t.width-s:t.width,x:t.type===g.laneSet?t.x+s:t.x,y:e},i)}_getAdjustments(t){let e=t.lane;const i=new u().getPool(e),s=u.getChildLanes(i);e=this._tryAddFirstLane(s,e,i)||e;const l=t.yOffset,p=e===i?i:e.parent,h=u.getMovableElements(this.elementRegistry.getAllElements()),m=e.y,C=m+e.height,y=l<0?m-Math.abs(l):C,b=l>=0,I=b?C-10:m+10,P=b?Math.abs(l):-Math.abs(l),L=(0,ve.cZ)(e,!1),G=Ks.A(h,L);this._createLane(e,y,l,p);const J=this.spaceTool.calculateAdjustments(G,"y",P,I);return J.resizingShapes.includes(i)||J.resizingShapes.push(i),J.pool=i,J}_recalcRelativePosition(t){const e=t.children.slice();je.A(e,n=>{this.modeling.moveShape(n,{x:0,y:0})})}preExecute(t){const e=this._getAdjustments(t),n=t.yOffset,i=n<0?"n":"s",s={x:0,y:n};return this.spaceTool.makeSpace([],e.resizingShapes,s,i),i==="n"&&this._recalcRelativePosition(e.pool),this.spaceTool.makeSpace(e.movingShapes,[],s,i),!1}};Ai=(0,a.Cg)([(0,a.Qj)(0,d("modeling")),(0,a.Qj)(1,d("spaceTool")),(0,a.Qj)(2,d("elementRegistry")),(0,a.Qj)(3,d("elements")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Y])],Ai);let Ri=class extends ui.A{constructor(t,e,n,i,s){super(t),this.modeling=e,this.spaceTool=n,this.elementRegistry=i,this.elements=s,t.on("resize.start",B.MAX,this._resizeStart.bind(this)),t.on("resize.end",B.MAX,this._resizeEnd.bind(this))}_resizeStart(t){if(u.isParticipants(t.shape)){const e=t.context,n=e.shape,{h:i,v:s}=this.getParseDirection(e.direction),c=new u().getPool(n),p=this._setMinResizeBox(t,c),h=this._findFirstInsideLane(n,s),m=this._getHeaderOffset(c,h,n);h&&this._setMinResizeBox(t,h),e.minBounds.x=i==="e"?n.x:p.x-m.x,e.minBounds.y=s==="s"?n.y:e.minBounds.y,e.minBounds.width=Math.max(p.width-m.width,this.elements.items.lane.minWidth+m.x)}}_getHeaderOffset(t,e,n){const i=this.elements.items.lane.headerWidth;let s;if(e){const l=this._getMaxNestingLevel(t),c=this._getNestingLevel(e,t);s={x:i*(l-c+1)-(n.x-e.x),width:i*c-(n.width-e.width)}}else s={x:i,width:0};return s}_getMaxNestingLevel(t){let e=0;return this._getAllLanes(t).forEach(i=>{const s=this._getNestingLevel(i,t);s>e&&(e=s)},this),e}_getNestingLevel(t,e){let n=1,i=t;for(;i.parent!==e;)i=i.parent,n++;return n}_getAllLanes(t){let e=[];return t.children.forEach(n=>{u.isLane(n)&&(e.push(n),e=e.concat(this._getAllLanes(n)))}),e}_setMinResizeBox(t,e){const n=t.context,i=u.getParticipantMinResizeBox(e,n.direction,[],this.elements);return i.height=e.y-n.shape.y+i.height,t.context.minBounds=i,i}_findFirstInsideLane(t,e){const n=t.children.filter(i=>u.isLane(i));if(n.length>0){const i=e==="n"?n.find(s=>s.y-10<t.y):n.find(s=>s.y+s.height+10>t.y+t.height);return this._findFirstInsideLane(i,e)}else return u.isLane(t)?t:null}_resizeEnd(t){u.isParticipants(t.shape)&&this.modeling.resizeLane(t.context)}_resizeDelta(t,e,n){return{x:n.h==="w"?(e.width-t.width)*-1:e.width-t.width,y:n.v==="n"?(e.height-t.height)*-1:e.height-t.height}}getParseDirection(t){let e="e",n="n";return t==="e"||t==="w"?e=t:t==="n"||t==="s"?n=t:(n=t[0],e=t[1]),{v:n,h:e}}preExecute(){}execute(){}postExecute(t){const e=t.newBounds,n=t.shape,{h:i,v:s}=this.getParseDirection(t.direction);if(u.isParticipants(n)){const c=new u().getPool(n),p=u.getMovableElements(this.elementRegistry.getAllElements()),h=u.getSelfAndAllChildren(c),m=this._resizeDelta(n,e,{v:s,h:i}),C=m.x,y=m.y,b=e.width-n.width,I=e.height-n.height,P=n.x+n.width,L=n.y+n.height,G=(s==="s"?1:-1)*Math.abs(y),J=(i==="e"?1:-1)*Math.abs(C),z=u.selfAndAllLanes(c),tt=s==="s"?L-10:n.y+10,wt=i==="e"?P-10:n.x+10,En=p.filter(oe=>u.isLaneSet(oe));if(I>0){const oe=this.spaceTool.calculateAdjustments(p,"y",G,tt);this.spaceTool.makeSpace(oe.movingShapes,oe.resizingShapes,{x:0,y},s)}else{const oe=this.spaceTool.calculateAdjustments(h,"y",G,tt);this.spaceTool.makeSpace(oe.movingShapes,oe.resizingShapes,{x:0,y},s)}if(this.spaceTool.makeSpace([],z,{x:C,y:0},i),b>0){const oe=p.filter(Qc=>!z.some(Uc=>Uc===Qc)),lo=this.spaceTool.calculateAdjustments(oe,"x",J,wt);this.spaceTool.makeSpace(lo.movingShapes,lo.resizingShapes,{x:C,y:0},i)}return En.forEach(oe=>this.modeling.recalculateChildrenPosition(oe)),!1}}};Ri=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("modeling")),(0,a.Qj)(2,d("spaceTool")),(0,a.Qj)(3,d("elementRegistry")),(0,a.Qj)(4,d("elements")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Y])],Ri);let zi=class{constructor(t,e,n,i){this.modeling=t,this.spaceTool=e,this.elementRegistry=n,this.elements=i}createLane(t,e){return this.modeling.createShape({type:g.lane},t,e)}makeMinWidthSpace(t){const e=t.width-this.elements.items.lane.minWidth;if(e>0)return;const n=t.x+this.elements.items.lane.headerWidth+10,i=Math.abs(e)+this.elements.items.lane.headerWidth,s=u.getMovableElements(this.elementRegistry.getAllElements()),l=this.spaceTool.calculateAdjustments(s,"x",i,n);this.spaceTool.makeSpace(l.movingShapes,l.resizingShapes,{x:i,y:0},"e")}preExecute(t){const e=t.lane,n=this.elements.items.lane.headerWidth,i=u.getAllChildren(e),s=Ks.A(u.getMovableElements(this.elementRegistry.getAllElements()),i),l=this.elements.items.lane.height,c=this.spaceTool.calculateAdjustments(s,"y",l,e.y+10);this.spaceTool.makeSpace(c.movingShapes,c.resizingShapes,{x:0,y:l},"s");const p=t.newLane=this.createLane({height:e.height-l,width:e.width-n,x:e.x+n,y:e.y},e);this.createLane({height:l,width:e.width-n,x:e.x+n,y:e.y+e.height-l},e),this.makeMinWidthSpace(p),i.forEach(h=>{this.modeling.moveShape(h,{x:0,y:0},p)})}};zi=(0,a.Cg)([(0,a.Qj)(0,d("modeling")),(0,a.Qj)(1,d("spaceTool")),(0,a.Qj)(2,d("elementRegistry")),(0,a.Qj)(3,d("elements")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Y])],zi);let _i=class extends Nt{constructor(t,e,n,i,s,l){super(t,e),this.modeling=t,this.canvas=e,this.elementRegistry=n,this.splitConnectionHelper=i,this.elements=s,this.diagramUtils=l}postExecuteEventSubProcess(t){t.forEach(e=>{e.type===g.eventSubProcessExpanded&&(t.find(i=>u.isStartEvent(i)&&i.parent===e)||this.modeling.createStartEventSignal(e))})}getParent(t,e){const n=this.canvas.getRootElement();if(u.isLaneSet(t))return n;let i=super.getParent(t,e);const s=e.elements;if(this.diagramUtils.isOrphanElement(t)&&s.length>1||this.diagramUtils.isFlow(i)){const l=this.diagramUtils.getAllContainers(this.elementRegistry.getAllElements());i=this.diagramUtils.findRealElementParent({x:t.x,y:t.y},l,n)}return i}preExecute(t){const e=t.parent;e&&this.diagramUtils.isFlow(e)&&(t.targetConnection=e),super.preExecute(t)}postExecute(t){this.postExecuteEventSubProcess(t.elements),this.splitConnectionHelper.splitConnection({connection:t.targetConnection,shapes:t.elements,modeling:this.modeling})}};_i=(0,a.Cg)([(0,a.Qj)(0,d("modeling")),(0,a.Qj)(1,d("canvas")),(0,a.Qj)(2,d("elementRegistry")),(0,a.Qj)(3,d("splitConnectionHelper")),(0,a.Qj)(4,d("elements")),(0,a.Qj)(5,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,yt,Y,u])],_i);class ll extends Mn{isDiagramFlow(t){return new u().isFlow(t)}}class cl extends Re{updateOutline(t,e){const n=e.previewHeight||e.height,i=this.config.offset;(0,x.CF)(t,{x:-i,y:-i,width:e.width+i*2,height:n+i*2})}}class dl extends ja{}class gl extends wa{getDefaultHeight(){return this.config.elements.items.exclusiveGateway.height}}class pl extends $n{}let pn=class extends ze{constructor(t,e,n,i){super(t,e,n,i),this.styles=t,this.rules=e,this.elements=n,this.diagramUtils=i}getOutline(t){switch(!0){case u.isEventElement(t):return new dl(this.config);case u.isParticipants(t):case u.isDataElement(t):case u.isTaskElement(t):return new pl(this.config);case u.isGateway(t):return new gl(this.config);case u.isAnnotationElement(t):return new cl(this.config);case this.diagramUtils.isConnection(t):return new Yn(this.config);default:return super.getOutline(t)}}};pn=(0,a.Cg)([(0,a.Qj)(0,d("styles")),(0,a.Qj)(1,d("rules")),(0,a.Qj)(2,d("elements")),(0,a.Qj)(3,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,F,M])],pn);class hl extends $n{constructor(){super(...arguments),this.outlineRX=6.5}getCreateOutlineConfig(){const t=super.getCreateOutlineConfig();return X.A(t,{rx:this.outlineRX})}}class ul extends pn{getConfig(){const t="djs-validate-outline",e={...this.styles.cls(t,["no-fill"],null),stroke:"#EB3800",strokeWidth:"2px"};return{outlineClassName:t,outlineStyle:e,offset:5,elements:this.elements.items,rules:this.rules}}getOutline(t){return u.isTaskElement(t)?new hl(this.config):super.getOutline(t)}}class ml extends Qt{init(){super.init(),this.copyProperties=[...this.copyProperties,"documentation","markers","userTaskType"]}}class vl extends dt{getConnectionAttributes(t,e){return{...super.getConnectionAttributes(t,e),order:this.elements.items.connection.order}}}let Ni=class{constructor(t){this.config=t}getMarkers(){const t=this.config&&this.config.customMarkers||{};return Qe.A(Ye,t)}};Ni=(0,a.Cg)([(0,a.Qj)(0,d("config")),(0,a.Sn)("design:paramtypes",[Object])],Ni);let Ct=class extends se{constructor(t,e,n,i,s,l,c,p,h,m){super(t,e,n,i,s,l,c,p,m),this.elements=c,this.rules=p,this.diagramGroups=h,this.diagramUtils=m}fixPosition(t,e){for(const n in t)if(t.hasOwnProperty(n)){const s=t[n].filter(l=>u.isLabel(l));if(s.length===1){const l=s[0];e.x>=l.x&&e.x<=l.x+l.width&&e.y>=l.y&&e.y<=l.y+l.height&&(e.x=Math.round(l.x-l.delta.x+l.width/2),e.y=Math.round(l.y-l.delta.y+l.height/2))}}}elementMoveShape(t,e,n=null){const i=n||t.parent;this.moveShape(t,e,i,{layout:!1,recalcShapePosition:!0},null)}addLaneHandlers(t){t[j.lane.split]=zi,t[j.lane.create]=Ai,t[j.lane.resize]=Ri}addProcessShapeHandlers(t){t[j.shape.shapeCreate]=Ti,t[j.shape.shapeMove]=ki,t[j.shape.shapeResize]=Li,t[j.shape.shapeDelete]=ll}addElementsHandlers(t){super.addElementsHandlers(t),t[j.elements.create]=_i,t[j.elements.move]=Oi}addProcessElementHandlers(t){t[j.element.update]=gn,t[j.element.updateLabel]=Ii}addConnectionHandlers(t){t[j.connection.update]=tl,t[j.connection.reconnect]=dn,t[j.connection.changeDirection]=el}needResetLabelPosition(t,e){return Z.A(t.x)||Z.A(t.y)||u.isTaskElement(e)&&u.isIntersect(e,t)}getFixedLabelPosition(t,e,n){return this.diagramUtils.isConnection(n)?t:super.getFixedLabelPosition(t,e,n)}getHandlers(){const t=super.getHandlers();return this.addLaneHandlers(t),this.addProcessShapeHandlers(t),this.addProcessElementHandlers(t),this.addConnectionHandlers(t),t}connect(t,e,n,i){if(!(t&&e)||e.type===g.boundaryInterruptingEventSignal&&e.parent===t)return;const s=this.canvas.getRootElement();return n=n||{},n.type||this.updateConnectionType(t,e,n),this.createConnection(t,e,n,s,i)}createShape(t,e,n,i=null,s=null){return super.createShape(t,e,n,i,s)}updateConnectionType(t,e,n){}pasteElements(t,e,n){this.fixPosition(t,n),super.pasteElements(t,e,n)}updateConnection(t,e){const n=this.getElement(t);if(n){const i={type:n.type,documentation:n.documentation,connection:n},s=Object.assign(i,e);this.commandStack.execute(j.connection.update,s)}}updateElement(t,e){const n=this.getElement(t),i={type:n.type,markers:n.markers,documentation:n.documentation,element:n};if(n){const s=Object.assign(i,e);this.commandStack.execute(j.element.update,s)}}externalUpdateElement(t,e){const n=Object.assign({externalUpdate:!0},e);this.updateElement(t,n)}updateElementType({id:t,config:e,force:n=!1}){(n||this.rules.allowed(j.element.canUpdateType,{id:t,config:e}))&&this.updateElement(t,e)}addLane(t,e){this.commandStack.execute(j.lane.create,{lane:t,yOffset:e})}splitLane(t){this.commandStack.execute(j.lane.split,{lane:t})}resizeLane(t){this.commandStack.execute(j.lane.resize,t)}changeConnectionDirection(t){this.commandStack.execute(j.connection.changeDirection,{connection:t})}createFeatureContext(){return{canvas:this.canvas,elementRegistry:this.registry,diagramGroups:this.diagramGroups,elements:this.elements}}externalResizeShape(t){const e=this.registry.get(t.id);if(e){this.convertUtils.setShapeAbsolutePosition(e);const{height:n,width:i,x:s,y:l}=e,c={height:n,width:i,x:s,y:l,[t.name]:t.value};super.resizeShape(e,c,{height:0,width:0},{externalUpdate:!0})}}externalMoveShape(t){const e=this.registry.get(t.id);if(e){const n=t.name;this.convertUtils.setShapeAbsolutePosition(e);const i={x:Math.round(n==="rx"?t.value-e[n]:0),y:Math.round(n==="ry"?t.value-e[n]:0)};this.elementMoveShape(e,i)}}externalUpdateWaypoints(t,e){super.updateWaypoints(t,e,{doUpdateLabelPosition:!1})}externalReconnectStart(t,e){this.reconnectStart(t,e,null,{doUpdateLabelPosition:!0,layoutConnection:!1})}externalReconnectEnd(t,e){this.reconnectEnd(t,e,null,{layoutConnection:!1})}reconnectStart(t,e,n,i={}){super.reconnectStart(t,e,n,i)}reconnectEnd(t,e,n,i={}){super.reconnectEnd(t,e,n,i)}updateParent(t){const e=this.registry,n=e.get(t.id),i=e.get(t.value);n&&i&&this.elementMoveShape(n,{x:0,y:0},i)}externalCreateConnection(t){const e=this.registry.get(t.value.source),n=this.registry.get(t.value.target);if(e&&n){const{source:i,target:s,...l}=t.value;this.connect(e,n,l,{})}}createDiagramElement(t,e){if(this.registry.get(t))return;const n=re.A(e[t]),i=this.elements.items.root,{markers:s,parent:l=i.id,caption:c,documentation:p,userTaskType:h}=n,m=n.type!==Ze.subProcess?n.type:u.getSubProcessType(n);let C=this.registry.get(l);C||(this.createDiagramElement(l,e),C=this.registry.get(l)),this.convertUtils.setShapeAbsolutePosition(n,C);const y=this.elements.getConfig(n);if(!y){console.warn(`Draw config for element type ${n.type} not found`);return}const b=n.width||y.width,I=n.height||y.height,P=n.itemName,L=y.order,G={id:t,type:m,userTaskType:h,width:b,itemName:P,height:I,order:L,markers:s,caption:c&&c.toString(),documentation:p&&p.toString(),tooltip:n.tooltip,tooltipConfig:n.tooltipConfig},J=this.getElementPosition(n,y);this.createShape(G,J,C,0,{generateUniqueCaption:!1})}externalRemoveShape(t){const e=this.registry.get(t.id);e&&(u.isLabel(e)&&!u.isEventSubProcessExpanded(e.labelTarget)&&(e.labelTarget.caption=""),super.removeShape(e,{layout:!1}))}recalculateChildrenPosition(t){t.children.slice().forEach(n=>{this.elementMoveShape(n,{x:0,y:0}),this.recalculateChildrenPosition(n)})}recalculateConnection(t){je.A(t.incoming,e=>{this.layoutConnection(e,{endChanged:!0})}),je.A(t.outgoing,e=>{this.layoutConnection(e,{startChanged:!0})})}createStartEventSignal(t){const e=this.elements.items.eventSubProcessExpanded.startEvent,{height:n,width:i}=this.elements.items[e],s={x:Math.round(t.x+20),y:Math.round(t.y+(t.height-n)/2),width:i,height:n};this.createShape({type:e},s,t)}};(0,a.Cg)([ke($s),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object]),(0,a.Sn)("design:returntype",void 0)],Ct.prototype,"createShape",null),(0,a.Cg)([ke(Di),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object,Object,Object]),(0,a.Sn)("design:returntype",void 0)],Ct.prototype,"updateConnectionType",null),Ct=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("elementFactory")),(0,a.Qj)(2,d("commandStack")),(0,a.Qj)(3,d("canvas")),(0,a.Qj)(4,d("elementRegistry")),(0,a.Qj)(5,d("diagramText")),(0,a.Qj)(6,d("elements")),(0,a.Qj)(7,d("rules")),(0,a.Qj)(8,d("groups")),(0,a.Qj)(9,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Y,Object,xe,M])],Ct);let me=class extends W{constructor(t,e,n,i,s,l){super(t,s),this.eventBus=t,this.elementRegistry=e,this.diagramGroups=n,this.elements=i,this.canElementMoveFactory=l}canConnectTo(t){return![this.elements.items.root.type,this.elements.items.label.type,...this.diagramGroups.groups.participants.elements,...this.diagramGroups.groups.flow.elements,...this.diagramGroups.groups.association.elements].includes(t.type)}_getCopyRootElement(t,e){return t&&e.includes(t.parent)?this._getCopyRootElement(t.parent,e):t}_isConnectToParent(t,e){return t.parent===e||t===e.parent}_canConnectToStartEvent(t){return!t||!u.isStartEvent(t)}canConnectToEndEvent(t,e){return!u.isEndEvent(t)||u.isEndEvent(t)&&u.isAnnotationElement(e)}_canConnectToAnnotation(t,e){return!t||!e||!(u.isAnnotationElement(e)&&u.isAnnotationElement(t))}_canCreateAssociation(t){return u.isAnnotationElement(t)||u.isDataElement(t)}canConnectToParticipants(t,e){return!u.isParticipants(e)&&!u.isParticipants(t)}_canConnectToEventSubProcess(t,e,n={targetParent:null}){if(!t||!e||this._canCreateAssociation(t)||this._canCreateAssociation(e))return!0;if(u.isEventSubProcessExpanded(t)&&u.isEventSubProcessExpanded(e))return!1;const i=u.isBoundaryEvent(t)?t.parent.parent:t.parent,s=n.targetParent;return s&&(u.isEventSubProcessExpanded(i)&&!u.isEventSubProcessExpanded(s)||!u.isEventSubProcessExpanded(i)&&u.isEventSubProcessExpanded(s))?!1:!u.isEventSubProcessExpanded(t)&&!u.isEventSubProcessExpanded(e)?!i||!e.parent||!u.isEventSubProcessExpanded(i)&&!u.isEventSubProcessExpanded(e.parent)?!0:i.id===e.parent.id:!1}_canConnectToDataObject(t,e){return!((u.isDataElement(t)||u.isDataElement(e))&&(u.isGateway(t)||u.isGateway(e)||u.isEventElement(t)||u.isEventElement(e))||u.isDataElement(t)&&u.isDataElement(e))}canDeleteElement(t,e){return!(t.parent&&u.isEventSubProcessExpanded(t.parent)&&u.isStartEvent(t)&&!e.find(n=>n===t.parent))}init(){super.init(),super.addRule("canElementDock",this.canElementDock.bind(this))}canConnectionCreate(t){const e=t.source,n=t.target;return super.canConnectionCreate(t)&&e!==n&&!this._isConnectToParent(e,n)&&this.canConnectToParticipants(e,n)&&this.canConnectTo(n)&&this.canConnectTo(e)&&this._canConnectToAnnotation(e,n)&&this._canConnectToDataObject(e,n)&&this._canConnectToEventSubProcess(e,n,t.hints)&&this._canConnectToStartEvent(n)}canReconnectStart(t){const e=t.source,n=t.connection.target;return e!==n&&!this._isConnectToParent(e,n)&&this.canConnectTo(e)&&this.canConnectTo(n)&&this._canConnectToAnnotation(e,n)&&this._canConnectToDataObject(e,n)&&this._canConnectToEventSubProcess(e,n)&&this._canConnectToStartEvent(n)&&this.canConnectToEndEvent(e,n)}canReconnectEnd(t){const e=t.connection.source,n=t.target;return n!==e&&!this._isConnectToParent(e,n)&&this.canConnectTo(e)&&this.canConnectTo(n)&&this._canConnectToAnnotation(e,n)&&this._canConnectToDataObject(e,n)&&this._canConnectToEventSubProcess(e,n)&&this._canConnectToStartEvent(n)}canElementMove(t){const e=new yt,n={delta:t.delta,position:t.position,shape:null,shapes:t.shapes||t.elements||[t.shape],target:t.target,splitConnectionHelper:e};return n.shapes.every(s=>(n.shape=s,this.canElementMoveFactory.getFeature(n,this.elementRegistry).canMove()))}canElementResize(t){return u.isContainer(t.shape)||u.isAnnotationElement(t.shape)}canElementCopy(t){const e=this._getCopyRootElement(t.element,t.elements);return!u.isLane(e)}canElementsDelete(t){const e=t.elements;return e.every(n=>this.canDeleteElement(n,e))}canElementDock(t){const e=t.target,n=t.shape;return!!(e&&u.isTaskElement(e)&&!u.isEventSubProcessExpanded(e)&&(n.type===g.intermediateThrowEvent&&n.parent===void 0||u.isBoundaryEvent(n)))}};(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object]),(0,a.Sn)("design:returntype",void 0)],me.prototype,"canConnectionCreate",null),(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object]),(0,a.Sn)("design:returntype",void 0)],me.prototype,"canReconnectStart",null),(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object]),(0,a.Sn)("design:returntype",void 0)],me.prototype,"canReconnectEnd",null),(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object]),(0,a.Sn)("design:returntype",void 0)],me.prototype,"canElementMove",null),(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object]),(0,a.Sn)("design:returntype",void 0)],me.prototype,"canElementResize",null),(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object]),(0,a.Sn)("design:returntype",void 0)],me.prototype,"canElementCopy",null),(0,a.Cg)([U(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object]),(0,a.Sn)("design:returntype",Boolean)],me.prototype,"canElementsDelete",null),me=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("elementRegistry")),(0,a.Qj)(2,d("groups")),(0,a.Qj)(3,d("elements")),(0,a.Qj)(4,d("config")),(0,a.Qj)(5,d("canElementMoveFactory")),(0,a.Sn)("design:paramtypes",[Object,Object,xe,Y,Object,Object])],me);const fl="assets/images/icon_tools_task.svg",yl="assets/images/icon_tools_gateway.svg",Cl="assets/images/icon_tools_end_event.svg",xl="assets/images/icon_tools_intermediate_event.svg";let Bi=class extends lt{constructor(t,e){super(t,e),this.elements=t,this.config=e}getAddItems(){const t=[{image:fl,type:g.task},{image:xl,type:g.intermediateThrowEvent},{image:yl,type:g.exclusiveGateway},{image:Cl,type:g.endEvent}];return t.forEach(e=>{const n=this.elements.getConfig(e);n&&(e.title=this.config.localizableStrings.get(n.caption))}),[...super.getAddItems(),...t]}};Bi=(0,a.Cg)([(0,a.Qj)(0,d("elements")),(0,a.Qj)(1,d("config")),(0,a.Sn)("design:paramtypes",[Y,Object])],Bi),(0,f.ngxTranslateExtract)("diagram.paletteProvider.flow"),(0,f.ngxTranslateExtract)("diagram.paletteProvider.artefacts"),(0,f.ngxTranslateExtract)("diagram.paletteProvider.lassoTool"),(0,f.ngxTranslateExtract)("diagram.paletteProvider.spaceTool");class bl extends Zt{init(){super.init(),this.featureProvider.getFeatureServiceValues(t=>{this.featureSubProcessExpanded=t.featureSubProcessExpanded,this.featureSubProcessExpanded&&this.canvas.getContainer()&&this.palette._update()})}getCreateMenuEntries(t){const e=super.getCreateMenuEntries(t);if(!this.featureSubProcessExpanded){const n=e.findIndex(i=>i.id===g.subProcessExpanded);e.splice(n,1)}return e}getPaletteEntries(){const t=super.getPaletteEntries();return this.featureSubProcessExpanded||delete t["create-subProcessExpanded"],t}}(0,f.ngxTranslateExtract)("diagram.replaceMenuProvider.reverseDirection");let Gi=class extends tn{constructor(t,e,n,i,s,l,c){super(t),this.popupMenu=t,this.modeling=e,this.config=n,this.featureProvider=i,this.diagramGroups=s,this.elements=l,this.diagramUtils=c,this.featureSubProcessExpanded=!1,this.localizableStrings=n.localizableStrings,i.getFeatureServiceValues(p=>{this.featureSubProcessExpanded=p.featureSubProcessExpanded})}addEntry(t,e,n){n.forEach(i=>{if(i.type===g.subProcessExpanded&&!this.featureSubProcessExpanded||i.showInReplaceMenu===!1)return;const s=this.getEntryConfig(i,e);t[s.id]=s})}replaceAction(t,e){const{userTaskType:n,markers:i}=e;let{type:s}=e;t.waypoints?(s===g.defaultConnection&&this.removeDefaultConnection(t.source),this.modeling.updateConnection(t,{type:s})):(u.isEventSubProcessExpanded(t.parent)&&s===g.intermediateThrowEvent&&(s=g.intermediateThrowEventSignal),this.modeling.updateElementType({id:t.id,config:{type:s,markers:i,userTaskType:n}})),this.popupMenu.close()}getGroupTypesExceptElement(t,e){let n;switch(!0){case t==="intermediateThrowEvent":case t==="intermediateCatchEvent":n=[...this.diagramGroups.groups.intermediateThrowEvent.elements,...this.diagramGroups.groups.intermediateCatchEvent.elements];break;default:n=[...this.diagramGroups.groups[t].elements];break}return this.diagramGroups.groups[t].canBeTransformed&&(n=[...this.diagramGroups.groups[t].canBeTransformed].concat(n)),n=this.filterAllowTypes(e,n),n=n.filter(i=>this.elements.items[i]!==void 0),n.map(i=>this.elements.items[i])}getFlowExcludeTypes(t){const e=[];return Mi(t.source)&&e.push(g.connection),Pi(t.source)&&(e.push(g.defaultConnection),e.push(g.conditionalConnection)),e}filterAllowTypes(t,e){const n=this.getExcludeTypes(t);return e.filter(i=>!n.includes(i))}removeDefaultConnection(t){t.outgoing.forEach(e=>{if(e.type===g.defaultConnection){const n=Zs(t)||g.connection;this.modeling.updateConnection(e,{type:n})}})}updateMarkersAction(t,e,n){this.popupMenu.close();const i=t.type,s=Rn.A(t.markers);t.markers[n]===e?delete s[n]:s[n]=e,this.replaceAction(t,{type:i,markers:s})}_isMarkerActive(t,e,n){return t.markers[n]===e}getMarkers(t){const e=[],n=u.getMarkerGroupsForElement(t,this.elements);return t.markers=t.markers||{},n.forEach(i=>{const s=i.type;i.markers.forEach(l=>{const c=l.type,p=this._isMarkerActive(t,c,s);e.push({action:this.updateMarkersAction.bind(this,t,c,s),id:c,imageUrl:p?l.selectedImage:l.largeImage,title:this.localizableStrings.get(l.caption),active:p})})}),e}addSpecialEntries(t,e){if(e.type===g.associationOneWay){const n={action:()=>{this.modeling.changeConnectionDirection(e)},id:"changeAssociationDirection",label:this.localizableStrings.get("replaceMenuProvider.reverseDirection"),imageUrl:"assets/images/Association/ReverseDirection.svg"};t[n.id]=n}}getElementGroup(t){const e=this.diagramGroups;return Object.keys(e.groups).find(n=>e.groups[n].elements&&e.groups[n].elements.includes(t))}getExcludeTypes(t){const n=[t.userTaskType||t.type];return u.isEventSubProcessExpanded(t.parent)?(n.push(t.parent.type),u.isStartEvent(t)&&n.push(g.startEvent,g.endEvent,g.intermediateThrowEvent),(u.isIntermediateThrowEvent(t)||u.isIntermediateCatchEvent(t))&&n.push(g.startEvent,g.intermediateThrowEvent),u.isEndEvent(t)&&n.push(g.startEvent)):n.push(...this.diagramGroups.eventSubProcess.startEvent.elements),n.concat(this.getFlowExcludeTypes(t))}getEntryConfig(t,e){const n=this.localizableStrings.get(t.caption),{userTaskType:i,type:s}=t,l=e.markers;return{action:()=>this.replaceAction(e,{type:s,userTaskType:i,markers:l}),id:t.userTaskType||t.type,imageUrl:t.smallImage,label:n}}getPopupMenuEntries(t){if(this.diagramUtils.isFlow(t)&&t.source&&u.isEventElement(t.source))return{};const e={},n=this.getElementGroup(t.type);if(n){const i=this.getGroupTypesExceptElement(n,t);this.addEntry(e,t,i)}return this.addSpecialEntries(e,t),e}getHeaderEntries(t){return this.getMarkers(t)}};Gi=(0,a.Cg)([(0,a.Qj)(0,d("popupMenu")),(0,a.Qj)(1,d("modeling")),(0,a.Qj)(2,d("config")),(0,a.Qj)(3,d("featureProvider")),(0,a.Qj)(4,d("groups")),(0,a.Qj)(5,d("elements")),(0,a.Qj)(6,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Ps,xe,Y,M])],Gi);function El(r,t,e){return e.type===g.connection}function jl(r,t,e){return e.type===g.conditionalConnection}function Sl(r,t,e){return e.type===g.defaultConnection}function wl(r,t,e){return e.type===g.association}function Il(r,t,e){return e.type===g.associationOneWay}function Ml(r,t,e){return e.type===g.associationTwoWay}var Se=function(r){return r.Association="association",r.AssociationEndMarker="association-end-marker",r.AssociationOneWay="association-one-way",r.AssociationStartMarker="association-start-marker",r.AssociationTwoWay="association-two-way",r.ConditionalConnection="conditional-connection",r.Connection="connection",r.ConnectionEndMarker="connection-end-marker",r.DefaultConnection="default-connection",r}(Se||{});const $={SequenceFlow:{Fill:"none",MarkerShape:"M-10,3 L1,0 L-10,-3",MarkerfillOpacity:1,StrokeLinejoin:"round",StrokeWidth:.9},Association:{Fill:"none",StrokeDasharray:"1, 5",StrokeLinecap:"round",StrokeLinejoin:"round",StrokeWidth:2,MarkerShape:"M-10,3 L1,0 L-10,-3"},DefaultConnection:{StartMarkerShape:"M-11,-3 L-6,3 Z"},ConditionalConnection:{StartMarkerShape:"M-10,0 L-5.5,3 L-1,0 L-5.5,-3 Z"}};class Xs extends He{getConnectionAttributes(t){return{class:Se.Association,fill:$.Association.Fill,stroke:Ce.connectionStrokeColor,strokeDasharray:$.Association.StrokeDasharray,strokeLinecap:$.Association.StrokeLinecap,strokeLinejoin:$.Association.StrokeLinejoin,strokeWidth:$.Association.StrokeWidth}}get endMarker(){return null}}class qs extends Xs{getConnectionAttributes(t){const e=super.getConnectionAttributes(t);return e.class=Se.AssociationOneWay,e}get endMarker(){const t=(0,x.vt)("path");return(0,x.CF)(t,{d:$.Association.MarkerShape,fill:$.Association.Fill,stroke:Ce.arrowStrokeColor,strokeLinejoin:$.Association.StrokeLinejoin,strokeWidth:$.Association.StrokeWidth,class:Se.AssociationEndMarker}),t}}class Pl extends qs{getConnectionAttributes(t){const e=super.getConnectionAttributes(t);return e.class=Se.AssociationTwoWay,e}startMarker(){const t=(0,x.vt)("path");return(0,x.CF)(t,{d:$.Association.MarkerShape,fill:$.Association.Fill,stroke:Ce.arrowStrokeColor,strokeLinejoin:$.Association.StrokeLinejoin,strokeWidth:$.Association.StrokeWidth,class:Se.AssociationStartMarker}),t}}class Dl extends He{startMarker(t){const e=t.source;if(e&&[g.inclusiveGateway,g.exclusiveGateway].includes(e.type))return null;const n=(0,x.vt)("path");return(0,x.CF)(n,{d:"M-10,0 L-5.5,3 L-1,0 L-5.5,-3 Z",fill:Ce.connectionMarkerFillColor,stroke:Ce.connectionMarkerStrokeColor,strokeLinejoin:"round",strokeWidth:.9,class:Se.ConditionalConnection}),n}}class Tl extends He{startMarker(){const t=(0,x.vt)("path");return(0,x.CF)(t,{d:$.DefaultConnection.StartMarkerShape,stroke:Ce.connectionMarkerStrokeColor,strokeLinejoin:$.SequenceFlow.StrokeLinejoin,strokeWidth:$.SequenceFlow.StrokeWidth,class:Se.DefaultConnection}),t}}class eo{drawConnection(t,e,n){}}(0,a.Cg)([H(El,He),H(jl,Dl),H(Sl,Tl),H(wl,Xs),H(Il,qs),H(Ml,Pl),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object,Object,Object]),(0,a.Sn)("design:returntype",Object)],eo.prototype,"drawConnection",null);class to extends Ve{drawConnection(t,e){return super.drawConnection(t,e)}}(0,a.Cg)([ke(eo,fe.instead),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object,Object]),(0,a.Sn)("design:returntype",void 0)],to.prototype,"drawConnection",null);class kl extends ue{getAnnotationShape(t){const e=(0,x.vt)("path");return(0,x.CF)(e,{d:`M16,5 H5,5 V5,${(t.previewHeight||t.height)-da} H16,5`,fill:"none",stroke:"#54657D",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1}),e.setAttributeNS(null,"type",t.type),e}draw(t,e){super.draw(t,e);const n=this.elements.getConfig(e);if(e.caption){const s=n.label,l={...this.diagramText.style,...s.editStyle},c={box:{height:e.height,width:e.width+3,x:e.x,y:e.y},...s.style,style:{...l}};this.createText(t,e.caption,c)}const i=this.getAnnotationShape(e);return(0,x.BC)(t,i),i}}var Ol=v(12619);class no extends ue{draw(t,e){if(super.draw(t,e),e.caption){const i=this.elements.getConfig(e),s={box:{height:i.headerWidth,width:e.height},...i.label.style},l=this.createText(t,e.caption,s);(0,de.pd)(l,0,e.height,270)}return this.drawRect(t,e.width,e.height,0,0,{fill:e.color||"none",stroke:"#BEBEBE"})}}class Ll extends no{drawLine(t,e,n){n=this.styles.computeStyle(n,["no-fill"],{fill:"none",stroke:"#8ECB60",strokeWidth:1});const i=(0,Ol.RJ)(e,n);return(0,x.BC)(t,i),i}draw(t,e){const n=super.draw(t,e);return this.drawLine(t,[{x:30,y:0},{x:30,y:e.height}],{stroke:"#BEBEBE"}),this.drawLine(t,[{x:0,y:-.5},{x:0,y:e.height+.5}],{stroke:"#8ECB60",strokeWidth:4}),n}}let Fi=class extends We{constructor(t,e,n,i,s,l){super(t,e),this.renderingLabel=t,this.renderingShape=e,this.renderingLane=n,this.renderingLaneSet=i,this.renderingAnnotation=s,this.renderingSubProcessExpanded=l}create(t){switch(t){case g.lane:return this.renderingLane;case g.laneSet:return this.renderingLaneSet;case g.label:return this.renderingLabel;case g.textAnnotation:return this.renderingAnnotation;case g.subProcessExpanded:case g.eventSubProcessExpanded:return this.renderingSubProcessExpanded;default:return this.renderingShape}}};Fi=(0,a.Cg)([(0,a.Qj)(0,d("renderingLabel")),(0,a.Qj)(1,d("renderingShape")),(0,a.Qj)(2,d("renderingLane")),(0,a.Qj)(3,d("renderingLaneSet")),(0,a.Qj)(4,d("renderingAnnotation")),(0,a.Qj)(5,d("renderingSubProcessExpanded")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object,Object])],Fi);var io;let Qi=class extends ks{constructor(t,e,n,i,s){super(t,e,n,s),this.elements=t,this.styles=e,this.diagramText=n,this.diagramMarkers=i,this.eventBus=s,this.markersConfig=this.diagramMarkers.getMarkers()}appendMarkers(t,e,n){const c=e.height-16,p=Object.values(n).filter(m=>!(0,Pn.A)(m));p.sort((m,C)=>this.markersConfig[m].order-this.markersConfig[C].order);let h=0;e.width&&(h=(e.width-(12*p.length+(2*p.length-2)))/2,h=Math.floor(h)),p.forEach(m=>{const C=(0,x.vt)("image");(0,x.CF)(C,{height:12,width:12,x:h,y:c}),h+=14,C.setAttributeNS(null,"type",this.markersConfig[m].type),C.setAttributeNS("http://www.w3.org/1999/xlink","href",this.markersConfig[m].smallImage),(0,x.BC)(t,C)})}draw(t,e){const n=super.draw(t,e),i={...e.markers};if(u.isTaskElement(e)){const l=[g.subProcessCollapsed,g.callActivity].includes(e.type)?this.markersConfig.Collapsed.type:null;Object.assign(i,{IsCollapsed:l})}if(Object.keys(i).length>0){const s=this.getSizeConfig(e);this.appendMarkers(t,s,i)}return n}};Qi=(0,a.Cg)([(0,a.Qj)(0,d("elements")),(0,a.Qj)(1,d("styles")),(0,a.Qj)(2,d("diagramText")),(0,a.Qj)(3,d("diagramMarkers")),(0,a.Qj)(4,d("eventBus")),(0,a.Sn)("design:paramtypes",[Object,typeof(io=typeof he.A<"u"&&he.A)=="function"?io:Object,Object,Object,Object])],Qi);class Al extends ue{draw(t,e){super.draw(t,e);const n=this.elements.getConfig(e);if(e.caption){const c={box:{height:e.height,width:e.width+3,x:e.x,y:e.y},...n.label.style,style:{...this.diagramText.style,...n.label.editStyle}};this.createText(t,e.caption,c)}const i=n.cornerRadius||0;return this.drawRect(t,e.width,e.height,i,0,{fill:n.fill||"none",stroke:n.stroke,"stroke-dasharray":n.strokeDasharray||"0","stroke-linecap":n.strokeLinecap||"initial"})}}class xt{constructor(t){this.context=t}canMove(){const t=this.context.target,e=this.context.shapes,n=this.context.splitConnectionHelper,i=new u;return!t||u.isRoot(t)||u.isContainer(t)||u.isLabel(t)||i.isFlow(t)&&n.canSplit(e)}}class Rl{constructor(t){this._context=t}canMove(){const{target:t,shapes:e}=this._context;return t===void 0||!e.some(n=>n.parent!==t)}}class Ui{constructor(t,e){this.context=t,this._elementRegistry=e}isElementHasValidPosition(){const{delta:t,position:e,shapes:n,shape:i}=this.context;let s=[],l,c,p,h;if(i.parent){const y=t&&t.x||0,b=t&&t.y||0,I=i.x||Math.round(e.x-i.width/2),P=i.y||Math.round(e.y-i.height/2);p=I+i.width+y,h=P+i.height+b,l=I+y,c=P+b}else{const y=(0,ve.U7)(n,!1);l=Math.round(i.x-y.x-y.width/2+e.x),c=Math.round(i.y-y.y-y.height/2+e.y),p=l+i.width,h=c+i.height}const m=u.getSelfAndAllChildren(i),C=new u;return s=this._elementRegistry.filter(y=>!C.isFlow(y)&&!u.isLabel(y)&&!m.some(b=>b===y)),n.forEach(y=>{s=s.filter(b=>!u.getSelfAndAllChildren(y).some(I=>I===b))}),s=s.filter(y=>{const b=y.x+y.width,I=y.y+y.height;return p>y.x&&b>l&&h>y.y&&I>c}),u.isLaneSet(i)||u.isLane(i)||(s=s.filter(y=>!u.isLane(y)&&!u.isLaneSet(y))),s.length===0}canMove(){const{target:t,delta:e,position:n}=this.context;if(!n&&!e)return!0;const i=new u;return t&&!u.isLabel(t)&&!i.isConnection(t)&&!u.isContainer(t)&&!u.isRoot(t)?!1:this.isElementHasValidPosition()}}class zl extends Ui{canMove(){const{target:t}=this.context,e=new u;return t&&(u.isEventSubProcessExpanded(t)||e.isFlow(t))?!1:super.canMove()}}class _l extends xt{constructor(t){super(t),this.context=t}canMove(){const t=this.context.target,e=this.context.shape;return t&&u.isTaskElement(t)&&e&&e.parent===void 0||super.canMove()}}class Nl extends xt{constructor(t){super(t),this.context=t}canMove(){const t=this.context.target;return!t||!u.isFlowNode(t)||u.isContainer(t)}}class Bl{constructor(t){this._context=t}canMove(){const{shape:t,shapes:e}=this._context,i=new u().getPool(t);return e.includes(i)}}class Gl extends Ui{canMove(){const{target:t}=this.context;return t&&(u.isLane(t)||u.isLaneSet(t))?!1:super.canMove()}}class Fl extends xt{constructor(t){super(t),this.context=t}isMoveFromEventSubProcess(){const t=this.context.target,n=this.context.shape.parent;return t&&n&&u.isEventSubProcessExpanded(n)&&!(u.isEventSubProcessExpanded(t)&&n===t)}isMoveToEventSubProcess(){const t=this.context.target,n=this.context.shape.parent;return!(t&&u.isEventSubProcessExpanded(t)&&n!==t)}canMove(){return!this.isMoveFromEventSubProcess()&&this.isMoveToEventSubProcess()&&super.canMove()}}class Ql{getFeature(t,e){const n=t.shape;switch(t.shapes=t.shapes||[n],!0){case u.isStartEvent(n):return new Fl(t);case u.isIntermediateThrowEvent(n):return new _l(t);case u.isLaneSet(n):return new Gl(t,e);case u.isLane(n):return new Bl(t);case u.isEventSubProcessExpanded(n):return new zl(t,e);case u.isContainer(n):return new Ui(t,e);case u.isLabel(n):return new Nl(t);case u.isBoundaryEvent(n):return new Rl(t);default:return new xt(t)}}}class id extends xt{constructor(t){super(t),this.context=t}canMove(){const t=this.context.target,e=this.context.shape,n=this.context.shapes,i=new u;return t&&i.isFlow(t)&&n&&n.length===1&&u.hasNoConnections(e)?!0:super.canMove()}}var Ul=v(40133);let Hi=class extends Xt{constructor(t,e,n,i,s,l,c,p){super(t,e,n,i,s,l,c,p),this.elements=c,this.diagramUtils=p}_getComputeMinAllowedDelta(t,e){const n=e==="e";if(u.isLaneSet(t)){const i=t.children.some(s=>u.isLane(s));return n||!i}return u.isLane(t)&&!n}canResizeShape(t,e,n){return!!(n==="x"&&u.isLane(t)&&this.diagramUtils.getPool(t).x<e&&t.x>e)}getMinAllowedDelta(t,e,n){let i=null;const s=e==="e";return t.forEach(l=>{if(this._getComputeMinAllowedDelta(l,e)){const c=u.getParticipantMinResizeBox(l,e,n,this.elements),p=s?c.width-l.width:c.height-l.height;(p>i||i===null)&&(i=p)}}),i}};Hi=(0,a.Cg)([(0,a.Qj)(0,d("eventBus")),(0,a.Qj)(1,d("dragging")),(0,a.Qj)(2,d("canvas")),(0,a.Qj)(3,d("modeling")),(0,a.Qj)(4,d("rules")),(0,a.Qj)(5,d("toolManager")),(0,a.Qj)(6,d("elements")),(0,a.Qj)(7,d("diagramUtils")),(0,a.Sn)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Y,u])],Hi);const Wi={..._e,copyPaste:["type",ml],diagramRules:["type",me],orderingProvider:["type",xi],layouter:["type",Us],snapping:["type",bi],splitConnectionHelper:["type",yt],labelEdit:["type",Si],directEditing:["type",wi],diagramText:["type",Nr],diagramLoader:["type",vl],deleteLane:["type",Ci],outlineFactory:["type",pn],validationOutlineFactory:["type",ul],validationOutline:["type",Jn],modeling:["type",Ct],elements:["type",Y],groups:["type",xe],paletteElements:["type",fi],paletteProvider:["type",bl],setupMenuProvider:["type",Gi],renderingShapeFactory:["type",Fi],renderingShape:["type",Qi],renderingLane:["type",no],renderingLaneSet:["type",Ll],renderingAnnotation:["type",kl],renderingSubProcessExpanded:["type",Al],diagramRenderer:["type",to],contextPadProvider:["type",ji],elementSizeUtils:["type",Ei],elementToolsConfig:["type",Bi],canElementMoveFactory:["type",Ql],diagramEventHandlerController:["type",Ot],diagramMarkers:["type",Ni],diagramUtils:["type",u],spaceTool:["type",Hi]};Wi.__depends__=[..._e.__depends__,Ul.A],Wi.__init__=[..._e.__init__,"deleteLane","orderingProvider","snapping","validationOutlineFactory","validationOutline","groups","elementSizeUtils"];const Hl=Wi;class sd extends null{}let Wl=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=o.\u0275\u0275defineNgModule({type:r})}static{this.\u0275inj=o.\u0275\u0275defineInjector({providers:[le,{provide:ot,useValue:Hl}],imports:[mt,A.CommonModule,R.h.forRoot()]})}}return r})();(function(){(typeof ngJitMode>"u"||ngJitMode)&&o.\u0275\u0275setNgModuleScope(Wl,{imports:[mt,A.CommonModule,R.h],exports:[Tt]})})();class od extends go{constructor(){super(...arguments),this.elements={},this.connections={},this.labels={},this.groups={}}}let hn=(()=>{class r extends Tt{constructor(e){super(e),this.initScroll=q.getSpacing("scroll")}ngOnInit(){this.loaded.pipe((0,Dt.$)()).subscribe(()=>{const e=this.diagramDataService.data;if(!e.rootElementId)return;const n=Object.values(e.elements).find(s=>s.recordId===e.rootElementId);this.get("modeling").positionViewboxRelativeToElement(n)})}static{this.\u0275fac=function(n){return new(n||r)(o.\u0275\u0275directiveInject(o.Injector))}}static{this.\u0275cmp=o.\u0275\u0275defineComponent({type:r,selectors:[["crt-relationship-diagram"]],features:[o.\u0275\u0275InheritDefinitionFeature],decls:2,vars:0,consts:[["diagramContainer",""],[1,"diagram-container"]],template:function(n,i){n&1&&o.\u0275\u0275element(0,"div",1,0)},styles:[`.diagram-container .relationship-container .djs-visual .foreign-text{margin-right:20px}.diagram-container .relationship-item .djs-visual .foreign-text{margin-right:10px}.diagram-container .relationship-item .djs-visual image,.diagram-container .relationship-container .djs-visual image{clip-path:inset(0% round 8px)}.diagram-container .relationship-item .djs-visual .foreign-text,.diagram-container .relationship-container .djs-visual .foreign-text{text-align:left;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.diagram-container .relationship-item .djs-visual .sub-caption .foreign-text,.diagram-container .relationship-container .djs-visual .sub-caption .foreign-text{color:#757575!important;font-family:var(--crt-caption-font-family);font-size:var(--crt-caption-font-size);line-height:var(--crt-caption-line-height);font-weight:var(--crt-caption-font-weight);letter-spacing:var(--crt-caption-letter-spacing);text-transform:var(--crt-caption-text-transform);-webkit-font-smoothing:antialiased}.diagram-container .relationship-item .djs-visual .caption .foreign-text,.diagram-container .relationship-container .djs-visual .caption .foreign-text{color:#004fd6!important;font-family:var(--crt-body-2-font-family);font-size:var(--crt-body-2-font-size);line-height:var(--crt-body-2-line-height);font-weight:var(--crt-body-2-font-weight);letter-spacing:var(--crt-body-2-letter-spacing);text-transform:var(--crt-body-2-text-transform);-webkit-font-smoothing:antialiased}.diagram-container .relationship-item .djs-visual .info .foreign-text-container .foreign-text,.diagram-container .relationship-container .djs-visual .info .foreign-text-container .foreign-text{color:#757575!important;font-size:10px;margin-right:0}.diagram-container .relationship-item.no-access .caption .foreign-text,.diagram-container .relationship-container.no-access .caption .foreign-text{color:#181818!important}.diagram-container .relationship-item.hover:not(.selected) .djs-outline,.diagram-container .relationship-container.hover:not(.selected) .djs-outline{stroke-width:1px!important}.diagram-container .relationship-item .lock-image,.diagram-container .relationship-container .lock-image{display:none}.diagram-container .relationship-item.hover .lock-image,.diagram-container .relationship-item.selected .lock-image,.diagram-container .relationship-container.hover .lock-image,.diagram-container .relationship-container.selected .lock-image{display:block}.diagram-container .relationship-item .group-caption .foreign-text-container .foreign-text,.diagram-container .relationship-container .group-caption .foreign-text-container .foreign-text{color:#fff!important;text-align:center;font-size:10px;height:100%;padding-top:1px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.diagram-container .relationship-item.show-groups .group-container,.diagram-container .relationship-container.show-groups .group-container{visibility:visible}.diagram-container .relationship-item.show-groups .group-container .group-item.has-item-comment,.diagram-container .relationship-container.show-groups .group-container .group-item.has-item-comment{cursor:pointer}.diagram-container .relationship-item.fade-item .djs-hit,.diagram-container .relationship-container.fade-item .djs-hit{fill:#ffffffa6!important}.diagram-container .relationship-item .djs-outline,.diagram-container .relationship-container .djs-outline{stroke:#006ce0!important}.diagram-container .relationship-item .group-container,.diagram-container .relationship-container .group-container{visibility:hidden}.diagram-container .relationship-item .toggle-container,.diagram-container .relationship-container .toggle-container,.diagram-container .relationship-item .show-all-group-caption,.diagram-container .relationship-container .show-all-group-caption{cursor:pointer}.diagram-container .relationship-item .show-all-group-caption .foreign-text-container .foreign-text,.diagram-container .relationship-container .show-all-group-caption .foreign-text-container .foreign-text{text-align:center;font-size:9px;height:100%;line-height:18px}.diagram-container .djs-bendpoints .djs-segment-dragger.horizontal .djs-hit,.diagram-container .djs-bendpoints .djs-segment-dragger.vertical .djs-hit{cursor:default}.diagram-container .djs-bendpoints .djs-segment-dragger.horizontal .djs-visual,.diagram-container .djs-bendpoints .djs-segment-dragger.vertical .djs-visual{visibility:hidden}.diagram-container .djs-diagram-popup{position:absolute;visibility:hidden;background:#fff 0% 0% no-repeat padding-box;box-shadow:0 3px 6px #00000029;border-radius:4px;opacity:.92;max-height:230px;overflow-y:auto;padding:8px}.diagram-container .additional-group-container:first-of-type{padding-top:0}.diagram-container .additional-group-container{font-size:11px;letter-spacing:0px;opacity:1;text-align:left;padding:4.5px 0;line-height:15px}.diagram-container .additional-group-container .additional-group-container-header{display:flex;align-items:center}.diagram-container .additional-group-container .additional-group-container-header .additional-group-name{color:#757575;padding-left:5px;text-align:left}.diagram-container .additional-group-container .additional-group-container-header .additional-group-name.has-comment{color:#006ce0}.diagram-container .additional-group-container .additional-group-container-header .comment-icon-gray{margin-left:4px;width:14px;height:14px;background:transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAALZJREFUOE9jZKAQMFKon4HaBvxnDA1dzYTPVatXh/5jYGD8D1OD4oL48rkHGf4zWeMz4D/D/yOLupIcsBqQUD7//4LORLzeQleDoniYGPD1HjcLLIBQQxwSQ9xKX/8ghxNqLJTN38PAwIAIYUaGgwwMDLMXdCauiCubd4CRgdGGgYHhwMKuRBessYAt+uLL5i1jYGTgYGRgDMQWQ0SlxISy+QH/GRmzF3YmuKJbQpQB+BLWwBsAAB0qUBHT9fFYAAAAAElFTkSuQmCC) 0% 0% no-repeat padding-box;opacity:1}.diagram-container .additional-group-container .additional-group-comment{padding-top:4px;font-size:13px;color:#181818}.diagram-container .group-item-comment{width:262px}.diagram-container .group-item-comment .circle{margin-right:5px}.diagram-container .group-item-comment .caption{color:#757575;margin:0;font-size:11px;font-weight:400}.diagram-container .group-item-comment .item-comment{margin-top:4px;margin-bottom:0;font-size:13px;line-height:15px;padding-right:8px}.diagram-container .circle{box-sizing:border-box;display:inline-block;border-radius:50%;height:8px;width:8px}.diagram-container .djs-popup.add .djs-popup-header{flex-direction:column;width:auto;border-bottom:none}.diagram-container .djs-popup.add .djs-popup-header .entry{margin-left:0}.diagram-container .djs-popup.add .djs-popup-header .entry.add-item-button-tool{width:100%}.diagram-container .djs-element.djs-connection.hover path.connection{stroke-width:2!important}.diagram-container .djs-element.djs-connection.selected path.connection{stroke-width:3!important}.diagram-container .djs-element.label>.djs-hit-all{pointer-events:none}.diagram-container .djs-connection~.djs-children .label .foreign-text{color:#54657d!important}.diagram-container .djs-connection.selected~.djs-children .label .foreign-text{color:#1186d8!important}.diagram-container .djs-element.djs-connection.highlight path.connection{stroke-width:2!important}
`,`.djs-outline{fill:none;visibility:hidden}.djs-element.hover .djs-outline,.djs-element.selected .djs-outline{visibility:visible;shape-rendering:crispEdges;stroke-dasharray:3,3}.djs-element.selected .djs-outline{stroke:#88f;stroke-width:1px}.djs-element.hover .djs-outline{stroke:#f88;stroke-width:1px}svg.drop-not-ok{background:#f9dee5!important}.djs-connection.connect-ok .djs-visual>:nth-child(1),.djs-connection.drop-ok .djs-visual>:nth-child(1){stroke:#90dd5f!important}.djs-connection.connect-not-ok .djs-visual>:nth-child(1),.djs-connection.drop-not-ok .djs-visual>:nth-child(1){stroke:#e56283!important}.drop-not-ok,.connect-not-ok{cursor:not-allowed}.djs-element.attach-ok .djs-visual>:nth-child(1){stroke-width:5px!important;stroke:#ff7400b3!important}.djs-frame.connect-not-ok .djs-visual>:nth-child(1),.djs-frame.drop-not-ok .djs-visual>:nth-child(1){stroke-width:3px!important;stroke:#e56283!important;fill:none!important}.djs-lasso-overlay{fill:#ff7400;fill-opacity:.1;stroke-dasharray:5 1 3 1;stroke:#ff7400;shape-rendering:crispEdges;pointer-events:none}.djs-resize-overlay{fill:none;stroke-dasharray:5 1 3 1;stroke:#ff7400;pointer-events:none}.djs-resizer-hit{fill:none;pointer-events:all}.djs-resizer-visual{fill:#fff;stroke-width:1px;stroke:#000;shape-rendering:crispEdges;stroke-opacity:.2}.djs-cursor-resize-ns,.djs-resizer-n,.djs-resizer-s{cursor:ns-resize}.djs-cursor-resize-ew,.djs-resizer-e,.djs-resizer-w{cursor:ew-resize}.djs-cursor-resize-nwse,.djs-resizer-nw,.djs-resizer-se{cursor:nwse-resize}.djs-cursor-resize-nesw,.djs-resizer-ne,.djs-resizer-sw{cursor:nesw-resize}.djs-shape.djs-resizing>.djs-outline{visibility:hidden!important}.djs-shape.djs-resizing>.djs-resizer{visibility:hidden}.djs-dragger>.djs-resizer{visibility:hidden}marker.djs-dragger circle,marker.djs-dragger path,marker.djs-dragger polygon,marker.djs-dragger polyline,marker.djs-dragger rect{fill:#ff7400!important;stroke:none!important}marker.djs-dragger text,marker.djs-dragger tspan{fill:none!important;stroke:#ff7400!important}.djs-dragging{opacity:.3}.djs-dragging,.djs-dragging>*{pointer-events:none!important}.djs-dragging .djs-context-pad,.djs-dragging .djs-outline{display:none!important}.djs-visual,.djs-outline{pointer-events:none}.djs-element.attach-ok .djs-hit{stroke-width:60px!important}.djs-element>.djs-hit-all{pointer-events:all}.djs-element>.djs-hit-stroke,.djs-element>.djs-hit-click-stroke{pointer-events:stroke}.djs-drag-active .djs-element>.djs-hit-click-stroke{pointer-events:all}.djs-connection .djs-visual{stroke-width:2px;fill:none}.djs-cursor-grab{cursor:grab}.djs-cursor-grabbing{cursor:grabbing}.djs-cursor-crosshair{cursor:crosshair}.djs-cursor-move{cursor:move}.djs-cursor-resize-ns{cursor:ns-resize}.djs-cursor-resize-ew{cursor:ew-resize}.djs-snap-line{stroke:#ffc342;stroke:#ffc34280;stroke-linecap:round;stroke-width:2px;pointer-events:none}.djs-crosshair{stroke:#555;stroke-linecap:round;stroke-width:1px;pointer-events:none;shape-rendering:crispEdges;stroke-dasharray:5,5}.djs-palette{position:absolute;left:20px;top:20px;box-sizing:border-box;width:48px}.djs-palette .separator{margin:0 5px;padding-top:5px;border:none;border-bottom:solid 1px #DDD;clear:both}.djs-palette .entry:before{vertical-align:text-bottom}.djs-palette .djs-palette-toggle{cursor:pointer}.djs-palette .entry,.djs-palette .djs-palette-toggle{color:#333;font-size:30px;text-align:center}.djs-palette .entry{float:left}.djs-palette .entry img{max-width:100%}.djs-palette .djs-palette-entries:after{content:"";display:table;clear:both}.djs-palette .djs-palette-toggle:hover{background:#666}.djs-palette .entry:hover{color:#ff7400}.djs-palette .highlighted-entry{color:#ff7400!important}.djs-palette .entry,.djs-palette .djs-palette-toggle{width:46px;height:46px;line-height:46px;cursor:default}.djs-palette.two-column.open{width:94px}.djs-palette:not(.open) .djs-palette-entries{display:none}.djs-palette:not(.open){overflow:hidden}.djs-palette.open .djs-palette-toggle{display:none}.djs-overlay-context-pad{width:72px}.djs-context-pad{position:absolute;display:none;pointer-events:none}.djs-context-pad .entry{width:22px;height:22px;text-align:center;display:inline-block;font-size:22px;margin:0 2px 2px 0;border-radius:3px;cursor:default;background-color:#fefefe;box-shadow:0 0 2px 1px #fefefe;pointer-events:all}.djs-context-pad .entry:before{vertical-align:top}.djs-context-pad .entry:hover{background:#fffcb0}.djs-context-pad.open{display:block}.djs-popup .entry{line-height:20px;white-space:nowrap;cursor:default}.djs-popup .entry:before{vertical-align:middle;font-size:20px}.djs-popup .entry>span{vertical-align:middle;font-size:14px}.djs-popup .entry:hover,.djs-popup .entry.active:hover{background:#fffcb0}.djs-popup .entry.disabled{background:inherit}.djs-popup .djs-popup-header .entry{display:inline-block;padding:2px 3px;border:solid 1px transparent;border-radius:3px}.djs-popup .djs-popup-header .entry.active{color:#ff7400;border:solid 1px rgb(255,116,0);background-color:#f6f6f6}.djs-popup-body .entry{padding:4px 10px 4px 5px}.djs-popup-body .entry>span{margin-left:5px}.djs-popup-body{background-color:#fefefe}.djs-popup-header{border-bottom:1px solid #DDD}.djs-popup-header .entry{margin:1px 1px 1px 3px}.djs-popup-header .entry:last-child{margin-right:3px}.djs-popup,.djs-palette{background:#fafafa;border:solid 1px #CCC;border-radius:2px}.djs-shape,.djs-connection{touch-action:none}.djs-segment-dragger,.djs-bendpoint{display:none}.djs-segment-dragger .djs-visual{fill:#ffff7933;stroke-width:1px;stroke-opacity:1;stroke:#ffff794d}.djs-bendpoint .djs-visual{fill:#ffff79cc;stroke-width:1px;stroke-opacity:.5;stroke:#000}.djs-segment-dragger:hover,.djs-bendpoints.hover .djs-segment-dragger,.djs-bendpoints.selected .djs-segment-dragger,.djs-bendpoint:hover,.djs-bendpoints.hover .djs-bendpoint,.djs-bendpoints.selected .djs-bendpoint{display:block}.djs-drag-active .djs-bendpoints *{display:none}.djs-bendpoints:not(.hover) .floating{display:none}.djs-segment-dragger:hover .djs-visual,.djs-segment-dragger.djs-dragging .djs-visual,.djs-bendpoint:hover .djs-visual,.djs-bendpoint.floating .djs-visual{fill:#ff0;stroke-opacity:.5;stroke:#000}.djs-bendpoint.floating .djs-hit{pointer-events:none}.djs-segment-dragger .djs-hit,.djs-bendpoint .djs-hit{pointer-events:all;fill:none}.djs-segment-dragger.horizontal .djs-hit{cursor:ns-resize}.djs-segment-dragger.vertical .djs-hit{cursor:ew-resize}.djs-segment-dragger.djs-dragging .djs-hit{pointer-events:none}.djs-updating,.djs-updating>*{pointer-events:none!important}.djs-updating .djs-context-pad,.djs-updating .djs-outline,.djs-updating .djs-bendpoint,.connect-ok .djs-bendpoint,.connect-not-ok .djs-bendpoint,.drop-ok .djs-bendpoint,.drop-not-ok .djs-bendpoint{display:none!important}.djs-segment-dragger.djs-dragging,.djs-bendpoint.djs-dragging{display:block;opacity:1}.djs-segment-dragger.djs-dragging .djs-visual,.djs-bendpoint.djs-dragging .djs-visual{fill:#ff0;stroke-opacity:.5}.djs-tooltip-error{font-size:11px;line-height:18px;text-align:left;padding:5px;opacity:.7}.djs-tooltip-error>*{width:160px;background:#fcecf0;color:#9e4c4c;padding:3px 7px;border-radius:5px;border-left:solid 5px rgb(174,73,73)}.djs-tooltip-error:hover{opacity:1}.djs-search-container{position:absolute;top:20px;left:0;right:0;margin-left:auto;margin-right:auto;width:25%;min-width:300px;max-width:400px;z-index:10;font-size:1.05em;opacity:.9;background:#fafafa;border:solid 1px #CCC;border-radius:2px}.djs-search-container:not(.open){display:none}.djs-search-input input{font-size:1.05em;width:100%;padding:6px 10px;border:1px solid #ccc}.djs-search-input input:focus{outline:none;border-color:#52b415}.djs-search-results{position:relative;overflow-y:auto;max-height:200px}.djs-search-results:hover{cursor:pointer}.djs-search-result{width:100%;padding:6px 10px;background:#fff;border-bottom:solid 1px #AAA;border-radius:1px}.djs-search-highlight{color:#000}.djs-search-result-primary{margin:0 0 10px}.djs-search-result-secondary{font-family:monospace;margin:0}.djs-search-result:hover{background:#fdffd6}.djs-search-result-selected{background:#fffcb0}.djs-search-result-selected:hover{background:#f7f388}.djs-search-overlay{background:#ff0;opacity:.3}.djs-element-hidden,.djs-element-hidden .djs-hit,.djs-element-hidden .djs-outline,.djs-label-hidden .djs-label{display:none!important}
`,`.diagram-container{position:relative;height:100%;width:100%;margin:0}.diagram-container svg{display:block}.djs-container{direction:ltr}.djs-tooltip{border-radius:4px;padding:8px;width:150px;opacity:.9;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);z-index:1010}.djs-palette{left:10px;top:10px;border-radius:4px;overflow:hidden;padding-top:6px;padding-bottom:6px}.djs-palette.open,.djs-palette.two-column.open{width:46px}.djs-palette .group{padding:0!important;width:100%}.djs-palette .entry{width:32px;height:32px;line-height:32px;margin-left:6px;cursor:pointer}.djs-palette .entry.active{border-radius:7px}.djs-palette .entry.create-menu:after{content:"";position:absolute;width:0;height:0;border-top:3px solid transparent;border-bottom:3px solid transparent;border-left:3px solid #006ce0;margin-top:13px;margin-left:-4px}.djs-context-pad.open{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;border-radius:4px;pointer-events:auto}.djs-context-pad.open .group{display:grid;grid-template-columns:auto auto;padding:3px}.djs-context-pad.open .group:not(:first-child){padding-left:0}.djs-context-pad.open.one-column-grid .group{grid-template-columns:auto}.djs-context-pad.open .entry{height:32px;width:32px;background:transparent;margin:0;box-shadow:none;border-radius:3px}.djs-context-pad.open .entry.entry-separator{height:0;margin-top:4px;margin-bottom:4px}.djs-context-pad.open .entry.noop-entry:hover{background:inherit!important}.djs-context-pad.open .entry img{padding:4px}.entry.entry-separator{height:0;margin-top:4px;margin-bottom:4px}@supports ((-webkit-backdrop-filter: none) or (backdrop-filter: none)){.djs-context-pad.open{-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);background:#ffffffc7}.djs-context-pad.open .entry{background:transparent}}.djs-context-pad{max-width:72px}.djs-element.djs-connection.djs-updating path,.djs-element.djs-connection.selected path,.djs-element.djs-connection.animated path{stroke:#1186d8!important}.djs-element.djs-connection.djs-updating path.connection-end-marker,.djs-element.djs-connection.selected path.connection-end-marker,.djs-element.djs-connection.animated path.connection-end-marker{fill:#1186d8!important}.djs-element.djs-connection.animated path.connection{stroke-width:3!important;stroke-dasharray:20,3;animation:dash 5s linear infinite}@keyframes dash{0%{stroke-dashoffset:115}}.djs-bendpoint .djs-visual{fill:#fff;stroke-width:1px;stroke:#1186d8}.djs-bendpoint.floating .djs-visual{display:none}.djs-bendpoints.hover .djs-visual{stroke:#8095b3}.djs-element.hover .djs-outline{stroke:#a7c6ff}.laneSet.hover .djs-visual,.lane.hover .djs-visual{opacity:initial}.djs-element.selected .djs-outline{stroke:#3168cc}.djs-segment-dragger .djs-visual{fill:transparent;stroke:transparent}.djs-snap-line{stroke-width:1px}.djs-popup{overflow-y:auto;overflow-x:hidden;max-height:calc(100% - 20px);opacity:0;transition:opacity .2s ease-out}.djs-popup .entry{display:flex;flex-direction:row-reverse;justify-content:flex-end;align-items:stretch;padding:5px 7px}.djs-popup .entry img{height:24px;width:24px}.djs-popup .djs-popup-header{display:flex;margin:0 9px}.djs-popup .djs-popup-header .entry.active{border:none}.djs-popup .djs-popup-header .entry:first-child{margin-left:0}.djs-popup .djs-popup-header .entry{height:34px;width:34px;padding:4px;margin:2px 1px 2px 4px}.djs-dragger .djs-visual rect{fill:none}.djs-direct-editing-parent:not(.djs-direct-editing-parent-no-border){display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;pointer-events:none}.djs-direct-editing-parent:not(.djs-direct-editing-parent-no-border) .djs-direct-editing-content{margin:0 auto;pointer-events:auto;text-align:center}.djs-direct-editing-content{-webkit-user-select:text!important;user-select:text!important;overflow:hidden;outline:none;resize:none}.djs-direct-editing-parent-no-border .djs-direct-editing-content{border:0}.djs-direct-editing-rotate-90{transform:rotate(-90deg);transition:transform .1s ease}.djs-direct-editing-rotate-90 .djs-direct-editing-content{border:none;transition:border .1s ease}.djs-direct-editing-rotate-0{transform:rotate(0)}.djs-text-hidden text{display:none}.djs-text-hidden foreignObject{display:none}.djs-direct-editing-resize-handle{display:none}.djs-shape.connect-ok.textAnnotation .djs-visual>:nth-child(1):not(path),.djs-shape.connect-not-ok.textAnnotation .djs-visual>:nth-child(1):not(path){fill:inherit!important}.djs-element.lane.hover:not(.selected) .djs-outline{stroke:none}.djs-element.laneSet.hover:not(.selected) .djs-outline{stroke:none}foreignObject.djs-label{overflow:visible}.foreign-text-container{display:flex;justify-content:center;height:100%}.laneSet .foreign-text-container,.lane .foreign-text-container{align-items:center}.eventSubProcessExpanded .foreign-text-container{height:initial;padding:5px}.foreign-text{text-align:center;box-sizing:border-box;outline:none;font-family:Open Sans,sans-serif;font-size:12px;font-weight:400;line-height:1.2;overflow-wrap:break-word;white-space:pre-line}.label .foreign-text{max-width:130px;-webkit-user-select:text;user-select:text}.textAnnotation .foreign-text{padding:12px;max-width:none;text-align:left;line-height:1.41667;word-wrap:break-word}.textAnnotation foreignObject{height:100%}.eventSubProcessExpanded .foreign-text,.laneSet .foreign-text,.lane .foreign-text{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}@supports (-webkit-line-clamp: 2){.eventSubProcessExpanded .foreign-text,.laneSet .foreign-text,.lane .foreign-text{vertical-align:center;overflow:hidden;text-overflow:ellipsis;white-space:initial;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}}.foreign-text-helper{max-width:128px;min-height:14.39px;width:-moz-fit-content;width:fit-content;margin:0 auto;overflow-wrap:break-word}.diagram-create-popup-menu{border-top:none!important}.diagram-create-popup-menu .entry{cursor:move}.djs-minimap{position:absolute;right:8px;bottom:11px;width:248px;height:33px;border-radius:4px;opacity:1;overflow:hidden;box-sizing:border-box;-webkit-user-select:none;user-select:none;transition:height .2s cubic-bezier(0,0,.2,1)}.djs-minimap .map-buttons{position:absolute;bottom:0;left:0;right:0;height:32px;display:flex;padding:0 5px;z-index:1}.djs-minimap .map-buttons .map-button{min-width:32px;height:32px;cursor:pointer;line-height:32px;font-size:16px;padding:0 8px;background-position:center;transition:background .8s}.djs-minimap .map-buttons .map-button:active{background-size:100%;transition:background 0s}.djs-minimap .map-buttons .map-button.preview-button{padding:0 12px 0 10px;margin:0 4px 0 0;min-width:40px}.djs-minimap .map-buttons .map-button.zoom-button{width:100%;height:100%;padding:0 16px 0 0;text-align:right}.djs-minimap .map-buttons .map-button.zoom-button:after{content:"";position:absolute;width:0;height:0;right:9px;top:16px}.djs-minimap .map{width:248px;height:148px;margin-bottom:32px;cursor:crosshair}.djs-minimap.open{transition:height .2s cubic-bezier(.18,.89,.32,1.28);height:180px}.djs-minimap.open .overlay{position:absolute;inset:0;pointer-events:none}.djs-minimap .viewport{fill:none;stroke:none}.djs-minimap .viewport-dom{position:absolute;border-radius:2px;box-sizing:border-box;cursor:move}.djs-minimap .cursor-crosshair{cursor:crosshair}.djs-minimap .cursor-move{cursor:move}.djs-popup.zoom{right:8px;bottom:47px;top:inherit!important;left:inherit!important}.djs-popup.zoom .entry{display:flex;flex-direction:row;justify-content:space-between;align-items:stretch}.djs-popup.zoom .entry.entry-separator{padding:0!important;margin:4px 10px!important}#canvas_svg_export{position:absolute;left:50px;top:50px;box-shadow:0 0 9px 2px #0000007a}#canvas_svg_export .close-button{position:absolute;right:8px;width:16px;height:16px;cursor:pointer}
`],encapsulation:2})}}return r})();var so=v(39959);let Vi=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=o.\u0275\u0275defineNgModule({type:r})}static{this.\u0275inj=o.\u0275\u0275defineInjector({providers:[le,{provide:ot,useValue:Bs}],imports:[A.CommonModule,mt,R.h.forChild(),Q.Ph,so.iI.forChild([])]})}}return r})();(function(){(typeof ngJitMode>"u"||ngJitMode)&&o.\u0275\u0275setNgModuleScope(Vi,{declarations:[hn],imports:[A.CommonModule,mt,R.h,Q.Ph,so.iI],exports:[hn]})})();var Zi=v(16837),Yi=v(43581),oo=v(37236),$i=v(73866),Vl=v(72831);let we=(()=>{class r{static{this.formal={id:"56d730bf-27f5-42d9-83df-183df2ec06a1",name:"Formal"}}static{this.notFormal={id:"6d1d2243-d4de-4d64-aab4-23eed4021a60",name:"Not formal"}}}return r})(),Je=(()=>{class r{static{this.AddElement="AddElement"}static{this.EditConnection="EditConnection"}static{this.DeleteElement="DeleteElement"}static{this.AddGroup="AddGroup"}static{this.AddEntityInGroup="AddEntityInGroup"}}return r})();var Zl=v(37603),Yl=v(37782);let bt=(()=>{class r{constructor(e){this.queryExecutor=e}_getDisplayValueFilterGroup(e,n){const i=new K.FilterGroup;i.logicalOperation=K.LogicalOperatorType.Or;for(const s of e)i.addSchemaColumnFilterWithParameter(K.ComparisonType.Contain,s,n);return i}getFilteredLookupItems(e){const n=new K.EntitySchemaQuery(e.schemaName);n.rowCount=20;const i=e.additionalColumns||[],s=e.excludedRecords||[],l=e.additionalFilters||[];i.includes("Id")||n.addSchemaColumn("Id"),i.includes("Name")||n.addSchemaColumn("Name");for(const c of i)n.addSchemaColumn(c);if(e.value!==""){const c=e.displayValueFilters||["Name"];n.filters.add(this._getDisplayValueFilterGroup(c,e.value))}s.length>0&&n.filters.addSchemaColumnInFilterWithParameters(K.ComparisonType.Not_equal,"Id",s);for(const c of l)n.filters.add(c);return this.queryExecutor.executeSelectQuery(n).pipe((0,st.T)(c=>c.map(p=>({value:p.Id,displayValue:e.displayValueGetter?e.displayValueGetter(p):p.Name,row:p}))),(0,Yl.u)())}static{this.\u0275fac=function(n){return new(n||r)(o.\u0275\u0275inject(Zl.wU))}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac})}}return r})(),Et=(()=>{class r{constructor(){this.createGroup$=new w.Subject,this.addEntityToGroup$=new w.Subject,this.initializeGroups$=new w.Subject,this.isLoading$=new w.ReplaySubject(1)}createGroup(){this.createGroup$.next()}addEntityToGroup(e){this.addEntityToGroup$.next(e)}isLoading(e){this.isLoading$.next(e)}initializeGroups(){this.initializeGroups$.next()}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac})}}return r})(),un=(()=>{class r{constructor(){this.designerConfig$=new w.ReplaySubject(1),this.doSave$=new w.Subject,this.saveCard$=new w.Subject,this.doCloseCard$=new w.Subject}setDesignerConfig(e){this.designerConfig$.next(e)}getDesignerConfig(){return this.designerConfig$}doSave(){return this.doSave$}cardSaved(e){this.saveCard$.next(e)}saveCard(){return this.doSave$.next(),this.saveCard$}closeCard(e){this.doCloseCard$.next(e)}doCloseCard(){return this.doCloseCard$}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac})}}return r})(),$l=(()=>{class r extends R.Wr{constructor(e,n,i){super(),this.customEventService=e,this._store=n,this._getTranslationsEventName=i,this.destroyed$=new w.Subject,this.translations={},this.InitializeTranslation()}InitializeTranslation(){this.customEventService.subscribe(this._getTranslationsEventName).pipe((0,Pt.Q)(this.destroyed$),(0,oo.M)(e=>{this._store.langs.forEach(n=>{const i=this._store.translations[n];this._store.translations[n]=(0,Qe.A)(i,e)})})).subscribe(e=>{this.translations=e}),this.customEventService.createOutboundChannel(this._getTranslationsEventName).next()}getTranslation(e){return(0,w.of)(this.translations)}ngOnDestroy(){this.destroyed$.next()}static{this.\u0275fac=function(n){return new(n||r)(o.\u0275\u0275inject(f.CustomEventService),o.\u0275\u0275inject(R.Mw),o.\u0275\u0275inject(Zi.TsT))}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac})}}return r})(),Ke=(()=>{class r{constructor(e){this.httpClient=e,this.serviceEndpoint="rest/RelationshipDesignerService/"}_prepareCollection(e,n){const i={};return e?.forEach(function(s){const l=s[n];i[l]=s},this),i}getDiagram(e,n){const i=this.serviceEndpoint+"GetDiagram";return this.httpClient.post(i,{recordId:e,schemaName:n}).pipe((0,st.T)(s=>{if(s&&s.success){const l=s.data;l.elements=this._prepareCollection(l.elements,"id"),l.connections=this._prepareCollection(l.connections,"id"),l.labels=this._prepareCollection(l.labels,"parent"),l.groups&&(l.groups=this._prepareCollection(l.groups,"id")),s.data=l;const c=s.config;c.customDiagramElements=this._prepareCollection(c.customDiagramElements,"type"),s.config=c}return s}))}deleteEntity(e){const n=this.serviceEndpoint+"DeleteEntity";return this.httpClient.post(n,{entityId:e})}createConnection(e){const n=this.serviceEndpoint+"CreateConnection";return this.httpClient.post(n,{entityConnection:e})}updateConnection(e){const n=this.serviceEndpoint+"UpdateConnection";return this.httpClient.post(n,{entityConnection:e})}deleteConnection(e){const n=this.serviceEndpoint+"DeleteConnection";return this.httpClient.post(n,{connectionId:e})}getGroupsData(){const e=this.serviceEndpoint+"GetGroupsData";return this.httpClient.post(e,null)}getGroupsDataForEntity(e){const n=this.serviceEndpoint+"GetGroupsDataForEntity";return this.httpClient.post(n,{entityId:e})}createGroup(e){const n=this.serviceEndpoint+"CreateGroup";return this.httpClient.post(n,{group:e})}updateGroup(e){const n=this.serviceEndpoint+"UpdateGroup";return this.httpClient.post(n,{group:e})}deleteGroup(e){const n=this.serviceEndpoint+"DeleteGroup";return this.httpClient.post(n,{groupId:e})}createEntityInGroup(e){const n=this.serviceEndpoint+"CreateEntityInGroup";return this.httpClient.post(n,{entityInGroup:e})}updateEntityInGroup(e){const n=this.serviceEndpoint+"UpdateEntityInGroup";return this.httpClient.post(n,{entityInGroup:e})}deleteEntityInGroup(e,n){const i=this.serviceEndpoint+"DeleteEntityInGroup";return this.httpClient.post(i,{entityId:e,groupId:n})}getRecordEntityInfo(e){const n=this.serviceEndpoint+"GetRecordEntityInfo";return this.httpClient.post(n,{entityId:e}).pipe((0,st.T)(i=>{const s=i?.recordEntityInfo;if(s){const l={};(0,ii.A)(s,c=>{const p=c.Key.toLowerCase();l[p]=c.Value}),i.recordEntityInfo=l}return i}))}static{this.\u0275fac=function(n){return new(n||r)(o.\u0275\u0275inject(ss.HttpClient))}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac})}}return r})(),Ji=(()=>{class r extends le{constructor(){super(),this.getDiagramInfo$=new w.ReplaySubject(1),this.itemSelected$=new w.Subject,this.highlightedGroup$=new w.Subject,this.diagramLoaded$=new w.Subject,this.elementDoubleClick$=new w.Subject,this.elementRemoving$=new w.Subject,this.connectionAdding$=new w.Subject,this.connectionAdded$=new w.Subject,this.connectionChanged$=new w.Subject,this.showMessage$=new w.Subject,this.connectionReconnect$=new w.Subject,this.entityInGroupAdded$=new w.Subject,this.entityInGroupRemoving$=new w.Subject,this.diagramChanged$=new w.Subject,this.init()}getDiagramConfig(){var e=this;return(0,D.A)(function*(){return(0,w.lastValueFrom)(e.getDiagramInfo$.asObservable(),{defaultValue:null})})()}setDiagramConfig(e){this.getDiagramInfo$.next(e),this.getDiagramInfo$.complete()}diagramLoaded(){this.diagramLoaded$.next()}itemSelected(e){this.itemSelected$.next(e)}highlightGroup(e){this.highlightedGroup$.next(e)}elementDoubleClick(e){this.elementDoubleClick$.next(e)}connectionAdding(e){this.connectionAdding$.next(e)}connectionReconnect(e){this.connectionReconnect$.next(e)}elementRemoving(e){return this.elementRemoving$.next(e),!1}showMessage(e){this.showMessage$.next(e)}entityInGroupAdded(){this.entityInGroupAdded$.next()}entityInGroupRemoving(){this.entityInGroupRemoving$.next()}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac})}}return r})(),Xe=(()=>{class r{constructor(e,n){this._dialogService=e,this._translateService=n}_getRemovingConfirmationDialogConfig(e){return{width:"450px",panelClass:["dialog-top-border","relationship-remove-item"],data:{message:this._translateService.instant(e),primaryButton:{result:Q.ch.result,caption:this._translateService.instant(Q.ch.caption).toLowerCase()},secondaryButton:{result:Q.ut.result,caption:this._translateService.instant(Q.ut.caption).toLowerCase()}}}}confirmRemoving(e){const n=this._getRemovingConfirmationDialogConfig(e);return this._dialogService.open(Q.DY,n).pipe((0,w.map)(i=>i===Q.ch.result))}static{this.\u0275fac=function(n){return new(n||r)(o.\u0275\u0275inject(Q.o3),o.\u0275\u0275inject(R.c$))}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac})}}return r})();class qe{static hasParent(t){return!!t?.parent}static getDefaultConnectionType(t,e){switch(!0){case(this.isContainer(t)&&this.isContainer(e)):case(this.isContainer(t)&&this.isItem(e)&&!this.hasParent(e)):case(this.isContainer(t)&&this.isItem(e)&&t.id===e.parent):case(this.isItem(t)&&!this.hasParent(t)&&this.isContainer(e)):case(this.isItem(t)&&this.hasParent(t)&&this.isItem(e)&&!this.hasParent(e)):case(this.isItem(t)&&!this.hasParent(t)&&this.isItem(e)&&this.hasParent(e)):case(this.isItem(t)&&this.hasParent(t)&&this.isItem(e)&&this.hasParent(e)&&t.parent===e.parent):return we.formal;default:return we.notFormal}}static getUnsupportedConnectionTypesIds(t,e){return qe.getDefaultConnectionType(t,e).id!==we.formal.id?[we.formal.id]:[]}static isItem(t){return t&&t.type==="relationship-item"}static isContainer(t){return t&&t.type==="relationship-container"}}var et=v(3126);let jt=(()=>{class r{_initializeDirectionality(){this.isRtl=this.directionality?.value==="rtl"}_initializeGTM(){this.subscription.add(this.googleTagManagerService.initialize().subscribe())}constructor(e){this.injector=e,this.subscription=new w.Subscription,this.isNew=!1,this.isLoading=!1,this.elementData=null,this.elementConfig=null,this.id$=new w.Subject,this.isRtl=!1,this.injectDependencies(),this.subscribeEvents(),this._initializeDirectionality(),this._initializeGTM()}injectDependencies(){this.designerService=this.injector.get(Ke),this.propertiesPageEventService=this.injector.get(un),this.dialogService=this.injector.get(Q.o3),this.translateService=this.injector.get(R.c$),this.diagramEventService=this.injector.get(le),this.directionality=this.injector.get(et.dS),this.googleTagManagerService=this.injector.get(nt.AR)}subscribeEvents(){this.subscription.add(this.id$.subscribe(e=>this.onIdChange(e))),this.subscription.add(this.propertiesPageEventService.doSave().subscribe(()=>this.saveCard()))}showMask(){this.isLoading=!0}hideMask(){this.isLoading=!1}getElement(e){return this.data.elements[e]||this.data.connections[e]}getElementConfig(e){return e&&this.config?.customDiagramElements[e]}getElementByRecordId(e){let n=null;return(0,ii.A)(this.data.elements,i=>{if(i.recordId===e)return n=i,!1}),n}onIdChange(e){this.subscription.add(this.propertiesPageEventService.getDesignerConfig().pipe((0,Hn.s)(1)).subscribe(n=>{this.fillData(n,e),this.onDataInitialized()}))}fillData(e,n){this.data=e.data,this.config=e.config;const i=this.elementData||this.getElement(n);this.elementConfig=this.getElementConfig(i?.type),this.elementData=i}onDataInitialized(){}saveCard(){const e=this.validate();if(!e){setTimeout(()=>{this.propertiesPageEventService.cardSaved({validated:e,success:!1,isChanged:!1})});return}this.showMask(),this.subscription.add(this.onSavedCard().subscribe(n=>{this.hideMask();const i=this.isNeedActualizeDiagram();this.propertiesPageEventService.cardSaved({validated:e,success:n,isChanged:i})}))}isNeedActualizeDiagram(){return this.isNew||this.isChanged()}onSavedCard(){return(0,w.of)(!0).pipe((0,$i.c)(1))}validate(){return!0}isChanged(){return!1}showErrorDialog(e){if(e?.success)return;const n=e?.errorInfo?.message||"An unknown error occurred during the operation.";this.subscription.add(this.dialogService.openInfoDialog(n).subscribe())}sendGtmAction(e){const n={moduleName:"RelationshipDesignerModule",schemaName:this.getGtmSchemaName()};e&&n&&this.googleTagManagerService.track((0,Qe.A)(n,e))}getGtmSchemaName(){throw new Error("Need return gtm schema name")}ngOnDestroy(){this.subscription.unsubscribe(),this.hideMask()}static{this.\u0275fac=function(n){return new(n||r)(o.\u0275\u0275directiveInject(o.Injector))}}static{this.\u0275cmp=o.\u0275\u0275defineComponent({type:r,selectors:[["crt-base-properties-page"]],hostVars:2,hostBindings:function(n,i){n&2&&o.\u0275\u0275classProp("rtl",i.isRtl)},decls:0,vars:0,template:function(n,i){},encapsulation:2})}}return r})();var mn=v(4872),ao=v(1608);let ro=(()=>{class r{set legacyAutocompleteTrigger(e){this._legacyAutocompleteTrigger=e}set legacyAutocomplete(e){this._legacyAutocomplete=e,this._openedSubscription||(this._openedSubscription=this._legacyAutocomplete.opened.subscribe(this._onAutocompleteOpened.bind(this)),this._closedSubscription=this._legacyAutocomplete.closed.subscribe(this._onAutocompleteClosed.bind(this)))}_onAutocompleteOpened(){this._overlayPointerEventsSubscription=this._legacyAutocompleteTrigger._overlayRef._outsidePointerEvents.subscribe(e=>this._legacyAutocompleteTrigger.closePanel())}_onAutocompleteClosed(){this._overlayPointerEventsSubscription.unsubscribe(),this._overlayPointerEventsSubscription=void 0}ngOnDestroy(){this._openedSubscription.unsubscribe(),this._openedSubscription=void 0,this._closedSubscription.unsubscribe(),this._closedSubscription=void 0}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275dir=o.\u0275\u0275defineDirective({type:r,selectors:[["","crtLegacyAutocompleteOverlayClick",""]],inputs:{legacyAutocompleteTrigger:"legacyAutocompleteTrigger",legacyAutocomplete:"legacyAutocomplete"}})}}return r})();function Jl(r,t){r&1&&o.\u0275\u0275element(0,"ts-mask",27)}function Kl(r,t){if(r&1&&(o.\u0275\u0275elementStart(0,"mat-hint"),o.\u0275\u0275text(1),o.\u0275\u0275elementEnd()),r&2){const e=o.\u0275\u0275nextContext();o.\u0275\u0275advance(),o.\u0275\u0275textInterpolate(e.getControlErrorMessage())}}function Xl(r,t){if(r&1&&(o.\u0275\u0275elementStart(0,"mat-option",28),o.\u0275\u0275text(1),o.\u0275\u0275elementEnd()),r&2){const e=t.$implicit;o.\u0275\u0275property("value",e),o.\u0275\u0275advance(),o.\u0275\u0275textInterpolate1(" ",e.displayValue," ")}}function ql(r,t){if(r&1&&(o.\u0275\u0275elementStart(0,"mat-hint"),o.\u0275\u0275text(1),o.\u0275\u0275elementEnd()),r&2){const e=o.\u0275\u0275nextContext();o.\u0275\u0275advance(),o.\u0275\u0275textInterpolate(e.getControlErrorMessage())}}function ec(r,t){if(r&1&&(o.\u0275\u0275elementStart(0,"mat-option",28),o.\u0275\u0275text(1),o.\u0275\u0275elementEnd()),r&2){const e=t.$implicit;o.\u0275\u0275property("value",e),o.\u0275\u0275advance(),o.\u0275\u0275textInterpolate1(" ",e.displayValue," ")}}function tc(r,t){if(r&1&&(o.\u0275\u0275elementStart(0,"mat-hint"),o.\u0275\u0275text(1),o.\u0275\u0275elementEnd()),r&2){const e=o.\u0275\u0275nextContext();o.\u0275\u0275advance(),o.\u0275\u0275textInterpolate(e.getControlErrorMessage())}}function nc(r,t){if(r&1&&(o.\u0275\u0275elementStart(0,"mat-option",28),o.\u0275\u0275text(1),o.\u0275\u0275elementEnd()),r&2){const e=t.$implicit;o.\u0275\u0275property("value",e),o.\u0275\u0275advance(),o.\u0275\u0275textInterpolate1(" ",e.displayValue," ")}}function ic(r,t){if(r&1&&(o.\u0275\u0275elementStart(0,"mat-hint"),o.\u0275\u0275text(1),o.\u0275\u0275elementEnd()),r&2){const e=o.\u0275\u0275nextContext();o.\u0275\u0275advance(),o.\u0275\u0275textInterpolate(e.getControlErrorMessage())}}function sc(r,t){if(r&1&&(o.\u0275\u0275elementStart(0,"mat-option",28),o.\u0275\u0275text(1),o.\u0275\u0275elementEnd()),r&2){const e=t.$implicit;o.\u0275\u0275property("value",e),o.\u0275\u0275advance(),o.\u0275\u0275textInterpolate1(" ",e.displayValue," ")}}let St=(()=>{class r extends jt{constructor(e){super(e),this.injector=e,this.relationshipTypeSchemaName="RelationType",this.connectionTypeSchemaName="RelationConnectionType",this.comment="",this.elementData=null,this._relationshipDeleteDialogService=this.injector.get(Xe)}injectDependencies(){super.injectDependencies(),this.lookupDataService=this.injector.get(bt)}onDataInitialized(){this.showMask(),super.onDataInitialized(),this.initializeIsNew(),this.initializeSourceElementData(),this.initializeTargetElementData(),this.initializeConnectionType(),this.initializeExcludedConnectionTypes(),this.initializeRelationshipType(),this.initializeEntityA(),this.initializeEntityB(),this.initializeComment(),this.hideMask()}initializeIsNew(){this.isNew=this.elementData?.isNew}initializeSourceElementData(){this.elementData?.source&&(this.sourceElement=this.getElement(this.elementData.source),this.sourceConfig=this.getElementConfig(this.sourceElement.type))}initializeTargetElementData(){this.elementData?.target&&(this.targetElement=this.getElement(this.elementData.target),this.targetConfig=this.getElementConfig(this.targetElement.type))}initializeEntityA(){this.sourceElement&&(this.selectedEntityA={value:this.sourceElement.recordId,displayValue:this.sourceElement.caption})}initializeEntityB(){if(!this.elementData?.target)return;const e=this.getElement(this.elementData.target);this.selectedEntityB={value:e.recordId,displayValue:e.caption}}initializeConnectionType(){if(!this.elementData?.relationshipType?.connectionType)return;const e=this.elementData.relationshipType.connectionType;let n=e.id;this.isNew?(n=this.isFormalConnectionAddingDisabled()?we.notFormal.id:n,this.initializeConnectionTypeById(n)):this.selectedConnectionType={value:n,displayValue:e.name}}initializeConnectionTypeById(e){this.getConnectionTypeControlLookupValues().pipe((0,Hn.s)(1)).subscribe(n=>{this.selectedConnectionType=n.find(i=>i.value===e)})}initializeExcludedConnectionTypes(){!this.sourceElement||!this.targetElement||(this.excludedConnectionTypes=qe.getUnsupportedConnectionTypesIds(this.sourceElement,this.targetElement))}initializeRelationshipType(){this.elementData?.relationshipType?.id&&(this.selectedRelationshipType={value:this.elementData?.relationshipType.id,displayValue:this.elementData?.relationshipType.name})}initializeComment(){this.comment=this.elementData?.comment||""}onSavedCard(){if(!this.isNeedActualizeDiagram())return(0,w.of)(!0).pipe((0,$i.c)(1));const e=this.buildServerElement(),n=this.isNew?this.designerService.createConnection(e):this.designerService.updateConnection(e);return this.sendGtmAction({action:this.isNew?Je.AddElement:Je.EditConnection}),n.pipe((0,Vl.n)(i=>{const s=i?.success;return s||this.showErrorDialog(i),(0,w.of)(s).pipe((0,$i.c)(1))}))}validate(){let e=super.validate();return e=e&&!!this.selectedConnectionType&&!!this.selectedRelationshipType&&!!this.selectedEntityA&&!!this.selectedEntityB,e}isChanged(){let e=super.isChanged();const n=this.elementData,i=this.getElementByRecordId(this.selectedEntityB.value);return e=e||!i||i.id!==n.target,e=e||this.selectedConnectionType?.value!==n.relationshipType.connectionType.id,e=e||this.selectedRelationshipType?.value!==n.relationshipType.id,e=e||this.comment!==n.comment,e}buildServerElement(){return{id:this.elementData.originalId||this.elementData.id,diagramId:this.data.id,relationshipRecordA:{id:this.selectedEntityA.value,schemaName:this.sourceConfig.caption},relationshipRecordB:{id:this.selectedEntityB.value,schemaName:this.targetConfig.caption},relationshipType:this.selectedRelationshipType.value,comment:this.comment}}doDeleteConnection(){if(this.isNew){this.forceCloseCard(!0);return}this.showMask(),this.subscription.add(this.designerService.deleteConnection(this.elementData.originalId).subscribe(e=>{if(!e?.success){this.hideMask(),this.showErrorDialog(e);return}this.forceCloseCard(!0),this.hideMask(),this.sendGtmAction({action:Je.DeleteElement})}))}forceCloseCard(e=!1){this.propertiesPageEventService.closeCard({isForced:!0,isNeedDiagramReload:e})}getControlLookupValues(e){return this.lookupDataService.getFilteredLookupItems({value:e.value,schemaName:e.schemaName,excludedRecords:e.excludedRecords,additionalColumns:e.additionalColumns,additionalFilters:e.additionalFilters,displayValueFilters:e.displayValueFilters,displayValueGetter:e.displayValueGetter})}isFormalConnectionAddingDisabled(){const e=qe.hasParent(this.sourceElement),n=qe.hasParent(this.targetElement),i=this.targetConfig.caption==="Account";return e&&n&&this.sourceElement.parent!==this.targetElement.parent||e&&i}getExcludedConnectionTypes(){return this.isFormalConnectionAddingDisabled()?[we.formal.id]:[]}getConnectionTypeControlLookupValues(e=""){const n=this.excludedConnectionTypes?.length?this.excludedConnectionTypes:this.getExcludedConnectionTypes();return this.getControlLookupValues({value:e,schemaName:this.connectionTypeSchemaName,excludedRecords:n})}getRelationTypeAdditionalFilterGroup(){const e="For"+this.sourceConfig.caption+this.targetConfig.caption,n=new K.FilterGroup;n.addSchemaColumnFilterWithParameter(K.ComparisonType.Equal,e,!0);let i=this.selectedConnectionType?.value;return!i&&this.isFormalConnectionAddingDisabled()&&(i=we.notFormal.id),i&&n.addSchemaColumnFilterWithParameter(K.ComparisonType.Equal,"RelationConnectionType.Id",i),n}getRelationshipTypeControlLookupValues(e=""){return this.getControlLookupValues({value:e,schemaName:this.relationshipTypeSchemaName,additionalColumns:["ReverseRelationType.Name","RelationConnectionType.Id","RelationConnectionType.Name"],additionalFilters:[this.getRelationTypeAdditionalFilterGroup()],displayValueFilters:["Name","ReverseRelationType.Name"],displayValueGetter:n=>n.Name+" - "+n["ReverseRelationType.Name"]})}getEntityAControlLookupValues(e=""){return this.getControlLookupValues({value:e,schemaName:this.sourceConfig.caption})}getEntityBControlLookupValues(e=""){return this.getControlLookupValues({value:e,schemaName:this.targetConfig.caption,excludedRecords:this.getExcludedEntityBControlValuesFilter()})}getExcludedEntityBControlValuesFilter(){const e=[];return this.addSelfExcludeFilterIfNeed(e),e}addSelfExcludeFilterIfNeed(e){this.targetConfig.caption===this.sourceConfig.caption&&e.push(this.sourceElement.recordId)}getGtmSchemaName(){return"ConnectionPropertiesPageComponent"}onConnectionTypeChange(e){this.selectedConnectionType=null,this.connectionTypes=this.getConnectionTypeControlLookupValues(e)}onConnectionTypeSelected(e){this.selectedConnectionType=e,this.connectionTypes=null,this.selectedRelationshipType=null}onRelationshipTypeChange(e){this.selectedRelationshipType=null,this.relationshipTypes=this.getRelationshipTypeControlLookupValues(e)}onRelationshipTypeSelected(e){this.selectedRelationshipType=e,this.selectedRelationshipType?.row&&(this.selectedConnectionType={value:this.selectedRelationshipType?.row["RelationConnectionType.Id"],displayValue:this.selectedRelationshipType?.row["RelationConnectionType.Name"]}),this.relationshipTypes=null}onEntityAChange(e){this.selectedEntityA=null,this.entitiesA=this.getEntityAControlLookupValues(e)}onEntityASelected(e){this.selectedEntityA=e,this.entitiesA=null}onEntityBChange(e){this.selectedEntityB=null,this.entitiesB=this.getEntityBControlLookupValues(e)}onEntityBSelected(e){this.selectedEntityB=e,this.entitiesB=null}getControlDisplayValue(e){return e?e.displayValue||e.value:""}getControlErrorMessage(){return this.translateService.instant("RelationshipDesigner.RequiredControlErrorMessage")}onCommentChange(e){this.comment=e}deleteConnection(){this._relationshipDeleteDialogService.confirmRemoving("RelationshipDesigner.DeleteItemMessage").subscribe(e=>{e&&this.doDeleteConnection()})}onConnectionTypeFocus(e){this.connectionTypes=this.getConnectionTypeControlLookupValues()}onRelationshipTypeFocus(e){this.relationshipTypes=this.getRelationshipTypeControlLookupValues()}onEntityAFocus(e){this.entitiesA=this.getEntityAControlLookupValues()}onEntityBFocus(e){this.entitiesB=this.getEntityBControlLookupValues()}static{this.\u0275fac=function(n){return new(n||r)(o.\u0275\u0275directiveInject(o.Injector))}}static{this.\u0275cmp=o.\u0275\u0275defineComponent({type:r,selectors:[["crt-connection-properties-page"]],features:[o.\u0275\u0275InheritDefinitionFeature],decls:59,vars:52,consts:[["connectionTypeTrigger","matAutocompleteTrigger"],["connectionTypeAuto","matAutocomplete"],["relationshipTypeTrigger","matAutocompleteTrigger"],["relationshipTypeAuto","matAutocomplete"],["entityATrigger","matAutocompleteTrigger"],["entityAAuto","matAutocomplete"],["entityBTrigger","matAutocompleteTrigger"],["entityBAuto","matAutocomplete"],["class","component-mask",4,"ngIf"],[1,"header"],[1,"title-wrap"],[1,"logo-wrap"],[1,"logo"],[1,"title"],[1,"title-control-group"],["floatLabel","always"],["type","text","matInput","","required","",3,"keyup","focus","matAutocomplete","value"],[4,"ngIf"],["crtLegacyAutocompleteOverlayClick","",3,"optionSelected","legacyAutocompleteTrigger","legacyAutocomplete","displayWith"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","",1,"delete-icon",3,"click"],[1,"content"],[1,"group-label"],["type","text","matInput","","disabled","",3,"keyup","focus","matAutocomplete","value"],[1,"divider"],["floatLabel","always",1,"text-area"],["matInput","","name","message",3,"change","value"],[1,"component-mask"],[3,"value"]],template:function(n,i){if(n&1){const s=o.\u0275\u0275getCurrentView();o.\u0275\u0275template(0,Jl,1,0,"ts-mask",8),o.\u0275\u0275elementStart(1,"div",9)(2,"div",10)(3,"div",11),o.\u0275\u0275element(4,"div",12),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(5,"div",13),o.\u0275\u0275text(6),o.\u0275\u0275pipe(7,"translate"),o.\u0275\u0275elementEnd()(),o.\u0275\u0275elementStart(8,"div",14)(9,"mat-form-field",15)(10,"input",16,0),o.\u0275\u0275listener("keyup",function(c){return o.\u0275\u0275restoreView(s),o.\u0275\u0275resetView(i.onConnectionTypeChange(c.target.value))})("focus",function(c){return o.\u0275\u0275restoreView(s),o.\u0275\u0275resetView(i.onConnectionTypeFocus(c.target.value))}),o.\u0275\u0275elementEnd(),o.\u0275\u0275template(12,Kl,2,1,"mat-hint",17),o.\u0275\u0275elementStart(13,"mat-autocomplete",18,1),o.\u0275\u0275listener("optionSelected",function(c){return o.\u0275\u0275restoreView(s),o.\u0275\u0275resetView(i.onConnectionTypeSelected(c.option.value))}),o.\u0275\u0275template(15,Xl,2,2,"mat-option",19),o.\u0275\u0275pipe(16,"async"),o.\u0275\u0275elementEnd()(),o.\u0275\u0275elementStart(17,"button",20),o.\u0275\u0275listener("click",function(){return o.\u0275\u0275restoreView(s),o.\u0275\u0275resetView(i.deleteConnection())}),o.\u0275\u0275elementEnd()()(),o.\u0275\u0275elementStart(18,"div",21)(19,"mat-form-field",15)(20,"mat-label"),o.\u0275\u0275text(21),o.\u0275\u0275pipe(22,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(23,"input",16,2),o.\u0275\u0275listener("keyup",function(c){return o.\u0275\u0275restoreView(s),o.\u0275\u0275resetView(i.onRelationshipTypeChange(c.target.value))})("focus",function(c){return o.\u0275\u0275restoreView(s),o.\u0275\u0275resetView(i.onRelationshipTypeFocus(c.target.value))}),o.\u0275\u0275elementEnd(),o.\u0275\u0275template(25,ql,2,1,"mat-hint",17),o.\u0275\u0275elementStart(26,"mat-autocomplete",18,3),o.\u0275\u0275listener("optionSelected",function(c){return o.\u0275\u0275restoreView(s),o.\u0275\u0275resetView(i.onRelationshipTypeSelected(c.option.value))}),o.\u0275\u0275template(28,ec,2,2,"mat-option",19),o.\u0275\u0275pipe(29,"async"),o.\u0275\u0275elementEnd()(),o.\u0275\u0275elementStart(30,"span",22),o.\u0275\u0275text(31),o.\u0275\u0275pipe(32,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(33,"mat-form-field",15)(34,"mat-label"),o.\u0275\u0275text(35),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(36,"input",23,4),o.\u0275\u0275listener("keyup",function(c){return o.\u0275\u0275restoreView(s),o.\u0275\u0275resetView(i.onEntityAChange(c.target.value))})("focus",function(c){return o.\u0275\u0275restoreView(s),o.\u0275\u0275resetView(i.onEntityAFocus(c.target.value))}),o.\u0275\u0275elementEnd(),o.\u0275\u0275template(38,tc,2,1,"mat-hint",17),o.\u0275\u0275elementStart(39,"mat-autocomplete",18,5),o.\u0275\u0275listener("optionSelected",function(c){return o.\u0275\u0275restoreView(s),o.\u0275\u0275resetView(i.onEntityASelected(c.option.value))}),o.\u0275\u0275template(41,nc,2,2,"mat-option",19),o.\u0275\u0275pipe(42,"async"),o.\u0275\u0275elementEnd()(),o.\u0275\u0275elementStart(43,"mat-form-field",15)(44,"mat-label"),o.\u0275\u0275text(45),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(46,"input",16,6),o.\u0275\u0275listener("keyup",function(c){return o.\u0275\u0275restoreView(s),o.\u0275\u0275resetView(i.onEntityBChange(c.target.value))})("focus",function(c){return o.\u0275\u0275restoreView(s),o.\u0275\u0275resetView(i.onEntityBFocus(c.target.value))}),o.\u0275\u0275elementEnd(),o.\u0275\u0275template(48,ic,2,1,"mat-hint",17),o.\u0275\u0275elementStart(49,"mat-autocomplete",18,7),o.\u0275\u0275listener("optionSelected",function(c){return o.\u0275\u0275restoreView(s),o.\u0275\u0275resetView(i.onEntityBSelected(c.option.value))}),o.\u0275\u0275template(51,sc,2,2,"mat-option",19),o.\u0275\u0275pipe(52,"async"),o.\u0275\u0275elementEnd()(),o.\u0275\u0275element(53,"mat-divider",24),o.\u0275\u0275elementStart(54,"mat-form-field",25)(55,"mat-label"),o.\u0275\u0275text(56),o.\u0275\u0275pipe(57,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(58,"textarea",26),o.\u0275\u0275listener("change",function(c){return o.\u0275\u0275restoreView(s),o.\u0275\u0275resetView(i.onCommentChange(c.target.value))}),o.\u0275\u0275elementEnd()()()}if(n&2){const s=o.\u0275\u0275reference(11),l=o.\u0275\u0275reference(14),c=o.\u0275\u0275reference(24),p=o.\u0275\u0275reference(27),h=o.\u0275\u0275reference(37),m=o.\u0275\u0275reference(40),C=o.\u0275\u0275reference(47),y=o.\u0275\u0275reference(50);o.\u0275\u0275property("ngIf",i.isLoading),o.\u0275\u0275advance(6),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(7,36,"ConnectionPropertiesPage.Title")),o.\u0275\u0275advance(4),o.\u0275\u0275property("matAutocomplete",l)("value",i.selectedConnectionType==null?null:i.selectedConnectionType.displayValue),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngIf",!i.selectedConnectionType),o.\u0275\u0275advance(),o.\u0275\u0275property("legacyAutocompleteTrigger",s)("legacyAutocomplete",l)("displayWith",i.getControlDisplayValue),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngForOf",o.\u0275\u0275pipeBind1(16,38,i.connectionTypes)),o.\u0275\u0275advance(6),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(22,40,"ConnectionPropertiesPage.RelationshipType")),o.\u0275\u0275advance(2),o.\u0275\u0275property("matAutocomplete",p)("value",i.selectedRelationshipType==null?null:i.selectedRelationshipType.displayValue),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngIf",!i.selectedRelationshipType),o.\u0275\u0275advance(),o.\u0275\u0275property("legacyAutocompleteTrigger",c)("legacyAutocomplete",p)("displayWith",i.getControlDisplayValue),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngForOf",o.\u0275\u0275pipeBind1(29,42,i.relationshipTypes)),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(32,44,"ConnectionPropertiesPage.Relations")),o.\u0275\u0275advance(4),o.\u0275\u0275textInterpolate(i.sourceConfig==null||i.sourceConfig.entitySchemaData==null?null:i.sourceConfig.entitySchemaData.caption),o.\u0275\u0275advance(),o.\u0275\u0275property("matAutocomplete",m)("value",i.selectedEntityA==null?null:i.selectedEntityA.displayValue),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngIf",!i.selectedEntityA),o.\u0275\u0275advance(),o.\u0275\u0275property("legacyAutocompleteTrigger",h)("legacyAutocomplete",m)("displayWith",i.getControlDisplayValue),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngForOf",o.\u0275\u0275pipeBind1(42,46,i.entitiesA)),o.\u0275\u0275advance(4),o.\u0275\u0275textInterpolate(i.targetConfig==null||i.targetConfig.entitySchemaData==null?null:i.targetConfig.entitySchemaData.caption),o.\u0275\u0275advance(),o.\u0275\u0275property("matAutocomplete",y)("value",i.selectedEntityB==null?null:i.selectedEntityB.displayValue),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngIf",!i.selectedEntityB),o.\u0275\u0275advance(),o.\u0275\u0275property("legacyAutocompleteTrigger",C)("legacyAutocomplete",y)("displayWith",i.getControlDisplayValue),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngForOf",o.\u0275\u0275pipeBind1(52,48,i.entitiesB)),o.\u0275\u0275advance(5),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(57,50,"ConnectionPropertiesPage.Comment")),o.\u0275\u0275advance(2),o.\u0275\u0275property("value",i.comment)}},dependencies:[A.NgForOf,A.NgIf,mn.I,Be.G7,Be.cm,ao.d1,ge.iV,jn.q,ne.Ky,ne.V3,ne.aw,Me.aL,ro,A.AsyncPipe,R.D9],styles:["[_nghost-%COMP%]{display:block;position:relative;height:100%}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]{margin-right:0}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-right:10px;text-align:right}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.open-card[_ngcontent-%COMP%]{transform:rotate(-90deg)}.rtl[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%]{text-align:right}.header[_ngcontent-%COMP%]{max-width:343px;padding:12px 20px 0;min-height:97px;max-height:135px;border-top-left-radius:8px;border-top-right-radius:8px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]{height:56px;margin-top:5px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]{margin-top:7px;flex:0 0 69px;width:72px;height:56px;display:inline-flex;justify-content:center;align-items:center;margin-right:16px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{background-position:center;background-repeat:no-repeat}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:inline-block;letter-spacing:0px;text-align:left;margin-top:3px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;margin-top:7px;margin-right:10px;justify-content:flex-end;align-items:center}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool[_ngcontent-%COMP%]{width:16px;height:16px;font-size:16px}.content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;width:100%;position:absolute;overflow-x:hidden;overflow-y:auto;height:auto;bottom:0;top:135px}.content[_ngcontent-%COMP%]:last-child{padding-bottom:0}.content[_ngcontent-%COMP%]   .text-area[_ngcontent-%COMP%]{min-width:150px;width:100%}.content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%]{text-align:left;letter-spacing:0px}",'.rtl[_nghost-%COMP%]   .title-control-group[_ngcontent-%COMP%]{width:300px}.rtl[_nghost-%COMP%]   .title-control-group[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]{padding:revert;margin-left:0}.rtl[_nghost-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]{margin-left:-50px}.logo[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMC45MDgiIGhlaWdodD0iMTEuMDI5IiB2aWV3Qm94PSIwIDAgMTAuOTA4IDExLjAyOSI+PGRlZnM+PHN0eWxlPi5he2ZpbGw6bm9uZTtzdHJva2U6IzU0NjU3ZDt9PC9zdHlsZT48L2RlZnM+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4zNTYgMC40NDcpIj48cGF0aCBjbGFzcz0iYSIgZD0iTTQuMTMxLDEwLjIzLDE0LjIzNiwwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNC4xMzEpIi8+PGxpbmUgY2xhc3M9ImEiIHkxPSIyLjEyNSIgeDI9IjQuMjUxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1Ljg1NSkiLz48bGluZSBjbGFzcz0iYSIgeTE9IjQuMjUxIiB4Mj0iMi4xMjUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDcuOTgpIi8+PC9nPjwvc3ZnPg==);width:24px;height:24px}.title-control-group[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:324px}.title-control-group[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:100%}.title-control-group[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]{font-family:bpmonline designer icons;line-height:1px;line-height:.6px;font-size:24px;height:24px;width:24px;opacity:.8;margin:19px 19px 10px 5px}.title-control-group[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]:before{content:"\\e92c"!important;display:inline;position:relative}.content[_ngcontent-%COMP%]{padding:20px}.content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   .mat-divider[_ngcontent-%COMP%]{padding-bottom:20px}.content[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{margin:8px -20px 0}']})}}return r})();var oc=v(68642);function ac(r,t){if(r&1&&(o.\u0275\u0275elementStart(0,"mat-option",14),o.\u0275\u0275text(1),o.\u0275\u0275elementEnd()),r&2){const e=t.$implicit;o.\u0275\u0275property("value",e),o.\u0275\u0275advance(),o.\u0275\u0275textInterpolate1(" ",e.displayValue," ")}}function rc(r,t){if(r&1){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"mat-form-field",6)(1,"mat-label"),o.\u0275\u0275text(2),o.\u0275\u0275pipe(3,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(4,"input",11),o.\u0275\u0275listener("keyup",function(i){o.\u0275\u0275restoreView(e);const s=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(s.onGroupChange(i.target.value))})("focus",function(i){o.\u0275\u0275restoreView(e);const s=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(s.onGroupFocus(i.target.value))}),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(5,"mat-autocomplete",12,0),o.\u0275\u0275listener("optionSelected",function(i){o.\u0275\u0275restoreView(e);const s=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(s.onGroupSelected(i.option.value))}),o.\u0275\u0275template(7,ac,2,2,"mat-option",13),o.\u0275\u0275pipe(8,"async"),o.\u0275\u0275elementEnd()()}if(r&2){const e=o.\u0275\u0275reference(6),n=o.\u0275\u0275nextContext();o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(3,5,"EntityInGroupPropertiesDialog.Group")),o.\u0275\u0275advance(2),o.\u0275\u0275property("matAutocomplete",e)("value",n.selectedGroup==null?null:n.selectedGroup.displayValue),o.\u0275\u0275advance(),o.\u0275\u0275property("displayWith",n.getControlDisplayValue),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngForOf",o.\u0275\u0275pipeBind1(8,7,n.groups))}}function lc(r,t){if(r&1&&(o.\u0275\u0275elementStart(0,"mat-option",14),o.\u0275\u0275text(1),o.\u0275\u0275elementEnd()),r&2){const e=t.$implicit;o.\u0275\u0275property("value",e),o.\u0275\u0275advance(),o.\u0275\u0275textInterpolate1(" ",e.displayValue," ")}}function cc(r,t){if(r&1){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"mat-form-field",6)(1,"mat-label"),o.\u0275\u0275text(2),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(3,"input",11),o.\u0275\u0275listener("keyup",function(i){o.\u0275\u0275restoreView(e);const s=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(s.onEntityChange(i.target.value))})("focus",function(i){o.\u0275\u0275restoreView(e);const s=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(s.onEntityFocus(i.target.value))}),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(4,"mat-autocomplete",12,1),o.\u0275\u0275listener("optionSelected",function(i){o.\u0275\u0275restoreView(e);const s=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(s.onEntitySelected(i.option.value))}),o.\u0275\u0275template(6,lc,2,2,"mat-option",13),o.\u0275\u0275pipe(7,"async"),o.\u0275\u0275elementEnd()()}if(r&2){const e=o.\u0275\u0275reference(5),n=o.\u0275\u0275nextContext();o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(n.itemTypeSchemaCaption),o.\u0275\u0275advance(),o.\u0275\u0275property("matAutocomplete",e)("value",n.selectedEntity==null?null:n.selectedEntity.displayValue),o.\u0275\u0275advance(),o.\u0275\u0275property("displayWith",n.getControlDisplayValue),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngForOf",o.\u0275\u0275pipeBind1(7,5,n.entities))}}let vn=(()=>{class r{constructor(e,n){this.injector=n,this.itemTypeSchemaCaption="",this.isGroupVisible=!0,this.isEntityVisible=!0,this.isRtl=!1,this.injectDependencies(),this.initializeItemTypeSchemaCaption(),this.initializeEntityInGroup(e?.entityInGroup),this.initializeExludedGroups(e?.excludedGroups),this.initializeExludedEntityRecords(e?.exludedEntityRecords),this._initializeDirectionality()}_initializeDirectionality(){this.isRtl=this.directionality?.value==="rtl"}initializeExludedGroups(e){this.excludedGroups=e||[]}initializeExludedEntityRecords(e){this.excludedEntityRecords=e||[]}injectDependencies(){this.lookupDataService=this.injector.get(bt),this.translateService=this.injector.get(R.c$),this.diagramEventService=this.injector.get(le),this.directionality=this.injector.get(et.dS)}initializeItemTypeSchemaCaption(){var e=this;return(0,D.A)(function*(){const i=(yield e.diagramEventService.getDiagramConfig())?.customDiagramElements[k.relationshipItem]||{};e.itemTypeSchemaCaption=i.entitySchemaData?.caption||""})()}initializeEntityInGroup(e){e&&(this.entityInGroup=e,this.initializeComment(),this.initializeInputVisibility())}initializeComment(){this.entityInGroup?.comment||(this.entityInGroup.comment="")}initializeInputVisibility(){this.entityInGroup.groupId&&(this.isGroupVisible=!1),this.entityInGroup.entityId&&(this.isEntityVisible=!1)}getControlLookupValues(e){return this.lookupDataService.getFilteredLookupItems({value:e.value,schemaName:e.schemaName,excludedRecords:e.excludedRecords})}getGroupControlLookupValues(e=""){return this.getControlLookupValues({value:e,schemaName:"RelationshipGroup",excludedRecords:this.excludedGroups})}getContactControlLookupValues(e=""){return this.getControlLookupValues({value:e,schemaName:"Contact",excludedRecords:this.excludedEntityRecords})}isCardValid(){const e=!this.isEntityVisible||!!this.selectedEntity,n=!this.isGroupVisible||!!this.selectedGroup;return e&&n}getControlDisplayValue(e){return e?e.displayValue||e.value:""}onGroupChange(e){this.selectedGroup=null,this.groups=this.getGroupControlLookupValues(e)}onGroupSelected(e){this.selectedGroup=e,this.entityInGroup.groupId=e.value,this.groups=null}onGroupFocus(e){this.groups=this.getGroupControlLookupValues()}onEntityChange(e){this.selectedEntity=null,this.entities=this.getContactControlLookupValues(e)}onEntitySelected(e){this.selectedEntity=e;let n=this.entityInGroup.entityRecordData||{};n=Object.assign(n,{id:e.value,name:e.displayValue}),this.entityInGroup.entityRecordData=n,this.entities=null}onEntityFocus(e){this.entities=this.getContactControlLookupValues()}getDialogCaption(){const e=this.isGroupVisible||this.isEntityVisible?"AddToGroup":"Edit";return this.translateService.instant("EntityInGroupPropertiesDialog."+e)}static{this.\u0275fac=function(n){return new(n||r)(o.\u0275\u0275directiveInject(ee.xh),o.\u0275\u0275directiveInject(o.Injector))}}static{this.\u0275cmp=o.\u0275\u0275defineComponent({type:r,selectors:[["crt-entity-in-group-properties-dialog"]],hostVars:2,hostBindings:function(n,i){n&2&&o.\u0275\u0275classProp("rtl",i.isRtl)},decls:19,vars:15,consts:[["groupAutocomplete","matAutocomplete"],["contactAutocomplete","matAutocomplete"],[1,"add-entity-to-group-dialog"],["mat-dialog-title",""],["mat-dialog-content","",1,"relationship-dialog-content"],["floatLabel","always",4,"ngIf"],["floatLabel","always"],["type","text","matInput","",3,"input","value"],["mat-dialog-actions",""],["mat-button","",1,"crt-button",3,"mat-dialog-close"],["mat-flat-button","","color","accent",1,"action-button","crt-button",3,"mat-dialog-close","disabled"],["type","text","matInput","","required","",3,"keyup","focus","matAutocomplete","value"],[3,"optionSelected","displayWith"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(n,i){n&1&&(o.\u0275\u0275elementStart(0,"div",2)(1,"div",3)(2,"span"),o.\u0275\u0275text(3),o.\u0275\u0275elementEnd()(),o.\u0275\u0275elementStart(4,"div",4),o.\u0275\u0275template(5,rc,9,9,"mat-form-field",5)(6,cc,8,7,"mat-form-field",5),o.\u0275\u0275elementStart(7,"mat-form-field",6)(8,"mat-label"),o.\u0275\u0275text(9),o.\u0275\u0275pipe(10,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(11,"input",7),o.\u0275\u0275listener("input",function(l){return i.entityInGroup.comment=l.target.value}),o.\u0275\u0275elementEnd()()(),o.\u0275\u0275elementStart(12,"div",8)(13,"button",9),o.\u0275\u0275text(14),o.\u0275\u0275pipe(15,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(16,"button",10),o.\u0275\u0275text(17),o.\u0275\u0275pipe(18,"translate"),o.\u0275\u0275elementEnd()()()),n&2&&(o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(i.getDialogCaption()),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngIf",i.isGroupVisible),o.\u0275\u0275advance(),o.\u0275\u0275property("ngIf",i.isEntityVisible),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(10,9,"EntityInGroupPropertiesDialog.Comment")),o.\u0275\u0275advance(2),o.\u0275\u0275property("value",i.entityInGroup==null?null:i.entityInGroup.comment),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(15,11,"EntityInGroupPropertiesDialog.Cancel")," "),o.\u0275\u0275advance(2),o.\u0275\u0275property("mat-dialog-close",i.entityInGroup)("disabled",!i.isCardValid()),o.\u0275\u0275advance(),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(18,13,"EntityInGroupPropertiesDialog.Save")," "))},dependencies:[A.NgForOf,A.NgIf,Be.G7,Be.cm,ao.d1,ge.iV,ee.kQ,ee.KI,ee.PQ,ee.$t,ne.Ky,ne.aw,Me.aL,A.AsyncPipe,R.D9],styles:["[_nghost-%COMP%]{min-width:240px}[_nghost-%COMP%]   .mat-dialog-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-top:4px;font-family:var(--crt-headline-2-font-family);font-size:var(--crt-headline-2-font-size);line-height:var(--crt-headline-2-line-height);font-weight:var(--crt-headline-2-font-weight);letter-spacing:var(--crt-headline-2-letter-spacing);text-transform:var(--crt-headline-2-text-transform);-webkit-font-smoothing:antialiased;color:var(--crt-palette-primary-500, var(--palette-primary-500))}.rtl[_nghost-%COMP%]   .mat-dialog-title[_ngcontent-%COMP%]{text-align:right}.rtl[_nghost-%COMP%]   .mat-autocomplete.mat-autocomplete[_ngcontent-%COMP%]:after{right:auto}.mat-dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column}.mat-dialog-content[_ngcontent-%COMP%]   .mat-form-field-wrapper[_ngcontent-%COMP%]   .mat-form-field-label-wrapper[_ngcontent-%COMP%]   .mat-form-field-required-marker[_ngcontent-%COMP%]{color:#f44336}.mat-dialog-actions[_ngcontent-%COMP%]{justify-content:flex-end}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%], .mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]{font-family:var(--crt-button-font-family, var(--button-font-family));font-size:var(--crt-button-font-size, var(--button-font-size));font-weight:var(--crt-button-font-weight, var(--button-font-weight));text-transform:var(--crt-button-text-transform, uppercase);border-radius:var(--button-border-radius, var(--button-rounded-border-radius))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[disabled][_ngcontent-%COMP%]{color:var(--crt-palette-disabled-500, var(--palette-primary-contrast-500));background-color:var(--crt-palette-disabled-50, rgba(var(--disabled-button-background), 1))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]){color:var(--crt-palette-primary-contrast-500, var(--palette-primary-contrast-500));background-color:var(--crt-palette-primary-500, var(--palette-primary-500))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]):focus{color:var(--crt-palette-primary-contrast-500, var(--palette-primary-contrast-500));background-color:var(--crt-palette-primary-500, var(--palette-primary-500))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]):hover, .mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]).cdk-keyboard-focused{background-color:var(--crt-palette-primary-800, var(--palette-primary-800))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]):active{background-color:var(--crt-palette-primary-900, var(--palette-primary-800))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{color:var(--crt-palette-secondary-500, var(--palette-primary-500))!important}"]})}}return r})();const dc=["colorBox"];function gc(r,t){if(r&1){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"color-github",15),o.\u0275\u0275listener("onChangeComplete",function(i){o.\u0275\u0275restoreView(e);const s=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(s.onChangeColor(i))}),o.\u0275\u0275elementEnd()}if(r&2){const e=o.\u0275\u0275nextContext();o.\u0275\u0275styleProp("left",e.colorPickerPosition.x,"px")("top",e.colorPickerPosition.y,"px"),o.\u0275\u0275property("triangle","top-right")("color",e.group.color)("colors",e.colors)("width",187)}}let fn=(()=>{class r{constructor(e,n,i){this.translateService=n,this.isNew=!0,this.colors=["#FF2031","#C40069","#C400A9","#8400C4","#5200C4","#2B00C4","#005BC4","#0076C4","#009FC4","#29A5A1","#00C4A8","#00C46D","#00C407","#A3C400"],this.isColorTabVisible=!1,this.colorPickerPosition={x:0,y:0},this.group={id:(0,K.generateGuid)(),name:"",color:"#000000",comment:""},this.isRtl=!1,e?.group?(this.group=e.group,this.isNew=!1):this.initializeColor(),this._initializeDirectionality(i)}_initializeDirectionality(e){this.isRtl=e?.value==="rtl"}initializeColor(){const e=Math.floor(Math.random()*Math.floor(this.colors.length-1));this.group.color=this.colors[e]}initializeColorPickerPostion(){const e=this.colorBox?.nativeElement;if(!e)return;let n=e.offsetLeft,i=e.offsetTop;i+=30,n-=145,this.colorPickerPosition={x:n,y:i}}showColorTab(){this.initializeColorPickerPostion(),this.isColorTabVisible=!0}onChangeColor(e){this.group.color=e.color.hex}onGlobalClick(e){this.colorBox.nativeElement.contains(e.target)||(this.isColorTabVisible=!1)}getDialogCaption(){const e=this.isNew?"NewGroup":"EditGroup";return this.translateService.instant("GroupPropertiesDialog."+e)}static{this.\u0275fac=function(n){return new(n||r)(o.\u0275\u0275directiveInject(ee.xh),o.\u0275\u0275directiveInject(R.c$),o.\u0275\u0275directiveInject(et.dS))}}static{this.\u0275cmp=o.\u0275\u0275defineComponent({type:r,selectors:[["crt-group-properties-dialog"]],viewQuery:function(n,i){if(n&1&&o.\u0275\u0275viewQuery(dc,5,o.ElementRef),n&2){let s;o.\u0275\u0275queryRefresh(s=o.\u0275\u0275loadQuery())&&(i.colorBox=s.first)}},hostVars:2,hostBindings:function(n,i){n&1&&o.\u0275\u0275listener("mousedown",function(l){return i.onGlobalClick(l)},!1,o.\u0275\u0275resolveDocument),n&2&&o.\u0275\u0275classProp("rtl",i.isRtl)},decls:27,vars:20,consts:[["colorBox",""],["mat-dialog-title",""],["mat-dialog-content","",1,"relationship-dialog-content"],[1,"flex-row-control-group"],["floatLabel","always",1,"name-control"],["matInput","","type","text","required","",3,"input","value"],["floatLabel","always"],["matInput","","type","text",3,"input","value"],[1,"color-box-wrap"],[1,"color-box"],[1,"choose-button",3,"click"],["class","color-picker",3,"left","top","triangle","color","colors","width","onChangeComplete",4,"ngIf"],["mat-dialog-actions",""],["mat-button","","cdkFocusInitial","",1,"crt-button",3,"mat-dialog-close"],["mat-flat-button","","color","accent",1,"crt-button",3,"mat-dialog-close","disabled"],[1,"color-picker",3,"onChangeComplete","triangle","color","colors","width"]],template:function(n,i){if(n&1){const s=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"div",1)(1,"span"),o.\u0275\u0275text(2),o.\u0275\u0275elementEnd()(),o.\u0275\u0275elementStart(3,"div",2)(4,"div",3)(5,"mat-form-field",4)(6,"mat-label"),o.\u0275\u0275text(7),o.\u0275\u0275pipe(8,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(9,"input",5),o.\u0275\u0275listener("input",function(c){return o.\u0275\u0275restoreView(s),o.\u0275\u0275resetView(i.group.name=c.target.value)}),o.\u0275\u0275elementEnd()(),o.\u0275\u0275elementStart(10,"mat-form-field",6)(11,"mat-label"),o.\u0275\u0275text(12),o.\u0275\u0275pipe(13,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(14,"input",7),o.\u0275\u0275listener("input",function(c){return o.\u0275\u0275restoreView(s),o.\u0275\u0275resetView(i.group.comment=c.target.value)}),o.\u0275\u0275elementEnd()()(),o.\u0275\u0275elementStart(15,"div",8,0),o.\u0275\u0275element(17,"div",9),o.\u0275\u0275elementStart(18,"div",10),o.\u0275\u0275listener("click",function(){return o.\u0275\u0275restoreView(s),o.\u0275\u0275resetView(i.showColorTab())}),o.\u0275\u0275elementEnd(),o.\u0275\u0275template(19,gc,1,8,"color-github",11),o.\u0275\u0275elementEnd()(),o.\u0275\u0275elementStart(20,"div",12)(21,"button",13),o.\u0275\u0275text(22),o.\u0275\u0275pipe(23,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(24,"button",14),o.\u0275\u0275text(25),o.\u0275\u0275pipe(26,"translate"),o.\u0275\u0275elementEnd()()}n&2&&(o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(i.getDialogCaption()),o.\u0275\u0275advance(5),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(8,12,"GroupPropertiesDialog.Name")),o.\u0275\u0275advance(2),o.\u0275\u0275property("value",i.group.name),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(13,14,"GroupPropertiesDialog.Comment")),o.\u0275\u0275advance(2),o.\u0275\u0275property("value",i.group.comment),o.\u0275\u0275advance(3),o.\u0275\u0275styleProp("background",i.group.color),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngIf",i.isColorTabVisible),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(23,16,"GroupPropertiesDialog.Cancel")," "),o.\u0275\u0275advance(2),o.\u0275\u0275property("mat-dialog-close",i.group)("disabled",!(i.group!=null&&i.group.name)),o.\u0275\u0275advance(),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(26,18,"GroupPropertiesDialog.Save")," "))},dependencies:[A.NgIf,Yi.Tj,ge.iV,ee.kQ,ee.KI,ee.PQ,ee.$t,ne.Ky,ne.aw,Me.aL,R.D9],styles:["[_nghost-%COMP%]{min-width:240px}[_nghost-%COMP%]   .mat-dialog-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-top:4px;font-family:var(--crt-headline-2-font-family, var(--dialog-title-font-family));font-size:var(--crt-headline-2-font-size, var(--dialog-title-font-size));line-height:var(--crt-headline-2-line-height, var(--dialog-title-line-height));font-weight:var(--crt-headline-2-font-weight, var(--dialog-title-font-weight));color:var(--crt-palette-primary-500, var(--palette-primary-500))}.rtl[_nghost-%COMP%]   .mat-dialog-content[_ngcontent-%COMP%]   .color-box-wrap[_ngcontent-%COMP%]{margin-right:30px}.rtl[_nghost-%COMP%]   .mat-dialog-title[_ngcontent-%COMP%]{text-align:right}.mat-dialog-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.mat-dialog-content[_ngcontent-%COMP%]   .flex-row-control-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1}.mat-dialog-content[_ngcontent-%COMP%]   .flex-row-control-group[_ngcontent-%COMP%]   .name-control[_ngcontent-%COMP%]{width:100%}.mat-dialog-content[_ngcontent-%COMP%]   .color-box-wrap[_ngcontent-%COMP%]{height:16px;width:32px;display:flex;margin-left:10px;flex-direction:row;margin-top:20px}.mat-dialog-content[_ngcontent-%COMP%]   .color-box-wrap[_ngcontent-%COMP%]   .color-box[_ngcontent-%COMP%]{height:16px;width:16px;border:1px solid #cccccc}.mat-dialog-content[_ngcontent-%COMP%]   .color-box-wrap[_ngcontent-%COMP%]   .choose-button[_ngcontent-%COMP%]{height:16px;width:16px;background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmF7ZmlsbDojNTQ2NTdkO30uYntmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNzgzLjc3OSA3NC40NTUpIj48cGF0aCBjbGFzcz0iYSIgZD0iTTE3ODcuNzc5LTY3LjQ1NWw0LDQsNC00WiIvPjwvZz48cmVjdCBjbGFzcz0iYiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+PC9zdmc+);background-position:center;background-repeat:no-repeat}.mat-dialog-content[_ngcontent-%COMP%]   .color-box-wrap[_ngcontent-%COMP%]   .choose-button[_ngcontent-%COMP%]:hover{cursor:pointer}.mat-dialog-content[_ngcontent-%COMP%]   .color-box-wrap[_ngcontent-%COMP%]   .color-picker[_ngcontent-%COMP%]{position:absolute;z-index:2600}.mat-dialog-content[_ngcontent-%COMP%]   .mat-form-field-wrapper[_ngcontent-%COMP%]   .mat-form-field-label-wrapper[_ngcontent-%COMP%]   mat-label[_ngcontent-%COMP%]{font-family:var(--crt-font-family, var(--font-family))}.mat-dialog-content[_ngcontent-%COMP%]   .mat-form-field-wrapper[_ngcontent-%COMP%]   .mat-form-field-label-wrapper[_ngcontent-%COMP%]   .mat-form-field-required-marker[_ngcontent-%COMP%]{color:#f44336}.mat-dialog-actions[_ngcontent-%COMP%]{justify-content:flex-end}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%], .mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]{font-family:var(--crt-button-font-family, var(--button-font-family));font-size:var(--crt-button-font-size, var(--button-font-size));font-weight:var(--crt-button-font-weight, var(--button-font-weight));text-transform:var(--crt-button-text-transform, uppercase);border-radius:var(--button-border-radius, var(--button-rounded-border-radius))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[disabled][_ngcontent-%COMP%]{color:var(--crt-palette-disabled-500, var(--palette-primary-contrast-500));background-color:var(--crt-palette-disabled-50, rgba(var(--disabled-button-background), 1))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]){color:var(--crt-palette-primary-contrast-500, var(--palette-primary-contrast-500));background-color:var(--crt-palette-primary-500, var(--palette-primary-500))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]):focus{color:var(--crt-palette-primary-contrast-500, var(--palette-primary-contrast-500));background-color:var(--crt-palette-primary-500, var(--palette-primary-500))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]):hover, .mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]).cdk-keyboard-focused{background-color:var(--crt-palette-primary-800, var(--palette-primary-800))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]):active{background-color:var(--crt-palette-primary-900, var(--palette-primary-800))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{color:var(--crt-palette-secondary-500, var(--palette-primary-500))!important}"]})}}return r})();const pc=r=>({"background-image":r});function hc(r,t){if(r&1){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"button",22),o.\u0275\u0275listener("click",function(i){o.\u0275\u0275restoreView(e);const s=o.\u0275\u0275nextContext().$implicit,l=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(l.addEntityToGroup(i,s.id))}),o.\u0275\u0275elementEnd()}}function uc(r,t){if(r&1){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"mat-list-item",23)(1,"div",24)(2,"div",25),o.\u0275\u0275element(3,"div",26),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(4,"div",27)(5,"div",28),o.\u0275\u0275text(6),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(7,"div",29)(8,"div"),o.\u0275\u0275text(9),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(10,"div",30),o.\u0275\u0275element(11,"button",31),o.\u0275\u0275elementStart(12,"mat-menu",16,1)(14,"button",18),o.\u0275\u0275listener("click",function(){const i=o.\u0275\u0275restoreView(e).$implicit,s=o.\u0275\u0275nextContext(2);return o.\u0275\u0275resetView(s.editEntityInGroup(i))}),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(15,"button",19),o.\u0275\u0275listener("click",function(){const i=o.\u0275\u0275restoreView(e).$implicit,s=o.\u0275\u0275nextContext(2);return o.\u0275\u0275resetView(s.deleteEntityFromGroup(i.entityId,i.groupId))}),o.\u0275\u0275elementEnd()()()(),o.\u0275\u0275elementStart(16,"div",32),o.\u0275\u0275text(17),o.\u0275\u0275elementEnd()()()()}if(r&2){const e=t.$implicit,n=o.\u0275\u0275reference(13);o.\u0275\u0275advance(3),o.\u0275\u0275property("ngStyle",o.\u0275\u0275pureFunction1(5,pc,"url("+(e.entityRecordData==null?null:e.entityRecordData.image)+")")),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(e.entityRecordData.type),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(e.entityRecordData.name),o.\u0275\u0275advance(2),o.\u0275\u0275property("matMenuTriggerFor",n),o.\u0275\u0275advance(6),o.\u0275\u0275textInterpolate(e.comment)}}function mc(r,t){if(r&1){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"mat-list-item",4)(1,"mat-expansion-panel",5)(2,"mat-expansion-panel-header",6)(3,"div",7)(4,"div",8),o.\u0275\u0275element(5,"mat-icon",9),o.\u0275\u0275elementStart(6,"div",10)(7,"div",11),o.\u0275\u0275text(8),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(9,"div",12),o.\u0275\u0275text(10),o.\u0275\u0275elementEnd()()(),o.\u0275\u0275elementStart(11,"div",13),o.\u0275\u0275template(12,hc,1,0,"button",14),o.\u0275\u0275elementStart(13,"button",15),o.\u0275\u0275listener("click",function(i){return o.\u0275\u0275restoreView(e),o.\u0275\u0275resetView(i==null?null:i.stopPropagation())}),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(14,"mat-menu",16,0)(16,"button",17),o.\u0275\u0275listener("click",function(i){const s=o.\u0275\u0275restoreView(e).$implicit,l=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(l.toggleHighlightGroup(i,s.id))}),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(17,"button",18),o.\u0275\u0275listener("click",function(){const i=o.\u0275\u0275restoreView(e).$implicit,s=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(s.editGroup(i))}),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(18,"button",19),o.\u0275\u0275listener("click",function(){const i=o.\u0275\u0275restoreView(e).$implicit,s=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(s.deleteGroup(i.id))}),o.\u0275\u0275elementEnd()()()()(),o.\u0275\u0275elementStart(19,"mat-list",20),o.\u0275\u0275template(20,uc,18,7,"mat-list-item",21),o.\u0275\u0275elementEnd()()()}if(r&2){const e=t.$implicit,n=o.\u0275\u0275reference(15),i=o.\u0275\u0275nextContext();o.\u0275\u0275advance(),o.\u0275\u0275property("expanded",!0),o.\u0275\u0275advance(),o.\u0275\u0275property("collapsedHeight","33px")("expandedHeight","33px"),o.\u0275\u0275advance(3),o.\u0275\u0275styleProp("background",e.color),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(e.name),o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate1("(",i.getGroupEntitiesCount(e),")"),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngIf",i.isAddEntityToGroupButtonVisible()),o.\u0275\u0275advance(),o.\u0275\u0275property("matMenuTriggerFor",n),o.\u0275\u0275advance(3),o.\u0275\u0275classProp("selectedGroup",i.highlightedGroupId===e.id),o.\u0275\u0275advance(4),o.\u0275\u0275property("ngForOf",e.entities)}}let yn=(()=>{class r{set isLoading(e){this.groupContentListEventService.isLoading(e)}set filteredEntityId(e){e!==this._filteredEntityId&&(this._filteredEntityId=e)}set searchFilter(e){e!==this._searchFilter&&(this._searchFilter=e,this.renderGroup())}_initializeDirectionality(){this.isRtl=this.directionality?.value==="rtl"}_initializeGTM(){this._subscription.add(this.googleTagManagerService.initialize().subscribe())}constructor(e){this.injector=e,this._subscription=new w.Subscription,this._searchFilter="",this.groups=[],this.renderedGroups=[],this.searchFilterChange=new o.EventEmitter,this.changed=new o.EventEmitter,this.isRtl=!1,this.injectDependencies(),this.subscribePageEvent(),this._initializeDirectionality(),this._initializeGTM()}injectDependencies(){this.diagramEventService=this.injector.get(le),this.directionality=this.injector.get(et.dS),this.googleTagManagerService=this.injector.get(nt.AR),this.relationshipDesignerService=this.injector.get(Ke),this.groupContentListEventService=this.injector.get(Et),this.dialogService=this.injector.get(Q.o3),this.translateService=this.injector.get(R.c$),this.relationshipDeleteDialogService=this.injector.get(Xe)}initializeGroups(){this.isLoading=!0;const e=this.relationshipDesignerService,n=this._filteredEntityId;(n?e.getGroupsDataForEntity(n):e.getGroupsData()).subscribe(s=>{if(!s?.success){this.isLoading=!1,this.showErrorDialog(s);return}this.groups=s.groups,this.renderGroup(),this.isLoading=!1})}renderGroup(){const e=(0,re.A)(this.groups);this.renderedGroups=this.filteredGroupByFilter(e)}filteredGroupByFilter(e){const n=this._searchFilter?.toLocaleLowerCase();return n?e.filter(i=>{let s=i.entities||[];return s=s.filter(l=>{const c=l.entityRecordData?.name||"";return this.isStringContain(c,n)}),i.entities=s,s.length===0?this.isStringContain(i.name,n)?i:!1:i}):e}isStringContain(e,n){return e.toLowerCase().indexOf(n)>=0}clearSearchFilter(){this._searchFilter="",this.searchFilterChange.emit(this._searchFilter),this.renderGroup()}showErrorDialog(e){if(e?.success)return;const n=e?.errorInfo?.message||"An unknown error occurred during the operation.";this._subscription.add(this.dialogService.openInfoDialog(n).subscribe())}handleBaseDialogAction(e,n,i){e&&(this.isLoading=!0,n.call(this.relationshipDesignerService,e).subscribe(s=>this.handleBaseResponseAction(s,i)))}handleBaseResponseAction(e,n){if(!e?.success){this.isLoading=!1,this.showErrorDialog(e);return}n(),this.clearSearchFilter(),this.isLoading=!1,this.changed.emit(this.groups)}subscribePageEvent(){const e=this.groupContentListEventService;this._subscription.add(e.createGroup$.subscribe(()=>this.createGroup())),this._subscription.add(e.addEntityToGroup$.subscribe(n=>this.doAddEntityToGroup(n))),this._subscription.add(e.initializeGroups$.subscribe(()=>this.initializeGroups()))}addGroupToList(e){this.groups.push(e)}updateGroupInList(e){const n=this.groups.findIndex(i=>i.id===e.id);this.groups[n]=e}deleteGroupFromList(e){const n=this.groups.findIndex(i=>i.id===e);this.groups.splice(n,1),this.diagramEventService.entityInGroupRemoving()}doAddEntityToGroup(e){const n={panelClass:["relationship-dialog-edit"],data:{entityInGroup:e,excludedGroups:this.getExcludedGroupsList(),exludedEntityRecords:this.getExcludedEntityRecords(e)},autoFocus:!1},i=this.dialogService.open(vn,n).subscribe(s=>{this.handleBaseDialogAction(s,this.relationshipDesignerService.createEntityInGroup,()=>{this.addEntityInGroupToList(s),this.diagramEventService.entityInGroupAdded(),this.sendGtmAction({action:Je.AddEntityInGroup})})});this._subscription.add(i)}addEntityInGroupToList(e){this.initializeGroups()}updateEntityInGroupInList(e){const n=this.groups.find(s=>s.id===e.groupId),i=n.entities.findIndex(s=>s.id===e.id);n.entities[i]=e}deleteEntityInGroupFromList(e,n){const i=this.groups.find(l=>l.id===n),s=i.entities.findIndex(l=>l.entityId===e);i.entities.splice(s,1)}getExcludedGroupsList(){return this._filteredEntityId?this.groups.map(e=>e.id):[]}getExcludedEntityRecords(e){if(this._filteredEntityId||!e.groupId)return[];const n=[];return this.groups.find(s=>s.id===e.groupId).entities?.forEach(s=>n.push(s.entityRecordData.id)),n}sendGtmAction(e){const n={moduleName:"RelationshipDesignerModule",schemaName:"GroupContentListComponent"};e&&n&&this.googleTagManagerService.track((0,Qe.A)(n,e))}getGroupEntitiesCount(e){return e.entities?.length||0}ngOnInit(){this.initializeGroups()}ngOnDestroy(){this._subscription.unsubscribe()}createGroup(){const e={panelClass:["relationship-dialog-edit"],data:{}},n=this.dialogService.open(fn,e).subscribe(i=>{this.handleBaseDialogAction(i,this.relationshipDesignerService.createGroup,()=>{this.addGroupToList(i),this.sendGtmAction({action:Je.AddGroup})})});this._subscription.add(n)}editGroup(e){const n=Object.assign({},e),i={panelClass:["relationship-dialog-edit"],data:{group:n}},s=this.dialogService.open(fn,i).subscribe(l=>{this.handleBaseDialogAction(l,this.relationshipDesignerService.updateGroup,()=>this.updateGroupInList(l))});this._subscription.add(s)}deleteGroup(e){const n=this.relationshipDeleteDialogService.confirmRemoving("RelationshipDesigner.DeleteItemMessage").subscribe(i=>{i&&(this.isLoading=!0,this.relationshipDesignerService.deleteGroup(e).subscribe(s=>{this.handleBaseResponseAction(s,()=>this.deleteGroupFromList(e))}))});this._subscription.add(n)}toggleHighlightGroup(e,n){e?.stopPropagation(),this.highlightedGroupId=n!==this.highlightedGroupId?n:null,this.diagramEventService.highlightGroup(this.highlightedGroupId)}addEntityToGroup(e,n){e?.stopPropagation(),this.doAddEntityToGroup({groupId:n})}editEntityInGroup(e){const n={panelClass:["relationship-dialog-edit"],data:{entityInGroup:Object.assign({},e)}},i=this.dialogService.open(vn,n).subscribe(s=>{this.handleBaseDialogAction(s,this.relationshipDesignerService.updateEntityInGroup,()=>this.updateEntityInGroupInList(s))});this._subscription.add(i)}deleteEntityFromGroup(e,n){const i=this.relationshipDeleteDialogService.confirmRemoving("RelationshipDesigner.DeleteItemMessage").subscribe(s=>{s&&this.relationshipDesignerService.deleteEntityInGroup(e,n).subscribe(l=>{this.handleBaseResponseAction(l,()=>this.deleteEntityInGroupFromList(e,n))})});this._subscription.add(i)}isAddEntityToGroupButtonVisible(){return!this._filteredEntityId}static{this.\u0275fac=function(n){return new(n||r)(o.\u0275\u0275directiveInject(o.Injector))}}static{this.\u0275cmp=o.\u0275\u0275defineComponent({type:r,selectors:[["crt-group-content-list"]],hostVars:2,hostBindings:function(n,i){n&2&&o.\u0275\u0275classProp("rtl",i.isRtl)},inputs:{filteredEntityId:"filteredEntityId",searchFilter:"searchFilter"},outputs:{searchFilterChange:"searchFilterChange",changed:"changed"},decls:2,vars:1,consts:[["matGroupItemMenu","matMenu"],["matGroupEntityItemMenu","matMenu"],[1,"group-list"],["class","group-list-item",4,"ngFor","ngForOf"],[1,"group-list-item"],[3,"expanded"],[3,"collapsedHeight","expandedHeight"],[1,"group-list-item-content"],[1,"group-list-item-info"],["matListIcon","",1,"group-icon"],[1,"group-caption-block"],[1,"group-caption"],[1,"group-caption-count"],[1,"group-list-item-actions"],["disableRipple","","mat-icon-button","","class","group-add-icon",3,"click",4,"ngIf"],["disableRipple","","mat-icon-button","",1,"group-menu-button",3,"click","matMenuTriggerFor"],["xPosition","before","yPosition","above",1,"relationship-group-menu"],["mat-menu-item","",1,"highlight",3,"click"],["mat-menu-item","",1,"edit",3,"click"],["mat-menu-item","",1,"delete",3,"click"],[1,"group-entity-list"],["class","group-entity-list-item",4,"ngFor","ngForOf"],["disableRipple","","mat-icon-button","",1,"group-add-icon",3,"click"],[1,"group-entity-list-item"],[1,"group-entity-list-item-info"],[1,"entity-logo"],[1,"logo",3,"ngStyle"],[1,"entity-info"],[1,"entity-type"],[1,"entity-name"],[1,"group-entity-list-item-actions"],["disableRipple","","mat-icon-button","",1,"group-menu-button",3,"matMenuTriggerFor"],[1,"entity-comment"]],template:function(n,i){n&1&&(o.\u0275\u0275elementStart(0,"mat-list",2),o.\u0275\u0275template(1,mc,21,12,"mat-list-item",3),o.\u0275\u0275elementEnd()),n&2&&(o.\u0275\u0275advance(),o.\u0275\u0275property("ngForOf",i.renderedGroups))},dependencies:[A.NgForOf,A.NgIf,A.NgStyle,ge.iV,Ie.GK,Ie.Z2,It.An,Pe.Qc,Pe.zB,Pe.pq,Ee.pI,Ee.gy,Ee.fS],styles:[".rtl[_nghost-%COMP%]   .group-list-item-content[_ngcontent-%COMP%]   .group-list-item-info[_ngcontent-%COMP%]   .group-icon[_ngcontent-%COMP%]{margin-left:7px;margin-right:0}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .search-tool[_ngcontent-%COMP%]{display:flex}.group-list-item-content[_ngcontent-%COMP%]{display:flex;width:100%;height:33px}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-info[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-info[_ngcontent-%COMP%]   .group-icon[_ngcontent-%COMP%]{height:12px;width:12px;padding:0;margin-right:7px}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-info[_ngcontent-%COMP%]   .group-caption-block[_ngcontent-%COMP%]{width:212px;display:flex;flex-direction:row}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-info[_ngcontent-%COMP%]   .group-caption-block[_ngcontent-%COMP%]   .group-caption[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-info[_ngcontent-%COMP%]   .group-caption-block[_ngcontent-%COMP%]   .group-caption-count[_ngcontent-%COMP%]{white-space:pre}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-actions[_ngcontent-%COMP%]{display:flex;align-items:center;opacity:0}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-actions[_ngcontent-%COMP%]   .group-add-icon[_ngcontent-%COMP%]{margin:0}.mat-expansion-panel-header[_ngcontent-%COMP%]:hover   .group-list-item-content[_ngcontent-%COMP%]   .group-list-item-actions[_ngcontent-%COMP%]{opacity:unset}.entity-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}.entity-logo[_ngcontent-%COMP%]{min-height:100%;width:42px;display:flex;flex-direction:column;justify-content:center}.entity-logo[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{height:32px;width:32px;border-radius:16px;background-position:center;background-repeat:no-repeat}"]})}}return r})();const vc=r=>({"background-image":r});function fc(r,t){if(r&1){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"mat-list-item",3)(1,"div",4)(2,"div",5),o.\u0275\u0275element(3,"div",6),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(4,"div",7)(5,"div",8),o.\u0275\u0275text(6),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(7,"div",9)(8,"div"),o.\u0275\u0275text(9),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(10,"div",10),o.\u0275\u0275element(11,"button",11),o.\u0275\u0275elementStart(12,"mat-menu",12,0)(14,"button",13),o.\u0275\u0275listener("click",function(){const i=o.\u0275\u0275restoreView(e).$implicit,s=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(s.edit(i))}),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(15,"button",14),o.\u0275\u0275listener("click",function(){const i=o.\u0275\u0275restoreView(e).$implicit,s=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(s.delete(i))}),o.\u0275\u0275elementEnd()()()(),o.\u0275\u0275elementStart(16,"div",15),o.\u0275\u0275text(17),o.\u0275\u0275elementEnd()()()()}if(r&2){const e=t.$implicit,n=o.\u0275\u0275reference(13);o.\u0275\u0275advance(3),o.\u0275\u0275property("ngStyle",o.\u0275\u0275pureFunction1(5,vc,"url("+e.image+")")),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(e.typeCaption),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(e.entityCaption),o.\u0275\u0275advance(2),o.\u0275\u0275property("matMenuTriggerFor",n),o.\u0275\u0275advance(6),o.\u0275\u0275textInterpolate(e.comment)}}let Ki=(()=>{class r{constructor(e){this.injector=e,this.subscription=new w.Subscription,this.isRtl=!1,this.injectDependencies(),this._initializeDirectionality()}_initializeDirectionality(){this.isRtl=this.directionality?.value==="rtl"}injectDependencies(){this.designerService=this.injector.get(Ke),this.diagramEventService=this.injector.get(le),this.dialogService=this.injector.get(Q.o3),this.translateService=this.injector.get(R.c$),this.directionality=this.injector.get(et.dS),this.relationshipDeleteDialogService=this.injector.get(Xe)}showErrorDialog(e){if(e?.success)return;const n=e?.errorInfo?.message||"An unknown error occurred during the operation.";this.subscription.add(this.dialogService.openInfoDialog(n).subscribe())}ngOnDestroy(){this.subscription.unsubscribe()}edit(e){this.diagramEventService.elementDoubleClick$.next(e.id)}delete(e){this.relationshipDeleteDialogService.confirmRemoving("RelationshipDesigner.DeleteItemMessage").subscribe(n=>{n&&this.designerService.deleteConnection(e.originalId).subscribe(i=>{if(!i?.success){this.showErrorDialog(i);return}this.diagramEventService.diagramChanged$.next()})})}static{this.\u0275fac=function(n){return new(n||r)(o.\u0275\u0275directiveInject(o.Injector))}}static{this.\u0275cmp=o.\u0275\u0275defineComponent({type:r,selectors:[["crt-related-list"]],hostVars:2,hostBindings:function(n,i){n&2&&o.\u0275\u0275classProp("rtl",i.isRtl)},inputs:{relatedItems:"relatedItems"},decls:2,vars:1,consts:[["matRelatedItemMenu","matMenu"],[1,"related-list"],["class","related-list-item",4,"ngFor","ngForOf"],[1,"related-list-item"],[1,"related-list-item-info"],[1,"related-entity-logo"],[1,"logo",3,"ngStyle"],[1,"related-info"],[1,"related-type-caption"],[1,"related-entity-name"],[1,"related-list-item-actions"],["mat-icon-button","",1,"related-item-menu-button",3,"matMenuTriggerFor"],["xPosition","before","yPosition","above",1,"relationship-group-menu"],["mat-menu-item","",1,"edit",3,"click"],["mat-menu-item","",1,"delete",3,"click"],[1,"related-comment"]],template:function(n,i){n&1&&(o.\u0275\u0275elementStart(0,"mat-list",1),o.\u0275\u0275template(1,fc,18,7,"mat-list-item",2),o.\u0275\u0275elementEnd()),n&2&&(o.\u0275\u0275advance(),o.\u0275\u0275property("ngForOf",i.relatedItems))},dependencies:[A.NgForOf,A.NgStyle,ge.iV,Pe.Qc,Pe.zB,Ee.pI,Ee.gy,Ee.fS],styles:[".rtl[_nghost-%COMP%]   .related-list-item-info[_ngcontent-%COMP%]   .related-info[_ngcontent-%COMP%]   .related-type-caption[_ngcontent-%COMP%]{padding-right:0;padding-left:20px}.rtl[_nghost-%COMP%]   .related-list-item-info[_ngcontent-%COMP%]   .related-info[_ngcontent-%COMP%]   .related-comment[_ngcontent-%COMP%]{padding-right:0;padding-left:20px}"]})}}return r})();const yc=r=>({"background-image":r});function Cc(r,t){r&1&&o.\u0275\u0275element(0,"ts-mask",13)}function xc(r,t){if(r&1&&(o.\u0275\u0275elementStart(0,"mat-form-field",17)(1,"mat-label"),o.\u0275\u0275text(2),o.\u0275\u0275pipe(3,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275element(4,"input",18),o.\u0275\u0275elementEnd()),r&2){const e=o.\u0275\u0275nextContext(2);o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(3,2,"ContainerPropertiesPage.Type")),o.\u0275\u0275advance(2),o.\u0275\u0275property("value",e.elementData==null||e.elementData.recordInfo==null?null:e.elementData.recordInfo.type)}}function bc(r,t){if(r&1&&(o.\u0275\u0275elementStart(0,"mat-form-field",17)(1,"mat-label"),o.\u0275\u0275text(2),o.\u0275\u0275pipe(3,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275element(4,"input",18),o.\u0275\u0275elementEnd()),r&2){const e=o.\u0275\u0275nextContext(2);o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(3,2,"ContainerPropertiesPage.Address")),o.\u0275\u0275advance(2),o.\u0275\u0275property("value",e.elementData==null||e.elementData.recordInfo==null?null:e.elementData.recordInfo.address)}}function Ec(r,t){if(r&1&&(o.\u0275\u0275elementStart(0,"mat-form-field",17)(1,"mat-label"),o.\u0275\u0275text(2),o.\u0275\u0275pipe(3,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275element(4,"input",19),o.\u0275\u0275elementEnd()),r&2){const e=o.\u0275\u0275nextContext(2);o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(3,2,"ContainerPropertiesPage.Phone")),o.\u0275\u0275advance(2),o.\u0275\u0275property("value",e.elementData==null||e.elementData.recordInfo==null?null:e.elementData.recordInfo.phone)}}function jc(r,t){if(r&1&&(o.\u0275\u0275elementStart(0,"mat-form-field",17)(1,"mat-label"),o.\u0275\u0275text(2),o.\u0275\u0275pipe(3,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275element(4,"input",20),o.\u0275\u0275elementEnd()),r&2){const e=o.\u0275\u0275nextContext(2);o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(3,2,"ContainerPropertiesPage.Email")),o.\u0275\u0275advance(2),o.\u0275\u0275property("value",e.elementData==null||e.elementData.recordInfo==null?null:e.elementData.recordInfo.email)}}function Sc(r,t){if(r&1&&(o.\u0275\u0275elementStart(0,"mat-form-field",17)(1,"mat-label"),o.\u0275\u0275text(2),o.\u0275\u0275pipe(3,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275element(4,"input",20),o.\u0275\u0275elementEnd()),r&2){const e=o.\u0275\u0275nextContext(2);o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(3,2,"ContainerPropertiesPage.Web")),o.\u0275\u0275advance(2),o.\u0275\u0275property("value",e.elementData==null||e.elementData.recordInfo==null?null:e.elementData.recordInfo.web)}}function wc(r,t){if(r&1&&(o.\u0275\u0275elementStart(0,"mat-expansion-panel",14)(1,"mat-expansion-panel-header",15)(2,"mat-panel-title"),o.\u0275\u0275text(3),o.\u0275\u0275pipe(4,"translate"),o.\u0275\u0275elementEnd()(),o.\u0275\u0275template(5,xc,5,4,"mat-form-field",16)(6,bc,5,4,"mat-form-field",16)(7,Ec,5,4,"mat-form-field",16)(8,jc,5,4,"mat-form-field",16)(9,Sc,5,4,"mat-form-field",16),o.\u0275\u0275elementEnd()),r&2){const e=o.\u0275\u0275nextContext();o.\u0275\u0275property("expanded",!0),o.\u0275\u0275advance(),o.\u0275\u0275property("collapsedHeight","48px")("expandedHeight","48px"),o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(4,9,"ContainerPropertiesPage.GeneralInformation")),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngIf",!!(!(e.elementData==null||e.elementData.recordInfo==null)&&e.elementData.recordInfo.type)),o.\u0275\u0275advance(),o.\u0275\u0275property("ngIf",!!(!(e.elementData==null||e.elementData.recordInfo==null)&&e.elementData.recordInfo.address)),o.\u0275\u0275advance(),o.\u0275\u0275property("ngIf",!!(!(e.elementData==null||e.elementData.recordInfo==null)&&e.elementData.recordInfo.phone)),o.\u0275\u0275advance(),o.\u0275\u0275property("ngIf",!!(!(e.elementData==null||e.elementData.recordInfo==null)&&e.elementData.recordInfo.email)),o.\u0275\u0275advance(),o.\u0275\u0275property("ngIf",!!(!(e.elementData==null||e.elementData.recordInfo==null)&&e.elementData.recordInfo.web))}}function Ic(r,t){if(r&1){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"mat-expansion-panel",14)(1,"mat-expansion-panel-header",15)(2,"mat-panel-title"),o.\u0275\u0275text(3),o.\u0275\u0275pipe(4,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(5,"button",21),o.\u0275\u0275listener("click",function(i){o.\u0275\u0275restoreView(e);const s=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(s.addToGroup(i))}),o.\u0275\u0275elementEnd()(),o.\u0275\u0275elementStart(6,"crt-group-content-list",22),o.\u0275\u0275listener("changed",function(){o.\u0275\u0275restoreView(e);const i=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(i.onGroupsChanged())}),o.\u0275\u0275elementEnd()()}if(r&2){const e=o.\u0275\u0275nextContext();o.\u0275\u0275property("expanded",e.isGroupsChanged),o.\u0275\u0275advance(),o.\u0275\u0275property("collapsedHeight","48px")("expandedHeight","48px"),o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(4,5,"ContainerPropertiesPage.Groups")),o.\u0275\u0275advance(3),o.\u0275\u0275property("filteredEntityId",e.elementData==null?null:e.elementData.originalId)}}function Mc(r,t){if(r&1&&(o.\u0275\u0275elementStart(0,"mat-expansion-panel",14)(1,"mat-expansion-panel-header",15)(2,"mat-panel-title"),o.\u0275\u0275text(3),o.\u0275\u0275elementEnd()(),o.\u0275\u0275element(4,"crt-related-list",23),o.\u0275\u0275elementEnd()),r&2){const e=o.\u0275\u0275nextContext();o.\u0275\u0275property("expanded",!0),o.\u0275\u0275advance(),o.\u0275\u0275property("collapsedHeight","48px")("expandedHeight","48px"),o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(e.getRelatedContactsCaption()),o.\u0275\u0275advance(),o.\u0275\u0275property("relatedItems",e.relatedContacts)}}function Pc(r,t){if(r&1&&(o.\u0275\u0275elementStart(0,"mat-expansion-panel",14)(1,"mat-expansion-panel-header",15)(2,"mat-panel-title"),o.\u0275\u0275text(3),o.\u0275\u0275elementEnd()(),o.\u0275\u0275element(4,"crt-related-list",23),o.\u0275\u0275elementEnd()),r&2){const e=o.\u0275\u0275nextContext();o.\u0275\u0275property("expanded",!0),o.\u0275\u0275advance(),o.\u0275\u0275property("collapsedHeight","48px")("expandedHeight","48px"),o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(e.getRelatedAccountsCaption()),o.\u0275\u0275advance(),o.\u0275\u0275property("relatedItems",e.relatedAccounts)}}let Xi=(()=>{class r extends jt{constructor(e){super(e),this.isGroupsChanged=!1,this.pageLink="",this.relatedAccounts=[],this.relatedContacts=[]}injectDependencies(){super.injectDependencies(),this.groupContentListEventService=this.injector.get(Et),this.linkGenerator=this.injector.get(nt.Kb)}subscribeEvents(){super.subscribeEvents(),this.subscription.add(this.groupContentListEventService.isLoading$.subscribe(e=>this.isLoading=e))}onDataInitialized(){super.onDataInitialized(),this.initializePageLinkTool(),this.showMask();const e=this.elementData.originalId||this.elementData.id;this.designerService.getRecordEntityInfo(e).subscribe(n=>{if(!n?.success){this.hideMask(),this.showErrorDialog(n);return}this.initializeRecordEntityInfo(n.recordEntityInfo),this.fillRelatedAccounts(),this.fillRelatedContacts(),this.hideMask()})}initializePageLinkTool(){const e=this.elementConfig.entitySchemaData.name,n=this.elementData.recordId;this.subscription.add(this.linkGenerator.buildPageUrl(e,n).subscribe(i=>this.pageLink=i))}initializeRecordEntityInfo(e){this.elementData.recordInfo=e}isChanged(){return super.isChanged()||this.isGroupsChanged}getRelatedElementCaption(e,n=""){const i=this.translateService.instant("ContainerPropertiesPage.RelationshipsWith"),l=this.getElementConfig(e)?.entitySchemaData?.caption||n;return oc.Qf.Format(i,l)}getRelatedItems(e){const n=this.elementData.id,i=[],s=k,l=[s.connection,s.indirectConnection],c=e===s.relationshipContainer?"Contact":"Account";return this.elementConfig?.caption===c&&l.push(s.parentConnection),Object.values(this.data.connections).filter(p=>l.includes(p.type)).forEach(p=>{let h;if(p.source===n)h=p.target;else if(p.target===n)h=p.source;else return;const m=this.data.elements[h];if(m?.type===e&&m?.canRead){const C=m,y=C.largeImage||this.getElementConfig(C.type).largeImage,b={id:p.id,originalId:p.originalId,image:y,typeCaption:p.relationshipType.name,entityCaption:C.caption,comment:p.comment};i.push(b)}}),i}isDescriptionVisible(){const e=this.elementData?.recordInfo||{};return!!e.type||!!e.address||!!e.phone||!!e.email||!!e.web}onGroupsChanged(){this.isGroupsChanged=!0}isGroupVisible(){return this.elementConfig?.caption==="Contact"}isRelatedAccountsVisible(){return!0}isRelatedContactsVisible(){return!0}addToGroup(e){e.stopPropagation();const n={entityId:this.elementData.originalId};this.groupContentListEventService.addEntityToGroup(n)}fillRelatedAccounts(){this.relatedAccounts=this.getRelatedItems(k.relationshipContainer)}fillRelatedContacts(){this.relatedContacts=this.getRelatedItems(k.relationshipItem)}getRelatedContactsCaption(){return this.getRelatedElementCaption(k.relationshipItem)}getRelatedAccountsCaption(){return this.getRelatedElementCaption(k.relationshipContainer)}static{this.\u0275fac=function(n){return new(n||r)(o.\u0275\u0275directiveInject(o.Injector))}}static{this.\u0275cmp=o.\u0275\u0275defineComponent({type:r,selectors:[["crt-container-properties-page"]],features:[o.\u0275\u0275InheritDefinitionFeature],decls:19,vars:11,consts:[["class","component-mask",4,"ngIf"],[1,"header"],[1,"title-wrap"],[1,"logo-wrap"],[1,"logo",3,"ngStyle"],[1,"title"],[1,"sub-title"],[1,"tools-group-wrap"],[1,"entity-info"],[1,"tools"],["target","_blank",1,"tool","open-card",3,"href"],[1,"content"],[3,"expanded",4,"ngIf"],[1,"component-mask"],[3,"expanded"],[3,"collapsedHeight","expandedHeight"],["floatLabel","always",4,"ngIf"],["floatLabel","always"],["type","text","matInput","","disabled","",3,"value"],["type","tel","matInput","","disabled","",3,"value"],["type","email","matInput","","disabled","",3,"value"],["mat-icon-button","",1,"group-add-icon",3,"click"],[3,"changed","filteredEntityId"],[3,"relatedItems"]],template:function(n,i){n&1&&(o.\u0275\u0275template(0,Cc,1,0,"ts-mask",0),o.\u0275\u0275elementStart(1,"div",1)(2,"div",2)(3,"div",3),o.\u0275\u0275element(4,"div",4),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(5,"div",5)(6,"div",6),o.\u0275\u0275text(7),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(8,"div"),o.\u0275\u0275text(9),o.\u0275\u0275elementEnd()()(),o.\u0275\u0275elementStart(10,"div",7),o.\u0275\u0275element(11,"div",8),o.\u0275\u0275elementStart(12,"div",9),o.\u0275\u0275element(13,"a",10),o.\u0275\u0275elementEnd()()(),o.\u0275\u0275elementStart(14,"div",11),o.\u0275\u0275template(15,wc,10,11,"mat-expansion-panel",12)(16,Ic,7,7,"mat-expansion-panel",12)(17,Mc,5,5,"mat-expansion-panel",12)(18,Pc,5,5,"mat-expansion-panel",12),o.\u0275\u0275elementEnd()),n&2&&(o.\u0275\u0275property("ngIf",i.isLoading),o.\u0275\u0275advance(4),o.\u0275\u0275property("ngStyle",o.\u0275\u0275pureFunction1(9,yc,"url("+(i.elementData==null?null:i.elementData.largeImage)+")")),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(i.elementData==null?null:i.elementData.subCaption),o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(i.elementData==null?null:i.elementData.caption),o.\u0275\u0275advance(4),o.\u0275\u0275property("href",i.pageLink,o.\u0275\u0275sanitizeUrl),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngIf",i.isDescriptionVisible()),o.\u0275\u0275advance(),o.\u0275\u0275property("ngIf",i.isGroupVisible()),o.\u0275\u0275advance(),o.\u0275\u0275property("ngIf",i.isRelatedContactsVisible()),o.\u0275\u0275advance(),o.\u0275\u0275property("ngIf",i.isRelatedAccountsVisible()))},dependencies:[A.NgIf,A.NgStyle,mn.I,ge.iV,Ie.GK,Ie.Z2,Ie.WN,ne.Ky,ne.aw,Me.aL,yn,Ki,R.D9],styles:["[_nghost-%COMP%]{display:block;position:relative;height:100%}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]{margin-right:0}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-right:10px;text-align:right}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.open-card[_ngcontent-%COMP%]{transform:rotate(-90deg)}.rtl[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%]{text-align:right}.header[_ngcontent-%COMP%]{max-width:343px;padding:12px 20px 0;min-height:97px;max-height:135px;border-top-left-radius:8px;border-top-right-radius:8px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]{height:56px;margin-top:5px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]{margin-top:7px;flex:0 0 69px;width:72px;height:56px;display:inline-flex;justify-content:center;align-items:center;margin-right:16px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{background-position:center;background-repeat:no-repeat}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:inline-block;letter-spacing:0px;text-align:left;margin-top:3px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;margin-top:7px;margin-right:10px;justify-content:flex-end;align-items:center}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool[_ngcontent-%COMP%]{width:16px;height:16px;font-size:16px}.content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;width:100%;position:absolute;overflow-x:hidden;overflow-y:auto;height:auto;bottom:0;top:135px}.content[_ngcontent-%COMP%]:last-child{padding-bottom:0}.content[_ngcontent-%COMP%]   .text-area[_ngcontent-%COMP%]{min-width:150px;width:100%}.content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%]{text-align:left;letter-spacing:0px}",".rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]{margin-right:-10px}.header[_ngcontent-%COMP%]{display:flex;min-height:97px;justify-content:space-between}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:100%;width:100%;max-width:290px;min-width:290px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{background-size:contain;width:100%;height:100%}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:0;height:49px;margin-bottom:2px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{height:29px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]{min-width:24px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .entity-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;align-items:center;width:50%}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]{width:50%;align-items:flex-start}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.open-card[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTEiIGhlaWdodD0iMTEiIHZpZXdCb3g9IjAgMCAxMSAxMSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02LjE3NTUzIDAuODAxODE3QzYuMTc1NTMgMC4zNTg5ODYgNi41MzQ1MiAwIDYuOTc3MzUgMEgxMC4xMDE3QzEwLjU5NzUgMCAxMC45OTk1IDAuNDAxOTggMTAuOTk5NSAwLjg5Nzg0M1Y0LjAyMjE3QzEwLjk5OTUgNC40NjUgMTAuNjQwNSA0LjgyMzk4IDEwLjE5NzcgNC44MjM5OEM5Ljc1NDg3IDQuODIzOTggOS4zOTU4OCA0LjQ2NSA5LjM5NTg4IDQuMDIyMTdWMi43Mzk5M0w1LjExMTA0IDcuMDM0MDhDNC43OTgyNSA3LjM0NzU1IDQuMjkwNTcgNy4zNDgxIDMuOTc3MSA3LjAzNTMxQzMuNjYzNjMgNi43MjI1MiAzLjY2MzA4IDYuMjE0ODQgMy45NzU4NyA1LjkwMTM3TDguMjY0MyAxLjYwMzYzSDYuOTc3MzVDNi41MzQ1MiAxLjYwMzYzIDYuMTc1NTMgMS4yNDQ2NSA2LjE3NTUzIDAuODAxODE3Wk0yLjcyMjM0IDEuNjAzNjNDMi4xMDQ0OSAxLjYwMzYzIDEuNjAzNjMgMi4xMDQ0OSAxLjYwMzYzIDIuNzIyMzRWOC4yNzc1OUMxLjYwMzYzIDguODk1NDMgMi4xMDQ0OSA5LjM5NjI5IDIuNzIyMzQgOS4zOTYyOUg4LjI3NzU5QzguODk1NDMgOS4zOTYyOSA5LjM5NjI5IDguODk1NDMgOS4zOTYyOSA4LjI3NzU5VjcuMjgxMzlDOS4zOTYyOSA2LjgzODU2IDkuNzU1MjcgNi40Nzk1OCAxMC4xOTgxIDYuNDc5NThDMTAuNjQwOSA2LjQ3OTU4IDEwLjk5OTkgNi44Mzg1NiAxMC45OTk5IDcuMjgxMzlWOC4yNzc1OUMxMC45OTk5IDkuNzgxMDkgOS43ODEwOSAxMC45OTk5IDguMjc3NTkgMTAuOTk5OUgyLjcyMjM0QzEuMjE4ODMgMTAuOTk5OSAwIDkuNzgxMDkgMCA4LjI3NzU5VjIuNzIyMzRDMCAxLjIxODgzIDEuMjE4ODMgMCAyLjcyMjM0IDBIMy42ODc0NkM0LjEzMDI5IDAgNC40ODkyOCAwLjM1ODk4NiA0LjQ4OTI4IDAuODAxODE3QzQuNDg5MjggMS4yNDQ2NSA0LjEzMDI5IDEuNjAzNjMgMy42ODc0NiAxLjYwMzYzSDIuNzIyMzRaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K);background-position:center;background-repeat:no-repeat}.content[_ngcontent-%COMP%]{top:99px;border-bottom-left-radius:8px;border-bottom-right-radius:8px}.content[_ngcontent-%COMP%]   .mat-divider[_ngcontent-%COMP%]{padding-bottom:0;margin-top:0}.content[_ngcontent-%COMP%]   .mat-expansion-panel-header[_ngcontent-%COMP%]   .group-add-icon[_ngcontent-%COMP%]{margin:0;opacity:0}.content[_ngcontent-%COMP%]   .mat-expansion-panel-header[_ngcontent-%COMP%]:hover   .group-add-icon[_ngcontent-%COMP%]{opacity:unset}"]})}}return r})();function Dc(r,t){r&1&&o.\u0275\u0275element(0,"ts-mask",15)}let qi=(()=>{class r extends jt{constructor(e){super(e),this.isGroupsChanged=!1,this.searchFilter=""}injectDependencies(){super.injectDependencies(),this.groupContentListEventService=this.injector.get(Et)}subscribeEvents(){super.subscribeEvents(),this.subscription.add(this.groupContentListEventService.isLoading$.subscribe(e=>this.isLoading=e))}isChanged(){return super.isChanged()||this.isGroupsChanged}onGroupsChanged(){this.isGroupsChanged=!0}createGroup(){this.groupContentListEventService.createGroup()}onSearchFilterValueChanged(e){this.searchFilter=e}static{this.\u0275fac=function(n){return new(n||r)(o.\u0275\u0275directiveInject(o.Injector))}}static{this.\u0275cmp=o.\u0275\u0275defineComponent({type:r,selectors:[["crt-groups-properties-page"]],features:[o.\u0275\u0275InheritDefinitionFeature],decls:18,vars:9,consts:[["class","component-mask",4,"ngIf"],[1,"header"],[1,"title-wrap"],[1,"logo-wrap"],[1,"logo"],[1,"title"],[1,"tools-group-wrap"],[1,"search-tool"],["floatLabel","never",1,"search-input"],["matInput","","type","text","spellcheck","false","autocomplete","off",1,"search-input-field",3,"keyup","placeholder","value"],["matSuffix","",1,"search-icon"],[1,"tools"],["mat-icon-button","",1,"tool","add-icon",3,"click"],[1,"content"],[3,"searchFilterChange","changed","searchFilter"],[1,"component-mask"]],template:function(n,i){n&1&&(o.\u0275\u0275template(0,Dc,1,0,"ts-mask",0),o.\u0275\u0275elementStart(1,"div",1)(2,"div",2)(3,"div",3),o.\u0275\u0275element(4,"div",4),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(5,"div",5),o.\u0275\u0275text(6),o.\u0275\u0275pipe(7,"translate"),o.\u0275\u0275elementEnd()(),o.\u0275\u0275elementStart(8,"div",6)(9,"div",7)(10,"mat-form-field",8)(11,"input",9),o.\u0275\u0275pipe(12,"translate"),o.\u0275\u0275listener("keyup",function(l){return i.onSearchFilterValueChanged(l.target.value)}),o.\u0275\u0275elementEnd(),o.\u0275\u0275element(13,"mat-icon",10),o.\u0275\u0275elementEnd()(),o.\u0275\u0275elementStart(14,"div",11)(15,"button",12),o.\u0275\u0275listener("click",function(){return i.createGroup()}),o.\u0275\u0275elementEnd()()()(),o.\u0275\u0275elementStart(16,"div",13)(17,"crt-group-content-list",14),o.\u0275\u0275twoWayListener("searchFilterChange",function(l){return o.\u0275\u0275twoWayBindingSet(i.searchFilter,l)||(i.searchFilter=l),l}),o.\u0275\u0275listener("changed",function(){return i.onGroupsChanged()}),o.\u0275\u0275elementEnd()()),n&2&&(o.\u0275\u0275property("ngIf",i.isLoading),o.\u0275\u0275advance(6),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(7,5,"GroupsPropertiesPage.Title")),o.\u0275\u0275advance(5),o.\u0275\u0275property("placeholder",o.\u0275\u0275pipeBind1(12,7,"GroupsPropertiesPage.Search"))("value",i.searchFilter),o.\u0275\u0275advance(6),o.\u0275\u0275twoWayProperty("searchFilter",i.searchFilter))},dependencies:[A.NgIf,mn.I,ge.iV,It.An,ne.Ky,ne.xZ,Me.aL,yn,R.D9],styles:["[_nghost-%COMP%]{display:block;position:relative;height:100%}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]{margin-right:0}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-right:10px;text-align:right}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.open-card[_ngcontent-%COMP%]{transform:rotate(-90deg)}.rtl[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%]{text-align:right}.header[_ngcontent-%COMP%]{max-width:343px;padding:12px 20px 0;min-height:97px;max-height:135px;border-top-left-radius:8px;border-top-right-radius:8px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]{height:56px;margin-top:5px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]{margin-top:7px;flex:0 0 69px;width:72px;height:56px;display:inline-flex;justify-content:center;align-items:center;margin-right:16px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{background-position:center;background-repeat:no-repeat}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:inline-block;letter-spacing:0px;text-align:left;margin-top:3px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;margin-top:7px;margin-right:10px;justify-content:flex-end;align-items:center}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool[_ngcontent-%COMP%]{width:16px;height:16px;font-size:16px}.content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;width:100%;position:absolute;overflow-x:hidden;overflow-y:auto;height:auto;bottom:0;top:135px}.content[_ngcontent-%COMP%]:last-child{padding-bottom:0}.content[_ngcontent-%COMP%]   .text-area[_ngcontent-%COMP%]{min-width:150px;width:100%}.content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%]{text-align:left;letter-spacing:0px}",".rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .search-tool[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{display:flex}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzOS4xOTEiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzOS4xOTEgMzIiPjxkZWZzPjxzdHlsZT4uYSwuYntmaWxsOm5vbmU7fS5he3N0cm9rZTojMDA2Y2UwO3N0cm9rZS1taXRlcmxpbWl0OjEwO308L3N0eWxlPjwvZGVmcz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzLjM5NCAtMC40MDMpIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxLjEwNiA1LjUzMikiPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTMwMi42MTYsNDc5LjQ2N2E1LjUyOSw1LjUyOSwwLDAsMC01LjUyNy01LjUzMiw1LjUzNSw1LjUzNSwwLDAsMC01LjUzNiw1LjUzMkE1LjUzNyw1LjUzNywwLDAsMC0zMDguMTQ0LDQ4NSw1LjUzMSw1LjUzMSwwLDAsMC0zMDIuNjE2LDQ3OS40NjdaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMjMuMjQ0IC00NzIuOTM1KSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTMwNS41MzIsNDg3LjU3M2g3Ljk4MWMwLTQtMy4wMjctNi42MzgtNy41NzItNi42MzhhOS41LDkuNSwwLDAsMC0zLjQ5Mi42MTciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMzMS43NDIgLTQ2OC40NDYpIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0tMjk5Ljc2NCw0NzkuODZhNC40MjcsNC40MjcsMCwwLDAtNC40MjUtNC40MjUsNC40MjYsNC40MjYsMCwwLDAtNC40MjUsNC40MjUsNC40MjcsNC40MjcsMCwwLDAsNC40MjUsNC40MzJBNC40MjksNC40MjksMCwwLDAtMjk5Ljc2NCw0NzkuODZaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMzAuNzQ1IC00NzIuMTE2KSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTMxMC43NTEsNDg3LjU3M2gtNy45NzljMC00LDMuMDI4LTYuNjM4LDcuNTctNi42MzhhOS41MjcsOS41MjcsMCwwLDEsMy40OTMuNjE3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMTQuNzMgLTQ2OC40NDYpIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0tMzE3LjYxNSw0NzkuODZhNC40MjQsNC40MjQsMCwwLDEsNC40MjMtNC40MjUsNC40Myw0LjQzLDAsMCwxLDQuNDI4LDQuNDI1LDQuNDMyLDQuNDMyLDAsMCwxLTQuNDI4LDQuNDMyQTQuNDI1LDQuNDI1LDAsMCwxLTMxNy42MTUsNDc5Ljg2WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzE2LjgzIC00NzIuMTE2KSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTI5OC43NjQsNDg5Ljc4NmMwLTUuMzMtMy4zODMtOC44NTEtOC40NTctOC44NTFzLTguNDU3LDMuNTIxLTguNDU3LDguODUxWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzIyLjMxNiAtNDY4LjQ0NikiLz48L2c+PHJlY3QgY2xhc3M9ImIiIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCAwLjQwMykiLz48L2c+PC9zdmc+);width:40px;height:32px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .search-tool[_ngcontent-%COMP%]{width:100%;padding-right:10px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .search-tool[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{width:100%}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .search-tool[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{font-size:16px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .search-tool[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]:before{margin-top:10px;position:absolute}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .add-icon[_ngcontent-%COMP%]{margin-bottom:6px;font-size:18px;height:24px;width:24px}"]})}}return r})();var Tc=v(64455);const kc=["card"],Oc=[[["","caption",""]],[["","tools",""]]],Lc=["[caption]","[tools]"],Ac=r=>({pressed:r});function Rc(r,t){r&1&&o.\u0275\u0275element(0,"ts-mask",12)}function zc(r,t){}let Cn=(()=>{class r{get diagramData(){return this._config?.data}get diagramConfig(){return this._config?.config}set data(e){e!==this._inputData&&(this._inputData=e,this.clearDiagramData(),this.loadDiagram())}_showResponseErorrs(e){if(e.length){const i=(0,Tc.A)(e).join(`
	`);this.showErrorDialog(i)}}_getDeleteItem(e){return new Promise(n=>{this._getDeleteItemObservable(e.id,e.originalId).subscribe(s=>{s?.success?n():n(this.getErrorResponseMessage(s))})})}_getDeleteItemObservable(e,n){return this.diagramData.connections[e]?this.designerService.deleteConnection(n):this.designerService.deleteEntity(n)}_getItem(e){return this.diagramData.elements[e]||this.diagramData.connections[e]}_getElementConfig(e){return e&&this.diagramConfig?.customDiagramElements[e]}_getCardTypeByElementId(e){const n=this._getItem(e);if(!n)throw new Error(`Not found element with id: ${e}`);return this._getCardTypeElementType(n.type)}_getCardTypeElementType(e){switch(e){case k.relationshipContainer:case k.relationshipItem:return Xi;case k.connection:case k.indirectConnection:case k.parentConnection:return St;default:throw new Error(`Not implemented properties page for type: ${e}`)}}_confirmRemoving(){var e=this;return(0,D.A)(function*(){return yield(0,w.firstValueFrom)(e.relationshipDeleteDialogService.confirmRemoving("RelationshipDesigner.DeleteItemMessage"))})()}_getExistDiagramItems(e){const n=[];return e.forEach(i=>{const s=this._getItem(i);s&&n.push(s)}),n}_deleteEntities(e){var n=this;return(0,D.A)(function*(){n.showMask();const s=n._getExistDiagramItems(e).map(c=>n._getDeleteItem(c));let l=!1;return yield Promise.all(s).then(c=>{c=c.filter(p=>p&&p!==""),n._showResponseErorrs(c),l=c.length<e.length}),n.sendGtmAction({action:Je.DeleteElement}),n.hideMask(),l})()}_initializeDirectionality(){this.isRtl=this.directionality?.value==="rtl"}_initializeGTM(){this._subscription.add(this.googleTagManagerService.initialize().subscribe())}constructor(e){this.injector=e,this._subscription=new w.Subscription,this.allowFullScreenMode=!0,this.isCardShowed=!1,this.isLoading=!1,this.isLoadingPending=!1,this.showMaskDelay=100,this.isGroupsCardOpen=!1,this.isFullscreenMode=!1,this.isRtl=!1,this.injectDependencies(),this.subscribeEvents(),this._initializeDirectionality(),this._initializeGTM()}showMask(){this.isLoadingPending=!0,setTimeout(()=>{this.isLoadingPending&&(this.isLoading=!0)},this.showMaskDelay)}hideMask(){this.isLoadingPending=!1,this.isLoading=!1,this.changeDetector.detectChanges()}injectDependencies(){this.changeDetector=this.injector.get(o.ChangeDetectorRef),this.designerService=this.injector.get(Ke),this.diagramEventService=this.injector.get(le),this.propertiesPageEventService=this.injector.get(un),this.dialogService=this.injector.get(Q.o3),this.translateService=this.injector.get(R.c$),this.notifyService=this.injector.get(Q.FL),this.directionality=this.injector.get(et.dS),this.googleTagManagerService=this.injector.get(nt.AR),this.relationshipDeleteDialogService=this.injector.get(Xe)}subscribeEvents(){this.subscribeDiagramEvents()}subscribeDiagramEvents(){var e=this;const n=this.diagramEventService;[n.itemSelected$.subscribe(s=>{this.onItemSelected(s)}),n.highlightedGroup$.subscribe(s=>{this.onGroupHighlighted(s)}),n.elementDoubleClick$.subscribe(s=>{this.onElementDoubleClick(s)}),n.elementRemoving$.subscribe(function(){var s=(0,D.A)(function*(l){yield e.onElementRemoving(l)});return function(l){return s.apply(this,arguments)}}()),n.connectionAdding$.subscribe(s=>{this.onConnectionAdding(s)}),n.showMessage$.subscribe(s=>{this.notifyService.show({message:s,translate:!1,panelClass:"relationship-notify"}).then()}),n.connectionReconnect$.subscribe(function(){var s=(0,D.A)(function*(l){yield e.onConnectionReconnect(l)});return function(l){return s.apply(this,arguments)}}()),n.entityInGroupAdded$.subscribe((0,D.A)(function*(){e.loadDiagram()})),n.entityInGroupRemoving$.subscribe((0,D.A)(function*(){e.loadDiagram()})),n.diagramChanged$.subscribe((0,D.A)(function*(){e.loadDiagram()})),this.propertiesPageEventService.doCloseCard().subscribe(function(){var s=(0,D.A)(function*(l){return yield e.closeCard(l)});return function(l){return s.apply(this,arguments)}}())].forEach(s=>{this._subscription.add(s)})}loadDiagram(){this.showMask();const e=this._inputData;if(!e?.selectedRecordId||!e?.schemaName){this.clearDiagramData(),this.hideMask();return}this.designerService.getDiagram(e.selectedRecordId,e.schemaName).subscribe(n=>{if(n?.success)this.initializeDesignerConfig({data:n.data,config:n.config});else{const i=this.getErrorResponseMessage(n);this.showErrorDialog(i)}this.hideMask()})}initializeDesignerConfig(e){this._config=e,this.propertiesPageEventService.setDesignerConfig(e),this.initializeDiagram(e.config),this.loadDataToDiagram(e.data)}initializeDiagram(e){this.initializeDiagramLocalizableStrings(e),this.diagramEventService.setDiagramConfig({dialogService:this.dialogService,translateService:this.translateService,...e})}initializeDiagramLocalizableStrings(e){this.initializeDiagramToolsLocalizableStrings(e)}initializeDiagramToolsLocalizableStrings(e){const n=e.customLocalizableStrings||{},i={};["FitToView","ResetView","ZoomIn","ZoomOut","MiniMapClose","MiniMapOpen"].forEach(l=>{const c=this.translateService.instant("RelationshipDiagram.Tools."+l);l=(0,Zi.yF9)(l),i[l]=c}),e.customLocalizableStrings=Object.assign(i,n)}loadDataToDiagram(e){this.diagramEventService.endLoading$.next(e)}openCardByElementId(e){var n=this;return(0,D.A)(function*(){let i=null;if(e){const s=n._getCardTypeByElementId(e);if(i=yield n.openCard(s),!i)return;i.id$.next(e)}return i})()}openCard(e){var n=this;return(0,D.A)(function*(){if(!(yield n.closeCard()))return;const s=n.card.createComponent(e);return n.isCardShowed=!0,s.instance})()}closeCard(e){return(0,w.lastValueFrom)(new w.Observable(n=>{e?.isForced?(this.forceCloseCard(e),n.next(!0),n.complete()):this.isCardShowed?this.saveAndCloseCard(n):(this.clearCardContainer(),n.next(!0),n.complete())}),{defaultValue:null})}forceCloseCard(e){this.clearCardContainer(),e.isNeedDiagramReload&&this.loadDiagram()}saveAndCloseCard(e){const n=this.propertiesPageEventService.saveCard().pipe((0,Dt.$)()).subscribe(i=>{const s=i?.success;s&&(this.clearCardContainer(),i.isChanged&&this.loadDiagram()),e.next(s),e.complete()});this._subscription.add(n)}clearCardContainer(){this.card.clear(),this.isCardShowed=!1,this.isGroupsCardOpen=!1}getErrorResponseMessage(e){return e?.errorInfo?.message||"An unknown error occurred during the operation."}showErrorDialog(e){this.hideMask(),this._subscription.add(this.dialogService.openInfoDialog(e).subscribe())}getDefaultRelationshipType(e,n){return{connectionType:this.getDefaultConnectionType(e,n)}}getDefaultConnectionType(e,n){const i=this._getItem(e),s=this._getItem(n);return i&&s?qe.getDefaultConnectionType(i,s):we.formal}clearDiagramData(){this.loadDataToDiagram({})}sendGtmAction(e){const n={moduleName:"RelationshipDesignerModule",schemaName:"RelationshipDesignerComponent"};e&&n&&this.googleTagManagerService.track((0,Qe.A)(n,e))}ngOnDestroy(){this._subscription.unsubscribe()}onItemSelected(e){var n=this;return(0,D.A)(function*(){e||(yield n.closeCard())})()}onGroupHighlighted(e){this.diagramComponent.get("eventBus").fire("relationshipGroup.highlight.changed",{id:e})}onElementDoubleClick(e){var n=this;return(0,D.A)(function*(){e?yield n.openCardByElementId(e):yield n.closeCard()})()}onElementRemoving(e){var n=this;return(0,D.A)(function*(){(yield n._confirmRemoving())&&(yield n.closeCard({isForced:!0,isNeedDiagramReload:!1}),(yield n._deleteEntities(e))&&n.loadDiagram())})()}onConnectionAdding(e){var n=this;return(0,D.A)(function*(){const i=yield n.openCard(St);i&&(i.elementData={id:e.id,source:e.source,target:e.target,relationshipType:n.getDefaultRelationshipType(e.source,e.target),isNew:!0},i.targetConfig=n._getElementConfig(e.targetType),i.id$.next(e.id||(0,K.generateGuid)()))})()}onConnectionReconnect(e){var n=this;return(0,D.A)(function*(){yield n._deleteEntities([e.id]);const i=yield n.openCard(St);i&&(i.elementData={source:e.source,target:e.target,relationshipType:n.getDefaultRelationshipType(e.source,e.target),isNew:!0},i.id$.next((0,K.generateGuid)()))})()}showGroupsCard(){var e=this;return(0,D.A)(function*(){if(e.isGroupsCardOpen)yield e.closeCard(),e.isGroupsCardOpen=!1;else{const n=yield e.openCard(qi);n&&(n.id$.next((0,K.generateGuid)()),e.isGroupsCardOpen=!0)}})()}toggleFullscreenMode(){this.isFullscreenMode=!this.isFullscreenMode}static{this.\u0275fac=function(n){return new(n||r)(o.\u0275\u0275directiveInject(o.Injector))}}static{this.\u0275cmp=o.\u0275\u0275defineComponent({type:r,selectors:[["crt-relationship-designer"]],viewQuery:function(n,i){if(n&1&&(o.\u0275\u0275viewQuery(kc,7,o.ViewContainerRef),o.\u0275\u0275viewQuery(hn,7)),n&2){let s;o.\u0275\u0275queryRefresh(s=o.\u0275\u0275loadQuery())&&(i.card=s.first),o.\u0275\u0275queryRefresh(s=o.\u0275\u0275loadQuery())&&(i.diagramComponent=s.first)}},hostVars:4,hostBindings:function(n,i){n&2&&o.\u0275\u0275classProp("fullscreen",i.isFullscreenMode)("rtl",i.isRtl)},inputs:{data:"data",allowFullScreenMode:"allowFullScreenMode"},ngContentSelectors:Lc,decls:15,vars:8,consts:[["card",""],["class","component-mask",4,"ngIf"],[1,"designer-tools-panel"],[1,"caption-content-container"],[1,"modes"],[1,"tools"],["mat-icon-button","",1,"tool","group",3,"click","ngClass"],["mat-icon-button","",1,"tool","fullscreen",3,"click"],[1,"additional-tools-container"],[1,"designer-content"],[1,"diagram-wrap"],[1,"card-wrap"],[1,"component-mask"]],template:function(n,i){if(n&1){const s=o.\u0275\u0275getCurrentView();o.\u0275\u0275projectionDef(Oc),o.\u0275\u0275template(0,Rc,1,0,"ts-mask",1),o.\u0275\u0275elementStart(1,"div",2)(2,"div",3),o.\u0275\u0275projection(3),o.\u0275\u0275elementEnd(),o.\u0275\u0275element(4,"div",4),o.\u0275\u0275elementStart(5,"div",5)(6,"button",6),o.\u0275\u0275listener("click",function(){return o.\u0275\u0275restoreView(s),o.\u0275\u0275resetView(i.showGroupsCard())}),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(7,"button",7),o.\u0275\u0275listener("click",function(){return o.\u0275\u0275restoreView(s),o.\u0275\u0275resetView(i.toggleFullscreenMode())}),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(8,"div",8),o.\u0275\u0275projection(9,1),o.\u0275\u0275elementEnd()()(),o.\u0275\u0275elementStart(10,"div",9),o.\u0275\u0275element(11,"crt-relationship-diagram",10),o.\u0275\u0275elementStart(12,"div",11),o.\u0275\u0275template(13,zc,0,0,"ng-template",null,0,o.\u0275\u0275templateRefExtractor),o.\u0275\u0275elementEnd()()}n&2&&(o.\u0275\u0275property("ngIf",i.isLoading),o.\u0275\u0275advance(6),o.\u0275\u0275property("ngClass",o.\u0275\u0275pureFunction1(6,Ac,i.isGroupsCardOpen)),o.\u0275\u0275advance(),o.\u0275\u0275classProp("hidden",!i.allowFullScreenMode),o.\u0275\u0275advance(5),o.\u0275\u0275classProp("card-hidden",!i.isCardShowed))},dependencies:[A.NgClass,A.NgIf,mn.I,ge.iV,hn],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;position:relative}.fullscreen[_nghost-%COMP%]{position:fixed;z-index:1999;top:0;left:0;width:100%;height:100%;background:#fff}.fullscreen[_nghost-%COMP%]   .designer-content[_ngcontent-%COMP%]{height:calc(100vh - 50px)}.fullscreen[_nghost-%COMP%]   .designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.fullscreen[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiI+CiAgPGRlZnM+CiAgICA8c3R5bGU+CiAgICAgIC5he2ZpbGw6IzU0NjU3ZH0uYntmaWxsOm5vbmU7c3Ryb2tlOiM1NDY1N2Q7c3Ryb2tlLW1pdGVybGltaXQ6MTB9CiAgICA8L3N0eWxlPgogIDwvZGVmcz4KICA8cGF0aCBjbGFzcz0iYSIgZD0iTTE0LjAwMyA4aC01VjN6TTguMDAzIDE0VjloLTV6Ii8+CiAgPHBhdGggY2xhc3M9ImIiIGQ9Ik0zIDE0bDQtNE0xMCA3bDQtNCIvPgogIDxwYXRoIGZpbGw9Im5vbmUiIGQ9Ik0wIDBoMTZ2MTZIMHoiLz4KPC9zdmc+Cg==) no-repeat center}.fullscreen[_nghost-%COMP%]   .designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.fullscreen[_ngcontent-%COMP%]:hover{background:url(data:image/svg+xml;base64,PHN2ZyBpZD0iQ29tcG9uZW50XzY3OF8xIiBkYXRhLW5hbWU9IkNvbXBvbmVudCA2Nzgg4oCTIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiB2aWV3Qm94PSIwIDAgMTYgMTYiPg0KICA8cGF0aCBpZD0iUGF0aF82MDU3IiBkYXRhLW5hbWU9IlBhdGggNjA1NyIgZD0iTTE4MjIuNi02MGgtNXYtNVoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xODA4LjU5NyA2OCkiIGZpbGw9IiMwMDZjZTAiLz4NCiAgPHBhdGggaWQ9IlBhdGhfNjA1OCIgZGF0YS1uYW1lPSJQYXRoIDYwNTgiIGQ9Ik0xODI5LjYtNjd2LTVoLTVaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTgyMS41OTcgODEpIiBmaWxsPSIjMDA2Y2UwIi8+DQogIDxsaW5lIGlkPSJMaW5lXzU3OSIgZGF0YS1uYW1lPSJMaW5lIDU3OSIgeTE9IjQiIHgyPSI0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzIDEwKSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDA2Y2UwIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iMSIvPg0KICA8bGluZSBpZD0iTGluZV81ODAiIGRhdGEtbmFtZT0iTGluZSA1ODAiIHkxPSI0IiB4Mj0iNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAgMykiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwNmNlMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBzdHJva2Utd2lkdGg9IjEiLz4NCiAgPHJlY3QgaWQ9IlJlY3RhbmdsZV82Mjc2IiBkYXRhLW5hbWU9IlJlY3RhbmdsZSA2Mjc2IiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9Im5vbmUiLz4NCjwvc3ZnPg0K) no-repeat center}.rtl[_nghost-%COMP%]   .designer-content[_ngcontent-%COMP%]{direction:rtl;text-align:right}.rtl[_nghost-%COMP%]   .designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool[_ngcontent-%COMP%]{margin-right:10px;margin-left:10px}.rtl[_nghost-%COMP%]   .designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.fullscreen[_ngcontent-%COMP%]{transform:rotate(90deg)}.fullscreen-overlay[_ngcontent-%COMP%]{position:fixed;width:100%;height:100%;top:0;left:0;opacity:.4;background-color:#fff;z-index:1998}.designer-tools-panel[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;height:48px;border:1px solid #dbdbdb;border-radius:8px}.designer-tools-panel[_ngcontent-%COMP%]   .modes[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch}.designer-tools-panel[_ngcontent-%COMP%]   .caption-content-container[_ngcontent-%COMP%]{width:100%}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;justify-content:flex-end;align-items:center;min-width:345px}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool[_ngcontent-%COMP%]{width:16px;height:16px;margin-right:22px}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.group[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmEsLmJ7ZmlsbDpub25lO30uYXtzdHJva2U6IzU0NjU3ZDtzdHJva2UtbWl0ZXJsaW1pdDoxMDt9PC9zdHlsZT48L2RlZnM+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzE5LjExNiAtNDcxLjQzNSkiPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTMwOC42OCw0NzYuNDM1YTIuNSwyLjUsMCwwLDAtMi41LTIuNSwyLjUsMi41LDAsMCwwLTIuNSwyLjUsMi41LDIuNSwwLDAsMCwyLjUsMi41QTIuNSwyLjUsMCwwLDAtMzA4LjY4LDQ3Ni40MzVaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjA2NCkiLz48cGF0aCBjbGFzcz0iYSIgZD0iTS0zMDcuMjIyLDQ4My45MzVoMy42MDdjMC0xLjgwNi0xLjM2OC0zLTMuNDIyLTNhNC4yOTQsNC4yOTQsMCwwLDAtMS41NzguMjc5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMC4wMDEpIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0tMzA0LjYxNSw0NzcuNDM1YTIsMiwwLDAsMC0yLTIsMiwyLDAsMCwwLTIsMiwyLDIsMCwwLDAsMiwyQTIsMiwwLDAsMC0zMDQuNjE1LDQ3Ny40MzVaIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0tMzE1LjEyNCw0ODMuOTM1aC0zLjYwNmMwLTEuODA2LDEuMzY5LTMsMy40MjEtM2E0LjMwNiw0LjMwNiwwLDAsMSwxLjU3OS4yNzkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuMTE0KSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTMxNy42MTUsNDc3LjQzNWEyLDIsMCwwLDEsMi0yLDIsMiwwLDAsMSwyLDIsMiwyLDAsMCwxLTIsMkEyLDIsMCwwLDEtMzE3LjYxNSw0NzcuNDM1WiIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTMwNi42NzgsNDg0LjkzNWMwLTIuNDA5LTEuOC00LTQuNS00cy00LjUsMS41OTEtNC41LDRaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjA2MikiLz48L2c+PHJlY3QgY2xhc3M9ImIiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIvPjwvc3ZnPg==) no-repeat center}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.group[_ngcontent-%COMP%]:hover{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmF7ZmlsbDojMDA2Y2UwO30uYntmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxwYXRoIGNsYXNzPSJhIiBkPSJNOCw5Yy0yLjk5MSwwLTUsMS44MDktNSw0LjVWMTRIMTN2LS41QzEzLDEwLjgwOSwxMC45OSw5LDgsOVoiLz48Y2lyY2xlIGNsYXNzPSJhIiBjeD0iMyIgY3k9IjMiIHI9IjMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUgMikiLz48cmVjdCBjbGFzcz0iYiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0xMiw5aC0uMzc5YTUuMTU1LDUuMTU1LDAsMCwxLDIuMzU1LDRIMTZ2LS41QzE2LDEwLjQ0LDE0LjM1NSw5LDEyLDlaIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik00LDloLjM3OWE1LjE1NSw1LjE1NSwwLDAsMC0yLjM1NSw0SDB2LS41QzAsMTAuNDQsMS42NDUsOSw0LDlaIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0xMi41LDMuNWEyLjQ3NiwyLjQ3NiwwLDAsMC0uNzU4LjEzLDMuOTI2LDMuOTI2LDAsMCwxLS45MjYsNC4yMDZBMi41LDIuNSwwLDEsMCwxMi41LDMuNVoiLz48cGF0aCBjbGFzcz0iYSIgZD0iTTMuNSwzLjVhMi40NzYsMi40NzYsMCwwLDEsLjc1OC4xMywzLjkyNiwzLjkyNiwwLDAsMCwuOTI2LDQuMjA2QTIuNSwyLjUsMCwxLDEsMy41LDMuNVoiLz48L3N2Zz4=) no-repeat center}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.group.pressed[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmF7ZmlsbDojMDA2Y2UwO30uYntmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxwYXRoIGNsYXNzPSJhIiBkPSJNOCw5Yy0yLjk5MSwwLTUsMS44MDktNSw0LjVWMTRIMTN2LS41QzEzLDEwLjgwOSwxMC45OSw5LDgsOVoiLz48Y2lyY2xlIGNsYXNzPSJhIiBjeD0iMyIgY3k9IjMiIHI9IjMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUgMikiLz48cmVjdCBjbGFzcz0iYiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0xMiw5aC0uMzc5YTUuMTU1LDUuMTU1LDAsMCwxLDIuMzU1LDRIMTZ2LS41QzE2LDEwLjQ0LDE0LjM1NSw5LDEyLDlaIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik00LDloLjM3OWE1LjE1NSw1LjE1NSwwLDAsMC0yLjM1NSw0SDB2LS41QzAsMTAuNDQsMS42NDUsOSw0LDlaIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0xMi41LDMuNWEyLjQ3NiwyLjQ3NiwwLDAsMC0uNzU4LjEzLDMuOTI2LDMuOTI2LDAsMCwxLS45MjYsNC4yMDZBMi41LDIuNSwwLDEsMCwxMi41LDMuNVoiLz48cGF0aCBjbGFzcz0iYSIgZD0iTTMuNSwzLjVhMi40NzYsMi40NzYsMCwwLDEsLjc1OC4xMywzLjkyNiwzLjkyNiwwLDAsMCwuOTI2LDQuMjA2QTIuNSwyLjUsMCwxLDEsMy41LDMuNVoiLz48L3N2Zz4=) no-repeat center}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.fullscreen[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyBpZD0iQ29tcG9uZW50XzUwN18zIiBkYXRhLW5hbWU9IkNvbXBvbmVudCA1MDcg4oCTIDMiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiB2aWV3Qm94PSIwIDAgMTYgMTYiPg0KICA8ZyBpZD0iR3JvdXBfNTgxMSIgZGF0YS1uYW1lPSJHcm91cCA1ODExIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTgxNS41OTcgNzQpIj4NCiAgICA8cGF0aCBpZD0iUGF0aF82MDU3IiBkYXRhLW5hbWU9IlBhdGggNjA1NyIgZD0iTTE4MjIuNi02MGgtNXYtNVoiIGZpbGw9IiM1NDY1N2QiLz4NCiAgICA8cGF0aCBpZD0iUGF0aF82MDU4IiBkYXRhLW5hbWU9IlBhdGggNjA1OCIgZD0iTTE4MjkuNi02N3YtNWgtNVoiIGZpbGw9IiM1NDY1N2QiLz4NCiAgICA8bGluZSBpZD0iTGluZV81NzkiIGRhdGEtbmFtZT0iTGluZSA1NzkiIHkxPSI0IiB4Mj0iNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTgyNC41OTcgLTcxKSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNTQ2NTdkIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iMSIvPg0KICAgIDxsaW5lIGlkPSJMaW5lXzU4MCIgZGF0YS1uYW1lPSJMaW5lIDU4MCIgeTE9IjQiIHgyPSI0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxODE4LjU5NyAtNjUpIiBmaWxsPSJub25lIiBzdHJva2U9IiM1NDY1N2QiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLXdpZHRoPSIxIi8+DQogICAgPHJlY3QgaWQ9IlJlY3RhbmdsZV82Mjc2IiBkYXRhLW5hbWU9IlJlY3RhbmdsZSA2Mjc2IiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4MTUuNTk3IC03NCkiIGZpbGw9Im5vbmUiLz4NCiAgPC9nPg0KPC9zdmc+DQo=) no-repeat center}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.fullscreen[_ngcontent-%COMP%]:hover{background:url(data:image/svg+xml;base64,PHN2ZyBpZD0iQ29tcG9uZW50XzY3OV8xIiBkYXRhLW5hbWU9IkNvbXBvbmVudCA2Nzkg4oCTIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiB2aWV3Qm94PSIwIDAgMTYgMTYiPg0KICA8cGF0aCBpZD0iUGF0aF82MDU3IiBkYXRhLW5hbWU9IlBhdGggNjA1NyIgZD0iTTE4MjIuNi02MGgtNXYtNVoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xODE1LjU5NyA3NCkiIGZpbGw9IiMwMDZjZTAiLz4NCiAgPHBhdGggaWQ9IlBhdGhfNjA1OCIgZGF0YS1uYW1lPSJQYXRoIDYwNTgiIGQ9Ik0xODI5LjYtNjd2LTVoLTVaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTgxNS41OTcgNzQpIiBmaWxsPSIjMDA2Y2UwIi8+DQogIDxsaW5lIGlkPSJMaW5lXzU3OSIgZGF0YS1uYW1lPSJMaW5lIDU3OSIgeTE9IjQiIHgyPSI0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5IDMpIiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDZjZTAiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLXdpZHRoPSIxIi8+DQogIDxsaW5lIGlkPSJMaW5lXzU4MCIgZGF0YS1uYW1lPSJMaW5lIDU4MCIgeTE9IjQiIHgyPSI0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzIDkpIiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDZjZTAiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLXdpZHRoPSIxIi8+DQogIDxyZWN0IGlkPSJSZWN0YW5nbGVfNjI3NiIgZGF0YS1uYW1lPSJSZWN0YW5nbGUgNjI3NiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiBmaWxsPSJub25lIi8+DQo8L3N2Zz4NCg==) no-repeat center}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.fullscreen.hidden[_ngcontent-%COMP%]{display:none}.designer-content[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch}.designer-content[_ngcontent-%COMP%]   .diagram-wrap[_ngcontent-%COMP%]{width:100%;border-radius:8px}.designer-content[_ngcontent-%COMP%]   .card-wrap[_ngcontent-%COMP%]{min-width:345px;max-width:345px;border:1px solid #dcdcdc;border-radius:8px}.designer-content[_ngcontent-%COMP%]   .card-wrap.card-hidden[_ngcontent-%COMP%]{display:none}"]})}}return r})();var _c=v(62115),Nc=v(79111),Bc=v(15112);const Gc=r=>({schemaName:r});let es=(()=>{class r{constructor(e,n){this.dialogRef=e,this.data=n}static{this.\u0275fac=function(n){return new(n||r)(o.\u0275\u0275directiveInject(ee.RN),o.\u0275\u0275directiveInject(ee.xh))}}static{this.\u0275cmp=o.\u0275\u0275defineComponent({type:r,selectors:[["crt-relationship-dialog"]],decls:10,vars:11,consts:[["content",""],[3,"data","allowFullScreenMode"],["caption",""],[1,"dialog-caption",3,"caption"],["tools",""],["mat-flat-button","","color","default",3,"clicked"]],template:function(n,i){n&1&&(o.\u0275\u0275elementStart(0,"crt-dialog"),o.\u0275\u0275elementContainerStart(1,0),o.\u0275\u0275elementStart(2,"crt-relationship-designer",1),o.\u0275\u0275elementContainerStart(3,2),o.\u0275\u0275element(4,"crt-label",3),o.\u0275\u0275pipe(5,"translate"),o.\u0275\u0275elementContainerEnd(),o.\u0275\u0275elementContainerStart(6,4),o.\u0275\u0275elementStart(7,"crt-button",5),o.\u0275\u0275listener("clicked",function(){return i.dialogRef.close()}),o.\u0275\u0275text(8),o.\u0275\u0275pipe(9,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementContainerEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementContainerEnd(),o.\u0275\u0275elementEnd()),n&2&&(o.\u0275\u0275advance(2),o.\u0275\u0275property("data",i.data)("allowFullScreenMode",!1),o.\u0275\u0275advance(2),o.\u0275\u0275property("caption",o.\u0275\u0275pipeBind2(5,4,"RelationshipDesignerModal.Caption",o.\u0275\u0275pureFunction1(9,Gc,i.data.schemaName))),o.\u0275\u0275advance(4),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(9,7,"BasePageComponent.Close"),""))},dependencies:[_c.B,Nc.V,Bc.H,Cn,R.D9],styles:[`.crt-relationship-dialog{max-width:94vw!important}.crt-relationship-dialog mat-dialog-container{height:90vh;width:94vw}.crt-relationship-dialog crt-relationship-dialog .designer-tools-panel{border:none}.crt-relationship-dialog crt-relationship-dialog .designer-tools-panel .dialog-caption label{font-family:var(--crt-headline-2-font-family);font-size:var(--crt-headline-2-font-size);line-height:var(--crt-headline-2-line-height);font-weight:var(--crt-headline-2-font-weight);letter-spacing:var(--crt-headline-2-letter-spacing);text-transform:var(--crt-headline-2-text-transform);-webkit-font-smoothing:antialiased;color:var(--crt-palette-primary-500, var(--palette-primary-500))}.crt-relationship-dialog crt-relationship-dialog .designer-content .diagram-wrap{border:1px solid #dcdcdc}.crt-relationship-dialog crt-relationship-dialog .designer-content .card-wrap{margin-left:10px}
`],encapsulation:2})}}return r})(),xn=class extends wn{constructor(t,e,n,i){super(),this.config=t,this.eventBus=e,this.rules=n,this.elements=i,this.translateService=t?.translateService}noAccessMessage(){const t=this.service,e=this.translateService.instant("RelationshipDiagram.NoAccess");t.showMessage(e)}subscribeServerDiagramChanges(){const t=this.service;this.eventBus.on(["element.dblclick"],e=>{const n=e.element;n&&!T.isRoot(n)&&(this.rules.canEdit(n)?t.elementDoubleClick(n.id):this.noAccessMessage())}),this.eventBus.on(["elements.noAccessMessage"],()=>{this.noAccessMessage()}),this.eventBus.on(["elements.removing"],e=>{const n=e.elements.map(i=>i.id);return t.elementRemoving(n)}),this.eventBus.on(["diagram.connection.adding"],e=>t.connectionAdding({source:e.source.id,target:e.target?.id,targetType:e.targetType})),this.eventBus.on([j.connection.reconnectExecuted],e=>{const n=e.context;if(n.newSource!==n.oldSource||n.newTarget!==n.oldTarget)return t.connectionReconnect({id:n.connection.id,source:n.newSource.id,target:n.newTarget.id})}),this.eventBus.on(["diagram.item.selected"],e=>t.itemSelected(e.id)),this.eventBus.on("diagram.loaded",()=>t.diagramLoaded()),this.eventBus.on("connect.end",B.LOW,function({context:e}){if(e.canExecute&&e.connection)return t.connectionAdding({id:e.connection.id,source:e.connection.source.id,target:e.connection.target.id})})}subscribeServerChanges(){return this.subscribeServerDiagramChanges(),[]}};xn=(0,a.Cg)([(0,a.Qj)(0,d("config")),(0,a.Qj)(1,d("eventBus")),(0,a.Qj)(2,d("diagramRules")),(0,a.Qj)(3,d("elements")),(0,a.Sn)("design:paramtypes",[Object,Object,vt,F])],xn);let ts=class extends K.BaseRequestHandler{constructor(t){super(),this._dialogProvider=t}handle(t){const e=t.recordId?.value??t.recordId;return(0,w.firstValueFrom)(this._dialogProvider.open(es,{data:{schemaName:t.entityName,selectedRecordId:e},panelClass:"crt-relationship-dialog"}))}};ts=(0,a.Cg)([(0,K.CrtRequestHandler)({requestType:"crt.ShowRelationshipsRequest",type:"crt.ShowRelationshipsHandler"}),(0,a.Sn)("design:paramtypes",[De.CoW])],ts);function Fc(r,t){return()=>(0,w.lastValueFrom)(r.loadCurrentUserInfo().pipe((0,oo.M)(e=>{t.use(e?.userInfo?.cultureInfo?.sysCultureName)})),{defaultValue:null})}let bn=class ns{static{this.\u0275fac=function(e){return new(e||ns)}}static{this.\u0275mod=o.\u0275\u0275defineNgModule({type:ns})}static{this.\u0275inj=o.\u0275\u0275defineInjector({providers:[Et,bt,un,Ke,Ji,Xe,bt,{provide:le,useClass:Ji},{provide:ot,useFactory:()=>({...Bs,diagramEventHandlerController:["type",xn],elementFactory:["type",Ka]})},nt.Kb,{provide:o.ENVIRONMENT_INITIALIZER,useFactory:Fc,deps:[Zi.fvr,R.c$],multi:!0}],imports:[A.CommonModule,Yi.bu,Q.Rm,Be.KR,ge.wG,ee.eB,jn.w,Ie.MY,It.m_,ne.C,Me.mz,Pe.Wh,Ee.bB,os.T7,Q.Ph,Vi,R.h.forChild({defaultLanguage:"en-US",loader:{provide:R.Wr,useFactory:(t,e)=>new co.s(t,e+"ClientApp/assets/i18n/"),deps:[ss.HttpClient,A.APP_BASE_HREF]}}),De.qOu,De.Sjg,De.kdL]})}};bn=(0,a.Cg)([(0,K.CrtModule)({includes:[],requestHandlers:[ts]})],bn),function(){(typeof ngJitMode>"u"||ngJitMode)&&o.\u0275\u0275setNgModuleScope(bn,{declarations:[jt,St,Xi,yn,fn,qi,Cn,vn,Ki,es,ro],imports:[A.CommonModule,Yi.bu,Q.Rm,Be.KR,ge.wG,ee.eB,jn.w,Ie.MY,It.m_,ne.C,Me.mz,Pe.Wh,Ee.bB,os.T7,Q.Ph,Vi,R.h,De.qOu,De.Sjg,De.kdL],exports:[jt,Cn]})}()},22008:be=>{be.exports=`<svg height="55" viewBox="0 0 69 55" width="69" xmlns="http://www.w3.org/2000/svg"><path d="m650 50a5.015 5.015 0 0 1 -5 5h-59a5.015 5.015 0 0 1 -5-5v-45a5.015 5.015 0 0 1 5-5h59a5.015 5.015 0 0 1 5 5z" fill="#3fc84c" transform="translate(-581)"/><g fill="none" stroke="#fff" stroke-miterlimit="10" stroke-width="0"><path d="m608.5 16.5h16l-6 6 6 6h-16z" transform="translate(-581)"/><path d="m27.5 39v-23"/></g></svg>
`},60096:be=>{be.exports='<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none"><path d="m114.5 32v-14.4h11l-4 3.9 4 4h-11" stroke="#54657d" stroke-miterlimit="10" transform="translate(-108 -12)"/><path d="m0 0h24v24h-24z" transform="matrix(0 1 -1 0 24 0)"/></g></svg>'},34035:be=>{be.exports=`<svg width="10" height="6" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg">
	<path fill-rule="evenodd" clip-rule="evenodd" d="M4.33435 0.278443C4.70198 -0.0928144 5.29802 -0.0928144 5.66565 0.278443L9.72428 4.37711C10.0919 4.74837 10.0919 5.3503 9.72428 5.72156C9.35665 6.09281 8.7606 6.09281 8.39297 5.72156L5 2.29511L1.60703 5.72156C1.2394 6.09281 0.643352 6.09281 0.275722 5.72156C-0.0919075 5.3503 -0.0919075 4.74837 0.275722 4.37711L4.33435 0.278443Z" fill="#0D2E4E"/>
</svg>
`},65070:be=>{be.exports=`<svg width="10" height="6" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg">
	<path fill-rule="evenodd" clip-rule="evenodd" d="M0.275722 0.278443C0.643352 -0.0928144 1.2394 -0.0928144 1.60703 0.278443L5 3.70489L8.39297 0.278443C8.7606 -0.0928144 9.35665 -0.0928144 9.72428 0.278443C10.0919 0.6497 10.0919 1.25163 9.72428 1.62289L5.66565 5.72156C5.29802 6.09281 4.70198 6.09281 4.33435 5.72156L0.275722 1.62289C-0.0919075 1.25163 -0.0919075 0.6497 0.275722 0.278443Z" fill="#0D2E4E"/>
</svg>
`}}]);
