(self.webpackChunkapp_studio_enterprise_schema_view=self.webpackChunkapp_studio_enterprise_schema_view||[]).push([[319],{24313:function(re,ce){var V,a,e;(function(i,C){a=[],V=C,e=typeof V=="function"?V.apply(ce,a):V,e!==void 0&&(re.exports=e)})(this,function(){"use strict";function i(u,x){return typeof x>"u"?x={autoBom:!1}:typeof x!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),x={autoBom:!x}),x.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function C(u,x,U){var m=new XMLHttpRequest;m.open("GET",u),m.responseType="blob",m.onload=function(){r(m.response,x,U)},m.onerror=function(){console.error("could not download file")},m.send()}function E(u){var x=new XMLHttpRequest;x.open("HEAD",u,!1);try{x.send()}catch{}return 200<=x.status&&299>=x.status}function S(u){try{u.dispatchEvent(new MouseEvent("click"))}catch{var x=document.createEvent("MouseEvents");x.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(x)}}var c=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,l=c.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),r=c.saveAs||(typeof window!="object"||window!==c?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(u,x,U){var m=c.URL||c.webkitURL,y=document.createElement("a");x=x||u.name||"download",y.download=x,y.rel="noopener",typeof u=="string"?(y.href=u,y.origin===location.origin?S(y):E(y.href)?C(u,x,U):S(y,y.target="_blank")):(y.href=m.createObjectURL(u),setTimeout(function(){m.revokeObjectURL(y.href)},4e4),setTimeout(function(){S(y)},0))}:"msSaveOrOpenBlob"in navigator?function(u,x,U){if(x=x||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(i(u,U),x);else if(E(u))C(u,x,U);else{var m=document.createElement("a");m.href=u,m.target="_blank",setTimeout(function(){S(m)})}}:function(u,x,U,m){if(m=m||open("","_blank"),m&&(m.document.title=m.document.body.innerText="downloading..."),typeof u=="string")return C(u,x,U);var y=u.type==="application/octet-stream",I=/constructor/i.test(c.HTMLElement)||c.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||y&&I||l)&&typeof FileReader<"u"){var v=new FileReader;v.onloadend=function(){var p=v.result;p=d?p:p.replace(/^data:[^;]*;/,"data:attachment/file;"),m?m.location.href=p:location=p,m=null},v.readAsDataURL(u)}else{var n=c.URL||c.webkitURL,f=n.createObjectURL(u);m?m.location=f:location.href=f,m=null,setTimeout(function(){n.revokeObjectURL(f)},4e4)}});c.saveAs=r.saveAs=r,re.exports=r})},57220:(re,ce,V)=>{var a=V(96560);V(77464),V(22278),V(64687),re.exports=a.aes=a.aes||{},a.aes.startEncrypting=function(y,I,d,v){var n=m({key:y,output:d,decrypt:!1,mode:v});return n.start(I),n},a.aes.createEncryptionCipher=function(y,I){return m({key:y,output:null,decrypt:!1,mode:I})},a.aes.startDecrypting=function(y,I,d,v){var n=m({key:y,output:d,decrypt:!0,mode:v});return n.start(I),n},a.aes.createDecryptionCipher=function(y,I){return m({key:y,output:null,decrypt:!0,mode:I})},a.aes.Algorithm=function(y,I){i||u();var d=this;d.name=y,d.mode=new I({blockSize:16,cipher:{encrypt:function(v,n){return U(d._w,v,n,!1)},decrypt:function(v,n){return U(d._w,v,n,!0)}}}),d._init=!1},a.aes.Algorithm.prototype.initialize=function(y){if(!this._init){var I=y.key,d;if(typeof I=="string"&&(I.length===16||I.length===24||I.length===32))I=a.util.createBuffer(I);else if(a.util.isArray(I)&&(I.length===16||I.length===24||I.length===32)){d=I,I=a.util.createBuffer();for(var v=0;v<d.length;++v)I.putByte(d[v])}if(!a.util.isArray(I)){d=I,I=[];var n=d.length();if(n===16||n===24||n===32){n=n>>>2;for(var v=0;v<n;++v)I.push(d.getInt32())}}if(!a.util.isArray(I)||!(I.length===4||I.length===6||I.length===8))throw new Error("Invalid key parameter.");var f=this.mode.name,p=["CFB","OFB","CTR","GCM"].indexOf(f)!==-1;this._w=x(I,y.decrypt&&!p),this._init=!0}},a.aes._expandKey=function(y,I){return i||u(),x(y,I)},a.aes._updateBlock=U,e("AES-ECB",a.cipher.modes.ecb),e("AES-CBC",a.cipher.modes.cbc),e("AES-CFB",a.cipher.modes.cfb),e("AES-OFB",a.cipher.modes.ofb),e("AES-CTR",a.cipher.modes.ctr),e("AES-GCM",a.cipher.modes.gcm);function e(y,I){var d=function(){return new a.aes.Algorithm(y,I)};a.cipher.registerAlgorithm(y,d)}var i=!1,C=4,E,S,c,l,r;function u(){i=!0,c=[0,1,2,4,8,16,32,64,128,27,54];for(var y=new Array(256),I=0;I<128;++I)y[I]=I<<1,y[I+128]=I+128<<1^283;E=new Array(256),S=new Array(256),l=new Array(4),r=new Array(4);for(var I=0;I<4;++I)l[I]=new Array(256),r[I]=new Array(256);for(var d=0,v=0,n,f,p,A,R,k,h,I=0;I<256;++I){A=v^v<<1^v<<2^v<<3^v<<4,A=A>>8^A&255^99,E[d]=A,S[A]=d,R=y[A],n=y[d],f=y[n],p=y[f],k=R<<24^A<<16^A<<8^(A^R),h=(n^f^p)<<24^(d^p)<<16^(d^f^p)<<8^(d^n^p);for(var g=0;g<4;++g)l[g][d]=k,r[g][A]=h,k=k<<24|k>>>8,h=h<<24|h>>>8;d===0?d=v=1:(d=n^y[y[y[n^p]]],v^=y[y[v]])}}function x(y,I){for(var d=y.slice(0),v,n=1,f=d.length,p=f+6+1,A=C*p,R=f;R<A;++R)v=d[R-1],R%f===0?(v=E[v>>>16&255]<<24^E[v>>>8&255]<<16^E[v&255]<<8^E[v>>>24]^c[n]<<24,n++):f>6&&R%f===4&&(v=E[v>>>24]<<24^E[v>>>16&255]<<16^E[v>>>8&255]<<8^E[v&255]),d[R]=d[R-f]^v;if(I){var k,h=r[0],g=r[1],N=r[2],t=r[3],L=d.slice(0);A=d.length;for(var R=0,O=A-C;R<A;R+=C,O-=C)if(R===0||R===A-C)L[R]=d[O],L[R+1]=d[O+3],L[R+2]=d[O+2],L[R+3]=d[O+1];else for(var w=0;w<C;++w)k=d[O+w],L[R+(3&-w)]=h[E[k>>>24]]^g[E[k>>>16&255]]^N[E[k>>>8&255]]^t[E[k&255]];d=L}return d}function U(y,I,d,v){var n=y.length/4-1,f,p,A,R,k;v?(f=r[0],p=r[1],A=r[2],R=r[3],k=S):(f=l[0],p=l[1],A=l[2],R=l[3],k=E);var h,g,N,t,L,O,w;h=I[0]^y[0],g=I[v?3:1]^y[1],N=I[2]^y[2],t=I[v?1:3]^y[3];for(var M=3,K=1;K<n;++K)L=f[h>>>24]^p[g>>>16&255]^A[N>>>8&255]^R[t&255]^y[++M],O=f[g>>>24]^p[N>>>16&255]^A[t>>>8&255]^R[h&255]^y[++M],w=f[N>>>24]^p[t>>>16&255]^A[h>>>8&255]^R[g&255]^y[++M],t=f[t>>>24]^p[h>>>16&255]^A[g>>>8&255]^R[N&255]^y[++M],h=L,g=O,N=w;d[0]=k[h>>>24]<<24^k[g>>>16&255]<<16^k[N>>>8&255]<<8^k[t&255]^y[++M],d[v?3:1]=k[g>>>24]<<24^k[N>>>16&255]<<16^k[t>>>8&255]<<8^k[h&255]^y[++M],d[2]=k[N>>>24]<<24^k[t>>>16&255]<<16^k[h>>>8&255]<<8^k[g&255]^y[++M],d[v?1:3]=k[t>>>24]<<24^k[h>>>16&255]<<16^k[g>>>8&255]<<8^k[N&255]^y[++M]}function m(y){y=y||{};var I=(y.mode||"CBC").toUpperCase(),d="AES-"+I,v;y.decrypt?v=a.cipher.createDecipher(d,y.key):v=a.cipher.createCipher(d,y.key);var n=v.start;return v.start=function(f,p){var A=null;p instanceof a.util.ByteBuffer&&(A=p,p={}),p=p||{},p.output=A,p.iv=f,n.call(v,p)},v}},36186:(re,ce,V)=>{var a=V(96560);V(57220),V(91550);var e=re.exports=a.tls;e.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(r){r.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,r.cipher_type=e.CipherType.block,r.enc_key_length=16,r.block_length=16,r.fixed_iv_length=16,r.record_iv_length=16,r.mac_algorithm=e.MACAlgorithm.hmac_sha1,r.mac_length=20,r.mac_key_length=20},initConnectionState:i},e.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(r){r.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,r.cipher_type=e.CipherType.block,r.enc_key_length=32,r.block_length=16,r.fixed_iv_length=16,r.record_iv_length=16,r.mac_algorithm=e.MACAlgorithm.hmac_sha1,r.mac_length=20,r.mac_key_length=20},initConnectionState:i};function i(r,u,x){var U=u.entity===a.tls.ConnectionEnd.client;r.read.cipherState={init:!1,cipher:a.cipher.createDecipher("AES-CBC",U?x.keys.server_write_key:x.keys.client_write_key),iv:U?x.keys.server_write_IV:x.keys.client_write_IV},r.write.cipherState={init:!1,cipher:a.cipher.createCipher("AES-CBC",U?x.keys.client_write_key:x.keys.server_write_key),iv:U?x.keys.client_write_IV:x.keys.server_write_IV},r.read.cipherFunction=c,r.write.cipherFunction=C,r.read.macLength=r.write.macLength=x.mac_length,r.read.macFunction=r.write.macFunction=e.hmac_sha1}function C(r,u){var x=!1,U=u.macFunction(u.macKey,u.sequenceNumber,r);r.fragment.putBytes(U),u.updateSequenceNumber();var m;r.version.minor===e.Versions.TLS_1_0.minor?m=u.cipherState.init?null:u.cipherState.iv:m=a.random.getBytesSync(16),u.cipherState.init=!0;var y=u.cipherState.cipher;return y.start({iv:m}),r.version.minor>=e.Versions.TLS_1_1.minor&&y.output.putBytes(m),y.update(r.fragment),y.finish(E)&&(r.fragment=y.output,r.length=r.fragment.length(),x=!0),x}function E(r,u,x){if(!x){var U=r-u.length()%r;u.fillWithByte(U-1,U)}return!0}function S(r,u,x){var U=!0;if(x){for(var m=u.length(),y=u.last(),I=m-1-y;I<m-1;++I)U=U&&u.at(I)==y;U&&u.truncate(y+1)}return U}function c(r,u){var x=!1,U;r.version.minor===e.Versions.TLS_1_0.minor?U=u.cipherState.init?null:u.cipherState.iv:U=r.fragment.getBytes(16),u.cipherState.init=!0;var m=u.cipherState.cipher;m.start({iv:U}),m.update(r.fragment),x=m.finish(S);var y=u.macLength,I=a.random.getBytesSync(y),d=m.output.length();d>=y?(r.fragment=m.output.getBytes(d-y),I=m.output.getBytes(y)):r.fragment=m.output.getBytes(),r.fragment=a.util.createBuffer(r.fragment),r.length=r.fragment.length();var v=u.macFunction(u.macKey,u.sequenceNumber,r);return u.updateSequenceNumber(),x=l(u.macKey,I,v)&&x,x}function l(r,u,x){var U=a.hmac.create();return U.start("SHA1",r),U.update(u),u=U.digest().getBytes(),U.start(null,null),U.update(x),x=U.digest().getBytes(),u===x}},92673:(re,ce,V)=>{var a=V(96560);V(19462);var e=a.asn1;ce.privateKeyValidator={name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},ce.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}},19462:(re,ce,V)=>{var a=V(96560);V(64687),V(4646);var e=re.exports=a.asn1=a.asn1||{};e.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},e.create=function(c,l,r,u,x){if(a.util.isArray(u)){for(var U=[],m=0;m<u.length;++m)u[m]!==void 0&&U.push(u[m]);u=U}var y={tagClass:c,type:l,constructed:r,composed:r||a.util.isArray(u),value:u};return x&&"bitStringContents"in x&&(y.bitStringContents=x.bitStringContents,y.original=e.copy(y)),y},e.copy=function(c,l){var r;if(a.util.isArray(c)){r=[];for(var u=0;u<c.length;++u)r.push(e.copy(c[u],l));return r}return typeof c=="string"?c:(r={tagClass:c.tagClass,type:c.type,constructed:c.constructed,composed:c.composed,value:e.copy(c.value,l)},l&&!l.excludeBitStringContents&&(r.bitStringContents=c.bitStringContents),r)},e.equals=function(c,l,r){if(a.util.isArray(c)){if(!a.util.isArray(l)||c.length!==l.length)return!1;for(var u=0;u<c.length;++u)if(!e.equals(c[u],l[u]))return!1;return!0}if(typeof c!=typeof l)return!1;if(typeof c=="string")return c===l;var x=c.tagClass===l.tagClass&&c.type===l.type&&c.constructed===l.constructed&&c.composed===l.composed&&e.equals(c.value,l.value);return r&&r.includeBitStringContents&&(x=x&&c.bitStringContents===l.bitStringContents),x},e.getBerValueLength=function(c){var l=c.getByte();if(l!==128){var r,u=l&128;return u?r=c.getInt((l&127)<<3):r=l,r}};function i(c,l,r){if(r>l){var u=new Error("Too few bytes to parse DER.");throw u.available=c.length(),u.remaining=l,u.requested=r,u}}var C=function(c,l){var r=c.getByte();if(l--,r!==128){var u,x=r&128;if(!x)u=r;else{var U=r&127;i(c,l,U),u=c.getInt(U<<3)}if(u<0)throw new Error("Negative length: "+u);return u}};e.fromDer=function(c,l){l===void 0&&(l={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof l=="boolean"&&(l={strict:l,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in l||(l.strict=!0),"parseAllBytes"in l||(l.parseAllBytes=!0),"decodeBitStrings"in l||(l.decodeBitStrings=!0),typeof c=="string"&&(c=a.util.createBuffer(c));var r=c.length(),u=E(c,c.length(),0,l);if(l.parseAllBytes&&c.length()!==0){var x=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw x.byteCount=r,x.remaining=c.length(),x}return u};function E(c,l,r,u){var x;i(c,l,2);var U=c.getByte();l--;var m=U&192,y=U&31;x=c.length();var I=C(c,l);if(l-=x-c.length(),I!==void 0&&I>l){if(u.strict){var d=new Error("Too few bytes to read ASN.1 value.");throw d.available=c.length(),d.remaining=l,d.requested=I,d}I=l}var v,n,f=(U&32)===32;if(f)if(v=[],I===void 0)for(;;){if(i(c,l,2),c.bytes(2)==="\0\0"){c.getBytes(2),l-=2;break}x=c.length(),v.push(E(c,l,r+1,u)),l-=x-c.length()}else for(;I>0;)x=c.length(),v.push(E(c,I,r+1,u)),l-=x-c.length(),I-=x-c.length();if(v===void 0&&m===e.Class.UNIVERSAL&&y===e.Type.BITSTRING&&(n=c.bytes(I)),v===void 0&&u.decodeBitStrings&&m===e.Class.UNIVERSAL&&y===e.Type.BITSTRING&&I>1){var p=c.read,A=l,R=0;if(y===e.Type.BITSTRING&&(i(c,l,1),R=c.getByte(),l--),R===0)try{x=c.length();var k={strict:!0,decodeBitStrings:!0},h=E(c,l,r+1,k),g=x-c.length();l-=g,y==e.Type.BITSTRING&&g++;var N=h.tagClass;g===I&&(N===e.Class.UNIVERSAL||N===e.Class.CONTEXT_SPECIFIC)&&(v=[h])}catch{}v===void 0&&(c.read=p,l=A)}if(v===void 0){if(I===void 0){if(u.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");I=l}if(y===e.Type.BMPSTRING)for(v="";I>0;I-=2)i(c,l,2),v+=String.fromCharCode(c.getInt16()),l-=2;else v=c.getBytes(I),l-=I}var t=n===void 0?null:{bitStringContents:n};return e.create(m,y,f,v,t)}e.toDer=function(c){var l=a.util.createBuffer(),r=c.tagClass|c.type,u=a.util.createBuffer(),x=!1;if("bitStringContents"in c&&(x=!0,c.original&&(x=e.equals(c,c.original))),x)u.putBytes(c.bitStringContents);else if(c.composed){c.constructed?r|=32:u.putByte(0);for(var U=0;U<c.value.length;++U)c.value[U]!==void 0&&u.putBuffer(e.toDer(c.value[U]))}else if(c.type===e.Type.BMPSTRING)for(var U=0;U<c.value.length;++U)u.putInt16(c.value.charCodeAt(U));else c.type===e.Type.INTEGER&&c.value.length>1&&(c.value.charCodeAt(0)===0&&!(c.value.charCodeAt(1)&128)||c.value.charCodeAt(0)===255&&(c.value.charCodeAt(1)&128)===128)?u.putBytes(c.value.substr(1)):u.putBytes(c.value);if(l.putByte(r),u.length()<=127)l.putByte(u.length()&127);else{var m=u.length(),y="";do y+=String.fromCharCode(m&255),m=m>>>8;while(m>0);l.putByte(y.length|128);for(var U=y.length-1;U>=0;--U)l.putByte(y.charCodeAt(U))}return l.putBuffer(u),l},e.oidToDer=function(c){var l=c.split("."),r=a.util.createBuffer();r.putByte(40*parseInt(l[0],10)+parseInt(l[1],10));for(var u,x,U,m,y=2;y<l.length;++y){u=!0,x=[],U=parseInt(l[y],10);do m=U&127,U=U>>>7,u||(m|=128),x.push(m),u=!1;while(U>0);for(var I=x.length-1;I>=0;--I)r.putByte(x[I])}return r},e.derToOid=function(c){var l;typeof c=="string"&&(c=a.util.createBuffer(c));var r=c.getByte();l=Math.floor(r/40)+"."+r%40;for(var u=0;c.length()>0;)r=c.getByte(),u=u<<7,r&128?u+=r&127:(l+="."+(u+r),u=0);return l},e.utcTimeToDate=function(c){var l=new Date,r=parseInt(c.substr(0,2),10);r=r>=50?1900+r:2e3+r;var u=parseInt(c.substr(2,2),10)-1,x=parseInt(c.substr(4,2),10),U=parseInt(c.substr(6,2),10),m=parseInt(c.substr(8,2),10),y=0;if(c.length>11){var I=c.charAt(10),d=10;I!=="+"&&I!=="-"&&(y=parseInt(c.substr(10,2),10),d+=2)}if(l.setUTCFullYear(r,u,x),l.setUTCHours(U,m,y,0),d&&(I=c.charAt(d),I==="+"||I==="-")){var v=parseInt(c.substr(d+1,2),10),n=parseInt(c.substr(d+4,2),10),f=v*60+n;f*=6e4,I==="+"?l.setTime(+l-f):l.setTime(+l+f)}return l},e.generalizedTimeToDate=function(c){var l=new Date,r=parseInt(c.substr(0,4),10),u=parseInt(c.substr(4,2),10)-1,x=parseInt(c.substr(6,2),10),U=parseInt(c.substr(8,2),10),m=parseInt(c.substr(10,2),10),y=parseInt(c.substr(12,2),10),I=0,d=0,v=!1;c.charAt(c.length-1)==="Z"&&(v=!0);var n=c.length-5,f=c.charAt(n);if(f==="+"||f==="-"){var p=parseInt(c.substr(n+1,2),10),A=parseInt(c.substr(n+4,2),10);d=p*60+A,d*=6e4,f==="+"&&(d*=-1),v=!0}return c.charAt(14)==="."&&(I=parseFloat(c.substr(14),10)*1e3),v?(l.setUTCFullYear(r,u,x),l.setUTCHours(U,m,y,I),l.setTime(+l+d)):(l.setFullYear(r,u,x),l.setHours(U,m,y,I)),l},e.dateToUtcTime=function(c){if(typeof c=="string")return c;var l="",r=[];r.push((""+c.getUTCFullYear()).substr(2)),r.push(""+(c.getUTCMonth()+1)),r.push(""+c.getUTCDate()),r.push(""+c.getUTCHours()),r.push(""+c.getUTCMinutes()),r.push(""+c.getUTCSeconds());for(var u=0;u<r.length;++u)r[u].length<2&&(l+="0"),l+=r[u];return l+="Z",l},e.dateToGeneralizedTime=function(c){if(typeof c=="string")return c;var l="",r=[];r.push(""+c.getUTCFullYear()),r.push(""+(c.getUTCMonth()+1)),r.push(""+c.getUTCDate()),r.push(""+c.getUTCHours()),r.push(""+c.getUTCMinutes()),r.push(""+c.getUTCSeconds());for(var u=0;u<r.length;++u)r[u].length<2&&(l+="0"),l+=r[u];return l+="Z",l},e.integerToDer=function(c){var l=a.util.createBuffer();if(c>=-128&&c<128)return l.putSignedInt(c,8);if(c>=-32768&&c<32768)return l.putSignedInt(c,16);if(c>=-8388608&&c<8388608)return l.putSignedInt(c,24);if(c>=-2147483648&&c<2147483648)return l.putSignedInt(c,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=c,r},e.derToInteger=function(c){typeof c=="string"&&(c=a.util.createBuffer(c));var l=c.length()*8;if(l>32)throw new Error("Integer too large; max is 32-bits.");return c.getSignedInt(l)},e.validate=function(c,l,r,u){var x=!1;if((c.tagClass===l.tagClass||typeof l.tagClass>"u")&&(c.type===l.type||typeof l.type>"u"))if(c.constructed===l.constructed||typeof l.constructed>"u"){if(x=!0,l.value&&a.util.isArray(l.value))for(var U=0,m=0;x&&m<l.value.length;++m)x=l.value[m].optional||!1,c.value[U]&&(x=e.validate(c.value[U],l.value[m],r,u),x?++U:l.value[m].optional&&(x=!0)),!x&&u&&u.push("["+l.name+'] Tag class "'+l.tagClass+'", type "'+l.type+'" expected value length "'+l.value.length+'", got "'+c.value.length+'"');if(x&&r&&(l.capture&&(r[l.capture]=c.value),l.captureAsn1&&(r[l.captureAsn1]=c),l.captureBitStringContents&&"bitStringContents"in c&&(r[l.captureBitStringContents]=c.bitStringContents),l.captureBitStringValue&&"bitStringContents"in c)){var y;if(c.bitStringContents.length<2)r[l.captureBitStringValue]="";else{var I=c.bitStringContents.charCodeAt(0);if(I!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[l.captureBitStringValue]=c.bitStringContents.slice(1)}}}else u&&u.push("["+l.name+'] Expected constructed "'+l.constructed+'", got "'+c.constructed+'"');else u&&(c.tagClass!==l.tagClass&&u.push("["+l.name+'] Expected tag class "'+l.tagClass+'", got "'+c.tagClass+'"'),c.type!==l.type&&u.push("["+l.name+'] Expected type "'+l.type+'", got "'+c.type+'"'));return x};var S=/[^\\u0000-\\u00ff]/;e.prettyPrint=function(c,l,r){var u="";l=l||0,r=r||2,l>0&&(u+=`
`);for(var x="",U=0;U<l*r;++U)x+=" ";switch(u+=x+"Tag: ",c.tagClass){case e.Class.UNIVERSAL:u+="Universal:";break;case e.Class.APPLICATION:u+="Application:";break;case e.Class.CONTEXT_SPECIFIC:u+="Context-Specific:";break;case e.Class.PRIVATE:u+="Private:";break}if(c.tagClass===e.Class.UNIVERSAL)switch(u+=c.type,c.type){case e.Type.NONE:u+=" (None)";break;case e.Type.BOOLEAN:u+=" (Boolean)";break;case e.Type.INTEGER:u+=" (Integer)";break;case e.Type.BITSTRING:u+=" (Bit string)";break;case e.Type.OCTETSTRING:u+=" (Octet string)";break;case e.Type.NULL:u+=" (Null)";break;case e.Type.OID:u+=" (Object Identifier)";break;case e.Type.ODESC:u+=" (Object Descriptor)";break;case e.Type.EXTERNAL:u+=" (External or Instance of)";break;case e.Type.REAL:u+=" (Real)";break;case e.Type.ENUMERATED:u+=" (Enumerated)";break;case e.Type.EMBEDDED:u+=" (Embedded PDV)";break;case e.Type.UTF8:u+=" (UTF8)";break;case e.Type.ROID:u+=" (Relative Object Identifier)";break;case e.Type.SEQUENCE:u+=" (Sequence)";break;case e.Type.SET:u+=" (Set)";break;case e.Type.PRINTABLESTRING:u+=" (Printable String)";break;case e.Type.IA5String:u+=" (IA5String (ASCII))";break;case e.Type.UTCTIME:u+=" (UTC time)";break;case e.Type.GENERALIZEDTIME:u+=" (Generalized time)";break;case e.Type.BMPSTRING:u+=" (BMP String)";break}else u+=c.type;if(u+=`
`,u+=x+"Constructed: "+c.constructed+`
`,c.composed){for(var m=0,y="",U=0;U<c.value.length;++U)c.value[U]!==void 0&&(m+=1,y+=e.prettyPrint(c.value[U],l+1,r),U+1<c.value.length&&(y+=","));u+=x+"Sub values: "+m+y}else{if(u+=x+"Value: ",c.type===e.Type.OID){var I=e.derToOid(c.value);u+=I,a.pki&&a.pki.oids&&I in a.pki.oids&&(u+=" ("+a.pki.oids[I]+") ")}if(c.type===e.Type.INTEGER)try{u+=e.derToInteger(c.value)}catch{u+="0x"+a.util.bytesToHex(c.value)}else if(c.type===e.Type.BITSTRING){if(c.value.length>1?u+="0x"+a.util.bytesToHex(c.value.slice(1)):u+="(none)",c.value.length>0){var d=c.value.charCodeAt(0);d==1?u+=" (1 unused bit shown)":d>1&&(u+=" ("+d+" unused bits shown)")}}else if(c.type===e.Type.OCTETSTRING)S.test(c.value)||(u+="("+c.value+") "),u+="0x"+a.util.bytesToHex(c.value);else if(c.type===e.Type.UTF8)try{u+=a.util.decodeUtf8(c.value)}catch(v){if(v.message==="URI malformed")u+="0x"+a.util.bytesToHex(c.value)+" (malformed UTF8)";else throw v}else c.type===e.Type.PRINTABLESTRING||c.type===e.Type.IA5String?u+=c.value:S.test(c.value)?u+="0x"+a.util.bytesToHex(c.value):c.value.length===0?u+="[null]":u+=c.value}return u}},20502:re=>{var ce={};re.exports=ce;var V={};ce.encode=function(e,i,C){if(typeof i!="string")throw new TypeError('"alphabet" must be a string.');if(C!==void 0&&typeof C!="number")throw new TypeError('"maxline" must be a number.');var E="";if(!(e instanceof Uint8Array))E=a(e,i);else{var S=0,c=i.length,l=i.charAt(0),r=[0];for(S=0;S<e.length;++S){for(var u=0,x=e[S];u<r.length;++u)x+=r[u]<<8,r[u]=x%c,x=x/c|0;for(;x>0;)r.push(x%c),x=x/c|0}for(S=0;e[S]===0&&S<e.length-1;++S)E+=l;for(S=r.length-1;S>=0;--S)E+=i[r[S]]}if(C){var U=new RegExp(".{1,"+C+"}","g");E=E.match(U).join(`\r
`)}return E},ce.decode=function(e,i){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof i!="string")throw new TypeError('"alphabet" must be a string.');var C=V[i];if(!C){C=V[i]=[];for(var E=0;E<i.length;++E)C[i.charCodeAt(E)]=E}e=e.replace(/\s/g,"");for(var S=i.length,c=i.charAt(0),l=[0],E=0;E<e.length;E++){var r=C[e.charCodeAt(E)];if(r===void 0)return;for(var u=0,x=r;u<l.length;++u)x+=l[u]*S,l[u]=x&255,x>>=8;for(;x>0;)l.push(x&255),x>>=8}for(var U=0;e[U]===c&&U<e.length-1;++U)l.push(0);return typeof Buffer<"u"?Buffer.from(l.reverse()):new Uint8Array(l.reverse())};function a(e,i){var C=0,E=i.length,S=i.charAt(0),c=[0];for(C=0;C<e.length();++C){for(var l=0,r=e.at(C);l<c.length;++l)r+=c[l]<<8,c[l]=r%E,r=r/E|0;for(;r>0;)c.push(r%E),r=r/E|0}var u="";for(C=0;e.at(C)===0&&C<e.length()-1;++C)u+=S;for(C=c.length-1;C>=0;--C)u+=i[c[C]];return u}},77464:(re,ce,V)=>{var a=V(96560);V(64687),re.exports=a.cipher=a.cipher||{},a.cipher.algorithms=a.cipher.algorithms||{},a.cipher.createCipher=function(i,C){var E=i;if(typeof E=="string"&&(E=a.cipher.getAlgorithm(E),E&&(E=E())),!E)throw new Error("Unsupported algorithm: "+i);return new a.cipher.BlockCipher({algorithm:E,key:C,decrypt:!1})},a.cipher.createDecipher=function(i,C){var E=i;if(typeof E=="string"&&(E=a.cipher.getAlgorithm(E),E&&(E=E())),!E)throw new Error("Unsupported algorithm: "+i);return new a.cipher.BlockCipher({algorithm:E,key:C,decrypt:!0})},a.cipher.registerAlgorithm=function(i,C){i=i.toUpperCase(),a.cipher.algorithms[i]=C},a.cipher.getAlgorithm=function(i){return i=i.toUpperCase(),i in a.cipher.algorithms?a.cipher.algorithms[i]:null};var e=a.cipher.BlockCipher=function(i){this.algorithm=i.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=i.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=i.decrypt,this.algorithm.initialize(i)};e.prototype.start=function(i){i=i||{};var C={};for(var E in i)C[E]=i[E];C.decrypt=this._decrypt,this._finish=!1,this._input=a.util.createBuffer(),this.output=i.output||a.util.createBuffer(),this.mode.start(C)},e.prototype.update=function(i){for(i&&this._input.putBuffer(i);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},e.prototype.finish=function(i){i&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(E){return i(this.blockSize,E,!1)},this.mode.unpad=function(E){return i(this.blockSize,E,!0)});var C={};return C.decrypt=this._decrypt,C.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,C)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,C))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,C))}},22278:(re,ce,V)=>{var a=V(96560);V(64687),a.cipher=a.cipher||{};var e=re.exports=a.cipher.modes=a.cipher.modes||{};e.ecb=function(S){S=S||{},this.name="ECB",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.ecb.prototype.start=function(S){},e.ecb.prototype.encrypt=function(S,c,l){if(S.length()<this.blockSize&&!(l&&S.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=S.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)c.putInt32(this._outBlock[r])},e.ecb.prototype.decrypt=function(S,c,l){if(S.length()<this.blockSize&&!(l&&S.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=S.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)c.putInt32(this._outBlock[r])},e.ecb.prototype.pad=function(S,c){var l=S.length()===this.blockSize?this.blockSize:this.blockSize-S.length();return S.fillWithByte(l,l),!0},e.ecb.prototype.unpad=function(S,c){if(c.overflow>0)return!1;var l=S.length(),r=S.at(l-1);return r>this.blockSize<<2?!1:(S.truncate(r),!0)},e.cbc=function(S){S=S||{},this.name="CBC",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.cbc.prototype.start=function(S){if(S.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in S)this._iv=i(S.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")},e.cbc.prototype.encrypt=function(S,c,l){if(S.length()<this.blockSize&&!(l&&S.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=this._prev[r]^S.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)c.putInt32(this._outBlock[r]);this._prev=this._outBlock},e.cbc.prototype.decrypt=function(S,c,l){if(S.length()<this.blockSize&&!(l&&S.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=S.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)c.putInt32(this._prev[r]^this._outBlock[r]);this._prev=this._inBlock.slice(0)},e.cbc.prototype.pad=function(S,c){var l=S.length()===this.blockSize?this.blockSize:this.blockSize-S.length();return S.fillWithByte(l,l),!0},e.cbc.prototype.unpad=function(S,c){if(c.overflow>0)return!1;var l=S.length(),r=S.at(l-1);return r>this.blockSize<<2?!1:(S.truncate(r),!0)},e.cfb=function(S){S=S||{},this.name="CFB",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=a.util.createBuffer(),this._partialBytes=0},e.cfb.prototype.start=function(S){if(!("iv"in S))throw new Error("Invalid IV parameter.");this._iv=i(S.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.cfb.prototype.encrypt=function(S,c,l){var r=S.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var u=0;u<this._ints;++u)this._inBlock[u]=S.getInt32()^this._outBlock[u],c.putInt32(this._inBlock[u]);return}var x=(this.blockSize-r)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var u=0;u<this._ints;++u)this._partialBlock[u]=S.getInt32()^this._outBlock[u],this._partialOutput.putInt32(this._partialBlock[u]);if(x>0)S.read-=this.blockSize;else for(var u=0;u<this._ints;++u)this._inBlock[u]=this._partialBlock[u];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!l)return c.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;c.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0},e.cfb.prototype.decrypt=function(S,c,l){var r=S.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var u=0;u<this._ints;++u)this._inBlock[u]=S.getInt32(),c.putInt32(this._inBlock[u]^this._outBlock[u]);return}var x=(this.blockSize-r)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var u=0;u<this._ints;++u)this._partialBlock[u]=S.getInt32(),this._partialOutput.putInt32(this._partialBlock[u]^this._outBlock[u]);if(x>0)S.read-=this.blockSize;else for(var u=0;u<this._ints;++u)this._inBlock[u]=this._partialBlock[u];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!l)return c.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;c.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0},e.ofb=function(S){S=S||{},this.name="OFB",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=a.util.createBuffer(),this._partialBytes=0},e.ofb.prototype.start=function(S){if(!("iv"in S))throw new Error("Invalid IV parameter.");this._iv=i(S.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ofb.prototype.encrypt=function(S,c,l){var r=S.length();if(S.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var u=0;u<this._ints;++u)c.putInt32(S.getInt32()^this._outBlock[u]),this._inBlock[u]=this._outBlock[u];return}var x=(this.blockSize-r)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var u=0;u<this._ints;++u)this._partialOutput.putInt32(S.getInt32()^this._outBlock[u]);if(x>0)S.read-=this.blockSize;else for(var u=0;u<this._ints;++u)this._inBlock[u]=this._outBlock[u];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!l)return c.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;c.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0},e.ofb.prototype.decrypt=e.ofb.prototype.encrypt,e.ctr=function(S){S=S||{},this.name="CTR",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=a.util.createBuffer(),this._partialBytes=0},e.ctr.prototype.start=function(S){if(!("iv"in S))throw new Error("Invalid IV parameter.");this._iv=i(S.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ctr.prototype.encrypt=function(S,c,l){var r=S.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize)for(var u=0;u<this._ints;++u)c.putInt32(S.getInt32()^this._outBlock[u]);else{var x=(this.blockSize-r)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var u=0;u<this._ints;++u)this._partialOutput.putInt32(S.getInt32()^this._outBlock[u]);if(x>0&&(S.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!l)return c.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;c.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}C(this._inBlock)},e.ctr.prototype.decrypt=e.ctr.prototype.encrypt,e.gcm=function(S){S=S||{},this.name="GCM",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=a.util.createBuffer(),this._partialBytes=0,this._R=3774873600},e.gcm.prototype.start=function(S){if(!("iv"in S))throw new Error("Invalid IV parameter.");var c=a.util.createBuffer(S.iv);this._cipherLength=0;var l;if("additionalData"in S?l=a.util.createBuffer(S.additionalData):l=a.util.createBuffer(),"tagLength"in S?this._tagLength=S.tagLength:this._tagLength=128,this._tag=null,S.decrypt&&(this._tag=a.util.createBuffer(S.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var r=c.length();if(r===12)this._j0=[c.getInt32(),c.getInt32(),c.getInt32(),1];else{for(this._j0=[0,0,0,0];c.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[c.getInt32(),c.getInt32(),c.getInt32(),c.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(E(r*8)))}this._inBlock=this._j0.slice(0),C(this._inBlock),this._partialBytes=0,l=a.util.createBuffer(l),this._aDataLength=E(l.length()*8);var u=l.length()%this.blockSize;for(u&&l.fillWithByte(0,this.blockSize-u),this._s=[0,0,0,0];l.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[l.getInt32(),l.getInt32(),l.getInt32(),l.getInt32()])},e.gcm.prototype.encrypt=function(S,c,l){var r=S.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var u=0;u<this._ints;++u)c.putInt32(this._outBlock[u]^=S.getInt32());this._cipherLength+=this.blockSize}else{var x=(this.blockSize-r)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var u=0;u<this._ints;++u)this._partialOutput.putInt32(S.getInt32()^this._outBlock[u]);if(x<=0||l){if(l){var U=r%this.blockSize;this._cipherLength+=U,this._partialOutput.truncate(this.blockSize-U)}else this._cipherLength+=this.blockSize;for(var u=0;u<this._ints;++u)this._outBlock[u]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!l)return S.read-=this.blockSize,c.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;c.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),C(this._inBlock)},e.gcm.prototype.decrypt=function(S,c,l){var r=S.length();if(r<this.blockSize&&!(l&&r>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),C(this._inBlock),this._hashBlock[0]=S.getInt32(),this._hashBlock[1]=S.getInt32(),this._hashBlock[2]=S.getInt32(),this._hashBlock[3]=S.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var u=0;u<this._ints;++u)c.putInt32(this._outBlock[u]^this._hashBlock[u]);r<this.blockSize?this._cipherLength+=r%this.blockSize:this._cipherLength+=this.blockSize},e.gcm.prototype.afterFinish=function(S,c){var l=!0;c.decrypt&&c.overflow&&S.truncate(this.blockSize-c.overflow),this.tag=a.util.createBuffer();var r=this._aDataLength.concat(E(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,r);var u=[];this.cipher.encrypt(this._j0,u);for(var x=0;x<this._ints;++x)this.tag.putInt32(this._s[x]^u[x]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),c.decrypt&&this.tag.bytes()!==this._tag&&(l=!1),l},e.gcm.prototype.multiply=function(S,c){for(var l=[0,0,0,0],r=c.slice(0),u=0;u<128;++u){var x=S[u/32|0]&1<<31-u%32;x&&(l[0]^=r[0],l[1]^=r[1],l[2]^=r[2],l[3]^=r[3]),this.pow(r,r)}return l},e.gcm.prototype.pow=function(S,c){for(var l=S[3]&1,r=3;r>0;--r)c[r]=S[r]>>>1|(S[r-1]&1)<<31;c[0]=S[0]>>>1,l&&(c[0]^=this._R)},e.gcm.prototype.tableMultiply=function(S){for(var c=[0,0,0,0],l=0;l<32;++l){var r=l/8|0,u=S[r]>>>(7-l%8)*4&15,x=this._m[l][u];c[0]^=x[0],c[1]^=x[1],c[2]^=x[2],c[3]^=x[3]}return c},e.gcm.prototype.ghash=function(S,c,l){return c[0]^=l[0],c[1]^=l[1],c[2]^=l[2],c[3]^=l[3],this.tableMultiply(c)},e.gcm.prototype.generateHashTable=function(S,c){for(var l=8/c,r=4*l,u=16*l,x=new Array(u),U=0;U<u;++U){var m=[0,0,0,0],y=U/r|0,I=(r-1-U%r)*c;m[y]=1<<c-1<<I,x[U]=this.generateSubHashTable(this.multiply(m,S),c)}return x},e.gcm.prototype.generateSubHashTable=function(S,c){var l=1<<c,r=l>>>1,u=new Array(l);u[r]=S.slice(0);for(var x=r>>>1;x>0;)this.pow(u[2*x],u[x]=[]),x>>=1;for(x=2;x<r;){for(var U=1;U<x;++U){var m=u[x],y=u[U];u[x+U]=[m[0]^y[0],m[1]^y[1],m[2]^y[2],m[3]^y[3]]}x*=2}for(u[0]=[0,0,0,0],x=r+1;x<l;++x){var I=u[x^r];u[x]=[S[0]^I[0],S[1]^I[1],S[2]^I[2],S[3]^I[3]]}return u};function i(S,c){if(typeof S=="string"&&(S=a.util.createBuffer(S)),a.util.isArray(S)&&S.length>4){var l=S;S=a.util.createBuffer();for(var r=0;r<l.length;++r)S.putByte(l[r])}if(S.length()<c)throw new Error("Invalid IV length; got "+S.length()+" bytes and expected "+c+" bytes.");if(!a.util.isArray(S)){for(var u=[],x=c/4,r=0;r<x;++r)u.push(S.getInt32());S=u}return S}function C(S){S[S.length-1]=S[S.length-1]+1&4294967295}function E(S){return[S/4294967296|0,S&4294967295]}},37187:(re,ce,V)=>{var a=V(96560);V(77464),V(22278),V(64687),re.exports=a.des=a.des||{},a.des.startEncrypting=function(y,I,d,v){var n=m({key:y,output:d,decrypt:!1,mode:v||(I===null?"ECB":"CBC")});return n.start(I),n},a.des.createEncryptionCipher=function(y,I){return m({key:y,output:null,decrypt:!1,mode:I})},a.des.startDecrypting=function(y,I,d,v){var n=m({key:y,output:d,decrypt:!0,mode:v||(I===null?"ECB":"CBC")});return n.start(I),n},a.des.createDecryptionCipher=function(y,I){return m({key:y,output:null,decrypt:!0,mode:I})},a.des.Algorithm=function(y,I){var d=this;d.name=y,d.mode=new I({blockSize:8,cipher:{encrypt:function(v,n){return U(d._keys,v,n,!1)},decrypt:function(v,n){return U(d._keys,v,n,!0)}}}),d._init=!1},a.des.Algorithm.prototype.initialize=function(y){if(!this._init){var I=a.util.createBuffer(y.key);if(this.name.indexOf("3DES")===0&&I.length()!==24)throw new Error("Invalid Triple-DES key size: "+I.length()*8);this._keys=x(I),this._init=!0}},e("DES-ECB",a.cipher.modes.ecb),e("DES-CBC",a.cipher.modes.cbc),e("DES-CFB",a.cipher.modes.cfb),e("DES-OFB",a.cipher.modes.ofb),e("DES-CTR",a.cipher.modes.ctr),e("3DES-ECB",a.cipher.modes.ecb),e("3DES-CBC",a.cipher.modes.cbc),e("3DES-CFB",a.cipher.modes.cfb),e("3DES-OFB",a.cipher.modes.ofb),e("3DES-CTR",a.cipher.modes.ctr);function e(y,I){var d=function(){return new a.des.Algorithm(y,I)};a.cipher.registerAlgorithm(y,d)}var i=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],C=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],E=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],S=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],c=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],l=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],r=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],u=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function x(y){for(var I=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],d=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],v=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],f=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],p=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],A=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],R=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],k=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],g=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],N=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],t=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],L=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],O=y.length()>8?3:1,w=[],M=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],K=0,G,X=0;X<O;X++){var W=y.getInt32(),q=y.getInt32();G=(W>>>4^q)&252645135,q^=G,W^=G<<4,G=(q>>>-16^W)&65535,W^=G,q^=G<<-16,G=(W>>>2^q)&858993459,q^=G,W^=G<<2,G=(q>>>-16^W)&65535,W^=G,q^=G<<-16,G=(W>>>1^q)&1431655765,q^=G,W^=G<<1,G=(q>>>8^W)&16711935,W^=G,q^=G<<8,G=(W>>>1^q)&1431655765,q^=G,W^=G<<1,G=W<<8|q>>>20&240,W=q<<24|q<<8&16711680|q>>>8&65280|q>>>24&240,q=G;for(var te=0;te<M.length;++te){M[te]?(W=W<<2|W>>>26,q=q<<2|q>>>26):(W=W<<1|W>>>27,q=q<<1|q>>>27),W&=-15,q&=-15;var fe=I[W>>>28]|d[W>>>24&15]|v[W>>>20&15]|n[W>>>16&15]|f[W>>>12&15]|p[W>>>8&15]|A[W>>>4&15],he=R[q>>>28]|k[q>>>24&15]|h[q>>>20&15]|g[q>>>16&15]|N[q>>>12&15]|t[q>>>8&15]|L[q>>>4&15];G=(he>>>16^fe)&65535,w[K++]=fe^G,w[K++]=he^G<<16}}return w}function U(y,I,d,v){var n=y.length===32?3:9,f;n===3?f=v?[30,-2,-2]:[0,32,2]:f=v?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var p,A=I[0],R=I[1];p=(A>>>4^R)&252645135,R^=p,A^=p<<4,p=(A>>>16^R)&65535,R^=p,A^=p<<16,p=(R>>>2^A)&858993459,A^=p,R^=p<<2,p=(R>>>8^A)&16711935,A^=p,R^=p<<8,p=(A>>>1^R)&1431655765,R^=p,A^=p<<1,A=A<<1|A>>>31,R=R<<1|R>>>31;for(var k=0;k<n;k+=3){for(var h=f[k+1],g=f[k+2],N=f[k];N!=h;N+=g){var t=R^y[N],L=(R>>>4|R<<28)^y[N+1];p=A,A=R,R=p^(C[t>>>24&63]|S[t>>>16&63]|l[t>>>8&63]|u[t&63]|i[L>>>24&63]|E[L>>>16&63]|c[L>>>8&63]|r[L&63])}p=A,A=R,R=p}A=A>>>1|A<<31,R=R>>>1|R<<31,p=(A>>>1^R)&1431655765,R^=p,A^=p<<1,p=(R>>>8^A)&16711935,A^=p,R^=p<<8,p=(R>>>2^A)&858993459,A^=p,R^=p<<2,p=(A>>>16^R)&65535,R^=p,A^=p<<16,p=(A>>>4^R)&252645135,R^=p,A^=p<<4,d[0]=A,d[1]=R}function m(y){y=y||{};var I=(y.mode||"CBC").toUpperCase(),d="DES-"+I,v;y.decrypt?v=a.cipher.createDecipher(d,y.key):v=a.cipher.createCipher(d,y.key);var n=v.start;return v.start=function(f,p){var A=null;p instanceof a.util.ByteBuffer&&(A=p,p={}),p=p||{},p.output=A,p.iv=f,n.call(v,p)},v}},3994:(re,ce,V)=>{var a=V(96560);V(35156),V(2608),V(6677),V(64687);var e=V(92673),i=e.publicKeyValidator,C=e.privateKeyValidator;if(typeof E>"u")var E=a.jsbn.BigInteger;var S=a.util.ByteBuffer,c=typeof Buffer>"u"?Uint8Array:Buffer;a.pki=a.pki||{},re.exports=a.pki.ed25519=a.ed25519=a.ed25519||{};var l=a.ed25519;l.constants={},l.constants.PUBLIC_KEY_BYTE_LENGTH=32,l.constants.PRIVATE_KEY_BYTE_LENGTH=64,l.constants.SEED_BYTE_LENGTH=32,l.constants.SIGN_BYTE_LENGTH=64,l.constants.HASH_BYTE_LENGTH=64,l.generateKeyPair=function(z){z=z||{};var Q=z.seed;if(Q===void 0)Q=a.random.getBytesSync(l.constants.SEED_BYTE_LENGTH);else if(typeof Q=="string"){if(Q.length!==l.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+l.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(Q instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');Q=r({message:Q,encoding:"binary"});for(var o=new c(l.constants.PUBLIC_KEY_BYTE_LENGTH),s=new c(l.constants.PRIVATE_KEY_BYTE_LENGTH),T=0;T<32;++T)s[T]=Q[T];return f(o,s),{publicKey:o,privateKey:s}},l.privateKeyFromAsn1=function(z){var Q={},o=[],s=a.asn1.validate(z,C,Q,o);if(!s){var T=new Error("Invalid Key.");throw T.errors=o,T}var P=a.asn1.derToOid(Q.privateKeyOid),F=a.oids.EdDSA25519;if(P!==F)throw new Error('Invalid OID "'+P+'"; OID must be "'+F+'".');var Y=Q.privateKey,_=r({message:a.asn1.fromDer(Y).value,encoding:"binary"});return{privateKeyBytes:_}},l.publicKeyFromAsn1=function(z){var Q={},o=[],s=a.asn1.validate(z,i,Q,o);if(!s){var T=new Error("Invalid Key.");throw T.errors=o,T}var P=a.asn1.derToOid(Q.publicKeyOid),F=a.oids.EdDSA25519;if(P!==F)throw new Error('Invalid OID "'+P+'"; OID must be "'+F+'".');var Y=Q.ed25519PublicKey;if(Y.length!==l.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return r({message:Y,encoding:"binary"})},l.publicKeyFromPrivateKey=function(z){z=z||{};var Q=r({message:z.privateKey,encoding:"binary"});if(Q.length!==l.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+l.constants.PRIVATE_KEY_BYTE_LENGTH);for(var o=new c(l.constants.PUBLIC_KEY_BYTE_LENGTH),s=0;s<o.length;++s)o[s]=Q[32+s];return o},l.sign=function(z){z=z||{};var Q=r(z),o=r({message:z.privateKey,encoding:"binary"});if(o.length===l.constants.SEED_BYTE_LENGTH){var s=l.generateKeyPair({seed:o});o=s.privateKey}else if(o.length!==l.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+l.constants.SEED_BYTE_LENGTH+" or "+l.constants.PRIVATE_KEY_BYTE_LENGTH);var T=new c(l.constants.SIGN_BYTE_LENGTH+Q.length);p(T,Q,Q.length,o);for(var P=new c(l.constants.SIGN_BYTE_LENGTH),F=0;F<P.length;++F)P[F]=T[F];return P},l.verify=function(z){z=z||{};var Q=r(z);if(z.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var o=r({message:z.signature,encoding:"binary"});if(o.length!==l.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+l.constants.SIGN_BYTE_LENGTH);var s=r({message:z.publicKey,encoding:"binary"});if(s.length!==l.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+l.constants.PUBLIC_KEY_BYTE_LENGTH);var T=new c(l.constants.SIGN_BYTE_LENGTH+Q.length),P=new c(l.constants.SIGN_BYTE_LENGTH+Q.length),F;for(F=0;F<l.constants.SIGN_BYTE_LENGTH;++F)T[F]=o[F];for(F=0;F<Q.length;++F)T[F+l.constants.SIGN_BYTE_LENGTH]=Q[F];return A(P,T,T.length,s)>=0};function r(z){var Q=z.message;if(Q instanceof Uint8Array||Q instanceof c)return Q;var o=z.encoding;if(Q===void 0)if(z.md)Q=z.md.digest().getBytes(),o="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof Q=="string"&&!o)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof Q=="string"){if(typeof Buffer<"u")return Buffer.from(Q,o);Q=new S(Q,o)}else if(!(Q instanceof S))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var s=new c(Q.length()),T=0;T<s.length;++T)s[T]=Q.at(T);return s}var u=J(),x=J([1]),U=J([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),m=J([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),y=J([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),I=J([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),d=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),v=J([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function n(z,Q){var o=a.md.sha512.create(),s=new S(z);o.update(s.getBytes(Q),"binary");var T=o.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(T,"binary");for(var P=new c(l.constants.HASH_BYTE_LENGTH),F=0;F<64;++F)P[F]=T.charCodeAt(F);return P}function f(z,Q){var o=[J(),J(),J(),J()],s,T=n(Q,32);for(T[0]&=248,T[31]&=127,T[31]|=64,q(o,T),N(z,o),s=0;s<32;++s)Q[s+32]=z[s];return 0}function p(z,Q,o,s){var T,P,F=new Float64Array(64),Y=[J(),J(),J(),J()],_=n(s,32);_[0]&=248,_[31]&=127,_[31]|=64;var ee=o+64;for(T=0;T<o;++T)z[64+T]=Q[T];for(T=0;T<32;++T)z[32+T]=_[32+T];var oe=n(z.subarray(32),o+32);for(k(oe),q(Y,oe),N(z,Y),T=32;T<64;++T)z[T]=s[T];var ue=n(z,o+64);for(k(ue),T=32;T<64;++T)F[T]=0;for(T=0;T<32;++T)F[T]=oe[T];for(T=0;T<32;++T)for(P=0;P<32;P++)F[T+P]+=ue[T]*_[P];return R(z.subarray(32),F),ee}function A(z,Q,o,s){var T,P,F=new c(32),Y=[J(),J(),J(),J()],_=[J(),J(),J(),J()];if(P=-1,o<64||L(_,s))return-1;for(T=0;T<o;++T)z[T]=Q[T];for(T=0;T<32;++T)z[T+32]=s[T];var ee=n(z,o);if(k(ee),W(Y,_,ee),q(_,Q.subarray(32)),h(Y,_),N(F,Y),o-=64,K(Q,0,F,0)){for(T=0;T<o;++T)z[T]=0;return-1}for(T=0;T<o;++T)z[T]=Q[T+64];return P=o,P}function R(z,Q){var o,s,T,P;for(s=63;s>=32;--s){for(o=0,T=s-32,P=s-12;T<P;++T)Q[T]+=o-16*Q[s]*d[T-(s-32)],o=Q[T]+128>>8,Q[T]-=o*256;Q[T]+=o,Q[s]=0}for(o=0,T=0;T<32;++T)Q[T]+=o-(Q[31]>>4)*d[T],o=Q[T]>>8,Q[T]&=255;for(T=0;T<32;++T)Q[T]-=o*d[T];for(s=0;s<32;++s)Q[s+1]+=Q[s]>>8,z[s]=Q[s]&255}function k(z){for(var Q=new Float64Array(64),o=0;o<64;++o)Q[o]=z[o],z[o]=0;R(z,Q)}function h(z,Q){var o=J(),s=J(),T=J(),P=J(),F=J(),Y=J(),_=J(),ee=J(),oe=J();ie(o,z[1],z[0]),ie(oe,Q[1],Q[0]),ve(o,o,oe),me(s,z[0],z[1]),me(oe,Q[0],Q[1]),ve(s,s,oe),ve(T,z[3],Q[3]),ve(T,T,m),ve(P,z[2],Q[2]),me(P,P,P),ie(F,s,o),ie(Y,P,T),me(_,P,T),me(ee,s,o),ve(z[0],F,Y),ve(z[1],ee,_),ve(z[2],_,Y),ve(z[3],F,ee)}function g(z,Q,o){for(var s=0;s<4;++s)pe(z[s],Q[s],o)}function N(z,Q){var o=J(),s=J(),T=J();fe(T,Q[2]),ve(o,Q[0],T),ve(s,Q[1],T),t(z,s),z[31]^=X(o)<<7}function t(z,Q){var o,s,T,P=J(),F=J();for(o=0;o<16;++o)F[o]=Q[o];for(he(F),he(F),he(F),s=0;s<2;++s){for(P[0]=F[0]-65517,o=1;o<15;++o)P[o]=F[o]-65535-(P[o-1]>>16&1),P[o-1]&=65535;P[15]=F[15]-32767-(P[14]>>16&1),T=P[15]>>16&1,P[14]&=65535,pe(F,P,1-T)}for(o=0;o<16;o++)z[2*o]=F[o]&255,z[2*o+1]=F[o]>>8}function L(z,Q){var o=J(),s=J(),T=J(),P=J(),F=J(),Y=J(),_=J();return te(z[2],x),O(z[1],Q),ge(T,z[1]),ve(P,T,U),ie(T,T,z[2]),me(P,z[2],P),ge(F,P),ge(Y,F),ve(_,Y,F),ve(o,_,T),ve(o,o,P),w(o,o),ve(o,o,T),ve(o,o,P),ve(o,o,P),ve(z[0],o,P),ge(s,z[0]),ve(s,s,P),M(s,T)&&ve(z[0],z[0],v),ge(s,z[0]),ve(s,s,P),M(s,T)?-1:(X(z[0])===Q[31]>>7&&ie(z[0],u,z[0]),ve(z[3],z[0],z[1]),0)}function O(z,Q){var o;for(o=0;o<16;++o)z[o]=Q[2*o]+(Q[2*o+1]<<8);z[15]&=32767}function w(z,Q){var o=J(),s;for(s=0;s<16;++s)o[s]=Q[s];for(s=250;s>=0;--s)ge(o,o),s!==1&&ve(o,o,Q);for(s=0;s<16;++s)z[s]=o[s]}function M(z,Q){var o=new c(32),s=new c(32);return t(o,z),t(s,Q),K(o,0,s,0)}function K(z,Q,o,s){return G(z,Q,o,s,32)}function G(z,Q,o,s,T){var P,F=0;for(P=0;P<T;++P)F|=z[Q+P]^o[s+P];return(1&F-1>>>8)-1}function X(z){var Q=new c(32);return t(Q,z),Q[0]&1}function W(z,Q,o){var s,T;for(te(z[0],u),te(z[1],x),te(z[2],x),te(z[3],u),T=255;T>=0;--T)s=o[T/8|0]>>(T&7)&1,g(z,Q,s),h(Q,z),h(z,z),g(z,Q,s)}function q(z,Q){var o=[J(),J(),J(),J()];te(o[0],y),te(o[1],I),te(o[2],x),ve(o[3],y,I),W(z,o,Q)}function te(z,Q){var o;for(o=0;o<16;o++)z[o]=Q[o]|0}function fe(z,Q){var o=J(),s;for(s=0;s<16;++s)o[s]=Q[s];for(s=253;s>=0;--s)ge(o,o),s!==2&&s!==4&&ve(o,o,Q);for(s=0;s<16;++s)z[s]=o[s]}function he(z){var Q,o,s=1;for(Q=0;Q<16;++Q)o=z[Q]+s+65535,s=Math.floor(o/65536),z[Q]=o-s*65536;z[0]+=s-1+37*(s-1)}function pe(z,Q,o){for(var s,T=~(o-1),P=0;P<16;++P)s=T&(z[P]^Q[P]),z[P]^=s,Q[P]^=s}function J(z){var Q,o=new Float64Array(16);if(z)for(Q=0;Q<z.length;++Q)o[Q]=z[Q];return o}function me(z,Q,o){for(var s=0;s<16;++s)z[s]=Q[s]+o[s]}function ie(z,Q,o){for(var s=0;s<16;++s)z[s]=Q[s]-o[s]}function ge(z,Q){ve(z,Q,Q)}function ve(z,Q,o){var s,T,P=0,F=0,Y=0,_=0,ee=0,oe=0,ue=0,j=0,se=0,le=0,ye=0,de=0,Ee=0,Te=0,xe=0,Se=0,Be=0,Ge=0,be=0,Qe=0,ze=0,Ye=0,Xe=0,qe=0,et=0,tt=0,at=0,it=0,st=0,ut=0,ft=0,Ne=o[0],Re=o[1],Le=o[2],we=o[3],De=o[4],Ue=o[5],ke=o[6],Pe=o[7],Ve=o[8],Oe=o[9],_e=o[10],Fe=o[11],Ke=o[12],Me=o[13],Ie=o[14],Ae=o[15];s=Q[0],P+=s*Ne,F+=s*Re,Y+=s*Le,_+=s*we,ee+=s*De,oe+=s*Ue,ue+=s*ke,j+=s*Pe,se+=s*Ve,le+=s*Oe,ye+=s*_e,de+=s*Fe,Ee+=s*Ke,Te+=s*Me,xe+=s*Ie,Se+=s*Ae,s=Q[1],F+=s*Ne,Y+=s*Re,_+=s*Le,ee+=s*we,oe+=s*De,ue+=s*Ue,j+=s*ke,se+=s*Pe,le+=s*Ve,ye+=s*Oe,de+=s*_e,Ee+=s*Fe,Te+=s*Ke,xe+=s*Me,Se+=s*Ie,Be+=s*Ae,s=Q[2],Y+=s*Ne,_+=s*Re,ee+=s*Le,oe+=s*we,ue+=s*De,j+=s*Ue,se+=s*ke,le+=s*Pe,ye+=s*Ve,de+=s*Oe,Ee+=s*_e,Te+=s*Fe,xe+=s*Ke,Se+=s*Me,Be+=s*Ie,Ge+=s*Ae,s=Q[3],_+=s*Ne,ee+=s*Re,oe+=s*Le,ue+=s*we,j+=s*De,se+=s*Ue,le+=s*ke,ye+=s*Pe,de+=s*Ve,Ee+=s*Oe,Te+=s*_e,xe+=s*Fe,Se+=s*Ke,Be+=s*Me,Ge+=s*Ie,be+=s*Ae,s=Q[4],ee+=s*Ne,oe+=s*Re,ue+=s*Le,j+=s*we,se+=s*De,le+=s*Ue,ye+=s*ke,de+=s*Pe,Ee+=s*Ve,Te+=s*Oe,xe+=s*_e,Se+=s*Fe,Be+=s*Ke,Ge+=s*Me,be+=s*Ie,Qe+=s*Ae,s=Q[5],oe+=s*Ne,ue+=s*Re,j+=s*Le,se+=s*we,le+=s*De,ye+=s*Ue,de+=s*ke,Ee+=s*Pe,Te+=s*Ve,xe+=s*Oe,Se+=s*_e,Be+=s*Fe,Ge+=s*Ke,be+=s*Me,Qe+=s*Ie,ze+=s*Ae,s=Q[6],ue+=s*Ne,j+=s*Re,se+=s*Le,le+=s*we,ye+=s*De,de+=s*Ue,Ee+=s*ke,Te+=s*Pe,xe+=s*Ve,Se+=s*Oe,Be+=s*_e,Ge+=s*Fe,be+=s*Ke,Qe+=s*Me,ze+=s*Ie,Ye+=s*Ae,s=Q[7],j+=s*Ne,se+=s*Re,le+=s*Le,ye+=s*we,de+=s*De,Ee+=s*Ue,Te+=s*ke,xe+=s*Pe,Se+=s*Ve,Be+=s*Oe,Ge+=s*_e,be+=s*Fe,Qe+=s*Ke,ze+=s*Me,Ye+=s*Ie,Xe+=s*Ae,s=Q[8],se+=s*Ne,le+=s*Re,ye+=s*Le,de+=s*we,Ee+=s*De,Te+=s*Ue,xe+=s*ke,Se+=s*Pe,Be+=s*Ve,Ge+=s*Oe,be+=s*_e,Qe+=s*Fe,ze+=s*Ke,Ye+=s*Me,Xe+=s*Ie,qe+=s*Ae,s=Q[9],le+=s*Ne,ye+=s*Re,de+=s*Le,Ee+=s*we,Te+=s*De,xe+=s*Ue,Se+=s*ke,Be+=s*Pe,Ge+=s*Ve,be+=s*Oe,Qe+=s*_e,ze+=s*Fe,Ye+=s*Ke,Xe+=s*Me,qe+=s*Ie,et+=s*Ae,s=Q[10],ye+=s*Ne,de+=s*Re,Ee+=s*Le,Te+=s*we,xe+=s*De,Se+=s*Ue,Be+=s*ke,Ge+=s*Pe,be+=s*Ve,Qe+=s*Oe,ze+=s*_e,Ye+=s*Fe,Xe+=s*Ke,qe+=s*Me,et+=s*Ie,tt+=s*Ae,s=Q[11],de+=s*Ne,Ee+=s*Re,Te+=s*Le,xe+=s*we,Se+=s*De,Be+=s*Ue,Ge+=s*ke,be+=s*Pe,Qe+=s*Ve,ze+=s*Oe,Ye+=s*_e,Xe+=s*Fe,qe+=s*Ke,et+=s*Me,tt+=s*Ie,at+=s*Ae,s=Q[12],Ee+=s*Ne,Te+=s*Re,xe+=s*Le,Se+=s*we,Be+=s*De,Ge+=s*Ue,be+=s*ke,Qe+=s*Pe,ze+=s*Ve,Ye+=s*Oe,Xe+=s*_e,qe+=s*Fe,et+=s*Ke,tt+=s*Me,at+=s*Ie,it+=s*Ae,s=Q[13],Te+=s*Ne,xe+=s*Re,Se+=s*Le,Be+=s*we,Ge+=s*De,be+=s*Ue,Qe+=s*ke,ze+=s*Pe,Ye+=s*Ve,Xe+=s*Oe,qe+=s*_e,et+=s*Fe,tt+=s*Ke,at+=s*Me,it+=s*Ie,st+=s*Ae,s=Q[14],xe+=s*Ne,Se+=s*Re,Be+=s*Le,Ge+=s*we,be+=s*De,Qe+=s*Ue,ze+=s*ke,Ye+=s*Pe,Xe+=s*Ve,qe+=s*Oe,et+=s*_e,tt+=s*Fe,at+=s*Ke,it+=s*Me,st+=s*Ie,ut+=s*Ae,s=Q[15],Se+=s*Ne,Be+=s*Re,Ge+=s*Le,be+=s*we,Qe+=s*De,ze+=s*Ue,Ye+=s*ke,Xe+=s*Pe,qe+=s*Ve,et+=s*Oe,tt+=s*_e,at+=s*Fe,it+=s*Ke,st+=s*Me,ut+=s*Ie,ft+=s*Ae,P+=38*Be,F+=38*Ge,Y+=38*be,_+=38*Qe,ee+=38*ze,oe+=38*Ye,ue+=38*Xe,j+=38*qe,se+=38*et,le+=38*tt,ye+=38*at,de+=38*it,Ee+=38*st,Te+=38*ut,xe+=38*ft,T=1,s=P+T+65535,T=Math.floor(s/65536),P=s-T*65536,s=F+T+65535,T=Math.floor(s/65536),F=s-T*65536,s=Y+T+65535,T=Math.floor(s/65536),Y=s-T*65536,s=_+T+65535,T=Math.floor(s/65536),_=s-T*65536,s=ee+T+65535,T=Math.floor(s/65536),ee=s-T*65536,s=oe+T+65535,T=Math.floor(s/65536),oe=s-T*65536,s=ue+T+65535,T=Math.floor(s/65536),ue=s-T*65536,s=j+T+65535,T=Math.floor(s/65536),j=s-T*65536,s=se+T+65535,T=Math.floor(s/65536),se=s-T*65536,s=le+T+65535,T=Math.floor(s/65536),le=s-T*65536,s=ye+T+65535,T=Math.floor(s/65536),ye=s-T*65536,s=de+T+65535,T=Math.floor(s/65536),de=s-T*65536,s=Ee+T+65535,T=Math.floor(s/65536),Ee=s-T*65536,s=Te+T+65535,T=Math.floor(s/65536),Te=s-T*65536,s=xe+T+65535,T=Math.floor(s/65536),xe=s-T*65536,s=Se+T+65535,T=Math.floor(s/65536),Se=s-T*65536,P+=T-1+37*(T-1),T=1,s=P+T+65535,T=Math.floor(s/65536),P=s-T*65536,s=F+T+65535,T=Math.floor(s/65536),F=s-T*65536,s=Y+T+65535,T=Math.floor(s/65536),Y=s-T*65536,s=_+T+65535,T=Math.floor(s/65536),_=s-T*65536,s=ee+T+65535,T=Math.floor(s/65536),ee=s-T*65536,s=oe+T+65535,T=Math.floor(s/65536),oe=s-T*65536,s=ue+T+65535,T=Math.floor(s/65536),ue=s-T*65536,s=j+T+65535,T=Math.floor(s/65536),j=s-T*65536,s=se+T+65535,T=Math.floor(s/65536),se=s-T*65536,s=le+T+65535,T=Math.floor(s/65536),le=s-T*65536,s=ye+T+65535,T=Math.floor(s/65536),ye=s-T*65536,s=de+T+65535,T=Math.floor(s/65536),de=s-T*65536,s=Ee+T+65535,T=Math.floor(s/65536),Ee=s-T*65536,s=Te+T+65535,T=Math.floor(s/65536),Te=s-T*65536,s=xe+T+65535,T=Math.floor(s/65536),xe=s-T*65536,s=Se+T+65535,T=Math.floor(s/65536),Se=s-T*65536,P+=T-1+37*(T-1),z[0]=P,z[1]=F,z[2]=Y,z[3]=_,z[4]=ee,z[5]=oe,z[6]=ue,z[7]=j,z[8]=se,z[9]=le,z[10]=ye,z[11]=de,z[12]=Ee,z[13]=Te,z[14]=xe,z[15]=Se}},96560:re=>{re.exports={options:{usePureJavaScript:!1}}},6252:(re,ce,V)=>{var a=V(96560);V(31502),V(64687);var e=re.exports=a.hmac=a.hmac||{};e.create=function(){var i=null,C=null,E=null,S=null,c={};return c.start=function(l,r){if(l!==null)if(typeof l=="string")if(l=l.toLowerCase(),l in a.md.algorithms)C=a.md.algorithms[l].create();else throw new Error('Unknown hash algorithm "'+l+'"');else C=l;if(r===null)r=i;else{if(typeof r=="string")r=a.util.createBuffer(r);else if(a.util.isArray(r)){var u=r;r=a.util.createBuffer();for(var x=0;x<u.length;++x)r.putByte(u[x])}var U=r.length();U>C.blockLength&&(C.start(),C.update(r.bytes()),r=C.digest()),E=a.util.createBuffer(),S=a.util.createBuffer(),U=r.length();for(var x=0;x<U;++x){var u=r.at(x);E.putByte(54^u),S.putByte(92^u)}if(U<C.blockLength)for(var u=C.blockLength-U,x=0;x<u;++x)E.putByte(54),S.putByte(92);i=r,E=E.bytes(),S=S.bytes()}C.start(),C.update(E)},c.update=function(l){C.update(l)},c.getMac=function(){var l=C.digest().bytes();return C.start(),C.update(S),C.update(l),C.digest()},c.digest=c.getMac,c}},31631:(re,ce,V)=>{re.exports=V(96560),V(57220),V(36186),V(19462),V(77464),V(37187),V(3994),V(6252),V(78820),V(86769),V(43671),V(9678),V(7866),V(38813),V(4745),V(28947),V(53379),V(46803),V(43704),V(35002),V(42242),V(2608),V(35568),V(48769),V(91550),V(64687)},35156:(re,ce,V)=>{var a=V(96560);re.exports=a.jsbn=a.jsbn||{};var e,i=0xdeadbeefcafe,C=(i&16777215)==15715070;function E(B,b,D){this.data=[],B!=null&&(typeof B=="number"?this.fromNumber(B,b,D):b==null&&typeof B!="string"?this.fromString(B,256):this.fromString(B,b))}a.jsbn.BigInteger=E;function S(){return new E(null)}function c(B,b,D,H,Z,$){for(;--$>=0;){var ne=b*this.data[B++]+D.data[H]+Z;Z=Math.floor(ne/67108864),D.data[H++]=ne&67108863}return Z}function l(B,b,D,H,Z,$){for(var ne=b&32767,ae=b>>15;--$>=0;){var Ce=this.data[B]&32767,He=this.data[B++]>>15,je=ae*Ce+He*ne;Ce=ne*Ce+((je&32767)<<15)+D.data[H]+(Z&1073741823),Z=(Ce>>>30)+(je>>>15)+ae*He+(Z>>>30),D.data[H++]=Ce&1073741823}return Z}function r(B,b,D,H,Z,$){for(var ne=b&16383,ae=b>>14;--$>=0;){var Ce=this.data[B]&16383,He=this.data[B++]>>14,je=ae*Ce+He*ne;Ce=ne*Ce+((je&16383)<<14)+D.data[H]+Z,Z=(Ce>>28)+(je>>14)+ae*He,D.data[H++]=Ce&268435455}return Z}typeof navigator>"u"?(E.prototype.am=r,e=28):C&&navigator.appName=="Microsoft Internet Explorer"?(E.prototype.am=l,e=30):C&&navigator.appName!="Netscape"?(E.prototype.am=c,e=26):(E.prototype.am=r,e=28),E.prototype.DB=e,E.prototype.DM=(1<<e)-1,E.prototype.DV=1<<e;var u=52;E.prototype.FV=Math.pow(2,u),E.prototype.F1=u-e,E.prototype.F2=2*e-u;var x="0123456789abcdefghijklmnopqrstuvwxyz",U=new Array,m,y;for(m=48,y=0;y<=9;++y)U[m++]=y;for(m=97,y=10;y<36;++y)U[m++]=y;for(m=65,y=10;y<36;++y)U[m++]=y;function I(B){return x.charAt(B)}function d(B,b){var D=U[B.charCodeAt(b)];return D??-1}function v(B){for(var b=this.t-1;b>=0;--b)B.data[b]=this.data[b];B.t=this.t,B.s=this.s}function n(B){this.t=1,this.s=B<0?-1:0,B>0?this.data[0]=B:B<-1?this.data[0]=B+this.DV:this.t=0}function f(B){var b=S();return b.fromInt(B),b}function p(B,b){var D;if(b==16)D=4;else if(b==8)D=3;else if(b==256)D=8;else if(b==2)D=1;else if(b==32)D=5;else if(b==4)D=2;else{this.fromRadix(B,b);return}this.t=0,this.s=0;for(var H=B.length,Z=!1,$=0;--H>=0;){var ne=D==8?B[H]&255:d(B,H);if(ne<0){B.charAt(H)=="-"&&(Z=!0);continue}Z=!1,$==0?this.data[this.t++]=ne:$+D>this.DB?(this.data[this.t-1]|=(ne&(1<<this.DB-$)-1)<<$,this.data[this.t++]=ne>>this.DB-$):this.data[this.t-1]|=ne<<$,$+=D,$>=this.DB&&($-=this.DB)}D==8&&B[0]&128&&(this.s=-1,$>0&&(this.data[this.t-1]|=(1<<this.DB-$)-1<<$)),this.clamp(),Z&&E.ZERO.subTo(this,this)}function A(){for(var B=this.s&this.DM;this.t>0&&this.data[this.t-1]==B;)--this.t}function R(B){if(this.s<0)return"-"+this.negate().toString(B);var b;if(B==16)b=4;else if(B==8)b=3;else if(B==2)b=1;else if(B==32)b=5;else if(B==4)b=2;else return this.toRadix(B);var D=(1<<b)-1,H,Z=!1,$="",ne=this.t,ae=this.DB-ne*this.DB%b;if(ne-- >0)for(ae<this.DB&&(H=this.data[ne]>>ae)>0&&(Z=!0,$=I(H));ne>=0;)ae<b?(H=(this.data[ne]&(1<<ae)-1)<<b-ae,H|=this.data[--ne]>>(ae+=this.DB-b)):(H=this.data[ne]>>(ae-=b)&D,ae<=0&&(ae+=this.DB,--ne)),H>0&&(Z=!0),Z&&($+=I(H));return Z?$:"0"}function k(){var B=S();return E.ZERO.subTo(this,B),B}function h(){return this.s<0?this.negate():this}function g(B){var b=this.s-B.s;if(b!=0)return b;var D=this.t;if(b=D-B.t,b!=0)return this.s<0?-b:b;for(;--D>=0;)if((b=this.data[D]-B.data[D])!=0)return b;return 0}function N(B){var b=1,D;return(D=B>>>16)!=0&&(B=D,b+=16),(D=B>>8)!=0&&(B=D,b+=8),(D=B>>4)!=0&&(B=D,b+=4),(D=B>>2)!=0&&(B=D,b+=2),(D=B>>1)!=0&&(B=D,b+=1),b}function t(){return this.t<=0?0:this.DB*(this.t-1)+N(this.data[this.t-1]^this.s&this.DM)}function L(B,b){var D;for(D=this.t-1;D>=0;--D)b.data[D+B]=this.data[D];for(D=B-1;D>=0;--D)b.data[D]=0;b.t=this.t+B,b.s=this.s}function O(B,b){for(var D=B;D<this.t;++D)b.data[D-B]=this.data[D];b.t=Math.max(this.t-B,0),b.s=this.s}function w(B,b){var D=B%this.DB,H=this.DB-D,Z=(1<<H)-1,$=Math.floor(B/this.DB),ne=this.s<<D&this.DM,ae;for(ae=this.t-1;ae>=0;--ae)b.data[ae+$+1]=this.data[ae]>>H|ne,ne=(this.data[ae]&Z)<<D;for(ae=$-1;ae>=0;--ae)b.data[ae]=0;b.data[$]=ne,b.t=this.t+$+1,b.s=this.s,b.clamp()}function M(B,b){b.s=this.s;var D=Math.floor(B/this.DB);if(D>=this.t){b.t=0;return}var H=B%this.DB,Z=this.DB-H,$=(1<<H)-1;b.data[0]=this.data[D]>>H;for(var ne=D+1;ne<this.t;++ne)b.data[ne-D-1]|=(this.data[ne]&$)<<Z,b.data[ne-D]=this.data[ne]>>H;H>0&&(b.data[this.t-D-1]|=(this.s&$)<<Z),b.t=this.t-D,b.clamp()}function K(B,b){for(var D=0,H=0,Z=Math.min(B.t,this.t);D<Z;)H+=this.data[D]-B.data[D],b.data[D++]=H&this.DM,H>>=this.DB;if(B.t<this.t){for(H-=B.s;D<this.t;)H+=this.data[D],b.data[D++]=H&this.DM,H>>=this.DB;H+=this.s}else{for(H+=this.s;D<B.t;)H-=B.data[D],b.data[D++]=H&this.DM,H>>=this.DB;H-=B.s}b.s=H<0?-1:0,H<-1?b.data[D++]=this.DV+H:H>0&&(b.data[D++]=H),b.t=D,b.clamp()}function G(B,b){var D=this.abs(),H=B.abs(),Z=D.t;for(b.t=Z+H.t;--Z>=0;)b.data[Z]=0;for(Z=0;Z<H.t;++Z)b.data[Z+D.t]=D.am(0,H.data[Z],b,Z,0,D.t);b.s=0,b.clamp(),this.s!=B.s&&E.ZERO.subTo(b,b)}function X(B){for(var b=this.abs(),D=B.t=2*b.t;--D>=0;)B.data[D]=0;for(D=0;D<b.t-1;++D){var H=b.am(D,b.data[D],B,2*D,0,1);(B.data[D+b.t]+=b.am(D+1,2*b.data[D],B,2*D+1,H,b.t-D-1))>=b.DV&&(B.data[D+b.t]-=b.DV,B.data[D+b.t+1]=1)}B.t>0&&(B.data[B.t-1]+=b.am(D,b.data[D],B,2*D,0,1)),B.s=0,B.clamp()}function W(B,b,D){var H=B.abs();if(!(H.t<=0)){var Z=this.abs();if(Z.t<H.t){b?.fromInt(0),D!=null&&this.copyTo(D);return}D==null&&(D=S());var $=S(),ne=this.s,ae=B.s,Ce=this.DB-N(H.data[H.t-1]);Ce>0?(H.lShiftTo(Ce,$),Z.lShiftTo(Ce,D)):(H.copyTo($),Z.copyTo(D));var He=$.t,je=$.data[He-1];if(je!=0){var We=je*(1<<this.F1)+(He>1?$.data[He-2]>>this.F2:0),rt=this.FV/We,lt=(1<<this.F1)/We,Je=1<<this.F2,$e=D.t,ct=$e-He,nt=b??S();for($.dlShiftTo(ct,nt),D.compareTo(nt)>=0&&(D.data[D.t++]=1,D.subTo(nt,D)),E.ONE.dlShiftTo(He,nt),nt.subTo($,$);$.t<He;)$.data[$.t++]=0;for(;--ct>=0;){var ht=D.data[--$e]==je?this.DM:Math.floor(D.data[$e]*rt+(D.data[$e-1]+Je)*lt);if((D.data[$e]+=$.am(0,ht,D,ct,0,He))<ht)for($.dlShiftTo(ct,nt),D.subTo(nt,D);D.data[$e]<--ht;)D.subTo(nt,D)}b!=null&&(D.drShiftTo(He,b),ne!=ae&&E.ZERO.subTo(b,b)),D.t=He,D.clamp(),Ce>0&&D.rShiftTo(Ce,D),ne<0&&E.ZERO.subTo(D,D)}}}function q(B){var b=S();return this.abs().divRemTo(B,null,b),this.s<0&&b.compareTo(E.ZERO)>0&&B.subTo(b,b),b}function te(B){this.m=B}function fe(B){return B.s<0||B.compareTo(this.m)>=0?B.mod(this.m):B}function he(B){return B}function pe(B){B.divRemTo(this.m,null,B)}function J(B,b,D){B.multiplyTo(b,D),this.reduce(D)}function me(B,b){B.squareTo(b),this.reduce(b)}te.prototype.convert=fe,te.prototype.revert=he,te.prototype.reduce=pe,te.prototype.mulTo=J,te.prototype.sqrTo=me;function ie(){if(this.t<1)return 0;var B=this.data[0];if(!(B&1))return 0;var b=B&3;return b=b*(2-(B&15)*b)&15,b=b*(2-(B&255)*b)&255,b=b*(2-((B&65535)*b&65535))&65535,b=b*(2-B*b%this.DV)%this.DV,b>0?this.DV-b:-b}function ge(B){this.m=B,this.mp=B.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<B.DB-15)-1,this.mt2=2*B.t}function ve(B){var b=S();return B.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),B.s<0&&b.compareTo(E.ZERO)>0&&this.m.subTo(b,b),b}function z(B){var b=S();return B.copyTo(b),this.reduce(b),b}function Q(B){for(;B.t<=this.mt2;)B.data[B.t++]=0;for(var b=0;b<this.m.t;++b){var D=B.data[b]&32767,H=D*this.mpl+((D*this.mph+(B.data[b]>>15)*this.mpl&this.um)<<15)&B.DM;for(D=b+this.m.t,B.data[D]+=this.m.am(0,H,B,b,0,this.m.t);B.data[D]>=B.DV;)B.data[D]-=B.DV,B.data[++D]++}B.clamp(),B.drShiftTo(this.m.t,B),B.compareTo(this.m)>=0&&B.subTo(this.m,B)}function o(B,b){B.squareTo(b),this.reduce(b)}function s(B,b,D){B.multiplyTo(b,D),this.reduce(D)}ge.prototype.convert=ve,ge.prototype.revert=z,ge.prototype.reduce=Q,ge.prototype.mulTo=s,ge.prototype.sqrTo=o;function T(){return(this.t>0?this.data[0]&1:this.s)==0}function P(B,b){if(B>4294967295||B<1)return E.ONE;var D=S(),H=S(),Z=b.convert(this),$=N(B)-1;for(Z.copyTo(D);--$>=0;)if(b.sqrTo(D,H),(B&1<<$)>0)b.mulTo(H,Z,D);else{var ne=D;D=H,H=ne}return b.revert(D)}function F(B,b){var D;return B<256||b.isEven()?D=new te(b):D=new ge(b),this.exp(B,D)}E.prototype.copyTo=v,E.prototype.fromInt=n,E.prototype.fromString=p,E.prototype.clamp=A,E.prototype.dlShiftTo=L,E.prototype.drShiftTo=O,E.prototype.lShiftTo=w,E.prototype.rShiftTo=M,E.prototype.subTo=K,E.prototype.multiplyTo=G,E.prototype.squareTo=X,E.prototype.divRemTo=W,E.prototype.invDigit=ie,E.prototype.isEven=T,E.prototype.exp=P,E.prototype.toString=R,E.prototype.negate=k,E.prototype.abs=h,E.prototype.compareTo=g,E.prototype.bitLength=t,E.prototype.mod=q,E.prototype.modPowInt=F,E.ZERO=f(0),E.ONE=f(1);function Y(){var B=S();return this.copyTo(B),B}function _(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function ee(){return this.t==0?this.s:this.data[0]<<24>>24}function oe(){return this.t==0?this.s:this.data[0]<<16>>16}function ue(B){return Math.floor(Math.LN2*this.DB/Math.log(B))}function j(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function se(B){if(B==null&&(B=10),this.signum()==0||B<2||B>36)return"0";var b=this.chunkSize(B),D=Math.pow(B,b),H=f(D),Z=S(),$=S(),ne="";for(this.divRemTo(H,Z,$);Z.signum()>0;)ne=(D+$.intValue()).toString(B).substr(1)+ne,Z.divRemTo(H,Z,$);return $.intValue().toString(B)+ne}function le(B,b){this.fromInt(0),b==null&&(b=10);for(var D=this.chunkSize(b),H=Math.pow(b,D),Z=!1,$=0,ne=0,ae=0;ae<B.length;++ae){var Ce=d(B,ae);if(Ce<0){B.charAt(ae)=="-"&&this.signum()==0&&(Z=!0);continue}ne=b*ne+Ce,++$>=D&&(this.dMultiply(H),this.dAddOffset(ne,0),$=0,ne=0)}$>0&&(this.dMultiply(Math.pow(b,$)),this.dAddOffset(ne,0)),Z&&E.ZERO.subTo(this,this)}function ye(B,b,D){if(typeof b=="number")if(B<2)this.fromInt(1);else for(this.fromNumber(B,D),this.testBit(B-1)||this.bitwiseTo(E.ONE.shiftLeft(B-1),be,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>B&&this.subTo(E.ONE.shiftLeft(B-1),this);else{var H=new Array,Z=B&7;H.length=(B>>3)+1,b.nextBytes(H),Z>0?H[0]&=(1<<Z)-1:H[0]=0,this.fromString(H,256)}}function de(){var B=this.t,b=new Array;b[0]=this.s;var D=this.DB-B*this.DB%8,H,Z=0;if(B-- >0)for(D<this.DB&&(H=this.data[B]>>D)!=(this.s&this.DM)>>D&&(b[Z++]=H|this.s<<this.DB-D);B>=0;)D<8?(H=(this.data[B]&(1<<D)-1)<<8-D,H|=this.data[--B]>>(D+=this.DB-8)):(H=this.data[B]>>(D-=8)&255,D<=0&&(D+=this.DB,--B)),H&128&&(H|=-256),Z==0&&(this.s&128)!=(H&128)&&++Z,(Z>0||H!=this.s)&&(b[Z++]=H);return b}function Ee(B){return this.compareTo(B)==0}function Te(B){return this.compareTo(B)<0?this:B}function xe(B){return this.compareTo(B)>0?this:B}function Se(B,b,D){var H,Z,$=Math.min(B.t,this.t);for(H=0;H<$;++H)D.data[H]=b(this.data[H],B.data[H]);if(B.t<this.t){for(Z=B.s&this.DM,H=$;H<this.t;++H)D.data[H]=b(this.data[H],Z);D.t=this.t}else{for(Z=this.s&this.DM,H=$;H<B.t;++H)D.data[H]=b(Z,B.data[H]);D.t=B.t}D.s=b(this.s,B.s),D.clamp()}function Be(B,b){return B&b}function Ge(B){var b=S();return this.bitwiseTo(B,Be,b),b}function be(B,b){return B|b}function Qe(B){var b=S();return this.bitwiseTo(B,be,b),b}function ze(B,b){return B^b}function Ye(B){var b=S();return this.bitwiseTo(B,ze,b),b}function Xe(B,b){return B&~b}function qe(B){var b=S();return this.bitwiseTo(B,Xe,b),b}function et(){for(var B=S(),b=0;b<this.t;++b)B.data[b]=this.DM&~this.data[b];return B.t=this.t,B.s=~this.s,B}function tt(B){var b=S();return B<0?this.rShiftTo(-B,b):this.lShiftTo(B,b),b}function at(B){var b=S();return B<0?this.lShiftTo(-B,b):this.rShiftTo(B,b),b}function it(B){if(B==0)return-1;var b=0;return B&65535||(B>>=16,b+=16),B&255||(B>>=8,b+=8),B&15||(B>>=4,b+=4),B&3||(B>>=2,b+=2),B&1||++b,b}function st(){for(var B=0;B<this.t;++B)if(this.data[B]!=0)return B*this.DB+it(this.data[B]);return this.s<0?this.t*this.DB:-1}function ut(B){for(var b=0;B!=0;)B&=B-1,++b;return b}function ft(){for(var B=0,b=this.s&this.DM,D=0;D<this.t;++D)B+=ut(this.data[D]^b);return B}function Ne(B){var b=Math.floor(B/this.DB);return b>=this.t?this.s!=0:(this.data[b]&1<<B%this.DB)!=0}function Re(B,b){var D=E.ONE.shiftLeft(B);return this.bitwiseTo(D,b,D),D}function Le(B){return this.changeBit(B,be)}function we(B){return this.changeBit(B,Xe)}function De(B){return this.changeBit(B,ze)}function Ue(B,b){for(var D=0,H=0,Z=Math.min(B.t,this.t);D<Z;)H+=this.data[D]+B.data[D],b.data[D++]=H&this.DM,H>>=this.DB;if(B.t<this.t){for(H+=B.s;D<this.t;)H+=this.data[D],b.data[D++]=H&this.DM,H>>=this.DB;H+=this.s}else{for(H+=this.s;D<B.t;)H+=B.data[D],b.data[D++]=H&this.DM,H>>=this.DB;H+=B.s}b.s=H<0?-1:0,H>0?b.data[D++]=H:H<-1&&(b.data[D++]=this.DV+H),b.t=D,b.clamp()}function ke(B){var b=S();return this.addTo(B,b),b}function Pe(B){var b=S();return this.subTo(B,b),b}function Ve(B){var b=S();return this.multiplyTo(B,b),b}function Oe(B){var b=S();return this.divRemTo(B,b,null),b}function _e(B){var b=S();return this.divRemTo(B,null,b),b}function Fe(B){var b=S(),D=S();return this.divRemTo(B,b,D),new Array(b,D)}function Ke(B){this.data[this.t]=this.am(0,B-1,this,0,0,this.t),++this.t,this.clamp()}function Me(B,b){if(B!=0){for(;this.t<=b;)this.data[this.t++]=0;for(this.data[b]+=B;this.data[b]>=this.DV;)this.data[b]-=this.DV,++b>=this.t&&(this.data[this.t++]=0),++this.data[b]}}function Ie(){}function Ae(B){return B}function dt(B,b,D){B.multiplyTo(b,D)}function pt(B,b){B.squareTo(b)}Ie.prototype.convert=Ae,Ie.prototype.revert=Ae,Ie.prototype.mulTo=dt,Ie.prototype.sqrTo=pt;function vt(B){return this.exp(B,new Ie)}function yt(B,b,D){var H=Math.min(this.t+B.t,b);for(D.s=0,D.t=H;H>0;)D.data[--H]=0;var Z;for(Z=D.t-this.t;H<Z;++H)D.data[H+this.t]=this.am(0,B.data[H],D,H,0,this.t);for(Z=Math.min(B.t,b);H<Z;++H)this.am(0,B.data[H],D,H,0,b-H);D.clamp()}function gt(B,b,D){--b;var H=D.t=this.t+B.t-b;for(D.s=0;--H>=0;)D.data[H]=0;for(H=Math.max(b-this.t,0);H<B.t;++H)D.data[this.t+H-b]=this.am(b-H,B.data[H],D,0,0,this.t+H-b);D.clamp(),D.drShiftTo(1,D)}function ot(B){this.r2=S(),this.q3=S(),E.ONE.dlShiftTo(2*B.t,this.r2),this.mu=this.r2.divide(B),this.m=B}function mt(B){if(B.s<0||B.t>2*this.m.t)return B.mod(this.m);if(B.compareTo(this.m)<0)return B;var b=S();return B.copyTo(b),this.reduce(b),b}function Ct(B){return B}function Et(B){for(B.drShiftTo(this.m.t-1,this.r2),B.t>this.m.t+1&&(B.t=this.m.t+1,B.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);B.compareTo(this.r2)<0;)B.dAddOffset(1,this.m.t+1);for(B.subTo(this.r2,B);B.compareTo(this.m)>=0;)B.subTo(this.m,B)}function xt(B,b){B.squareTo(b),this.reduce(b)}function St(B,b,D){B.multiplyTo(b,D),this.reduce(D)}ot.prototype.convert=mt,ot.prototype.revert=Ct,ot.prototype.reduce=Et,ot.prototype.mulTo=St,ot.prototype.sqrTo=xt;function Tt(B,b){var D=B.bitLength(),H,Z=f(1),$;if(D<=0)return Z;D<18?H=1:D<48?H=3:D<144?H=4:D<768?H=5:H=6,D<8?$=new te(b):b.isEven()?$=new ot(b):$=new ge(b);var ne=new Array,ae=3,Ce=H-1,He=(1<<H)-1;if(ne[1]=$.convert(this),H>1){var je=S();for($.sqrTo(ne[1],je);ae<=He;)ne[ae]=S(),$.mulTo(je,ne[ae-2],ne[ae]),ae+=2}var We=B.t-1,rt,lt=!0,Je=S(),$e;for(D=N(B.data[We])-1;We>=0;){for(D>=Ce?rt=B.data[We]>>D-Ce&He:(rt=(B.data[We]&(1<<D+1)-1)<<Ce-D,We>0&&(rt|=B.data[We-1]>>this.DB+D-Ce)),ae=H;!(rt&1);)rt>>=1,--ae;if((D-=ae)<0&&(D+=this.DB,--We),lt)ne[rt].copyTo(Z),lt=!1;else{for(;ae>1;)$.sqrTo(Z,Je),$.sqrTo(Je,Z),ae-=2;ae>0?$.sqrTo(Z,Je):($e=Z,Z=Je,Je=$e),$.mulTo(Je,ne[rt],Z)}for(;We>=0&&!(B.data[We]&1<<D);)$.sqrTo(Z,Je),$e=Z,Z=Je,Je=$e,--D<0&&(D=this.DB-1,--We)}return $.revert(Z)}function It(B){var b=this.s<0?this.negate():this.clone(),D=B.s<0?B.negate():B.clone();if(b.compareTo(D)<0){var H=b;b=D,D=H}var Z=b.getLowestSetBit(),$=D.getLowestSetBit();if($<0)return b;for(Z<$&&($=Z),$>0&&(b.rShiftTo($,b),D.rShiftTo($,D));b.signum()>0;)(Z=b.getLowestSetBit())>0&&b.rShiftTo(Z,b),(Z=D.getLowestSetBit())>0&&D.rShiftTo(Z,D),b.compareTo(D)>=0?(b.subTo(D,b),b.rShiftTo(1,b)):(D.subTo(b,D),D.rShiftTo(1,D));return $>0&&D.lShiftTo($,D),D}function At(B){if(B<=0)return 0;var b=this.DV%B,D=this.s<0?B-1:0;if(this.t>0)if(b==0)D=this.data[0]%B;else for(var H=this.t-1;H>=0;--H)D=(b*D+this.data[H])%B;return D}function Bt(B){var b=B.isEven();if(this.isEven()&&b||B.signum()==0)return E.ZERO;for(var D=B.clone(),H=this.clone(),Z=f(1),$=f(0),ne=f(0),ae=f(1);D.signum()!=0;){for(;D.isEven();)D.rShiftTo(1,D),b?((!Z.isEven()||!$.isEven())&&(Z.addTo(this,Z),$.subTo(B,$)),Z.rShiftTo(1,Z)):$.isEven()||$.subTo(B,$),$.rShiftTo(1,$);for(;H.isEven();)H.rShiftTo(1,H),b?((!ne.isEven()||!ae.isEven())&&(ne.addTo(this,ne),ae.subTo(B,ae)),ne.rShiftTo(1,ne)):ae.isEven()||ae.subTo(B,ae),ae.rShiftTo(1,ae);D.compareTo(H)>=0?(D.subTo(H,D),b&&Z.subTo(ne,Z),$.subTo(ae,$)):(H.subTo(D,H),b&&ne.subTo(Z,ne),ae.subTo($,ae))}if(H.compareTo(E.ONE)!=0)return E.ZERO;if(ae.compareTo(B)>=0)return ae.subtract(B);if(ae.signum()<0)ae.addTo(B,ae);else return ae;return ae.signum()<0?ae.add(B):ae}var Ze=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],bt=(1<<26)/Ze[Ze.length-1];function Nt(B){var b,D=this.abs();if(D.t==1&&D.data[0]<=Ze[Ze.length-1]){for(b=0;b<Ze.length;++b)if(D.data[0]==Ze[b])return!0;return!1}if(D.isEven())return!1;for(b=1;b<Ze.length;){for(var H=Ze[b],Z=b+1;Z<Ze.length&&H<bt;)H*=Ze[Z++];for(H=D.modInt(H);b<Z;)if(H%Ze[b++]==0)return!1}return D.millerRabin(B)}function Rt(B){var b=this.subtract(E.ONE),D=b.getLowestSetBit();if(D<=0)return!1;for(var H=b.shiftRight(D),Z=Lt(),$,ne=0;ne<B;++ne){do $=new E(this.bitLength(),Z);while($.compareTo(E.ONE)<=0||$.compareTo(b)>=0);var ae=$.modPow(H,this);if(ae.compareTo(E.ONE)!=0&&ae.compareTo(b)!=0){for(var Ce=1;Ce++<D&&ae.compareTo(b)!=0;)if(ae=ae.modPowInt(2,this),ae.compareTo(E.ONE)==0)return!1;if(ae.compareTo(b)!=0)return!1}}return!0}function Lt(){return{nextBytes:function(B){for(var b=0;b<B.length;++b)B[b]=Math.floor(Math.random()*256)}}}E.prototype.chunkSize=ue,E.prototype.toRadix=se,E.prototype.fromRadix=le,E.prototype.fromNumber=ye,E.prototype.bitwiseTo=Se,E.prototype.changeBit=Re,E.prototype.addTo=Ue,E.prototype.dMultiply=Ke,E.prototype.dAddOffset=Me,E.prototype.multiplyLowerTo=yt,E.prototype.multiplyUpperTo=gt,E.prototype.modInt=At,E.prototype.millerRabin=Rt,E.prototype.clone=Y,E.prototype.intValue=_,E.prototype.byteValue=ee,E.prototype.shortValue=oe,E.prototype.signum=j,E.prototype.toByteArray=de,E.prototype.equals=Ee,E.prototype.min=Te,E.prototype.max=xe,E.prototype.and=Ge,E.prototype.or=Qe,E.prototype.xor=Ye,E.prototype.andNot=qe,E.prototype.not=et,E.prototype.shiftLeft=tt,E.prototype.shiftRight=at,E.prototype.getLowestSetBit=st,E.prototype.bitCount=ft,E.prototype.testBit=Ne,E.prototype.setBit=Le,E.prototype.clearBit=we,E.prototype.flipBit=De,E.prototype.add=ke,E.prototype.subtract=Pe,E.prototype.multiply=Ve,E.prototype.divide=Oe,E.prototype.remainder=_e,E.prototype.divideAndRemainder=Fe,E.prototype.modPow=Tt,E.prototype.modInverse=Bt,E.prototype.pow=vt,E.prototype.gcd=It,E.prototype.isProbablePrime=Nt},78820:(re,ce,V)=>{var a=V(96560);V(64687),V(2608),V(35156),re.exports=a.kem=a.kem||{};var e=a.jsbn.BigInteger;a.kem.rsa={},a.kem.rsa.create=function(C,E){E=E||{};var S=E.prng||a.random,c={};return c.encrypt=function(l,r){var u=Math.ceil(l.n.bitLength()/8),x;do x=new e(a.util.bytesToHex(S.getBytesSync(u)),16).mod(l.n);while(x.compareTo(e.ONE)<=0);x=a.util.hexToBytes(x.toString(16));var U=u-x.length;U>0&&(x=a.util.fillString("\0",U)+x);var m=l.encrypt(x,"NONE"),y=C.generate(x,r);return{encapsulation:m,key:y}},c.decrypt=function(l,r,u){var x=l.decrypt(r,"NONE");return C.generate(x,u)},c},a.kem.kdf1=function(C,E){i(this,C,0,E||C.digestLength)},a.kem.kdf2=function(C,E){i(this,C,1,E||C.digestLength)};function i(C,E,S,c){C.generate=function(l,r){for(var u=new a.util.ByteBuffer,x=Math.ceil(r/c)+S,U=new a.util.ByteBuffer,m=S;m<x;++m){U.putInt32(m),E.start(),E.update(l+U.getBytes());var y=E.digest();u.putBytes(y.getBytes(c))}return u.truncate(u.length()-r),u.getBytes()}}},86769:(re,ce,V)=>{var a=V(96560);V(64687),re.exports=a.log=a.log||{},a.log.levels=["none","error","warning","info","debug","verbose","max"];var e={},i=[],C=null;a.log.LEVEL_LOCKED=2,a.log.NO_LEVEL_CHECK=4,a.log.INTERPOLATE=8;for(var E=0;E<a.log.levels.length;++E){var S=a.log.levels[E];e[S]={index:E,name:S.toUpperCase()}}a.log.logMessage=function(m){for(var y=e[m.level].index,I=0;I<i.length;++I){var d=i[I];if(d.flags&a.log.NO_LEVEL_CHECK)d.f(m);else{var v=e[d.level].index;y<=v&&d.f(d,m)}}},a.log.prepareStandard=function(m){"standard"in m||(m.standard=e[m.level].name+" ["+m.category+"] "+m.message)},a.log.prepareFull=function(m){if(!("full"in m)){var y=[m.message];y=y.concat([]),m.full=a.util.format.apply(this,y)}},a.log.prepareStandardFull=function(m){"standardFull"in m||(a.log.prepareStandard(m),m.standardFull=m.standard)};for(var c=["error","warning","info","debug","verbose"],E=0;E<c.length;++E)(function(y){a.log[y]=function(I,d){var v=Array.prototype.slice.call(arguments).slice(2),n={timestamp:new Date,level:y,category:I,message:d,arguments:v};a.log.logMessage(n)}})(c[E]);if(a.log.makeLogger=function(m){var y={flags:0,f:m};return a.log.setLevel(y,"none"),y},a.log.setLevel=function(m,y){var I=!1;if(m&&!(m.flags&a.log.LEVEL_LOCKED))for(var d=0;d<a.log.levels.length;++d){var v=a.log.levels[d];if(y==v){m.level=y,I=!0;break}}return I},a.log.lock=function(m,y){typeof y>"u"||y?m.flags|=a.log.LEVEL_LOCKED:m.flags&=~a.log.LEVEL_LOCKED},a.log.addLogger=function(m){i.push(m)},typeof console<"u"&&"log"in console){var l;if(console.error&&console.warn&&console.info&&console.debug){var r={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},u=function(m,y){a.log.prepareStandard(y);var I=r[y.level],d=[y.standard];d=d.concat(y.arguments.slice()),I.apply(console,d)};l=a.log.makeLogger(u)}else{var u=function(y,I){a.log.prepareStandardFull(I),console.log(I.standardFull)};l=a.log.makeLogger(u)}a.log.setLevel(l,"debug"),a.log.addLogger(l),C=l}else console={log:function(){}};if(C!==null&&typeof window<"u"&&window.location){var x=new URL(window.location.href).searchParams;if(x.has("console.level")&&a.log.setLevel(C,x.get("console.level").slice(-1)[0]),x.has("console.lock")){var U=x.get("console.lock").slice(-1)[0];U=="true"&&a.log.lock(C)}}a.log.consoleLogger=C},43671:(re,ce,V)=>{re.exports=V(31502),V(98311),V(34341),V(25984),V(6677)},31502:(re,ce,V)=>{var a=V(96560);re.exports=a.md=a.md||{},a.md.algorithms=a.md.algorithms||{}},98311:(re,ce,V)=>{var a=V(96560);V(31502),V(64687);var e=re.exports=a.md5=a.md5||{};a.md.md5=a.md.algorithms.md5=e,e.create=function(){c||l();var u=null,x=a.util.createBuffer(),U=new Array(16),m={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return m.start=function(){m.messageLength=0,m.fullMessageLength=m.messageLength64=[];for(var y=m.messageLengthSize/4,I=0;I<y;++I)m.fullMessageLength.push(0);return x=a.util.createBuffer(),u={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},m},m.start(),m.update=function(y,I){I==="utf8"&&(y=a.util.encodeUtf8(y));var d=y.length;m.messageLength+=d,d=[d/4294967296>>>0,d>>>0];for(var v=m.fullMessageLength.length-1;v>=0;--v)m.fullMessageLength[v]+=d[1],d[1]=d[0]+(m.fullMessageLength[v]/4294967296>>>0),m.fullMessageLength[v]=m.fullMessageLength[v]>>>0,d[0]=d[1]/4294967296>>>0;return x.putBytes(y),r(u,U,x),(x.read>2048||x.length()===0)&&x.compact(),m},m.digest=function(){var y=a.util.createBuffer();y.putBytes(x.bytes());var I=m.fullMessageLength[m.fullMessageLength.length-1]+m.messageLengthSize,d=I&m.blockLength-1;y.putBytes(i.substr(0,m.blockLength-d));for(var v,n=0,f=m.fullMessageLength.length-1;f>=0;--f)v=m.fullMessageLength[f]*8+n,n=v/4294967296>>>0,y.putInt32Le(v>>>0);var p={h0:u.h0,h1:u.h1,h2:u.h2,h3:u.h3};r(p,U,y);var A=a.util.createBuffer();return A.putInt32Le(p.h0),A.putInt32Le(p.h1),A.putInt32Le(p.h2),A.putInt32Le(p.h3),A},m};var i=null,C=null,E=null,S=null,c=!1;function l(){i="\x80",i+=a.util.fillString("\0",64),C=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],E=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],S=new Array(64);for(var u=0;u<64;++u)S[u]=Math.floor(Math.abs(Math.sin(u+1))*4294967296);c=!0}function r(u,x,U){for(var m,y,I,d,v,n,f,p,A=U.length();A>=64;){for(y=u.h0,I=u.h1,d=u.h2,v=u.h3,p=0;p<16;++p)x[p]=U.getInt32Le(),n=v^I&(d^v),m=y+n+S[p]+x[p],f=E[p],y=v,v=d,d=I,I+=m<<f|m>>>32-f;for(;p<32;++p)n=d^v&(I^d),m=y+n+S[p]+x[C[p]],f=E[p],y=v,v=d,d=I,I+=m<<f|m>>>32-f;for(;p<48;++p)n=I^d^v,m=y+n+S[p]+x[C[p]],f=E[p],y=v,v=d,d=I,I+=m<<f|m>>>32-f;for(;p<64;++p)n=d^(I|~v),m=y+n+S[p]+x[C[p]],f=E[p],y=v,v=d,d=I,I+=m<<f|m>>>32-f;u.h0=u.h0+y|0,u.h1=u.h1+I|0,u.h2=u.h2+d|0,u.h3=u.h3+v|0,A-=64}}},57361:(re,ce,V)=>{var a=V(96560);V(9678),re.exports=a.mgf=a.mgf||{},a.mgf.mgf1=a.mgf1},9678:(re,ce,V)=>{var a=V(96560);V(64687),a.mgf=a.mgf||{};var e=re.exports=a.mgf.mgf1=a.mgf1=a.mgf1||{};e.create=function(i){var C={generate:function(E,S){for(var c=new a.util.ByteBuffer,l=Math.ceil(S/i.digestLength),r=0;r<l;r++){var u=new a.util.ByteBuffer;u.putInt32(r),i.start(),i.update(E+u.getBytes()),c.putBuffer(i.digest())}return c.truncate(c.length()-S),c.getBytes()}};return C}},4646:(re,ce,V)=>{var a=V(96560);a.pki=a.pki||{};var e=re.exports=a.pki.oids=a.oids=a.oids||{};function i(E,S){e[E]=S,e[S]=E}function C(E,S){e[E]=S}i("1.2.840.113549.1.1.1","rsaEncryption"),i("1.2.840.113549.1.1.4","md5WithRSAEncryption"),i("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),i("1.2.840.113549.1.1.7","RSAES-OAEP"),i("1.2.840.113549.1.1.8","mgf1"),i("1.2.840.113549.1.1.9","pSpecified"),i("1.2.840.113549.1.1.10","RSASSA-PSS"),i("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),i("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),i("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),i("1.3.101.112","EdDSA25519"),i("1.2.840.10040.4.3","dsa-with-sha1"),i("1.3.14.3.2.7","desCBC"),i("1.3.14.3.2.26","sha1"),i("1.3.14.3.2.29","sha1WithRSASignature"),i("2.16.840.1.101.3.4.2.1","sha256"),i("2.16.840.1.101.3.4.2.2","sha384"),i("2.16.840.1.101.3.4.2.3","sha512"),i("2.16.840.1.101.3.4.2.4","sha224"),i("2.16.840.1.101.3.4.2.5","sha512-224"),i("2.16.840.1.101.3.4.2.6","sha512-256"),i("1.2.840.113549.2.2","md2"),i("1.2.840.113549.2.5","md5"),i("1.2.840.113549.1.7.1","data"),i("1.2.840.113549.1.7.2","signedData"),i("1.2.840.113549.1.7.3","envelopedData"),i("1.2.840.113549.1.7.4","signedAndEnvelopedData"),i("1.2.840.113549.1.7.5","digestedData"),i("1.2.840.113549.1.7.6","encryptedData"),i("1.2.840.113549.1.9.1","emailAddress"),i("1.2.840.113549.1.9.2","unstructuredName"),i("1.2.840.113549.1.9.3","contentType"),i("1.2.840.113549.1.9.4","messageDigest"),i("1.2.840.113549.1.9.5","signingTime"),i("1.2.840.113549.1.9.6","counterSignature"),i("1.2.840.113549.1.9.7","challengePassword"),i("1.2.840.113549.1.9.8","unstructuredAddress"),i("1.2.840.113549.1.9.14","extensionRequest"),i("1.2.840.113549.1.9.20","friendlyName"),i("1.2.840.113549.1.9.21","localKeyId"),i("1.2.840.113549.1.9.22.1","x509Certificate"),i("1.2.840.113549.1.12.10.1.1","keyBag"),i("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),i("1.2.840.113549.1.12.10.1.3","certBag"),i("1.2.840.113549.1.12.10.1.4","crlBag"),i("1.2.840.113549.1.12.10.1.5","secretBag"),i("1.2.840.113549.1.12.10.1.6","safeContentsBag"),i("1.2.840.113549.1.5.13","pkcs5PBES2"),i("1.2.840.113549.1.5.12","pkcs5PBKDF2"),i("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),i("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),i("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),i("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),i("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),i("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),i("1.2.840.113549.2.7","hmacWithSHA1"),i("1.2.840.113549.2.8","hmacWithSHA224"),i("1.2.840.113549.2.9","hmacWithSHA256"),i("1.2.840.113549.2.10","hmacWithSHA384"),i("1.2.840.113549.2.11","hmacWithSHA512"),i("1.2.840.113549.3.7","des-EDE3-CBC"),i("2.16.840.1.101.3.4.1.2","aes128-CBC"),i("2.16.840.1.101.3.4.1.22","aes192-CBC"),i("2.16.840.1.101.3.4.1.42","aes256-CBC"),i("2.5.4.3","commonName"),i("2.5.4.4","surname"),i("2.5.4.5","serialNumber"),i("2.5.4.6","countryName"),i("2.5.4.7","localityName"),i("2.5.4.8","stateOrProvinceName"),i("2.5.4.9","streetAddress"),i("2.5.4.10","organizationName"),i("2.5.4.11","organizationalUnitName"),i("2.5.4.12","title"),i("2.5.4.13","description"),i("2.5.4.15","businessCategory"),i("2.5.4.17","postalCode"),i("2.5.4.42","givenName"),i("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),i("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),i("2.16.840.1.113730.1.1","nsCertType"),i("2.16.840.1.113730.1.13","nsComment"),C("2.5.29.1","authorityKeyIdentifier"),C("2.5.29.2","keyAttributes"),C("2.5.29.3","certificatePolicies"),C("2.5.29.4","keyUsageRestriction"),C("2.5.29.5","policyMapping"),C("2.5.29.6","subtreesConstraint"),C("2.5.29.7","subjectAltName"),C("2.5.29.8","issuerAltName"),C("2.5.29.9","subjectDirectoryAttributes"),C("2.5.29.10","basicConstraints"),C("2.5.29.11","nameConstraints"),C("2.5.29.12","policyConstraints"),C("2.5.29.13","basicConstraints"),i("2.5.29.14","subjectKeyIdentifier"),i("2.5.29.15","keyUsage"),C("2.5.29.16","privateKeyUsagePeriod"),i("2.5.29.17","subjectAltName"),i("2.5.29.18","issuerAltName"),i("2.5.29.19","basicConstraints"),C("2.5.29.20","cRLNumber"),C("2.5.29.21","cRLReason"),C("2.5.29.22","expirationDate"),C("2.5.29.23","instructionCode"),C("2.5.29.24","invalidityDate"),C("2.5.29.25","cRLDistributionPoints"),C("2.5.29.26","issuingDistributionPoint"),C("2.5.29.27","deltaCRLIndicator"),C("2.5.29.28","issuingDistributionPoint"),C("2.5.29.29","certificateIssuer"),C("2.5.29.30","nameConstraints"),i("2.5.29.31","cRLDistributionPoints"),i("2.5.29.32","certificatePolicies"),C("2.5.29.33","policyMappings"),C("2.5.29.34","policyConstraints"),i("2.5.29.35","authorityKeyIdentifier"),C("2.5.29.36","policyConstraints"),i("2.5.29.37","extKeyUsage"),C("2.5.29.46","freshestCRL"),C("2.5.29.54","inhibitAnyPolicy"),i("1.3.6.1.4.1.11129.2.4.2","timestampList"),i("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),i("1.3.6.1.5.5.7.3.1","serverAuth"),i("1.3.6.1.5.5.7.3.2","clientAuth"),i("1.3.6.1.5.5.7.3.3","codeSigning"),i("1.3.6.1.5.5.7.3.4","emailProtection"),i("1.3.6.1.5.5.7.3.8","timeStamping")},59950:(re,ce,V)=>{var a=V(96560);if(V(57220),V(19462),V(37187),V(31502),V(4646),V(7866),V(38813),V(2608),V(35568),V(13865),V(64687),typeof e>"u")var e=a.jsbn.BigInteger;var i=a.asn1,C=a.pki=a.pki||{};re.exports=C.pbe=a.pbe=a.pbe||{};var E=C.oids,S={name:"EncryptedPrivateKeyInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},c={name:"PBES2Algorithms",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},l={name:"pkcs-12PbeParams",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"iterations"}]};C.encryptPrivateKeyInfo=function(m,y,I){I=I||{},I.saltSize=I.saltSize||8,I.count=I.count||2048,I.algorithm=I.algorithm||"aes128",I.prfAlgorithm=I.prfAlgorithm||"sha1";var d=a.random.getBytesSync(I.saltSize),v=I.count,n=i.integerToDer(v),f,p,A;if(I.algorithm.indexOf("aes")===0||I.algorithm==="des"){var R,k,h;switch(I.algorithm){case"aes128":f=16,R=16,k=E["aes128-CBC"],h=a.aes.createEncryptionCipher;break;case"aes192":f=24,R=16,k=E["aes192-CBC"],h=a.aes.createEncryptionCipher;break;case"aes256":f=32,R=16,k=E["aes256-CBC"],h=a.aes.createEncryptionCipher;break;case"des":f=8,R=8,k=E.desCBC,h=a.des.createEncryptionCipher;break;default:var g=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw g.algorithm=I.algorithm,g}var N="hmacWith"+I.prfAlgorithm.toUpperCase(),t=x(N),L=a.pkcs5.pbkdf2(y,d,v,f,t),O=a.random.getBytesSync(R),w=h(L);w.start(O),w.update(i.toDer(m)),w.finish(),A=w.output.getBytes();var M=U(d,n,f,N);p=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(E.pkcs5PBES2).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(E.pkcs5PBKDF2).getBytes()),M]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(k).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,O)])])])}else if(I.algorithm==="3des"){f=24;var K=new a.util.ByteBuffer(d),L=C.pbe.generatePkcs12Key(y,K,1,v,f),O=C.pbe.generatePkcs12Key(y,K,2,v,f),w=a.des.createEncryptionCipher(L);w.start(O),w.update(i.toDer(m)),w.finish(),A=w.output.getBytes(),p=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(E["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,d),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.getBytes())])])}else{var g=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw g.algorithm=I.algorithm,g}var G=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[p,i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,A)]);return G},C.decryptPrivateKeyInfo=function(m,y){var I=null,d={},v=[];if(!i.validate(m,S,d,v)){var n=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw n.errors=v,n}var f=i.derToOid(d.encryptionOid),p=C.pbe.getCipher(f,d.encryptionParams,y),A=a.util.createBuffer(d.encryptedData);return p.update(A),p.finish()&&(I=i.fromDer(p.output)),I},C.encryptedPrivateKeyToPem=function(m,y){var I={type:"ENCRYPTED PRIVATE KEY",body:i.toDer(m).getBytes()};return a.pem.encode(I,{maxline:y})},C.encryptedPrivateKeyFromPem=function(m){var y=a.pem.decode(m)[0];if(y.type!=="ENCRYPTED PRIVATE KEY"){var I=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw I.headerType=y.type,I}if(y.procType&&y.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return i.fromDer(y.body)},C.encryptRsaPrivateKey=function(m,y,I){if(I=I||{},!I.legacy){var d=C.wrapRsaPrivateKey(C.privateKeyToAsn1(m));return d=C.encryptPrivateKeyInfo(d,y,I),C.encryptedPrivateKeyToPem(d)}var v,n,f,p;switch(I.algorithm){case"aes128":v="AES-128-CBC",f=16,n=a.random.getBytesSync(16),p=a.aes.createEncryptionCipher;break;case"aes192":v="AES-192-CBC",f=24,n=a.random.getBytesSync(16),p=a.aes.createEncryptionCipher;break;case"aes256":v="AES-256-CBC",f=32,n=a.random.getBytesSync(16),p=a.aes.createEncryptionCipher;break;case"3des":v="DES-EDE3-CBC",f=24,n=a.random.getBytesSync(8),p=a.des.createEncryptionCipher;break;case"des":v="DES-CBC",f=8,n=a.random.getBytesSync(8),p=a.des.createEncryptionCipher;break;default:var A=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+I.algorithm+'".');throw A.algorithm=I.algorithm,A}var R=a.pbe.opensslDeriveBytes(y,n.substr(0,8),f),k=p(R);k.start(n),k.update(i.toDer(C.privateKeyToAsn1(m))),k.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:v,parameters:a.util.bytesToHex(n).toUpperCase()},body:k.output.getBytes()};return a.pem.encode(h)},C.decryptRsaPrivateKey=function(m,y){var I=null,d=a.pem.decode(m)[0];if(d.type!=="ENCRYPTED PRIVATE KEY"&&d.type!=="PRIVATE KEY"&&d.type!=="RSA PRIVATE KEY"){var v=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw v.headerType=v,v}if(d.procType&&d.procType.type==="ENCRYPTED"){var n,f;switch(d.dekInfo.algorithm){case"DES-CBC":n=8,f=a.des.createDecryptionCipher;break;case"DES-EDE3-CBC":n=24,f=a.des.createDecryptionCipher;break;case"AES-128-CBC":n=16,f=a.aes.createDecryptionCipher;break;case"AES-192-CBC":n=24,f=a.aes.createDecryptionCipher;break;case"AES-256-CBC":n=32,f=a.aes.createDecryptionCipher;break;case"RC2-40-CBC":n=5,f=function(h){return a.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":n=8,f=function(h){return a.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":n=16,f=function(h){return a.rc2.createDecryptionCipher(h,128)};break;default:var v=new Error('Could not decrypt private key; unsupported encryption algorithm "'+d.dekInfo.algorithm+'".');throw v.algorithm=d.dekInfo.algorithm,v}var p=a.util.hexToBytes(d.dekInfo.parameters),A=a.pbe.opensslDeriveBytes(y,p.substr(0,8),n),R=f(A);if(R.start(p),R.update(a.util.createBuffer(d.body)),R.finish())I=R.output.getBytes();else return I}else I=d.body;return d.type==="ENCRYPTED PRIVATE KEY"?I=C.decryptPrivateKeyInfo(i.fromDer(I),y):I=i.fromDer(I),I!==null&&(I=C.privateKeyFromAsn1(I)),I},C.pbe.generatePkcs12Key=function(m,y,I,d,v,n){var f,p;if(typeof n>"u"||n===null){if(!("sha1"in a.md))throw new Error('"sha1" hash algorithm unavailable.');n=a.md.sha1.create()}var A=n.digestLength,R=n.blockLength,k=new a.util.ByteBuffer,h=new a.util.ByteBuffer;if(m!=null){for(p=0;p<m.length;p++)h.putInt16(m.charCodeAt(p));h.putInt16(0)}var g=h.length(),N=y.length(),t=new a.util.ByteBuffer;t.fillWithByte(I,R);var L=R*Math.ceil(N/R),O=new a.util.ByteBuffer;for(p=0;p<L;p++)O.putByte(y.at(p%N));var w=R*Math.ceil(g/R),M=new a.util.ByteBuffer;for(p=0;p<w;p++)M.putByte(h.at(p%g));var K=O;K.putBuffer(M);for(var G=Math.ceil(v/A),X=1;X<=G;X++){var W=new a.util.ByteBuffer;W.putBytes(t.bytes()),W.putBytes(K.bytes());for(var q=0;q<d;q++)n.start(),n.update(W.getBytes()),W=n.digest();var te=new a.util.ByteBuffer;for(p=0;p<R;p++)te.putByte(W.at(p%A));var fe=Math.ceil(N/R)+Math.ceil(g/R),he=new a.util.ByteBuffer;for(f=0;f<fe;f++){var pe=new a.util.ByteBuffer(K.getBytes(R)),J=511;for(p=te.length()-1;p>=0;p--)J=J>>8,J+=te.at(p)+pe.at(p),pe.setAt(p,J&255);he.putBuffer(pe)}K=he,k.putBuffer(W)}return k.truncate(k.length()-v),k},C.pbe.getCipher=function(m,y,I){switch(m){case C.oids.pkcs5PBES2:return C.pbe.getCipherForPBES2(m,y,I);case C.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case C.oids["pbewithSHAAnd40BitRC2-CBC"]:return C.pbe.getCipherForPKCS12PBE(m,y,I);default:var d=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw d.oid=m,d.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],d}},C.pbe.getCipherForPBES2=function(m,y,I){var d={},v=[];if(!i.validate(y,c,d,v)){var n=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw n.errors=v,n}if(m=i.derToOid(d.kdfOid),m!==C.oids.pkcs5PBKDF2){var n=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw n.oid=m,n.supportedOids=["pkcs5PBKDF2"],n}if(m=i.derToOid(d.encOid),m!==C.oids["aes128-CBC"]&&m!==C.oids["aes192-CBC"]&&m!==C.oids["aes256-CBC"]&&m!==C.oids["des-EDE3-CBC"]&&m!==C.oids.desCBC){var n=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw n.oid=m,n.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],n}var f=d.kdfSalt,p=a.util.createBuffer(d.kdfIterationCount);p=p.getInt(p.length()<<3);var A,R;switch(C.oids[m]){case"aes128-CBC":A=16,R=a.aes.createDecryptionCipher;break;case"aes192-CBC":A=24,R=a.aes.createDecryptionCipher;break;case"aes256-CBC":A=32,R=a.aes.createDecryptionCipher;break;case"des-EDE3-CBC":A=24,R=a.des.createDecryptionCipher;break;case"desCBC":A=8,R=a.des.createDecryptionCipher;break}var k=u(d.prfOid),h=a.pkcs5.pbkdf2(I,f,p,A,k),g=d.encIv,N=R(h);return N.start(g),N},C.pbe.getCipherForPKCS12PBE=function(m,y,I){var d={},v=[];if(!i.validate(y,l,d,v)){var n=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw n.errors=v,n}var f=a.util.createBuffer(d.salt),p=a.util.createBuffer(d.iterations);p=p.getInt(p.length()<<3);var A,R,k;switch(m){case C.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:A=24,R=8,k=a.des.startDecrypting;break;case C.oids["pbewithSHAAnd40BitRC2-CBC"]:A=5,R=8,k=function(L,O){var w=a.rc2.createDecryptionCipher(L,40);return w.start(O,null),w};break;default:var n=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw n.oid=m,n}var h=u(d.prfOid),g=C.pbe.generatePkcs12Key(I,f,1,p,A,h);h.start();var N=C.pbe.generatePkcs12Key(I,f,2,p,R,h);return k(g,N)},C.pbe.opensslDeriveBytes=function(m,y,I,d){if(typeof d>"u"||d===null){if(!("md5"in a.md))throw new Error('"md5" hash algorithm unavailable.');d=a.md.md5.create()}y===null&&(y="");for(var v=[r(d,m+y)],n=16,f=1;n<I;++f,n+=16)v.push(r(d,v[f-1]+m+y));return v.join("").substr(0,I)};function r(m,y){return m.start().update(y).digest().getBytes()}function u(m){var y;if(!m)y="hmacWithSHA1";else if(y=C.oids[i.derToOid(m)],!y){var I=new Error("Unsupported PRF OID.");throw I.oid=m,I.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],I}return x(y)}function x(m){var y=a.md;switch(m){case"hmacWithSHA224":y=a.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":m=m.substr(8).toLowerCase();break;default:var I=new Error("Unsupported PRF algorithm.");throw I.algorithm=m,I.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],I}if(!y||!(m in y))throw new Error("Unknown hash algorithm: "+m);return y[m].create()}function U(m,y,I,d){var v=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,m),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,y.getBytes())]);return d!=="hmacWithSHA1"&&v.value.push(i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,a.util.hexToBytes(I.toString(16))),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(C.oids[d]).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])),v}},7866:(re,ce,V)=>{var a=V(96560);V(6252),V(31502),V(64687);var e=a.pkcs5=a.pkcs5||{},i;a.util.isNodejs&&!a.options.usePureJavaScript&&(i=V(50310)),re.exports=a.pbkdf2=e.pbkdf2=function(C,E,S,c,l,r){if(typeof l=="function"&&(r=l,l=null),a.util.isNodejs&&!a.options.usePureJavaScript&&i.pbkdf2&&(l===null||typeof l!="object")&&(i.pbkdf2Sync.length>4||!l||l==="sha1"))return typeof l!="string"&&(l="sha1"),C=Buffer.from(C,"binary"),E=Buffer.from(E,"binary"),r?i.pbkdf2Sync.length===4?i.pbkdf2(C,E,S,c,function(k,h){if(k)return r(k);r(null,h.toString("binary"))}):i.pbkdf2(C,E,S,c,l,function(k,h){if(k)return r(k);r(null,h.toString("binary"))}):i.pbkdf2Sync.length===4?i.pbkdf2Sync(C,E,S,c).toString("binary"):i.pbkdf2Sync(C,E,S,c,l).toString("binary");if((typeof l>"u"||l===null)&&(l="sha1"),typeof l=="string"){if(!(l in a.md.algorithms))throw new Error("Unknown hash algorithm: "+l);l=a.md[l].create()}var u=l.digestLength;if(c>4294967295*u){var x=new Error("Derived key is too long.");if(r)return r(x);throw x}var U=Math.ceil(c/u),m=c-(U-1)*u,y=a.hmac.create();y.start(l,C);var I="",d,v,n;if(!r){for(var f=1;f<=U;++f){y.start(null,null),y.update(E),y.update(a.util.int32ToBytes(f)),d=n=y.digest().getBytes();for(var p=2;p<=S;++p)y.start(null,null),y.update(n),v=y.digest().getBytes(),d=a.util.xorBytes(d,v,u),n=v;I+=f<U?d:d.substr(0,m)}return I}var f=1,p;function A(){if(f>U)return r(null,I);y.start(null,null),y.update(E),y.update(a.util.int32ToBytes(f)),d=n=y.digest().getBytes(),p=2,R()}function R(){if(p<=S)return y.start(null,null),y.update(n),v=y.digest().getBytes(),d=a.util.xorBytes(d,v,u),n=v,++p,a.util.setImmediate(R);I+=f<U?d:d.substr(0,m),++f,A()}A()}},38813:(re,ce,V)=>{var a=V(96560);V(64687);var e=re.exports=a.pem=a.pem||{};e.encode=function(E,S){S=S||{};var c="-----BEGIN "+E.type+`-----\r
`,l;if(E.procType&&(l={name:"Proc-Type",values:[String(E.procType.version),E.procType.type]},c+=i(l)),E.contentDomain&&(l={name:"Content-Domain",values:[E.contentDomain]},c+=i(l)),E.dekInfo&&(l={name:"DEK-Info",values:[E.dekInfo.algorithm]},E.dekInfo.parameters&&l.values.push(E.dekInfo.parameters),c+=i(l)),E.headers)for(var r=0;r<E.headers.length;++r)c+=i(E.headers[r]);return E.procType&&(c+=`\r
`),c+=a.util.encode64(E.body,S.maxline||64)+`\r
`,c+="-----END "+E.type+`-----\r
`,c},e.decode=function(E){for(var S=[],c=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,l=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,r=/\r?\n/,u;u=c.exec(E),!!u;){var x=u[1];x==="NEW CERTIFICATE REQUEST"&&(x="CERTIFICATE REQUEST");var U={type:x,procType:null,contentDomain:null,dekInfo:null,headers:[],body:a.util.decode64(u[3])};if(S.push(U),!!u[2]){for(var m=u[2].split(r),y=0;u&&y<m.length;){for(var I=m[y].replace(/\s+$/,""),d=y+1;d<m.length;++d){var v=m[d];if(!/\s/.test(v[0]))break;I+=v,y=d}if(u=I.match(l),u){for(var n={name:u[1],values:[]},f=u[2].split(","),p=0;p<f.length;++p)n.values.push(C(f[p]));if(U.procType)if(!U.contentDomain&&n.name==="Content-Domain")U.contentDomain=f[0]||"";else if(!U.dekInfo&&n.name==="DEK-Info"){if(n.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');U.dekInfo={algorithm:f[0],parameters:f[1]||null}}else U.headers.push(n);else{if(n.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(n.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');U.procType={version:f[0],type:f[1]}}}++y}if(U.procType==="ENCRYPTED"&&!U.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(S.length===0)throw new Error("Invalid PEM formatted message.");return S};function i(E){for(var S=E.name+": ",c=[],l=function(m,y){return" "+y},r=0;r<E.values.length;++r)c.push(E.values[r].replace(/^(\S+\r\n)/,l));S+=c.join(",")+`\r
`;for(var u=0,x=-1,r=0;r<S.length;++r,++u)if(u>65&&x!==-1){var U=S[x];U===","?(++x,S=S.substr(0,x)+`\r
 `+S.substr(x)):S=S.substr(0,x)+`\r
`+U+S.substr(x+1),u=r-x-1,x=-1,++r}else(S[r]===" "||S[r]==="	"||S[r]===",")&&(x=r);return S}function C(E){return E.replace(/^\s+/,"")}},4745:(re,ce,V)=>{var a=V(96560);V(64687),V(2608),V(34341);var e=re.exports=a.pkcs1=a.pkcs1||{};e.encode_rsa_oaep=function(C,E,S){var c,l,r,u;typeof S=="string"?(c=S,l=arguments[3]||void 0,r=arguments[4]||void 0):S&&(c=S.label||void 0,l=S.seed||void 0,r=S.md||void 0,S.mgf1&&S.mgf1.md&&(u=S.mgf1.md)),r?r.start():r=a.md.sha1.create(),u||(u=r);var x=Math.ceil(C.n.bitLength()/8),U=x-2*r.digestLength-2;if(E.length>U){var m=new Error("RSAES-OAEP input message length is too long.");throw m.length=E.length,m.maxLength=U,m}c||(c=""),r.update(c,"raw");for(var y=r.digest(),I="",d=U-E.length,v=0;v<d;v++)I+="\0";var n=y.getBytes()+I+""+E;if(!l)l=a.random.getBytes(r.digestLength);else if(l.length!==r.digestLength){var m=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw m.seedLength=l.length,m.digestLength=r.digestLength,m}var f=i(l,x-r.digestLength-1,u),p=a.util.xorBytes(n,f,n.length),A=i(p,r.digestLength,u),R=a.util.xorBytes(l,A,l.length);return"\0"+R+p},e.decode_rsa_oaep=function(C,E,S){var c,l,r;typeof S=="string"?(c=S,l=arguments[3]||void 0):S&&(c=S.label||void 0,l=S.md||void 0,S.mgf1&&S.mgf1.md&&(r=S.mgf1.md));var u=Math.ceil(C.n.bitLength()/8);if(E.length!==u){var p=new Error("RSAES-OAEP encoded message length is invalid.");throw p.length=E.length,p.expectedLength=u,p}if(l===void 0?l=a.md.sha1.create():l.start(),r||(r=l),u<2*l.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");c||(c=""),l.update(c,"raw");for(var x=l.digest().getBytes(),U=E.charAt(0),m=E.substring(1,l.digestLength+1),y=E.substring(1+l.digestLength),I=i(y,l.digestLength,r),d=a.util.xorBytes(m,I,m.length),v=i(d,u-l.digestLength-1,r),n=a.util.xorBytes(y,v,y.length),f=n.substring(0,l.digestLength),p=U!=="\0",A=0;A<l.digestLength;++A)p|=x.charAt(A)!==f.charAt(A);for(var R=1,k=l.digestLength,h=l.digestLength;h<n.length;h++){var g=n.charCodeAt(h),N=g&1^1,t=R?65534:0;p|=g&t,R=R&N,k+=R}if(p||n.charCodeAt(k)!==1)throw new Error("Invalid RSAES-OAEP padding.");return n.substring(k+1)};function i(C,E,S){S||(S=a.md.sha1.create());for(var c="",l=Math.ceil(E/S.digestLength),r=0;r<l;++r){var u=String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255);S.start(),S.update(C+u),c+=S.digest().getBytes()}return c.substring(0,E)}},28947:(re,ce,V)=>{var a=V(96560);V(19462),V(6252),V(4646),V(67006),V(59950),V(2608),V(13865),V(34341),V(64687),V(63543);var e=a.asn1,i=a.pki,C=re.exports=a.pkcs12=a.pkcs12||{},E={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},S={name:"PFX",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},E,{name:"PFX.macData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},c={name:"SafeBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},l={name:"Attribute",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,capture:"values"}]},r={name:"CertBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:e.Class.UNIVERSAL,type:e.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function u(d,v,n,f){for(var p=[],A=0;A<d.length;A++)for(var R=0;R<d[A].safeBags.length;R++){var k=d[A].safeBags[R];if(!(f!==void 0&&k.type!==f)){if(v===null){p.push(k);continue}k.attributes[v]!==void 0&&k.attributes[v].indexOf(n)>=0&&p.push(k)}}return p}C.pkcs12FromAsn1=function(d,v,n){typeof v=="string"?(n=v,v=!0):v===void 0&&(v=!0);var f={},p=[];if(!e.validate(d,S,f,p)){var A=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw A.errors=A,A}var R={version:f.version.charCodeAt(0),safeContents:[],getBags:function(K){var G={},X;return"localKeyId"in K?X=K.localKeyId:"localKeyIdHex"in K&&(X=a.util.hexToBytes(K.localKeyIdHex)),X===void 0&&!("friendlyName"in K)&&"bagType"in K&&(G[K.bagType]=u(R.safeContents,null,null,K.bagType)),X!==void 0&&(G.localKeyId=u(R.safeContents,"localKeyId",X,K.bagType)),"friendlyName"in K&&(G.friendlyName=u(R.safeContents,"friendlyName",K.friendlyName,K.bagType)),G},getBagsByFriendlyName:function(K,G){return u(R.safeContents,"friendlyName",K,G)},getBagsByLocalKeyId:function(K,G){return u(R.safeContents,"localKeyId",K,G)}};if(f.version.charCodeAt(0)!==3){var A=new Error("PKCS#12 PFX of version other than 3 not supported.");throw A.version=f.version.charCodeAt(0),A}if(e.derToOid(f.contentType)!==i.oids.data){var A=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw A.oid=e.derToOid(f.contentType),A}var k=f.content.value[0];if(k.tagClass!==e.Class.UNIVERSAL||k.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(k=x(k),f.mac){var h=null,g=0,N=e.derToOid(f.macAlgorithm);switch(N){case i.oids.sha1:h=a.md.sha1.create(),g=20;break;case i.oids.sha256:h=a.md.sha256.create(),g=32;break;case i.oids.sha384:h=a.md.sha384.create(),g=48;break;case i.oids.sha512:h=a.md.sha512.create(),g=64;break;case i.oids.md5:h=a.md.md5.create(),g=16;break}if(h===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+N);var t=new a.util.ByteBuffer(f.macSalt),L="macIterations"in f?parseInt(a.util.bytesToHex(f.macIterations),16):1,O=C.generateKey(n,t,3,L,g,h),w=a.hmac.create();w.start(h,O),w.update(k.value);var M=w.getMac();if(M.getBytes()!==f.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return U(R,k.value,v,n),R};function x(d){if(d.composed||d.constructed){for(var v=a.util.createBuffer(),n=0;n<d.value.length;++n)v.putBytes(d.value[n].value);d.composed=d.constructed=!1,d.value=v.getBytes()}return d}function U(d,v,n,f){if(v=e.fromDer(v,n),v.tagClass!==e.Class.UNIVERSAL||v.type!==e.Type.SEQUENCE||v.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var p=0;p<v.value.length;p++){var A=v.value[p],R={},k=[];if(!e.validate(A,E,R,k)){var h=new Error("Cannot read ContentInfo.");throw h.errors=k,h}var g={encrypted:!1},N=null,t=R.content.value[0];switch(e.derToOid(R.contentType)){case i.oids.data:if(t.tagClass!==e.Class.UNIVERSAL||t.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");N=x(t).value;break;case i.oids.encryptedData:N=m(t,f),g.encrypted=!0;break;default:var h=new Error("Unsupported PKCS#12 contentType.");throw h.contentType=e.derToOid(R.contentType),h}g.safeBags=y(N,n,f),d.safeContents.push(g)}}function m(d,v){var n={},f=[];if(!e.validate(d,a.pkcs7.asn1.encryptedDataValidator,n,f)){var p=new Error("Cannot read EncryptedContentInfo.");throw p.errors=f,p}var A=e.derToOid(n.contentType);if(A!==i.oids.data){var p=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw p.oid=A,p}A=e.derToOid(n.encAlgorithm);var R=i.pbe.getCipher(A,n.encParameter,v),k=x(n.encryptedContentAsn1),h=a.util.createBuffer(k.value);if(R.update(h),!R.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return R.output.getBytes()}function y(d,v,n){if(!v&&d.length===0)return[];if(d=e.fromDer(d,v),d.tagClass!==e.Class.UNIVERSAL||d.type!==e.Type.SEQUENCE||d.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var f=[],p=0;p<d.value.length;p++){var A=d.value[p],R={},k=[];if(!e.validate(A,c,R,k)){var h=new Error("Cannot read SafeBag.");throw h.errors=k,h}var g={type:e.derToOid(R.bagId),attributes:I(R.bagAttributes)};f.push(g);var N,t,L=R.bagValue.value[0];switch(g.type){case i.oids.pkcs8ShroudedKeyBag:if(L=i.decryptPrivateKeyInfo(L,n),L===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case i.oids.keyBag:try{g.key=i.privateKeyFromAsn1(L)}catch{g.key=null,g.asn1=L}continue;case i.oids.certBag:N=r,t=function(){if(e.derToOid(R.certId)!==i.oids.x509Certificate){var w=new Error("Unsupported certificate type, only X.509 supported.");throw w.oid=e.derToOid(R.certId),w}var M=e.fromDer(R.cert,v);try{g.cert=i.certificateFromAsn1(M,!0)}catch{g.cert=null,g.asn1=M}};break;default:var h=new Error("Unsupported PKCS#12 SafeBag type.");throw h.oid=g.type,h}if(N!==void 0&&!e.validate(L,N,R,k)){var h=new Error("Cannot read PKCS#12 "+N.name);throw h.errors=k,h}t()}return f}function I(d){var v={};if(d!==void 0)for(var n=0;n<d.length;++n){var f={},p=[];if(!e.validate(d[n],l,f,p)){var A=new Error("Cannot read PKCS#12 BagAttribute.");throw A.errors=p,A}var R=e.derToOid(f.oid);if(i.oids[R]!==void 0){v[i.oids[R]]=[];for(var k=0;k<f.values.length;++k)v[i.oids[R]].push(f.values[k].value)}}return v}C.toPkcs12Asn1=function(d,v,n,f){f=f||{},f.saltSize=f.saltSize||8,f.count=f.count||2048,f.algorithm=f.algorithm||f.encAlgorithm||"aes128","useMac"in f||(f.useMac=!0),"localKeyId"in f||(f.localKeyId=null),"generateLocalKeyId"in f||(f.generateLocalKeyId=!0);var p=f.localKeyId,A;if(p!==null)p=a.util.hexToBytes(p);else if(f.generateLocalKeyId)if(v){var R=a.util.isArray(v)?v[0]:v;typeof R=="string"&&(R=i.certificateFromPem(R));var k=a.md.sha1.create();k.update(e.toDer(i.certificateToAsn1(R)).getBytes()),p=k.digest().getBytes()}else p=a.random.getBytes(20);var h=[];p!==null&&h.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.oids.localKeyId).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,p)])])),"friendlyName"in f&&h.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.oids.friendlyName).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.BMPSTRING,!1,f.friendlyName)])])),h.length>0&&(A=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,h));var g=[],N=[];v!==null&&(a.util.isArray(v)?N=v:N=[v]);for(var t=[],L=0;L<N.length;++L){v=N[L],typeof v=="string"&&(v=i.certificateFromPem(v));var O=L===0?A:void 0,w=i.certificateToAsn1(v),M=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.oids.certBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.oids.x509Certificate).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(w).getBytes())])])]),O]);t.push(M)}if(t.length>0){var K=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,t),G=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(K).getBytes())])]);g.push(G)}var X=null;if(d!==null){var W=i.wrapRsaPrivateKey(i.privateKeyToAsn1(d));n===null?X=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.oids.keyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[W]),A]):X=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.oids.pkcs8ShroudedKeyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[i.encryptPrivateKeyInfo(W,n,f)]),A]);var q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[X]),te=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(q).getBytes())])]);g.push(te)}var fe=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,g),he;if(f.useMac){var k=a.md.sha1.create(),pe=new a.util.ByteBuffer(a.random.getBytes(f.saltSize)),J=f.count,d=C.generateKey(n,pe,3,J,20),me=a.hmac.create();me.start(k,d),me.update(e.toDer(fe).getBytes());var ie=me.getMac();he=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.oids.sha1).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,ie.getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,pe.getBytes()),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(J).getBytes())])}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(3).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(fe).getBytes())])]),he])},C.generateKey=a.pbe.generatePkcs12Key},53379:(re,ce,V)=>{var a=V(96560);V(57220),V(19462),V(37187),V(4646),V(38813),V(67006),V(2608),V(64687),V(63543);var e=a.asn1,i=re.exports=a.pkcs7=a.pkcs7||{};i.messageFromPem=function(d){var v=a.pem.decode(d)[0];if(v.type!=="PKCS7"){var n=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw n.headerType=v.type,n}if(v.procType&&v.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var f=e.fromDer(v.body);return i.messageFromAsn1(f)},i.messageToPem=function(d,v){var n={type:"PKCS7",body:e.toDer(d.toAsn1()).getBytes()};return a.pem.encode(n,{maxline:v})},i.messageFromAsn1=function(d){var v={},n=[];if(!e.validate(d,i.asn1.contentInfoValidator,v,n)){var f=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw f.errors=n,f}var p=e.derToOid(v.contentType),A;switch(p){case a.pki.oids.envelopedData:A=i.createEnvelopedData();break;case a.pki.oids.encryptedData:A=i.createEncryptedData();break;case a.pki.oids.signedData:A=i.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+p+" is not (yet) supported.")}return A.fromAsn1(v.content.value[0]),A},i.createSignedData=function(){var d=null;return d={type:a.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(f){if(y(d,f,i.asn1.signedDataValidator),d.certificates=[],d.crls=[],d.digestAlgorithmIdentifiers=[],d.contentInfo=null,d.signerInfos=[],d.rawCapture.certificates)for(var p=d.rawCapture.certificates.value,A=0;A<p.length;++A)d.certificates.push(a.pki.certificateFromAsn1(p[A]))},toAsn1:function(){d.contentInfo||d.sign();for(var f=[],p=0;p<d.certificates.length;++p)f.push(a.pki.certificateToAsn1(d.certificates[p]));var A=[],R=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(d.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,d.digestAlgorithmIdentifiers),d.contentInfo])]);return f.length>0&&R.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,f)),A.length>0&&R.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,A)),R.value[0].value.push(e.create(e.Class.UNIVERSAL,e.Type.SET,!0,d.signerInfos)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.type).getBytes()),R])},addSigner:function(f){var p=f.issuer,A=f.serialNumber;if(f.certificate){var R=f.certificate;typeof R=="string"&&(R=a.pki.certificateFromPem(R)),p=R.issuer.attributes,A=R.serialNumber}var k=f.key;if(!k)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof k=="string"&&(k=a.pki.privateKeyFromPem(k));var h=f.digestAlgorithm||a.pki.oids.sha1;switch(h){case a.pki.oids.sha1:case a.pki.oids.sha256:case a.pki.oids.sha384:case a.pki.oids.sha512:case a.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+h)}var g=f.authenticatedAttributes||[];if(g.length>0){for(var N=!1,t=!1,L=0;L<g.length;++L){var O=g[L];if(!N&&O.type===a.pki.oids.contentType){if(N=!0,t)break;continue}if(!t&&O.type===a.pki.oids.messageDigest){if(t=!0,N)break;continue}}if(!N||!t)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}d.signers.push({key:k,version:1,issuer:p,serialNumber:A,digestAlgorithm:h,signatureAlgorithm:a.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:g,unauthenticatedAttributes:[]})},sign:function(f){if(f=f||{},(typeof d.content!="object"||d.contentInfo===null)&&(d.contentInfo=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.pki.oids.data).getBytes())]),"content"in d)){var p;d.content instanceof a.util.ByteBuffer?p=d.content.bytes():typeof d.content=="string"&&(p=a.util.encodeUtf8(d.content)),f.detached?d.detachedContent=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,p):d.contentInfo.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,p)]))}if(d.signers.length!==0){var A=v();n(A)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(f){typeof f=="string"&&(f=a.pki.certificateFromPem(f)),d.certificates.push(f)},addCertificateRevokationList:function(f){throw new Error("PKCS#7 CRL support not yet implemented.")}},d;function v(){for(var f={},p=0;p<d.signers.length;++p){var A=d.signers[p],R=A.digestAlgorithm;R in f||(f[R]=a.md[a.pki.oids[R]].create()),A.authenticatedAttributes.length===0?A.md=f[R]:A.md=a.md[a.pki.oids[R]].create()}d.digestAlgorithmIdentifiers=[];for(var R in f)d.digestAlgorithmIdentifiers.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(R).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]));return f}function n(f){var p;if(d.detachedContent?p=d.detachedContent:(p=d.contentInfo.value[1],p=p.value[0]),!p)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var A=e.derToOid(d.contentInfo.value[0].value),R=e.toDer(p);R.getByte(),e.getBerValueLength(R),R=R.getBytes();for(var k in f)f[k].start().update(R);for(var h=new Date,g=0;g<d.signers.length;++g){var N=d.signers[g];if(N.authenticatedAttributes.length===0){if(A!==a.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{N.authenticatedAttributesAsn1=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var t=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[]),L=0;L<N.authenticatedAttributes.length;++L){var O=N.authenticatedAttributes[L];O.type===a.pki.oids.messageDigest?O.value=f[N.digestAlgorithm].digest():O.type===a.pki.oids.signingTime&&(O.value||(O.value=h)),t.value.push(U(O)),N.authenticatedAttributesAsn1.value.push(U(O))}R=e.toDer(t).getBytes(),N.md.start().update(R)}N.signature=N.key.sign(N.md,"RSASSA-PKCS1-V1_5")}d.signerInfos=x(d.signers)}},i.createEncryptedData=function(){var d=null;return d={type:a.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(v){y(d,v,i.asn1.encryptedDataValidator)},decrypt:function(v){v!==void 0&&(d.encryptedContent.key=v),I(d)}},d},i.createEnvelopedData=function(){var d=null;return d={type:a.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(v){var n=y(d,v,i.asn1.envelopedDataValidator);d.recipients=S(n.recipientInfos.value)},toAsn1:function(){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.type).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(d.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,c(d.recipients)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,m(d.encryptedContent))])])])},findRecipient:function(v){for(var n=v.issuer.attributes,f=0;f<d.recipients.length;++f){var p=d.recipients[f],A=p.issuer;if(p.serialNumber===v.serialNumber&&A.length===n.length){for(var R=!0,k=0;k<n.length;++k)if(A[k].type!==n[k].type||A[k].value!==n[k].value){R=!1;break}if(R)return p}}return null},decrypt:function(v,n){if(d.encryptedContent.key===void 0&&v!==void 0&&n!==void 0)switch(v.encryptedContent.algorithm){case a.pki.oids.rsaEncryption:case a.pki.oids.desCBC:var f=n.decrypt(v.encryptedContent.content);d.encryptedContent.key=a.util.createBuffer(f);break;default:throw new Error("Unsupported asymmetric cipher, OID "+v.encryptedContent.algorithm)}I(d)},addRecipient:function(v){d.recipients.push({version:0,issuer:v.issuer.attributes,serialNumber:v.serialNumber,encryptedContent:{algorithm:a.pki.oids.rsaEncryption,key:v.publicKey}})},encrypt:function(v,n){if(d.encryptedContent.content===void 0){n=n||d.encryptedContent.algorithm,v=v||d.encryptedContent.key;var f,p,A;switch(n){case a.pki.oids["aes128-CBC"]:f=16,p=16,A=a.aes.createEncryptionCipher;break;case a.pki.oids["aes192-CBC"]:f=24,p=16,A=a.aes.createEncryptionCipher;break;case a.pki.oids["aes256-CBC"]:f=32,p=16,A=a.aes.createEncryptionCipher;break;case a.pki.oids["des-EDE3-CBC"]:f=24,p=8,A=a.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+n)}if(v===void 0)v=a.util.createBuffer(a.random.getBytes(f));else if(v.length()!=f)throw new Error("Symmetric key has wrong length; got "+v.length()+" bytes, expected "+f+".");d.encryptedContent.algorithm=n,d.encryptedContent.key=v,d.encryptedContent.parameter=a.util.createBuffer(a.random.getBytes(p));var R=A(v);if(R.start(d.encryptedContent.parameter.copy()),R.update(d.content),!R.finish())throw new Error("Symmetric encryption failed.");d.encryptedContent.content=R.output}for(var k=0;k<d.recipients.length;++k){var h=d.recipients[k];if(h.encryptedContent.content===void 0)switch(h.encryptedContent.algorithm){case a.pki.oids.rsaEncryption:h.encryptedContent.content=h.encryptedContent.key.encrypt(d.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+h.encryptedContent.algorithm)}}}},d};function C(d){var v={},n=[];if(!e.validate(d,i.asn1.recipientInfoValidator,v,n)){var f=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw f.errors=n,f}return{version:v.version.charCodeAt(0),issuer:a.pki.RDNAttributesAsArray(v.issuer),serialNumber:a.util.createBuffer(v.serial).toHex(),encryptedContent:{algorithm:e.derToOid(v.encAlgorithm),parameter:v.encParameter?v.encParameter.value:void 0,content:v.encKey}}}function E(d){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(d.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[a.pki.distinguishedNameToAsn1({attributes:d.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,a.util.hexToBytes(d.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.encryptedContent.algorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.encryptedContent.content)])}function S(d){for(var v=[],n=0;n<d.length;++n)v.push(C(d[n]));return v}function c(d){for(var v=[],n=0;n<d.length;++n)v.push(E(d[n]));return v}function l(d){var v={},n=[];if(!e.validate(d,i.asn1.signerInfoValidator,v,n)){var f=new Error("Cannot read PKCS#7 SignerInfo. ASN.1 object is not an PKCS#7 SignerInfo.");throw f.errors=n,f}var p={version:v.version.charCodeAt(0),issuer:a.pki.RDNAttributesAsArray(v.issuer),serialNumber:a.util.createBuffer(v.serial).toHex(),digestAlgorithm:e.derToOid(v.digestAlgorithm),signatureAlgorithm:e.derToOid(v.signatureAlgorithm),signature:v.signature,authenticatedAttributes:[],unauthenticatedAttributes:[]},A=v.authenticatedAttributes||[],R=v.unauthenticatedAttributes||[];return p}function r(d){var v=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(d.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[a.pki.distinguishedNameToAsn1({attributes:d.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,a.util.hexToBytes(d.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.digestAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])]);if(d.authenticatedAttributesAsn1&&v.value.push(d.authenticatedAttributesAsn1),v.value.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.signatureAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])),v.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.signature)),d.unauthenticatedAttributes.length>0){for(var n=e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[]),f=0;f<d.unauthenticatedAttributes.length;++f){var p=d.unauthenticatedAttributes[f];n.values.push(U(p))}v.value.push(n)}return v}function u(d){for(var v=[],n=0;n<d.length;++n)v.push(l(d[n]));return v}function x(d){for(var v=[],n=0;n<d.length;++n)v.push(r(d[n]));return v}function U(d){var v;if(d.type===a.pki.oids.contentType)v=e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.value).getBytes());else if(d.type===a.pki.oids.messageDigest)v=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.value.bytes());else if(d.type===a.pki.oids.signingTime){var n=new Date("1950-01-01T00:00:00Z"),f=new Date("2050-01-01T00:00:00Z"),p=d.value;if(typeof p=="string"){var A=Date.parse(p);isNaN(A)?p.length===13?p=e.utcTimeToDate(p):p=e.generalizedTimeToDate(p):p=new Date(A)}p>=n&&p<f?v=e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(p)):v=e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(p))}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[v])])}function m(d){return[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.pki.oids.data).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.algorithm).getBytes()),d.parameter?e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.parameter.getBytes()):void 0]),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.content.getBytes())])]}function y(d,v,n){var f={},p=[];if(!e.validate(v,n,f,p)){var A=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw A.errors=A,A}var R=e.derToOid(f.contentType);if(R!==a.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(f.encryptedContent){var k="";if(a.util.isArray(f.encryptedContent))for(var h=0;h<f.encryptedContent.length;++h){if(f.encryptedContent[h].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");k+=f.encryptedContent[h].value}else k=f.encryptedContent;d.encryptedContent={algorithm:e.derToOid(f.encAlgorithm),parameter:a.util.createBuffer(f.encParameter.value),content:a.util.createBuffer(k)}}if(f.content){var k="";if(a.util.isArray(f.content))for(var h=0;h<f.content.length;++h){if(f.content[h].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");k+=f.content[h].value}else k=f.content;d.content=a.util.createBuffer(k)}return d.version=f.version.charCodeAt(0),d.rawCapture=f,f}function I(d){if(d.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(d.content===void 0){var v;switch(d.encryptedContent.algorithm){case a.pki.oids["aes128-CBC"]:case a.pki.oids["aes192-CBC"]:case a.pki.oids["aes256-CBC"]:v=a.aes.createDecryptionCipher(d.encryptedContent.key);break;case a.pki.oids.desCBC:case a.pki.oids["des-EDE3-CBC"]:v=a.des.createDecryptionCipher(d.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+d.encryptedContent.algorithm)}if(v.start(d.encryptedContent.parameter),v.update(d.encryptedContent.content),!v.finish())throw new Error("Symmetric decryption failed.");d.content=v.output}}},67006:(re,ce,V)=>{var a=V(96560);V(19462),V(64687);var e=a.asn1,i=re.exports=a.pkcs7asn1=a.pkcs7asn1||{};a.pkcs7=a.pkcs7||{},a.pkcs7.asn1=i;var C={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};i.contentInfoValidator=C;var E={name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};i.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(E)},i.encryptedDataValidator={name:"EncryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(E)};var S={name:"SignerInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};i.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},C,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[S]}]},i.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},46803:(re,ce,V)=>{var a=V(96560);V(19462),V(4646),V(59950),V(38813),V(7866),V(28947),V(42242),V(13865),V(64687),V(63543);var e=a.asn1,i=re.exports=a.pki=a.pki||{};i.pemToDer=function(C){var E=a.pem.decode(C)[0];if(E.procType&&E.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return a.util.createBuffer(E.body)},i.privateKeyFromPem=function(C){var E=a.pem.decode(C)[0];if(E.type!=="PRIVATE KEY"&&E.type!=="RSA PRIVATE KEY"){var S=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw S.headerType=E.type,S}if(E.procType&&E.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var c=e.fromDer(E.body);return i.privateKeyFromAsn1(c)},i.privateKeyToPem=function(C,E){var S={type:"RSA PRIVATE KEY",body:e.toDer(i.privateKeyToAsn1(C)).getBytes()};return a.pem.encode(S,{maxline:E})},i.privateKeyInfoToPem=function(C,E){var S={type:"PRIVATE KEY",body:e.toDer(C).getBytes()};return a.pem.encode(S,{maxline:E})}},43704:(re,ce,V)=>{var a=V(96560);V(64687),V(35156),V(2608),function(){if(a.prime){re.exports=a.prime;return}var e=re.exports=a.prime=a.prime||{},i=a.jsbn.BigInteger,C=[6,4,2,4,2,4,6,2],E=new i(null);E.fromInt(30);var S=function(m,y){return m|y};e.generateProbablePrime=function(m,y,I){typeof y=="function"&&(I=y,y={}),y=y||{};var d=y.algorithm||"PRIMEINC";typeof d=="string"&&(d={name:d}),d.options=d.options||{};var v=y.prng||a.random,n={nextBytes:function(f){for(var p=v.getBytesSync(f.length),A=0;A<f.length;++A)f[A]=p.charCodeAt(A)}};if(d.name==="PRIMEINC")return c(m,n,d.options,I);throw new Error("Invalid prime generation algorithm: "+d.name)};function c(m,y,I,d){return"workers"in I?u(m,y,I,d):l(m,y,I,d)}function l(m,y,I,d){var v=x(m,y),n=0,f=U(v.bitLength());"millerRabinTests"in I&&(f=I.millerRabinTests);var p=10;"maxBlockTime"in I&&(p=I.maxBlockTime),r(v,m,y,n,f,p,d)}function r(m,y,I,d,v,n,f){var p=+new Date;do{if(m.bitLength()>y&&(m=x(y,I)),m.isProbablePrime(v))return f(null,m);m.dAddOffset(C[d++%8],0)}while(n<0||+new Date-p<n);a.util.setImmediate(function(){r(m,y,I,d,v,n,f)})}function u(m,y,I,d){if(typeof Worker>"u")return l(m,y,I,d);var v=x(m,y),n=I.workers,f=I.workLoad||100,p=f*30/8,A=I.workerScript||"forge/prime.worker.js";if(n===-1)return a.util.estimateCores(function(k,h){k&&(h=2),n=h-1,R()});R();function R(){n=Math.max(1,n);for(var k=[],h=0;h<n;++h)k[h]=new Worker(A);for(var g=n,h=0;h<n;++h)k[h].addEventListener("message",t);var N=!1;function t(L){if(!N){--g;var O=L.data;if(O.found){for(var w=0;w<k.length;++w)k[w].terminate();return N=!0,d(null,new i(O.prime,16))}v.bitLength()>m&&(v=x(m,y));var M=v.toString(16);L.target.postMessage({hex:M,workLoad:f}),v.dAddOffset(p,0)}}}}function x(m,y){var I=new i(m,y),d=m-1;return I.testBit(d)||I.bitwiseTo(i.ONE.shiftLeft(d),S,I),I.dAddOffset(31-I.mod(E).byteValue(),0),I}function U(m){return m<=100?27:m<=150?18:m<=200?15:m<=250?12:m<=300?9:m<=350?8:m<=400?7:m<=500?6:m<=600?5:m<=800?4:m<=1250?3:2}}()},35002:(re,ce,V)=>{var a=V(96560);V(64687);var e=null;a.util.isNodejs&&!a.options.usePureJavaScript&&!process.versions["node-webkit"]&&(e=V(50310));var i=re.exports=a.prng=a.prng||{};i.create=function(C){for(var E={plugin:C,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},S=C.md,c=new Array(32),l=0;l<32;++l)c[l]=S.create();E.pools=c,E.pool=0,E.generate=function(m,y){if(!y)return E.generateSync(m);var I=E.plugin.cipher,d=E.plugin.increment,v=E.plugin.formatKey,n=E.plugin.formatSeed,f=a.util.createBuffer();E.key=null,p();function p(A){if(A)return y(A);if(f.length()>=m)return y(null,f.getBytes(m));if(E.generated>1048575&&(E.key=null),E.key===null)return a.util.nextTick(function(){r(p)});var R=I(E.key,E.seed);E.generated+=R.length,f.putBytes(R),E.key=v(I(E.key,d(E.seed))),E.seed=n(I(E.key,E.seed)),a.util.setImmediate(p)}},E.generateSync=function(m){var y=E.plugin.cipher,I=E.plugin.increment,d=E.plugin.formatKey,v=E.plugin.formatSeed;E.key=null;for(var n=a.util.createBuffer();n.length()<m;){E.generated>1048575&&(E.key=null),E.key===null&&u();var f=y(E.key,E.seed);E.generated+=f.length,n.putBytes(f),E.key=d(y(E.key,I(E.seed))),E.seed=v(y(E.key,E.seed))}return n.getBytes(m)};function r(m){if(E.pools[0].messageLength>=32)return x(),m();var y=32-E.pools[0].messageLength<<5;E.seedFile(y,function(I,d){if(I)return m(I);E.collect(d),x(),m()})}function u(){if(E.pools[0].messageLength>=32)return x();var m=32-E.pools[0].messageLength<<5;E.collect(E.seedFileSync(m)),x()}function x(){E.reseeds=E.reseeds===4294967295?0:E.reseeds+1;var m=E.plugin.md.create();m.update(E.keyBytes);for(var y=1,I=0;I<32;++I)E.reseeds%y===0&&(m.update(E.pools[I].digest().getBytes()),E.pools[I].start()),y=y<<1;E.keyBytes=m.digest().getBytes(),m.start(),m.update(E.keyBytes);var d=m.digest().getBytes();E.key=E.plugin.formatKey(E.keyBytes),E.seed=E.plugin.formatSeed(d),E.generated=0}function U(m){var y=null,I=a.util.globalScope,d=I.crypto||I.msCrypto;d&&d.getRandomValues&&(y=function(g){return d.getRandomValues(g)});var v=a.util.createBuffer();if(y)for(;v.length()<m;){var n=Math.max(1,Math.min(m-v.length(),65536)/4),f=new Uint32Array(Math.floor(n));try{y(f);for(var p=0;p<f.length;++p)v.putInt32(f[p])}catch(g){if(!(typeof QuotaExceededError<"u"&&g instanceof QuotaExceededError))throw g}}if(v.length()<m)for(var A,R,k,h=Math.floor(Math.random()*65536);v.length()<m;){R=16807*(h&65535),A=16807*(h>>16),R+=(A&32767)<<16,R+=A>>15,R=(R&2147483647)+(R>>31),h=R&4294967295;for(var p=0;p<3;++p)k=h>>>(p<<3),k^=Math.floor(Math.random()*256),v.putByte(k&255)}return v.getBytes(m)}return e?(E.seedFile=function(m,y){e.randomBytes(m,function(I,d){if(I)return y(I);y(null,d.toString())})},E.seedFileSync=function(m){return e.randomBytes(m).toString()}):(E.seedFile=function(m,y){try{y(null,U(m))}catch(I){y(I)}},E.seedFileSync=U),E.collect=function(m){for(var y=m.length,I=0;I<y;++I)E.pools[E.pool].update(m.substr(I,1)),E.pool=E.pool===31?0:E.pool+1},E.collectInt=function(m,y){for(var I="",d=0;d<y;d+=8)I+=String.fromCharCode(m>>d&255);E.collect(I)},E.registerWorker=function(m){if(m===self)E.seedFile=function(I,d){function v(n){var f=n.data;f.forge&&f.forge.prng&&(self.removeEventListener("message",v),d(f.forge.prng.err,f.forge.prng.bytes))}self.addEventListener("message",v),self.postMessage({forge:{prng:{needed:I}}})};else{var y=function(I){var d=I.data;d.forge&&d.forge.prng&&E.seedFile(d.forge.prng.needed,function(v,n){m.postMessage({forge:{prng:{err:v,bytes:n}}})})};m.addEventListener("message",y)}},E}},42242:(re,ce,V)=>{var a=V(96560);V(2608),V(64687);var e=re.exports=a.pss=a.pss||{};e.create=function(i){arguments.length===3&&(i={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var C=i.md,E=i.mgf,S=C.digestLength,c=i.salt||null;typeof c=="string"&&(c=a.util.createBuffer(c));var l;if("saltLength"in i)l=i.saltLength;else if(c!==null)l=c.length();else throw new Error("Salt length not specified or specific salt not given.");if(c!==null&&c.length()!==l)throw new Error("Given salt length does not match length of given salt.");var r=i.prng||a.random,u={};return u.encode=function(x,U){var m,y=U-1,I=Math.ceil(y/8),d=x.digest().getBytes();if(I<S+l+2)throw new Error("Message is too long to encrypt.");var v;c===null?v=r.getBytesSync(l):v=c.bytes();var n=new a.util.ByteBuffer;n.fillWithByte(0,8),n.putBytes(d),n.putBytes(v),C.start(),C.update(n.getBytes());var f=C.digest().getBytes(),p=new a.util.ByteBuffer;p.fillWithByte(0,I-l-S-2),p.putByte(1),p.putBytes(v);var A=p.getBytes(),R=I-S-1,k=E.generate(f,R),h="";for(m=0;m<R;m++)h+=String.fromCharCode(A.charCodeAt(m)^k.charCodeAt(m));var g=65280>>8*I-y&255;return h=String.fromCharCode(h.charCodeAt(0)&~g)+h.substr(1),h+f+"\xBC"},u.verify=function(x,U,m){var y,I=m-1,d=Math.ceil(I/8);if(U=U.substr(-d),d<S+l+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(U.charCodeAt(d-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var v=d-S-1,n=U.substr(0,v),f=U.substr(v,S),p=65280>>8*d-I&255;if(n.charCodeAt(0)&p)throw new Error("Bits beyond keysize not zero as expected.");var A=E.generate(f,v),R="";for(y=0;y<v;y++)R+=String.fromCharCode(n.charCodeAt(y)^A.charCodeAt(y));R=String.fromCharCode(R.charCodeAt(0)&~p)+R.substr(1);var k=d-S-l-2;for(y=0;y<k;y++)if(R.charCodeAt(y)!==0)throw new Error("Leftmost octets not zero as expected");if(R.charCodeAt(k)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var h=R.substr(-l),g=new a.util.ByteBuffer;g.fillWithByte(0,8),g.putBytes(x),g.putBytes(h),C.start(),C.update(g.getBytes());var N=C.digest().getBytes();return f===N},u}},2608:(re,ce,V)=>{var a=V(96560);V(57220),V(25984),V(35002),V(64687),function(){if(a.random&&a.random.getBytes){re.exports=a.random;return}(function(e){var i={},C=new Array(4),E=a.util.createBuffer();i.formatKey=function(m){var y=a.util.createBuffer(m);return m=new Array(4),m[0]=y.getInt32(),m[1]=y.getInt32(),m[2]=y.getInt32(),m[3]=y.getInt32(),a.aes._expandKey(m,!1)},i.formatSeed=function(m){var y=a.util.createBuffer(m);return m=new Array(4),m[0]=y.getInt32(),m[1]=y.getInt32(),m[2]=y.getInt32(),m[3]=y.getInt32(),m},i.cipher=function(m,y){return a.aes._updateBlock(m,y,C,!1),E.putInt32(C[0]),E.putInt32(C[1]),E.putInt32(C[2]),E.putInt32(C[3]),E.getBytes()},i.increment=function(m){return++m[3],m},i.md=a.md.sha256;function S(){var m=a.prng.create(i);return m.getBytes=function(y,I){return m.generate(y,I)},m.getBytesSync=function(y){return m.generate(y)},m}var c=S(),l=null,r=a.util.globalScope,u=r.crypto||r.msCrypto;if(u&&u.getRandomValues&&(l=function(m){return u.getRandomValues(m)}),a.options.usePureJavaScript||!a.util.isNodejs&&!l){if(typeof window>"u"||window.document,c.collectInt(+new Date,32),typeof navigator<"u"){var x="";for(var U in navigator)try{typeof navigator[U]=="string"&&(x+=navigator[U])}catch{}c.collect(x),x=null}e&&(e().mousemove(function(m){c.collectInt(m.clientX,16),c.collectInt(m.clientY,16)}),e().keypress(function(m){c.collectInt(m.charCode,8)}))}if(!a.random)a.random=c;else for(var U in c)a.random[U]=c[U];a.random.createInstance=S,re.exports=a.random})(typeof jQuery<"u"?jQuery:null)}()},35568:(re,ce,V)=>{var a=V(96560);V(64687);var e=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],i=[1,2,3,5],C=function(c,l){return c<<l&65535|(c&65535)>>16-l},E=function(c,l){return(c&65535)>>l|c<<16-l&65535};re.exports=a.rc2=a.rc2||{},a.rc2.expandKey=function(c,l){typeof c=="string"&&(c=a.util.createBuffer(c)),l=l||128;var r=c,u=c.length(),x=l,U=Math.ceil(x/8),m=255>>(x&7),y;for(y=u;y<128;y++)r.putByte(e[r.at(y-1)+r.at(y-u)&255]);for(r.setAt(128-U,e[r.at(128-U)&m]),y=127-U;y>=0;y--)r.setAt(y,e[r.at(y+1)^r.at(y+U)]);return r};var S=function(c,l,r){var u=!1,x=null,U=null,m=null,y,I,d,v,n=[];for(c=a.rc2.expandKey(c,l),d=0;d<64;d++)n.push(c.getInt16Le());r?(y=function(A){for(d=0;d<4;d++)A[d]+=n[v]+(A[(d+3)%4]&A[(d+2)%4])+(~A[(d+3)%4]&A[(d+1)%4]),A[d]=C(A[d],i[d]),v++},I=function(A){for(d=0;d<4;d++)A[d]+=n[A[(d+3)%4]&63]}):(y=function(A){for(d=3;d>=0;d--)A[d]=E(A[d],i[d]),A[d]-=n[v]+(A[(d+3)%4]&A[(d+2)%4])+(~A[(d+3)%4]&A[(d+1)%4]),v--},I=function(A){for(d=3;d>=0;d--)A[d]-=n[A[(d+3)%4]&63]});var f=function(A){var R=[];for(d=0;d<4;d++){var k=x.getInt16Le();m!==null&&(r?k^=m.getInt16Le():m.putInt16Le(k)),R.push(k&65535)}v=r?0:63;for(var h=0;h<A.length;h++)for(var g=0;g<A[h][0];g++)A[h][1](R);for(d=0;d<4;d++)m!==null&&(r?m.putInt16Le(R[d]):R[d]^=m.getInt16Le()),U.putInt16Le(R[d])},p=null;return p={start:function(A,R){A&&typeof A=="string"&&(A=a.util.createBuffer(A)),u=!1,x=a.util.createBuffer(),U=R||new a.util.createBuffer,m=A,p.output=U},update:function(A){for(u||x.putBuffer(A);x.length()>=8;)f([[5,y],[1,I],[6,y],[1,I],[5,y]])},finish:function(A){var R=!0;if(r)if(A)R=A(8,x,!r);else{var k=x.length()===8?8:8-x.length();x.fillWithByte(k,k)}if(R&&(u=!0,p.update()),!r&&(R=x.length()===0,R))if(A)R=A(8,U,!r);else{var h=U.length(),g=U.at(h-1);g>h?R=!1:U.truncate(g)}return R}},p};a.rc2.startEncrypting=function(c,l,r){var u=a.rc2.createEncryptionCipher(c,128);return u.start(l,r),u},a.rc2.createEncryptionCipher=function(c,l){return S(c,l,!0)},a.rc2.startDecrypting=function(c,l,r){var u=a.rc2.createDecryptionCipher(c,128);return u.start(l,r),u},a.rc2.createDecryptionCipher=function(c,l){return S(c,l,!1)}},13865:(re,ce,V)=>{var a=V(96560);if(V(19462),V(35156),V(4646),V(4745),V(43704),V(2608),V(64687),typeof e>"u")var e=a.jsbn.BigInteger;var i=a.util.isNodejs?V(50310):null,C=a.asn1,E=a.util;a.pki=a.pki||{},re.exports=a.pki.rsa=a.rsa=a.rsa||{};var S=a.pki,c=[6,4,2,4,2,4,6,2],l={name:"PrivateKeyInfo",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:C.Class.UNIVERSAL,type:C.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:C.Class.UNIVERSAL,type:C.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:C.Class.UNIVERSAL,type:C.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},r={name:"RSAPrivateKey",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:C.Class.UNIVERSAL,type:C.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:C.Class.UNIVERSAL,type:C.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:C.Class.UNIVERSAL,type:C.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:C.Class.UNIVERSAL,type:C.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:C.Class.UNIVERSAL,type:C.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:C.Class.UNIVERSAL,type:C.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:C.Class.UNIVERSAL,type:C.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:C.Class.UNIVERSAL,type:C.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:C.Class.UNIVERSAL,type:C.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},u={name:"RSAPublicKey",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:C.Class.UNIVERSAL,type:C.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:C.Class.UNIVERSAL,type:C.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},x=a.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:C.Class.UNIVERSAL,type:C.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:C.Class.UNIVERSAL,type:C.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},U={name:"DigestInfo",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:C.Class.UNIVERSAL,type:C.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:C.Class.UNIVERSAL,type:C.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:C.Class.UNIVERSAL,type:C.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},m=function(t){var L;if(t.algorithm in S.oids)L=S.oids[t.algorithm];else{var O=new Error("Unknown message digest algorithm.");throw O.algorithm=t.algorithm,O}var w=C.oidToDer(L).getBytes(),M=C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[]),K=C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[]);K.value.push(C.create(C.Class.UNIVERSAL,C.Type.OID,!1,w)),K.value.push(C.create(C.Class.UNIVERSAL,C.Type.NULL,!1,""));var G=C.create(C.Class.UNIVERSAL,C.Type.OCTETSTRING,!1,t.digest().getBytes());return M.value.push(K),M.value.push(G),C.toDer(M).getBytes()},y=function(t,L,O){if(O)return t.modPow(L.e,L.n);if(!L.p||!L.q)return t.modPow(L.d,L.n);L.dP||(L.dP=L.d.mod(L.p.subtract(e.ONE))),L.dQ||(L.dQ=L.d.mod(L.q.subtract(e.ONE))),L.qInv||(L.qInv=L.q.modInverse(L.p));var w;do w=new e(a.util.bytesToHex(a.random.getBytes(L.n.bitLength()/8)),16);while(w.compareTo(L.n)>=0||!w.gcd(L.n).equals(e.ONE));t=t.multiply(w.modPow(L.e,L.n)).mod(L.n);for(var M=t.mod(L.p).modPow(L.dP,L.p),K=t.mod(L.q).modPow(L.dQ,L.q);M.compareTo(K)<0;)M=M.add(L.p);var G=M.subtract(K).multiply(L.qInv).mod(L.p).multiply(L.q).add(K);return G=G.multiply(w.modInverse(L.n)).mod(L.n),G};S.rsa.encrypt=function(t,L,O){var w=O,M,K=Math.ceil(L.n.bitLength()/8);O!==!1&&O!==!0?(w=O===2,M=I(t,L,O)):(M=a.util.createBuffer(),M.putBytes(t));for(var G=new e(M.toHex(),16),X=y(G,L,w),W=X.toString(16),q=a.util.createBuffer(),te=K-Math.ceil(W.length/2);te>0;)q.putByte(0),--te;return q.putBytes(a.util.hexToBytes(W)),q.getBytes()},S.rsa.decrypt=function(t,L,O,w){var M=Math.ceil(L.n.bitLength()/8);if(t.length!==M){var K=new Error("Encrypted message length is invalid.");throw K.length=t.length,K.expected=M,K}var G=new e(a.util.createBuffer(t).toHex(),16);if(G.compareTo(L.n)>=0)throw new Error("Encrypted message is invalid.");for(var X=y(G,L,O),W=X.toString(16),q=a.util.createBuffer(),te=M-Math.ceil(W.length/2);te>0;)q.putByte(0),--te;return q.putBytes(a.util.hexToBytes(W)),w!==!1?d(q.getBytes(),L,O):q.getBytes()},S.rsa.createKeyPairGenerationState=function(t,L,O){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,O=O||{};var w=O.prng||a.random,M={nextBytes:function(X){for(var W=w.getBytesSync(X.length),q=0;q<X.length;++q)X[q]=W.charCodeAt(q)}},K=O.algorithm||"PRIMEINC",G;if(K==="PRIMEINC")G={algorithm:K,state:0,bits:t,rng:M,eInt:L||65537,e:new e(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},G.e.fromInt(G.eInt);else throw new Error("Invalid key generation algorithm: "+K);return G},S.rsa.stepKeyPairGenerationState=function(t,L){"algorithm"in t||(t.algorithm="PRIMEINC");var O=new e(null);O.fromInt(30);for(var w=0,M=function(fe,he){return fe|he},K=+new Date,G,X=0;t.keys===null&&(L<=0||X<L);){if(t.state===0){var W=t.p===null?t.pBits:t.qBits,q=W-1;t.pqState===0?(t.num=new e(W,t.rng),t.num.testBit(q)||t.num.bitwiseTo(e.ONE.shiftLeft(q),M,t.num),t.num.dAddOffset(31-t.num.mod(O).byteValue(),0),w=0,++t.pqState):t.pqState===1?t.num.bitLength()>W?t.pqState=0:t.num.isProbablePrime(f(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(c[w++%8],0):t.pqState===2?t.pqState=t.num.subtract(e.ONE).gcd(t.e).compareTo(e.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(e.ONE),t.q1=t.q.subtract(e.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(e.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var te=t.e.modInverse(t.phi);t.keys={privateKey:S.rsa.setPrivateKey(t.n,t.e,te,t.p,t.q,te.mod(t.p1),te.mod(t.q1),t.q.modInverse(t.p)),publicKey:S.rsa.setPublicKey(t.n,t.e)}}G=+new Date,X+=G-K,K=G}return t.keys!==null},S.rsa.generateKeyPair=function(t,L,O,w){if(arguments.length===1?typeof t=="object"?(O=t,t=void 0):typeof t=="function"&&(w=t,t=void 0):arguments.length===2?typeof t=="number"?typeof L=="function"?(w=L,L=void 0):typeof L!="number"&&(O=L,L=void 0):(O=t,w=L,t=void 0,L=void 0):arguments.length===3&&(typeof L=="number"?typeof O=="function"&&(w=O,O=void 0):(w=O,O=L,L=void 0)),O=O||{},t===void 0&&(t=O.bits||2048),L===void 0&&(L=O.e||65537),!a.options.usePureJavaScript&&!O.prng&&t>=256&&t<=16384&&(L===65537||L===3)){if(w){if(p("generateKeyPair"))return i.generateKeyPair("rsa",{modulusLength:t,publicExponent:L,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(X,W,q){if(X)return w(X);w(null,{privateKey:S.privateKeyFromPem(q),publicKey:S.publicKeyFromPem(W)})});if(A("generateKey")&&A("exportKey"))return E.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:k(L),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(X){return E.globalScope.crypto.subtle.exportKey("pkcs8",X.privateKey)}).then(void 0,function(X){w(X)}).then(function(X){if(X){var W=S.privateKeyFromAsn1(C.fromDer(a.util.createBuffer(X)));w(null,{privateKey:W,publicKey:S.setRsaPublicKey(W.n,W.e)})}});if(R("generateKey")&&R("exportKey")){var M=E.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:k(L),hash:{name:"SHA-256"}},!0,["sign","verify"]);M.oncomplete=function(X){var W=X.target.result,q=E.globalScope.msCrypto.subtle.exportKey("pkcs8",W.privateKey);q.oncomplete=function(te){var fe=te.target.result,he=S.privateKeyFromAsn1(C.fromDer(a.util.createBuffer(fe)));w(null,{privateKey:he,publicKey:S.setRsaPublicKey(he.n,he.e)})},q.onerror=function(te){w(te)}},M.onerror=function(X){w(X)};return}}else if(p("generateKeyPairSync")){var K=i.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:L,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:S.privateKeyFromPem(K.privateKey),publicKey:S.publicKeyFromPem(K.publicKey)}}}var G=S.rsa.createKeyPairGenerationState(t,L,O);if(!w)return S.rsa.stepKeyPairGenerationState(G,0),G.keys;v(G,O,w)},S.setRsaPublicKey=S.rsa.setPublicKey=function(t,L){var O={n:t,e:L};return O.encrypt=function(w,M,K){if(typeof M=="string"?M=M.toUpperCase():M===void 0&&(M="RSAES-PKCS1-V1_5"),M==="RSAES-PKCS1-V1_5")M={encode:function(X,W,q){return I(X,W,2).getBytes()}};else if(M==="RSA-OAEP"||M==="RSAES-OAEP")M={encode:function(X,W){return a.pkcs1.encode_rsa_oaep(W,X,K)}};else if(["RAW","NONE","NULL",null].indexOf(M)!==-1)M={encode:function(X){return X}};else if(typeof M=="string")throw new Error('Unsupported encryption scheme: "'+M+'".');var G=M.encode(w,O,!0);return S.rsa.encrypt(G,O,!0)},O.verify=function(w,M,K,G){typeof K=="string"?K=K.toUpperCase():K===void 0&&(K="RSASSA-PKCS1-V1_5"),G===void 0&&(G={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in G||(G._parseAllDigestBytes=!0),K==="RSASSA-PKCS1-V1_5"?K={verify:function(W,q){q=d(q,O,!0);var te=C.fromDer(q,{parseAllBytes:G._parseAllDigestBytes}),fe={},he=[];if(!C.validate(te,U,fe,he)){var pe=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw pe.errors=he,pe}var J=C.derToOid(fe.algorithmIdentifier);if(!(J===a.oids.md2||J===a.oids.md5||J===a.oids.sha1||J===a.oids.sha224||J===a.oids.sha256||J===a.oids.sha384||J===a.oids.sha512||J===a.oids["sha512-224"]||J===a.oids["sha512-256"])){var pe=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw pe.oid=J,pe}if((J===a.oids.md2||J===a.oids.md5)&&!("parameters"in fe))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return W===fe.digest}}:(K==="NONE"||K==="NULL"||K===null)&&(K={verify:function(W,q){return q=d(q,O,!0),W===q}});var X=S.rsa.decrypt(M,O,!0,!1);return K.verify(w,X,O.n.bitLength())},O},S.setRsaPrivateKey=S.rsa.setPrivateKey=function(t,L,O,w,M,K,G,X){var W={n:t,e:L,d:O,p:w,q:M,dP:K,dQ:G,qInv:X};return W.decrypt=function(q,te,fe){typeof te=="string"?te=te.toUpperCase():te===void 0&&(te="RSAES-PKCS1-V1_5");var he=S.rsa.decrypt(q,W,!1,!1);if(te==="RSAES-PKCS1-V1_5")te={decode:d};else if(te==="RSA-OAEP"||te==="RSAES-OAEP")te={decode:function(pe,J){return a.pkcs1.decode_rsa_oaep(J,pe,fe)}};else if(["RAW","NONE","NULL",null].indexOf(te)!==-1)te={decode:function(pe){return pe}};else throw new Error('Unsupported encryption scheme: "'+te+'".');return te.decode(he,W,!1)},W.sign=function(q,te){var fe=!1;typeof te=="string"&&(te=te.toUpperCase()),te===void 0||te==="RSASSA-PKCS1-V1_5"?(te={encode:m},fe=1):(te==="NONE"||te==="NULL"||te===null)&&(te={encode:function(){return q}},fe=1);var he=te.encode(q,W.n.bitLength());return S.rsa.encrypt(he,W,fe)},W},S.wrapRsaPrivateKey=function(t){return C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,C.integerToDer(0).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(S.oids.rsaEncryption).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.NULL,!1,"")]),C.create(C.Class.UNIVERSAL,C.Type.OCTETSTRING,!1,C.toDer(t).getBytes())])},S.privateKeyFromAsn1=function(t){var L={},O=[];if(C.validate(t,l,L,O)&&(t=C.fromDer(a.util.createBuffer(L.privateKey))),L={},O=[],!C.validate(t,r,L,O)){var w=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw w.errors=O,w}var M,K,G,X,W,q,te,fe;return M=a.util.createBuffer(L.privateKeyModulus).toHex(),K=a.util.createBuffer(L.privateKeyPublicExponent).toHex(),G=a.util.createBuffer(L.privateKeyPrivateExponent).toHex(),X=a.util.createBuffer(L.privateKeyPrime1).toHex(),W=a.util.createBuffer(L.privateKeyPrime2).toHex(),q=a.util.createBuffer(L.privateKeyExponent1).toHex(),te=a.util.createBuffer(L.privateKeyExponent2).toHex(),fe=a.util.createBuffer(L.privateKeyCoefficient).toHex(),S.setRsaPrivateKey(new e(M,16),new e(K,16),new e(G,16),new e(X,16),new e(W,16),new e(q,16),new e(te,16),new e(fe,16))},S.privateKeyToAsn1=S.privateKeyToRSAPrivateKey=function(t){return C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,C.integerToDer(0).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,n(t.n)),C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,n(t.e)),C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,n(t.d)),C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,n(t.p)),C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,n(t.q)),C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,n(t.dP)),C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,n(t.dQ)),C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,n(t.qInv))])},S.publicKeyFromAsn1=function(t){var L={},O=[];if(C.validate(t,x,L,O)){var w=C.derToOid(L.publicKeyOid);if(w!==S.oids.rsaEncryption){var M=new Error("Cannot read public key. Unknown OID.");throw M.oid=w,M}t=L.rsaPublicKey}if(O=[],!C.validate(t,u,L,O)){var M=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw M.errors=O,M}var K=a.util.createBuffer(L.publicKeyModulus).toHex(),G=a.util.createBuffer(L.publicKeyExponent).toHex();return S.setRsaPublicKey(new e(K,16),new e(G,16))},S.publicKeyToAsn1=S.publicKeyToSubjectPublicKeyInfo=function(t){return C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(S.oids.rsaEncryption).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.NULL,!1,"")]),C.create(C.Class.UNIVERSAL,C.Type.BITSTRING,!1,[S.publicKeyToRSAPublicKey(t)])])},S.publicKeyToRSAPublicKey=function(t){return C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,n(t.n)),C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,n(t.e))])};function I(t,L,O){var w=a.util.createBuffer(),M=Math.ceil(L.n.bitLength()/8);if(t.length>M-11){var K=new Error("Message is too long for PKCS#1 v1.5 padding.");throw K.length=t.length,K.max=M-11,K}w.putByte(0),w.putByte(O);var G=M-3-t.length,X;if(O===0||O===1){X=O===0?0:255;for(var W=0;W<G;++W)w.putByte(X)}else for(;G>0;){for(var q=0,te=a.random.getBytes(G),W=0;W<G;++W)X=te.charCodeAt(W),X===0?++q:w.putByte(X);G=q}return w.putByte(0),w.putBytes(t),w}function d(t,L,O,w){var M=Math.ceil(L.n.bitLength()/8),K=a.util.createBuffer(t),G=K.getByte(),X=K.getByte();if(G!==0||O&&X!==0&&X!==1||!O&&X!=2||O&&X===0&&typeof w>"u")throw new Error("Encryption block is invalid.");var W=0;if(X===0){W=M-3-w;for(var q=0;q<W;++q)if(K.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(X===1)for(W=0;K.length()>1;){if(K.getByte()!==255){--K.read;break}++W}else if(X===2)for(W=0;K.length()>1;){if(K.getByte()===0){--K.read;break}++W}var te=K.getByte();if(te!==0||W!==M-3-K.length())throw new Error("Encryption block is invalid.");return K.getBytes()}function v(t,L,O){typeof L=="function"&&(O=L,L={}),L=L||{};var w={algorithm:{name:L.algorithm||"PRIMEINC",options:{workers:L.workers||2,workLoad:L.workLoad||100,workerScript:L.workerScript}}};"prng"in L&&(w.prng=L.prng),M();function M(){K(t.pBits,function(X,W){if(X)return O(X);if(t.p=W,t.q!==null)return G(X,t.q);K(t.qBits,G)})}function K(X,W){a.prime.generateProbablePrime(X,w,W)}function G(X,W){if(X)return O(X);if(t.q=W,t.p.compareTo(t.q)<0){var q=t.p;t.p=t.q,t.q=q}if(t.p.subtract(e.ONE).gcd(t.e).compareTo(e.ONE)!==0){t.p=null,M();return}if(t.q.subtract(e.ONE).gcd(t.e).compareTo(e.ONE)!==0){t.q=null,K(t.qBits,G);return}if(t.p1=t.p.subtract(e.ONE),t.q1=t.q.subtract(e.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(e.ONE)!==0){t.p=t.q=null,M();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,K(t.qBits,G);return}var te=t.e.modInverse(t.phi);t.keys={privateKey:S.rsa.setPrivateKey(t.n,t.e,te,t.p,t.q,te.mod(t.p1),te.mod(t.q1),t.q.modInverse(t.p)),publicKey:S.rsa.setPublicKey(t.n,t.e)},O(null,t.keys)}}function n(t){var L=t.toString(16);L[0]>="8"&&(L="00"+L);var O=a.util.hexToBytes(L);return O.length>1&&(O.charCodeAt(0)===0&&!(O.charCodeAt(1)&128)||O.charCodeAt(0)===255&&(O.charCodeAt(1)&128)===128)?O.substr(1):O}function f(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function p(t){return a.util.isNodejs&&typeof i[t]=="function"}function A(t){return typeof E.globalScope<"u"&&typeof E.globalScope.crypto=="object"&&typeof E.globalScope.crypto.subtle=="object"&&typeof E.globalScope.crypto.subtle[t]=="function"}function R(t){return typeof E.globalScope<"u"&&typeof E.globalScope.msCrypto=="object"&&typeof E.globalScope.msCrypto.subtle=="object"&&typeof E.globalScope.msCrypto.subtle[t]=="function"}function k(t){for(var L=a.util.hexToBytes(t.toString(16)),O=new Uint8Array(L.length),w=0;w<L.length;++w)O[w]=L.charCodeAt(w);return O}function h(t){if(t.kty!=="RSA")throw new Error('Unsupported key algorithm "'+t.kty+'"; algorithm must be "RSA".');return S.setRsaPrivateKey(N(t.n),N(t.e),N(t.d),N(t.p),N(t.q),N(t.dp),N(t.dq),N(t.qi))}function g(t){if(t.kty!=="RSA")throw new Error('Key algorithm must be "RSA".');return S.setRsaPublicKey(N(t.n),N(t.e))}function N(t){return new e(a.util.bytesToHex(a.util.decode64(t)),16)}},34341:(re,ce,V)=>{var a=V(96560);V(31502),V(64687);var e=re.exports=a.sha1=a.sha1||{};a.md.sha1=a.md.algorithms.sha1=e,e.create=function(){C||E();var c=null,l=a.util.createBuffer(),r=new Array(80),u={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return u.start=function(){u.messageLength=0,u.fullMessageLength=u.messageLength64=[];for(var x=u.messageLengthSize/4,U=0;U<x;++U)u.fullMessageLength.push(0);return l=a.util.createBuffer(),c={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},u},u.start(),u.update=function(x,U){U==="utf8"&&(x=a.util.encodeUtf8(x));var m=x.length;u.messageLength+=m,m=[m/4294967296>>>0,m>>>0];for(var y=u.fullMessageLength.length-1;y>=0;--y)u.fullMessageLength[y]+=m[1],m[1]=m[0]+(u.fullMessageLength[y]/4294967296>>>0),u.fullMessageLength[y]=u.fullMessageLength[y]>>>0,m[0]=m[1]/4294967296>>>0;return l.putBytes(x),S(c,r,l),(l.read>2048||l.length()===0)&&l.compact(),u},u.digest=function(){var x=a.util.createBuffer();x.putBytes(l.bytes());var U=u.fullMessageLength[u.fullMessageLength.length-1]+u.messageLengthSize,m=U&u.blockLength-1;x.putBytes(i.substr(0,u.blockLength-m));for(var y,I,d=u.fullMessageLength[0]*8,v=0;v<u.fullMessageLength.length-1;++v)y=u.fullMessageLength[v+1]*8,I=y/4294967296>>>0,d+=I,x.putInt32(d>>>0),d=y>>>0;x.putInt32(d);var n={h0:c.h0,h1:c.h1,h2:c.h2,h3:c.h3,h4:c.h4};S(n,r,x);var f=a.util.createBuffer();return f.putInt32(n.h0),f.putInt32(n.h1),f.putInt32(n.h2),f.putInt32(n.h3),f.putInt32(n.h4),f},u};var i=null,C=!1;function E(){i="\x80",i+=a.util.fillString("\0",64),C=!0}function S(c,l,r){for(var u,x,U,m,y,I,d,v,n=r.length();n>=64;){for(x=c.h0,U=c.h1,m=c.h2,y=c.h3,I=c.h4,v=0;v<16;++v)u=r.getInt32(),l[v]=u,d=y^U&(m^y),u=(x<<5|x>>>27)+d+I+1518500249+u,I=y,y=m,m=(U<<30|U>>>2)>>>0,U=x,x=u;for(;v<20;++v)u=l[v-3]^l[v-8]^l[v-14]^l[v-16],u=u<<1|u>>>31,l[v]=u,d=y^U&(m^y),u=(x<<5|x>>>27)+d+I+1518500249+u,I=y,y=m,m=(U<<30|U>>>2)>>>0,U=x,x=u;for(;v<32;++v)u=l[v-3]^l[v-8]^l[v-14]^l[v-16],u=u<<1|u>>>31,l[v]=u,d=U^m^y,u=(x<<5|x>>>27)+d+I+1859775393+u,I=y,y=m,m=(U<<30|U>>>2)>>>0,U=x,x=u;for(;v<40;++v)u=l[v-6]^l[v-16]^l[v-28]^l[v-32],u=u<<2|u>>>30,l[v]=u,d=U^m^y,u=(x<<5|x>>>27)+d+I+1859775393+u,I=y,y=m,m=(U<<30|U>>>2)>>>0,U=x,x=u;for(;v<60;++v)u=l[v-6]^l[v-16]^l[v-28]^l[v-32],u=u<<2|u>>>30,l[v]=u,d=U&m|y&(U^m),u=(x<<5|x>>>27)+d+I+2400959708+u,I=y,y=m,m=(U<<30|U>>>2)>>>0,U=x,x=u;for(;v<80;++v)u=l[v-6]^l[v-16]^l[v-28]^l[v-32],u=u<<2|u>>>30,l[v]=u,d=U^m^y,u=(x<<5|x>>>27)+d+I+3395469782+u,I=y,y=m,m=(U<<30|U>>>2)>>>0,U=x,x=u;c.h0=c.h0+x|0,c.h1=c.h1+U|0,c.h2=c.h2+m|0,c.h3=c.h3+y|0,c.h4=c.h4+I|0,n-=64}}},25984:(re,ce,V)=>{var a=V(96560);V(31502),V(64687);var e=re.exports=a.sha256=a.sha256||{};a.md.sha256=a.md.algorithms.sha256=e,e.create=function(){C||S();var l=null,r=a.util.createBuffer(),u=new Array(64),x={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return x.start=function(){x.messageLength=0,x.fullMessageLength=x.messageLength64=[];for(var U=x.messageLengthSize/4,m=0;m<U;++m)x.fullMessageLength.push(0);return r=a.util.createBuffer(),l={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},x},x.start(),x.update=function(U,m){m==="utf8"&&(U=a.util.encodeUtf8(U));var y=U.length;x.messageLength+=y,y=[y/4294967296>>>0,y>>>0];for(var I=x.fullMessageLength.length-1;I>=0;--I)x.fullMessageLength[I]+=y[1],y[1]=y[0]+(x.fullMessageLength[I]/4294967296>>>0),x.fullMessageLength[I]=x.fullMessageLength[I]>>>0,y[0]=y[1]/4294967296>>>0;return r.putBytes(U),c(l,u,r),(r.read>2048||r.length()===0)&&r.compact(),x},x.digest=function(){var U=a.util.createBuffer();U.putBytes(r.bytes());var m=x.fullMessageLength[x.fullMessageLength.length-1]+x.messageLengthSize,y=m&x.blockLength-1;U.putBytes(i.substr(0,x.blockLength-y));for(var I,d,v=x.fullMessageLength[0]*8,n=0;n<x.fullMessageLength.length-1;++n)I=x.fullMessageLength[n+1]*8,d=I/4294967296>>>0,v+=d,U.putInt32(v>>>0),v=I>>>0;U.putInt32(v);var f={h0:l.h0,h1:l.h1,h2:l.h2,h3:l.h3,h4:l.h4,h5:l.h5,h6:l.h6,h7:l.h7};c(f,u,U);var p=a.util.createBuffer();return p.putInt32(f.h0),p.putInt32(f.h1),p.putInt32(f.h2),p.putInt32(f.h3),p.putInt32(f.h4),p.putInt32(f.h5),p.putInt32(f.h6),p.putInt32(f.h7),p},x};var i=null,C=!1,E=null;function S(){i="\x80",i+=a.util.fillString("\0",64),E=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],C=!0}function c(l,r,u){for(var x,U,m,y,I,d,v,n,f,p,A,R,k,h,g,N=u.length();N>=64;){for(v=0;v<16;++v)r[v]=u.getInt32();for(;v<64;++v)x=r[v-2],x=(x>>>17|x<<15)^(x>>>19|x<<13)^x>>>10,U=r[v-15],U=(U>>>7|U<<25)^(U>>>18|U<<14)^U>>>3,r[v]=x+r[v-7]+U+r[v-16]|0;for(n=l.h0,f=l.h1,p=l.h2,A=l.h3,R=l.h4,k=l.h5,h=l.h6,g=l.h7,v=0;v<64;++v)y=(R>>>6|R<<26)^(R>>>11|R<<21)^(R>>>25|R<<7),I=h^R&(k^h),m=(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10),d=n&f|p&(n^f),x=g+y+I+E[v]+r[v],U=m+d,g=h,h=k,k=R,R=A+x>>>0,A=p,p=f,f=n,n=x+U>>>0;l.h0=l.h0+n|0,l.h1=l.h1+f|0,l.h2=l.h2+p|0,l.h3=l.h3+A|0,l.h4=l.h4+R|0,l.h5=l.h5+k|0,l.h6=l.h6+h|0,l.h7=l.h7+g|0,N-=64}}},6677:(re,ce,V)=>{var a=V(96560);V(31502),V(64687);var e=re.exports=a.sha512=a.sha512||{};a.md.sha512=a.md.algorithms.sha512=e;var i=a.sha384=a.sha512.sha384=a.sha512.sha384||{};i.create=function(){return e.create("SHA-384")},a.md.sha384=a.md.algorithms.sha384=i,a.sha512.sha256=a.sha512.sha256||{create:function(){return e.create("SHA-512/256")}},a.md["sha512/256"]=a.md.algorithms["sha512/256"]=a.sha512.sha256,a.sha512.sha224=a.sha512.sha224||{create:function(){return e.create("SHA-512/224")}},a.md["sha512/224"]=a.md.algorithms["sha512/224"]=a.sha512.sha224,e.create=function(u){if(E||l(),typeof u>"u"&&(u="SHA-512"),!(u in c))throw new Error("Invalid SHA-512 algorithm: "+u);for(var x=c[u],U=null,m=a.util.createBuffer(),y=new Array(80),I=0;I<80;++I)y[I]=new Array(2);var d=64;switch(u){case"SHA-384":d=48;break;case"SHA-512/256":d=32;break;case"SHA-512/224":d=28;break}var v={algorithm:u.replace("-","").toLowerCase(),blockLength:128,digestLength:d,messageLength:0,fullMessageLength:null,messageLengthSize:16};return v.start=function(){v.messageLength=0,v.fullMessageLength=v.messageLength128=[];for(var n=v.messageLengthSize/4,f=0;f<n;++f)v.fullMessageLength.push(0);m=a.util.createBuffer(),U=new Array(x.length);for(var f=0;f<x.length;++f)U[f]=x[f].slice(0);return v},v.start(),v.update=function(n,f){f==="utf8"&&(n=a.util.encodeUtf8(n));var p=n.length;v.messageLength+=p,p=[p/4294967296>>>0,p>>>0];for(var A=v.fullMessageLength.length-1;A>=0;--A)v.fullMessageLength[A]+=p[1],p[1]=p[0]+(v.fullMessageLength[A]/4294967296>>>0),v.fullMessageLength[A]=v.fullMessageLength[A]>>>0,p[0]=p[1]/4294967296>>>0;return m.putBytes(n),r(U,y,m),(m.read>2048||m.length()===0)&&m.compact(),v},v.digest=function(){var n=a.util.createBuffer();n.putBytes(m.bytes());var f=v.fullMessageLength[v.fullMessageLength.length-1]+v.messageLengthSize,p=f&v.blockLength-1;n.putBytes(C.substr(0,v.blockLength-p));for(var A,R,k=v.fullMessageLength[0]*8,h=0;h<v.fullMessageLength.length-1;++h)A=v.fullMessageLength[h+1]*8,R=A/4294967296>>>0,k+=R,n.putInt32(k>>>0),k=A>>>0;n.putInt32(k);for(var g=new Array(U.length),h=0;h<U.length;++h)g[h]=U[h].slice(0);r(g,y,n);var N=a.util.createBuffer(),t;u==="SHA-512"?t=g.length:u==="SHA-384"?t=g.length-2:t=g.length-4;for(var h=0;h<t;++h)N.putInt32(g[h][0]),(h!==t-1||u!=="SHA-512/224")&&N.putInt32(g[h][1]);return N},v};var C=null,E=!1,S=null,c=null;function l(){C="\x80",C+=a.util.fillString("\0",128),S=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],c={},c["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],c["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],c["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],c["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],E=!0}function r(u,x,U){for(var m,y,I,d,v,n,f,p,A,R,k,h,g,N,t,L,O,w,M,K,G,X,W,q,te,fe,he,pe,J,me,ie,ge,ve,z,Q,o=U.length();o>=128;){for(J=0;J<16;++J)x[J][0]=U.getInt32()>>>0,x[J][1]=U.getInt32()>>>0;for(;J<80;++J)ge=x[J-2],me=ge[0],ie=ge[1],m=((me>>>19|ie<<13)^(ie>>>29|me<<3)^me>>>6)>>>0,y=((me<<13|ie>>>19)^(ie<<3|me>>>29)^(me<<26|ie>>>6))>>>0,z=x[J-15],me=z[0],ie=z[1],I=((me>>>1|ie<<31)^(me>>>8|ie<<24)^me>>>7)>>>0,d=((me<<31|ie>>>1)^(me<<24|ie>>>8)^(me<<25|ie>>>7))>>>0,ve=x[J-7],Q=x[J-16],ie=y+ve[1]+d+Q[1],x[J][0]=m+ve[0]+I+Q[0]+(ie/4294967296>>>0)>>>0,x[J][1]=ie>>>0;for(g=u[0][0],N=u[0][1],t=u[1][0],L=u[1][1],O=u[2][0],w=u[2][1],M=u[3][0],K=u[3][1],G=u[4][0],X=u[4][1],W=u[5][0],q=u[5][1],te=u[6][0],fe=u[6][1],he=u[7][0],pe=u[7][1],J=0;J<80;++J)f=((G>>>14|X<<18)^(G>>>18|X<<14)^(X>>>9|G<<23))>>>0,p=((G<<18|X>>>14)^(G<<14|X>>>18)^(X<<23|G>>>9))>>>0,A=(te^G&(W^te))>>>0,R=(fe^X&(q^fe))>>>0,v=((g>>>28|N<<4)^(N>>>2|g<<30)^(N>>>7|g<<25))>>>0,n=((g<<4|N>>>28)^(N<<30|g>>>2)^(N<<25|g>>>7))>>>0,k=(g&t|O&(g^t))>>>0,h=(N&L|w&(N^L))>>>0,ie=pe+p+R+S[J][1]+x[J][1],m=he+f+A+S[J][0]+x[J][0]+(ie/4294967296>>>0)>>>0,y=ie>>>0,ie=n+h,I=v+k+(ie/4294967296>>>0)>>>0,d=ie>>>0,he=te,pe=fe,te=W,fe=q,W=G,q=X,ie=K+y,G=M+m+(ie/4294967296>>>0)>>>0,X=ie>>>0,M=O,K=w,O=t,w=L,t=g,L=N,ie=y+d,g=m+I+(ie/4294967296>>>0)>>>0,N=ie>>>0;ie=u[0][1]+N,u[0][0]=u[0][0]+g+(ie/4294967296>>>0)>>>0,u[0][1]=ie>>>0,ie=u[1][1]+L,u[1][0]=u[1][0]+t+(ie/4294967296>>>0)>>>0,u[1][1]=ie>>>0,ie=u[2][1]+w,u[2][0]=u[2][0]+O+(ie/4294967296>>>0)>>>0,u[2][1]=ie>>>0,ie=u[3][1]+K,u[3][0]=u[3][0]+M+(ie/4294967296>>>0)>>>0,u[3][1]=ie>>>0,ie=u[4][1]+X,u[4][0]=u[4][0]+G+(ie/4294967296>>>0)>>>0,u[4][1]=ie>>>0,ie=u[5][1]+q,u[5][0]=u[5][0]+W+(ie/4294967296>>>0)>>>0,u[5][1]=ie>>>0,ie=u[6][1]+fe,u[6][0]=u[6][0]+te+(ie/4294967296>>>0)>>>0,u[6][1]=ie>>>0,ie=u[7][1]+pe,u[7][0]=u[7][0]+he+(ie/4294967296>>>0)>>>0,u[7][1]=ie>>>0,o-=128}}},48769:(re,ce,V)=>{var a=V(96560);V(57220),V(6252),V(98311),V(34341),V(64687);var e=re.exports=a.ssh=a.ssh||{};e.privateKeyToPutty=function(S,c,l){l=l||"",c=c||"";var r="ssh-rsa",u=c===""?"none":"aes256-cbc",x="PuTTY-User-Key-File-2: "+r+`\r
`;x+="Encryption: "+u+`\r
`,x+="Comment: "+l+`\r
`;var U=a.util.createBuffer();C(U,r),i(U,S.e),i(U,S.n);var m=a.util.encode64(U.bytes(),64),y=Math.floor(m.length/66)+1;x+="Public-Lines: "+y+`\r
`,x+=m;var I=a.util.createBuffer();i(I,S.d),i(I,S.p),i(I,S.q),i(I,S.qInv);var d;if(!c)d=a.util.encode64(I.bytes(),64);else{var v=I.length()+16-1;v-=v%16;var n=E(I.bytes());n.truncate(n.length()-v+I.length()),I.putBuffer(n);var f=a.util.createBuffer();f.putBuffer(E("\0\0\0\0",c)),f.putBuffer(E("\0\0\0",c));var p=a.aes.createEncryptionCipher(f.truncate(8),"CBC");p.start(a.util.createBuffer().fillWithByte(0,16)),p.update(I.copy()),p.finish();var A=p.output;A.truncate(16),d=a.util.encode64(A.bytes(),64)}y=Math.floor(d.length/66)+1,x+=`\r
Private-Lines: `+y+`\r
`,x+=d;var R=E("putty-private-key-file-mac-key",c),k=a.util.createBuffer();C(k,r),C(k,u),C(k,l),k.putInt32(U.length()),k.putBuffer(U),k.putInt32(I.length()),k.putBuffer(I);var h=a.hmac.create();return h.start("sha1",R),h.update(k.bytes()),x+=`\r
Private-MAC: `+h.digest().toHex()+`\r
`,x},e.publicKeyToOpenSSH=function(S,c){var l="ssh-rsa";c=c||"";var r=a.util.createBuffer();return C(r,l),i(r,S.e),i(r,S.n),l+" "+a.util.encode64(r.bytes())+" "+c},e.privateKeyToOpenSSH=function(S,c){return c?a.pki.encryptRsaPrivateKey(S,c,{legacy:!0,algorithm:"aes128"}):a.pki.privateKeyToPem(S)},e.getPublicKeyFingerprint=function(S,c){c=c||{};var l=c.md||a.md.md5.create(),r="ssh-rsa",u=a.util.createBuffer();C(u,r),i(u,S.e),i(u,S.n),l.start(),l.update(u.getBytes());var x=l.digest();if(c.encoding==="hex"){var U=x.toHex();return c.delimiter?U.match(/.{2}/g).join(c.delimiter):U}else{if(c.encoding==="binary")return x.getBytes();if(c.encoding)throw new Error('Unknown encoding "'+c.encoding+'".')}return x};function i(S,c){var l=c.toString(16);l[0]>="8"&&(l="00"+l);var r=a.util.hexToBytes(l);S.putInt32(r.length),S.putBytes(r)}function C(S,c){S.putInt32(c.length),S.putString(c)}function E(){for(var S=a.md.sha1.create(),c=arguments.length,l=0;l<c;++l)S.update(arguments[l]);return S.digest()}},91550:(re,ce,V)=>{var a=V(96560);V(19462),V(6252),V(98311),V(38813),V(46803),V(2608),V(34341),V(64687);var e=function(o,s,T,P){var F=a.util.createBuffer(),Y=o.length>>1,_=Y+(o.length&1),ee=o.substr(0,_),oe=o.substr(Y,_),ue=a.util.createBuffer(),j=a.hmac.create();T=s+T;var se=Math.ceil(P/16),le=Math.ceil(P/20);j.start("MD5",ee);var ye=a.util.createBuffer();ue.putBytes(T);for(var de=0;de<se;++de)j.start(null,null),j.update(ue.getBytes()),ue.putBuffer(j.digest()),j.start(null,null),j.update(ue.bytes()+T),ye.putBuffer(j.digest());j.start("SHA1",oe);var Ee=a.util.createBuffer();ue.clear(),ue.putBytes(T);for(var de=0;de<le;++de)j.start(null,null),j.update(ue.getBytes()),ue.putBuffer(j.digest()),j.start(null,null),j.update(ue.bytes()+T),Ee.putBuffer(j.digest());return F.putBytes(a.util.xorBytes(ye.getBytes(),Ee.getBytes(),P)),F},i=function(o,s,T,P){},C=function(o,s,T){var P=a.hmac.create();P.start("SHA1",o);var F=a.util.createBuffer();return F.putInt32(s[0]),F.putInt32(s[1]),F.putByte(T.type),F.putByte(T.version.major),F.putByte(T.version.minor),F.putInt16(T.length),F.putBytes(T.fragment.bytes()),P.update(F.getBytes()),P.digest().getBytes()},E=function(o,s,T){var P=!1;try{var F=o.deflate(s.fragment.getBytes());s.fragment=a.util.createBuffer(F),s.length=F.length,P=!0}catch{}return P},S=function(o,s,T){var P=!1;try{var F=o.inflate(s.fragment.getBytes());s.fragment=a.util.createBuffer(F),s.length=F.length,P=!0}catch{}return P},c=function(o,s){var T=0;switch(s){case 1:T=o.getByte();break;case 2:T=o.getInt16();break;case 3:T=o.getInt24();break;case 4:T=o.getInt32();break}return a.util.createBuffer(o.getBytes(T))},l=function(o,s,T){o.putInt(T.length(),s<<3),o.putBuffer(T)},r={};r.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},r.SupportedVersions=[r.Versions.TLS_1_1,r.Versions.TLS_1_0],r.Version=r.SupportedVersions[0],r.MaxFragment=15360,r.ConnectionEnd={server:0,client:1},r.PRFAlgorithm={tls_prf_sha256:0},r.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},r.CipherType={stream:0,block:1,aead:2},r.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},r.CompressionMethod={none:0,deflate:1},r.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},r.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},r.Alert={},r.Alert.Level={warning:1,fatal:2},r.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},r.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},r.CipherSuites={},r.getCipherSuite=function(o){var s=null;for(var T in r.CipherSuites){var P=r.CipherSuites[T];if(P.id[0]===o.charCodeAt(0)&&P.id[1]===o.charCodeAt(1)){s=P;break}}return s},r.handleUnexpected=function(o,s){var T=!o.open&&o.entity===r.ConnectionEnd.client;T||o.error(o,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.unexpected_message}})},r.handleHelloRequest=function(o,s,T){!o.handshaking&&o.handshakes>0&&(r.queue(o,r.createAlert(o,{level:r.Alert.Level.warning,description:r.Alert.Description.no_renegotiation})),r.flush(o)),o.process()},r.parseHelloMessage=function(o,s,T){var P=null,F=o.entity===r.ConnectionEnd.client;if(T<38)o.error(o,{message:F?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.illegal_parameter}});else{var Y=s.fragment,_=Y.length();if(P={version:{major:Y.getByte(),minor:Y.getByte()},random:a.util.createBuffer(Y.getBytes(32)),session_id:c(Y,1),extensions:[]},F?(P.cipher_suite=Y.getBytes(2),P.compression_method=Y.getByte()):(P.cipher_suites=c(Y,2),P.compression_methods=c(Y,1)),_=T-(_-Y.length()),_>0){for(var ee=c(Y,2);ee.length()>0;)P.extensions.push({type:[ee.getByte(),ee.getByte()],data:c(ee,2)});if(!F)for(var oe=0;oe<P.extensions.length;++oe){var ue=P.extensions[oe];if(ue.type[0]===0&&ue.type[1]===0)for(var j=c(ue.data,2);j.length()>0;){var se=j.getByte();if(se!==0)break;o.session.extensions.server_name.serverNameList.push(c(j,2).getBytes())}}}if(o.session.version&&(P.version.major!==o.session.version.major||P.version.minor!==o.session.version.minor))return o.error(o,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.protocol_version}});if(F)o.session.cipherSuite=r.getCipherSuite(P.cipher_suite);else for(var le=a.util.createBuffer(P.cipher_suites.bytes());le.length()>0&&(o.session.cipherSuite=r.getCipherSuite(le.getBytes(2)),o.session.cipherSuite===null););if(o.session.cipherSuite===null)return o.error(o,{message:"No cipher suites in common.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.handshake_failure},cipherSuite:a.util.bytesToHex(P.cipher_suite)});F?o.session.compressionMethod=P.compression_method:o.session.compressionMethod=r.CompressionMethod.none}return P},r.createSecurityParameters=function(o,s){var T=o.entity===r.ConnectionEnd.client,P=s.random.bytes(),F=T?o.session.sp.client_random:P,Y=T?P:r.createRandom().getBytes();o.session.sp={entity:o.entity,prf_algorithm:r.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:o.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:F,server_random:Y}},r.handleServerHello=function(o,s,T){var P=r.parseHelloMessage(o,s,T);if(!o.fail){if(P.version.minor<=o.version.minor)o.version.minor=P.version.minor;else return o.error(o,{message:"Incompatible TLS version.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.protocol_version}});o.session.version=o.version;var F=P.session_id.bytes();F.length>0&&F===o.session.id?(o.expect=I,o.session.resuming=!0,o.session.sp.server_random=P.random.bytes()):(o.expect=x,o.session.resuming=!1,r.createSecurityParameters(o,P)),o.session.id=F,o.process()}},r.handleClientHello=function(o,s,T){var P=r.parseHelloMessage(o,s,T);if(!o.fail){var F=P.session_id.bytes(),Y=null;if(o.sessionCache&&(Y=o.sessionCache.getSession(F),Y===null?F="":(Y.version.major!==P.version.major||Y.version.minor>P.version.minor)&&(Y=null,F="")),F.length===0&&(F=a.random.getBytes(32)),o.session.id=F,o.session.clientHelloVersion=P.version,o.session.sp={},Y)o.version=o.session.version=Y.version,o.session.sp=Y.sp;else{for(var _,ee=1;ee<r.SupportedVersions.length&&(_=r.SupportedVersions[ee],!(_.minor<=P.version.minor));++ee);o.version={major:_.major,minor:_.minor},o.session.version=o.version}Y!==null?(o.expect=k,o.session.resuming=!0,o.session.sp.client_random=P.random.bytes()):(o.expect=o.verifyClient!==!1?p:A,o.session.resuming=!1,r.createSecurityParameters(o,P)),o.open=!0,r.queue(o,r.createRecord(o,{type:r.ContentType.handshake,data:r.createServerHello(o)})),o.session.resuming?(r.queue(o,r.createRecord(o,{type:r.ContentType.change_cipher_spec,data:r.createChangeCipherSpec()})),o.state.pending=r.createConnectionState(o),o.state.current.write=o.state.pending.write,r.queue(o,r.createRecord(o,{type:r.ContentType.handshake,data:r.createFinished(o)}))):(r.queue(o,r.createRecord(o,{type:r.ContentType.handshake,data:r.createCertificate(o)})),o.fail||(r.queue(o,r.createRecord(o,{type:r.ContentType.handshake,data:r.createServerKeyExchange(o)})),o.verifyClient!==!1&&r.queue(o,r.createRecord(o,{type:r.ContentType.handshake,data:r.createCertificateRequest(o)})),r.queue(o,r.createRecord(o,{type:r.ContentType.handshake,data:r.createServerHelloDone(o)})))),r.flush(o),o.process()}},r.handleCertificate=function(o,s,T){if(T<3)return o.error(o,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.illegal_parameter}});var P=s.fragment,F={certificate_list:c(P,3)},Y,_,ee=[];try{for(;F.certificate_list.length()>0;)Y=c(F.certificate_list,3),_=a.asn1.fromDer(Y),Y=a.pki.certificateFromAsn1(_,!0),ee.push(Y)}catch(ue){return o.error(o,{message:"Could not parse certificate list.",cause:ue,send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.bad_certificate}})}var oe=o.entity===r.ConnectionEnd.client;(oe||o.verifyClient===!0)&&ee.length===0?o.error(o,{message:oe?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.illegal_parameter}}):ee.length===0?o.expect=oe?U:A:(oe?o.session.serverCertificate=ee[0]:o.session.clientCertificate=ee[0],r.verifyCertificateChain(o,ee)&&(o.expect=oe?U:A)),o.process()},r.handleServerKeyExchange=function(o,s,T){if(T>0)return o.error(o,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.unsupported_certificate}});o.expect=m,o.process()},r.handleClientKeyExchange=function(o,s,T){if(T<48)return o.error(o,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.unsupported_certificate}});var P=s.fragment,F={enc_pre_master_secret:c(P,2).getBytes()},Y=null;if(o.getPrivateKey)try{Y=o.getPrivateKey(o,o.session.serverCertificate),Y=a.pki.privateKeyFromPem(Y)}catch(oe){o.error(o,{message:"Could not get private key.",cause:oe,send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.internal_error}})}if(Y===null)return o.error(o,{message:"No private key set.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.internal_error}});try{var _=o.session.sp;_.pre_master_secret=Y.decrypt(F.enc_pre_master_secret);var ee=o.session.clientHelloVersion;if(ee.major!==_.pre_master_secret.charCodeAt(0)||ee.minor!==_.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{_.pre_master_secret=a.random.getBytes(48)}o.expect=k,o.session.clientCertificate!==null&&(o.expect=R),o.process()},r.handleCertificateRequest=function(o,s,T){if(T<3)return o.error(o,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.illegal_parameter}});var P=s.fragment,F={certificate_types:c(P,1),certificate_authorities:c(P,2)};o.session.certificateRequest=F,o.expect=y,o.process()},r.handleCertificateVerify=function(o,s,T){if(T<2)return o.error(o,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.illegal_parameter}});var P=s.fragment;P.read-=4;var F=P.bytes();P.read+=4;var Y={signature:c(P,2).getBytes()},_=a.util.createBuffer();_.putBuffer(o.session.md5.digest()),_.putBuffer(o.session.sha1.digest()),_=_.getBytes();try{var ee=o.session.clientCertificate;if(!ee.publicKey.verify(_,Y.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");o.session.md5.update(F),o.session.sha1.update(F)}catch{return o.error(o,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.handshake_failure}})}o.expect=k,o.process()},r.handleServerHelloDone=function(o,s,T){if(T>0)return o.error(o,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.record_overflow}});if(o.serverCertificate===null){var P={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.insufficient_security}},F=0,Y=o.verify(o,P.alert.description,F,[]);if(Y!==!0)return(Y||Y===0)&&(typeof Y=="object"&&!a.util.isArray(Y)?(Y.message&&(P.message=Y.message),Y.alert&&(P.alert.description=Y.alert)):typeof Y=="number"&&(P.alert.description=Y)),o.error(o,P)}o.session.certificateRequest!==null&&(s=r.createRecord(o,{type:r.ContentType.handshake,data:r.createCertificate(o)}),r.queue(o,s)),s=r.createRecord(o,{type:r.ContentType.handshake,data:r.createClientKeyExchange(o)}),r.queue(o,s),o.expect=n;var _=function(ee,oe){ee.session.certificateRequest!==null&&ee.session.clientCertificate!==null&&r.queue(ee,r.createRecord(ee,{type:r.ContentType.handshake,data:r.createCertificateVerify(ee,oe)})),r.queue(ee,r.createRecord(ee,{type:r.ContentType.change_cipher_spec,data:r.createChangeCipherSpec()})),ee.state.pending=r.createConnectionState(ee),ee.state.current.write=ee.state.pending.write,r.queue(ee,r.createRecord(ee,{type:r.ContentType.handshake,data:r.createFinished(ee)})),ee.expect=I,r.flush(ee),ee.process()};if(o.session.certificateRequest===null||o.session.clientCertificate===null)return _(o,null);r.getClientSignature(o,_)},r.handleChangeCipherSpec=function(o,s){if(s.fragment.getByte()!==1)return o.error(o,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.illegal_parameter}});var T=o.entity===r.ConnectionEnd.client;(o.session.resuming&&T||!o.session.resuming&&!T)&&(o.state.pending=r.createConnectionState(o)),o.state.current.read=o.state.pending.read,(!o.session.resuming&&T||o.session.resuming&&!T)&&(o.state.pending=null),o.expect=T?d:h,o.process()},r.handleFinished=function(o,s,T){var P=s.fragment;P.read-=4;var F=P.bytes();P.read+=4;var Y=s.fragment.getBytes();P=a.util.createBuffer(),P.putBuffer(o.session.md5.digest()),P.putBuffer(o.session.sha1.digest());var _=o.entity===r.ConnectionEnd.client,ee=_?"server finished":"client finished",oe=o.session.sp,ue=12,j=e;if(P=j(oe.master_secret,ee,P.getBytes(),ue),P.getBytes()!==Y)return o.error(o,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.decrypt_error}});o.session.md5.update(F),o.session.sha1.update(F),(o.session.resuming&&_||!o.session.resuming&&!_)&&(r.queue(o,r.createRecord(o,{type:r.ContentType.change_cipher_spec,data:r.createChangeCipherSpec()})),o.state.current.write=o.state.pending.write,o.state.pending=null,r.queue(o,r.createRecord(o,{type:r.ContentType.handshake,data:r.createFinished(o)}))),o.expect=_?v:g,o.handshaking=!1,++o.handshakes,o.peerCertificate=_?o.session.serverCertificate:o.session.clientCertificate,r.flush(o),o.isConnected=!0,o.connected(o),o.process()},r.handleAlert=function(o,s){var T=s.fragment,P={level:T.getByte(),description:T.getByte()},F;switch(P.description){case r.Alert.Description.close_notify:F="Connection closed.";break;case r.Alert.Description.unexpected_message:F="Unexpected message.";break;case r.Alert.Description.bad_record_mac:F="Bad record MAC.";break;case r.Alert.Description.decryption_failed:F="Decryption failed.";break;case r.Alert.Description.record_overflow:F="Record overflow.";break;case r.Alert.Description.decompression_failure:F="Decompression failed.";break;case r.Alert.Description.handshake_failure:F="Handshake failure.";break;case r.Alert.Description.bad_certificate:F="Bad certificate.";break;case r.Alert.Description.unsupported_certificate:F="Unsupported certificate.";break;case r.Alert.Description.certificate_revoked:F="Certificate revoked.";break;case r.Alert.Description.certificate_expired:F="Certificate expired.";break;case r.Alert.Description.certificate_unknown:F="Certificate unknown.";break;case r.Alert.Description.illegal_parameter:F="Illegal parameter.";break;case r.Alert.Description.unknown_ca:F="Unknown certificate authority.";break;case r.Alert.Description.access_denied:F="Access denied.";break;case r.Alert.Description.decode_error:F="Decode error.";break;case r.Alert.Description.decrypt_error:F="Decrypt error.";break;case r.Alert.Description.export_restriction:F="Export restriction.";break;case r.Alert.Description.protocol_version:F="Unsupported protocol version.";break;case r.Alert.Description.insufficient_security:F="Insufficient security.";break;case r.Alert.Description.internal_error:F="Internal error.";break;case r.Alert.Description.user_canceled:F="User canceled.";break;case r.Alert.Description.no_renegotiation:F="Renegotiation not supported.";break;default:F="Unknown error.";break}if(P.description===r.Alert.Description.close_notify)return o.close();o.error(o,{message:F,send:!1,origin:o.entity===r.ConnectionEnd.client?"server":"client",alert:P}),o.process()},r.handleHandshake=function(o,s){var T=s.fragment,P=T.getByte(),F=T.getInt24();if(F>T.length())return o.fragmented=s,s.fragment=a.util.createBuffer(),T.read-=4,o.process();o.fragmented=null,T.read-=4;var Y=T.bytes(F+4);T.read+=4,P in J[o.entity][o.expect]?(o.entity===r.ConnectionEnd.server&&!o.open&&!o.fail&&(o.handshaking=!0,o.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:a.md.md5.create(),sha1:a.md.sha1.create()}),P!==r.HandshakeType.hello_request&&P!==r.HandshakeType.certificate_verify&&P!==r.HandshakeType.finished&&(o.session.md5.update(Y),o.session.sha1.update(Y)),J[o.entity][o.expect][P](o,s,F)):r.handleUnexpected(o,s)},r.handleApplicationData=function(o,s){o.data.putBuffer(s.fragment),o.dataReady(o),o.process()},r.handleHeartbeat=function(o,s){var T=s.fragment,P=T.getByte(),F=T.getInt16(),Y=T.getBytes(F);if(P===r.HeartbeatMessageType.heartbeat_request){if(o.handshaking||F>Y.length)return o.process();r.queue(o,r.createRecord(o,{type:r.ContentType.heartbeat,data:r.createHeartbeat(r.HeartbeatMessageType.heartbeat_response,Y)})),r.flush(o)}else if(P===r.HeartbeatMessageType.heartbeat_response){if(Y!==o.expectedHeartbeatPayload)return o.process();o.heartbeatReceived&&o.heartbeatReceived(o,a.util.createBuffer(Y))}o.process()};var u=0,x=1,U=2,m=3,y=4,I=5,d=6,v=7,n=8,f=0,p=1,A=2,R=3,k=4,h=5,g=6,N=7,t=r.handleUnexpected,L=r.handleChangeCipherSpec,O=r.handleAlert,w=r.handleHandshake,M=r.handleApplicationData,K=r.handleHeartbeat,G=[];G[r.ConnectionEnd.client]=[[t,O,w,t,K],[t,O,w,t,K],[t,O,w,t,K],[t,O,w,t,K],[t,O,w,t,K],[L,O,t,t,K],[t,O,w,t,K],[t,O,w,M,K],[t,O,w,t,K]],G[r.ConnectionEnd.server]=[[t,O,w,t,K],[t,O,w,t,K],[t,O,w,t,K],[t,O,w,t,K],[L,O,t,t,K],[t,O,w,t,K],[t,O,w,M,K],[t,O,w,t,K]];var X=r.handleHelloRequest,W=r.handleServerHello,q=r.handleCertificate,te=r.handleServerKeyExchange,fe=r.handleCertificateRequest,he=r.handleServerHelloDone,pe=r.handleFinished,J=[];J[r.ConnectionEnd.client]=[[t,t,W,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[X,t,t,t,t,t,t,t,t,t,t,q,te,fe,he,t,t,t,t,t,t],[X,t,t,t,t,t,t,t,t,t,t,t,te,fe,he,t,t,t,t,t,t],[X,t,t,t,t,t,t,t,t,t,t,t,t,fe,he,t,t,t,t,t,t],[X,t,t,t,t,t,t,t,t,t,t,t,t,t,he,t,t,t,t,t,t],[X,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[X,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,pe],[X,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[X,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t]];var me=r.handleClientHello,ie=r.handleClientKeyExchange,ge=r.handleCertificateVerify;J[r.ConnectionEnd.server]=[[t,me,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,q,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,ie,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,ge,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,pe],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t]],r.generateKeys=function(o,s){var T=e,P=s.client_random+s.server_random;o.session.resuming||(s.master_secret=T(s.pre_master_secret,"master secret",P,48).bytes(),s.pre_master_secret=null),P=s.server_random+s.client_random;var F=2*s.mac_key_length+2*s.enc_key_length,Y=o.version.major===r.Versions.TLS_1_0.major&&o.version.minor===r.Versions.TLS_1_0.minor;Y&&(F+=2*s.fixed_iv_length);var _=T(s.master_secret,"key expansion",P,F),ee={client_write_MAC_key:_.getBytes(s.mac_key_length),server_write_MAC_key:_.getBytes(s.mac_key_length),client_write_key:_.getBytes(s.enc_key_length),server_write_key:_.getBytes(s.enc_key_length)};return Y&&(ee.client_write_IV=_.getBytes(s.fixed_iv_length),ee.server_write_IV=_.getBytes(s.fixed_iv_length)),ee},r.createConnectionState=function(o){var s=o.entity===r.ConnectionEnd.client,T=function(){var Y={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(_){return!0},compressionState:null,compressFunction:function(_){return!0},updateSequenceNumber:function(){Y.sequenceNumber[1]===4294967295?(Y.sequenceNumber[1]=0,++Y.sequenceNumber[0]):++Y.sequenceNumber[1]}};return Y},P={read:T(),write:T()};if(P.read.update=function(Y,_){return P.read.cipherFunction(_,P.read)?P.read.compressFunction(Y,_,P.read)||Y.error(Y,{message:"Could not decompress record.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.decompression_failure}}):Y.error(Y,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.bad_record_mac}}),!Y.fail},P.write.update=function(Y,_){return P.write.compressFunction(Y,_,P.write)?P.write.cipherFunction(_,P.write)||Y.error(Y,{message:"Could not encrypt record.",send:!1,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.internal_error}}):Y.error(Y,{message:"Could not compress record.",send:!1,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.internal_error}}),!Y.fail},o.session){var F=o.session.sp;switch(o.session.cipherSuite.initSecurityParameters(F),F.keys=r.generateKeys(o,F),P.read.macKey=s?F.keys.server_write_MAC_key:F.keys.client_write_MAC_key,P.write.macKey=s?F.keys.client_write_MAC_key:F.keys.server_write_MAC_key,o.session.cipherSuite.initConnectionState(P,o,F),F.compression_algorithm){case r.CompressionMethod.none:break;case r.CompressionMethod.deflate:P.read.compressFunction=S,P.write.compressFunction=E;break;default:throw new Error("Unsupported compression algorithm.")}}return P},r.createRandom=function(){var o=new Date,s=+o+o.getTimezoneOffset()*6e4,T=a.util.createBuffer();return T.putInt32(s),T.putBytes(a.random.getBytes(28)),T},r.createRecord=function(o,s){if(!s.data)return null;var T={type:s.type,version:{major:o.version.major,minor:o.version.minor},length:s.data.length(),fragment:s.data};return T},r.createAlert=function(o,s){var T=a.util.createBuffer();return T.putByte(s.level),T.putByte(s.description),r.createRecord(o,{type:r.ContentType.alert,data:T})},r.createClientHello=function(o){o.session.clientHelloVersion={major:o.version.major,minor:o.version.minor};for(var s=a.util.createBuffer(),T=0;T<o.cipherSuites.length;++T){var P=o.cipherSuites[T];s.putByte(P.id[0]),s.putByte(P.id[1])}var F=s.length(),Y=a.util.createBuffer();Y.putByte(r.CompressionMethod.none);var _=Y.length(),ee=a.util.createBuffer();if(o.virtualHost){var oe=a.util.createBuffer();oe.putByte(0),oe.putByte(0);var ue=a.util.createBuffer();ue.putByte(0),l(ue,2,a.util.createBuffer(o.virtualHost));var j=a.util.createBuffer();l(j,2,ue),l(oe,2,j),ee.putBuffer(oe)}var se=ee.length();se>0&&(se+=2);var le=o.session.id,ye=le.length+1+2+4+28+2+F+1+_+se,de=a.util.createBuffer();return de.putByte(r.HandshakeType.client_hello),de.putInt24(ye),de.putByte(o.version.major),de.putByte(o.version.minor),de.putBytes(o.session.sp.client_random),l(de,1,a.util.createBuffer(le)),l(de,2,s),l(de,1,Y),se>0&&l(de,2,ee),de},r.createServerHello=function(o){var s=o.session.id,T=s.length+1+2+4+28+2+1,P=a.util.createBuffer();return P.putByte(r.HandshakeType.server_hello),P.putInt24(T),P.putByte(o.version.major),P.putByte(o.version.minor),P.putBytes(o.session.sp.server_random),l(P,1,a.util.createBuffer(s)),P.putByte(o.session.cipherSuite.id[0]),P.putByte(o.session.cipherSuite.id[1]),P.putByte(o.session.compressionMethod),P},r.createCertificate=function(o){var s=o.entity===r.ConnectionEnd.client,T=null;if(o.getCertificate){var P;s?P=o.session.certificateRequest:P=o.session.extensions.server_name.serverNameList,T=o.getCertificate(o,P)}var F=a.util.createBuffer();if(T!==null)try{a.util.isArray(T)||(T=[T]);for(var Y=null,_=0;_<T.length;++_){var ee=a.pem.decode(T[_])[0];if(ee.type!=="CERTIFICATE"&&ee.type!=="X509 CERTIFICATE"&&ee.type!=="TRUSTED CERTIFICATE"){var oe=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw oe.headerType=ee.type,oe}if(ee.procType&&ee.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var ue=a.util.createBuffer(ee.body);Y===null&&(Y=a.asn1.fromDer(ue.bytes(),!1));var j=a.util.createBuffer();l(j,3,ue),F.putBuffer(j)}T=a.pki.certificateFromAsn1(Y),s?o.session.clientCertificate=T:o.session.serverCertificate=T}catch(ye){return o.error(o,{message:"Could not send certificate list.",cause:ye,send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.bad_certificate}})}var se=3+F.length(),le=a.util.createBuffer();return le.putByte(r.HandshakeType.certificate),le.putInt24(se),l(le,3,F),le},r.createClientKeyExchange=function(o){var s=a.util.createBuffer();s.putByte(o.session.clientHelloVersion.major),s.putByte(o.session.clientHelloVersion.minor),s.putBytes(a.random.getBytes(46));var T=o.session.sp;T.pre_master_secret=s.getBytes();var P=o.session.serverCertificate.publicKey;s=P.encrypt(T.pre_master_secret);var F=s.length+2,Y=a.util.createBuffer();return Y.putByte(r.HandshakeType.client_key_exchange),Y.putInt24(F),Y.putInt16(s.length),Y.putBytes(s),Y},r.createServerKeyExchange=function(o){var s=0,T=a.util.createBuffer();return s>0&&(T.putByte(r.HandshakeType.server_key_exchange),T.putInt24(s)),T},r.getClientSignature=function(o,s){var T=a.util.createBuffer();T.putBuffer(o.session.md5.digest()),T.putBuffer(o.session.sha1.digest()),T=T.getBytes(),o.getSignature=o.getSignature||function(P,F,Y){var _=null;if(P.getPrivateKey)try{_=P.getPrivateKey(P,P.session.clientCertificate),_=a.pki.privateKeyFromPem(_)}catch(ee){P.error(P,{message:"Could not get private key.",cause:ee,send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.internal_error}})}_===null?P.error(P,{message:"No private key set.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.internal_error}}):F=_.sign(F,null),Y(P,F)},o.getSignature(o,T,s)},r.createCertificateVerify=function(o,s){var T=s.length+2,P=a.util.createBuffer();return P.putByte(r.HandshakeType.certificate_verify),P.putInt24(T),P.putInt16(s.length),P.putBytes(s),P},r.createCertificateRequest=function(o){var s=a.util.createBuffer();s.putByte(1);var T=a.util.createBuffer();for(var P in o.caStore.certs){var F=o.caStore.certs[P],Y=a.pki.distinguishedNameToAsn1(F.subject),_=a.asn1.toDer(Y);T.putInt16(_.length()),T.putBuffer(_)}var ee=1+s.length()+2+T.length(),oe=a.util.createBuffer();return oe.putByte(r.HandshakeType.certificate_request),oe.putInt24(ee),l(oe,1,s),l(oe,2,T),oe},r.createServerHelloDone=function(o){var s=a.util.createBuffer();return s.putByte(r.HandshakeType.server_hello_done),s.putInt24(0),s},r.createChangeCipherSpec=function(){var o=a.util.createBuffer();return o.putByte(1),o},r.createFinished=function(o){var s=a.util.createBuffer();s.putBuffer(o.session.md5.digest()),s.putBuffer(o.session.sha1.digest());var T=o.entity===r.ConnectionEnd.client,P=o.session.sp,F=12,Y=e,_=T?"client finished":"server finished";s=Y(P.master_secret,_,s.getBytes(),F);var ee=a.util.createBuffer();return ee.putByte(r.HandshakeType.finished),ee.putInt24(s.length()),ee.putBuffer(s),ee},r.createHeartbeat=function(o,s,T){typeof T>"u"&&(T=s.length);var P=a.util.createBuffer();P.putByte(o),P.putInt16(T),P.putBytes(s);var F=P.length(),Y=Math.max(16,F-T-3);return P.putBytes(a.random.getBytes(Y)),P},r.queue=function(o,s){if(s&&!(s.fragment.length()===0&&(s.type===r.ContentType.handshake||s.type===r.ContentType.alert||s.type===r.ContentType.change_cipher_spec))){if(s.type===r.ContentType.handshake){var T=s.fragment.bytes();o.session.md5.update(T),o.session.sha1.update(T),T=null}var P;if(s.fragment.length()<=r.MaxFragment)P=[s];else{P=[];for(var F=s.fragment.bytes();F.length>r.MaxFragment;)P.push(r.createRecord(o,{type:s.type,data:a.util.createBuffer(F.slice(0,r.MaxFragment))})),F=F.slice(r.MaxFragment);F.length>0&&P.push(r.createRecord(o,{type:s.type,data:a.util.createBuffer(F)}))}for(var Y=0;Y<P.length&&!o.fail;++Y){var _=P[Y],ee=o.state.current.write;ee.update(o,_)&&o.records.push(_)}}},r.flush=function(o){for(var s=0;s<o.records.length;++s){var T=o.records[s];o.tlsData.putByte(T.type),o.tlsData.putByte(T.version.major),o.tlsData.putByte(T.version.minor),o.tlsData.putInt16(T.fragment.length()),o.tlsData.putBuffer(o.records[s].fragment)}return o.records=[],o.tlsDataReady(o)};var ve=function(o){switch(o){case!0:return!0;case a.pki.certificateError.bad_certificate:return r.Alert.Description.bad_certificate;case a.pki.certificateError.unsupported_certificate:return r.Alert.Description.unsupported_certificate;case a.pki.certificateError.certificate_revoked:return r.Alert.Description.certificate_revoked;case a.pki.certificateError.certificate_expired:return r.Alert.Description.certificate_expired;case a.pki.certificateError.certificate_unknown:return r.Alert.Description.certificate_unknown;case a.pki.certificateError.unknown_ca:return r.Alert.Description.unknown_ca;default:return r.Alert.Description.bad_certificate}},z=function(o){switch(o){case!0:return!0;case r.Alert.Description.bad_certificate:return a.pki.certificateError.bad_certificate;case r.Alert.Description.unsupported_certificate:return a.pki.certificateError.unsupported_certificate;case r.Alert.Description.certificate_revoked:return a.pki.certificateError.certificate_revoked;case r.Alert.Description.certificate_expired:return a.pki.certificateError.certificate_expired;case r.Alert.Description.certificate_unknown:return a.pki.certificateError.certificate_unknown;case r.Alert.Description.unknown_ca:return a.pki.certificateError.unknown_ca;default:return a.pki.certificateError.bad_certificate}};r.verifyCertificateChain=function(o,s){try{var T={};for(var P in o.verifyOptions)T[P]=o.verifyOptions[P];T.verify=function(Y,_,ee){var oe=ve(Y),ue=o.verify(o,Y,_,ee);if(ue!==!0){if(typeof ue=="object"&&!a.util.isArray(ue)){var j=new Error("The application rejected the certificate.");throw j.send=!0,j.alert={level:r.Alert.Level.fatal,description:r.Alert.Description.bad_certificate},ue.message&&(j.message=ue.message),ue.alert&&(j.alert.description=ue.alert),j}ue!==Y&&(ue=z(ue))}return ue},a.pki.verifyCertificateChain(o.caStore,s,T)}catch(Y){var F=Y;(typeof F!="object"||a.util.isArray(F))&&(F={send:!0,alert:{level:r.Alert.Level.fatal,description:ve(Y)}}),"send"in F||(F.send=!0),"alert"in F||(F.alert={level:r.Alert.Level.fatal,description:ve(F.error)}),o.error(o,F)}return!o.fail},r.createSessionCache=function(o,s){var T=null;if(o&&o.getSession&&o.setSession&&o.order)T=o;else{T={},T.cache=o||{},T.capacity=Math.max(s||100,1),T.order=[];for(var P in o)T.order.length<=s?T.order.push(P):delete o[P];T.getSession=function(F){var Y=null,_=null;if(F?_=a.util.bytesToHex(F):T.order.length>0&&(_=T.order[0]),_!==null&&_ in T.cache){Y=T.cache[_],delete T.cache[_];for(var ee in T.order)if(T.order[ee]===_){T.order.splice(ee,1);break}}return Y},T.setSession=function(F,Y){if(T.order.length===T.capacity){var _=T.order.shift();delete T.cache[_]}var _=a.util.bytesToHex(F);T.order.push(_),T.cache[_]=Y}}return T},r.createConnection=function(o){var s=null;o.caStore?a.util.isArray(o.caStore)?s=a.pki.createCaStore(o.caStore):s=o.caStore:s=a.pki.createCaStore();var T=o.cipherSuites||null;if(T===null){T=[];for(var P in r.CipherSuites)T.push(r.CipherSuites[P])}var F=o.server?r.ConnectionEnd.server:r.ConnectionEnd.client,Y=o.sessionCache?r.createSessionCache(o.sessionCache):null,_={version:{major:r.Version.major,minor:r.Version.minor},entity:F,sessionId:o.sessionId,caStore:s,sessionCache:Y,cipherSuites:T,connected:o.connected,virtualHost:o.virtualHost||null,verifyClient:o.verifyClient||!1,verify:o.verify||function(j,se,le,ye){return se},verifyOptions:o.verifyOptions||{},getCertificate:o.getCertificate||null,getPrivateKey:o.getPrivateKey||null,getSignature:o.getSignature||null,input:a.util.createBuffer(),tlsData:a.util.createBuffer(),data:a.util.createBuffer(),tlsDataReady:o.tlsDataReady,dataReady:o.dataReady,heartbeatReceived:o.heartbeatReceived,closed:o.closed,error:function(j,se){se.origin=se.origin||(j.entity===r.ConnectionEnd.client?"client":"server"),se.send&&(r.queue(j,r.createAlert(j,se.alert)),r.flush(j));var le=se.fatal!==!1;le&&(j.fail=!0),o.error(j,se),le&&j.close(!1)},deflate:o.deflate||null,inflate:o.inflate||null};_.reset=function(j){_.version={major:r.Version.major,minor:r.Version.minor},_.record=null,_.session=null,_.peerCertificate=null,_.state={pending:null,current:null},_.expect=_.entity===r.ConnectionEnd.client?u:f,_.fragmented=null,_.records=[],_.open=!1,_.handshakes=0,_.handshaking=!1,_.isConnected=!1,_.fail=!(j||typeof j>"u"),_.input.clear(),_.tlsData.clear(),_.data.clear(),_.state.current=r.createConnectionState(_)},_.reset();var ee=function(j,se){var le=se.type-r.ContentType.change_cipher_spec,ye=G[j.entity][j.expect];le in ye?ye[le](j,se):r.handleUnexpected(j,se)},oe=function(j){var se=0,le=j.input,ye=le.length();if(ye<5)se=5-ye;else{j.record={type:le.getByte(),version:{major:le.getByte(),minor:le.getByte()},length:le.getInt16(),fragment:a.util.createBuffer(),ready:!1};var de=j.record.version.major===j.version.major;de&&j.session&&j.session.version&&(de=j.record.version.minor===j.version.minor),de||j.error(j,{message:"Incompatible TLS version.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.protocol_version}})}return se},ue=function(j){var se=0,le=j.input,ye=le.length();if(ye<j.record.length)se=j.record.length-ye;else{j.record.fragment.putBytes(le.getBytes(j.record.length)),le.compact();var de=j.state.current.read;de.update(j,j.record)&&(j.fragmented!==null&&(j.fragmented.type===j.record.type?(j.fragmented.fragment.putBuffer(j.record.fragment),j.record=j.fragmented):j.error(j,{message:"Invalid fragmented record.",send:!0,alert:{level:r.Alert.Level.fatal,description:r.Alert.Description.unexpected_message}})),j.record.ready=!0)}return se};return _.handshake=function(j){if(_.entity!==r.ConnectionEnd.client)_.error(_,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(_.handshaking)_.error(_,{message:"Handshake already in progress.",fatal:!1});else{_.fail&&!_.open&&_.handshakes===0&&(_.fail=!1),_.handshaking=!0,j=j||"";var se=null;j.length>0&&(_.sessionCache&&(se=_.sessionCache.getSession(j)),se===null&&(j="")),j.length===0&&_.sessionCache&&(se=_.sessionCache.getSession(),se!==null&&(j=se.id)),_.session={id:j,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:a.md.md5.create(),sha1:a.md.sha1.create()},se&&(_.version=se.version,_.session.sp=se.sp),_.session.sp.client_random=r.createRandom().getBytes(),_.open=!0,r.queue(_,r.createRecord(_,{type:r.ContentType.handshake,data:r.createClientHello(_)})),r.flush(_)}},_.process=function(j){var se=0;return j&&_.input.putBytes(j),_.fail||(_.record!==null&&_.record.ready&&_.record.fragment.isEmpty()&&(_.record=null),_.record===null&&(se=oe(_)),!_.fail&&_.record!==null&&!_.record.ready&&(se=ue(_)),!_.fail&&_.record!==null&&_.record.ready&&ee(_,_.record)),se},_.prepare=function(j){return r.queue(_,r.createRecord(_,{type:r.ContentType.application_data,data:a.util.createBuffer(j)})),r.flush(_)},_.prepareHeartbeatRequest=function(j,se){return j instanceof a.util.ByteBuffer&&(j=j.bytes()),typeof se>"u"&&(se=j.length),_.expectedHeartbeatPayload=j,r.queue(_,r.createRecord(_,{type:r.ContentType.heartbeat,data:r.createHeartbeat(r.HeartbeatMessageType.heartbeat_request,j,se)})),r.flush(_)},_.close=function(j){if(!_.fail&&_.sessionCache&&_.session){var se={id:_.session.id,version:_.session.version,sp:_.session.sp};se.sp.keys=null,_.sessionCache.setSession(se.id,se)}_.open&&(_.open=!1,_.input.clear(),(_.isConnected||_.handshaking)&&(_.isConnected=_.handshaking=!1,r.queue(_,r.createAlert(_,{level:r.Alert.Level.warning,description:r.Alert.Description.close_notify})),r.flush(_)),_.closed(_)),_.reset(j)},_},re.exports=a.tls=a.tls||{};for(var Q in r)typeof r[Q]!="function"&&(a.tls[Q]=r[Q]);a.tls.prf_tls1=e,a.tls.hmac_sha1=C,a.tls.createSessionCache=r.createSessionCache,a.tls.createConnection=r.createConnection},64687:(re,ce,V)=>{var a=V(96560),e=V(20502),i=re.exports=a.util=a.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){i.nextTick=process.nextTick,typeof setImmediate=="function"?i.setImmediate=setImmediate:i.setImmediate=i.nextTick;return}if(typeof setImmediate=="function"){i.setImmediate=function(){return setImmediate.apply(void 0,arguments)},i.nextTick=function(g){return setImmediate(g)};return}if(i.setImmediate=function(g){setTimeout(g,0)},typeof window<"u"&&typeof window.postMessage=="function"){let g=function(N){if(N.source===window&&N.data===n){N.stopPropagation();var t=f.slice();f.length=0,t.forEach(function(L){L()})}};var h=g,n="forge.setImmediate",f=[];i.setImmediate=function(N){f.push(N),f.length===1&&window.postMessage(n,"*")},window.addEventListener("message",g,!0)}if(typeof MutationObserver<"u"){var p=Date.now(),A=!0,R=document.createElement("div"),f=[];new MutationObserver(function(){var N=f.slice();f.length=0,N.forEach(function(t){t()})}).observe(R,{attributes:!0});var k=i.setImmediate;i.setImmediate=function(N){Date.now()-p>15?(p=Date.now(),k(N)):(f.push(N),f.length===1&&R.setAttribute("a",A=!A))}}i.nextTick=i.setImmediate})(),i.isNodejs=typeof process<"u"&&process.versions&&process.versions.node,i.globalScope=function(){return i.isNodejs?global:typeof self>"u"?window:self}(),i.isArray=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"},i.isArrayBuffer=function(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer},i.isArrayBufferView=function(n){return n&&i.isArrayBuffer(n.buffer)&&n.byteLength!==void 0};function C(n){if(!(n===8||n===16||n===24||n===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+n)}i.ByteBuffer=E;function E(n){if(this.data="",this.read=0,typeof n=="string")this.data=n;else if(i.isArrayBuffer(n)||i.isArrayBufferView(n))if(typeof Buffer<"u"&&n instanceof Buffer)this.data=n.toString("binary");else{var f=new Uint8Array(n);try{this.data=String.fromCharCode.apply(null,f)}catch{for(var p=0;p<f.length;++p)this.putByte(f[p])}}else(n instanceof E||typeof n=="object"&&typeof n.data=="string"&&typeof n.read=="number")&&(this.data=n.data,this.read=n.read);this._constructedStringLength=0}i.ByteStringBuffer=E;var S=4096;i.ByteStringBuffer.prototype._optimizeConstructedString=function(n){this._constructedStringLength+=n,this._constructedStringLength>S&&(this.data.substr(0,1),this._constructedStringLength=0)},i.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},i.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},i.ByteStringBuffer.prototype.putByte=function(n){return this.putBytes(String.fromCharCode(n))},i.ByteStringBuffer.prototype.fillWithByte=function(n,f){n=String.fromCharCode(n);for(var p=this.data;f>0;)f&1&&(p+=n),f>>>=1,f>0&&(n+=n);return this.data=p,this._optimizeConstructedString(f),this},i.ByteStringBuffer.prototype.putBytes=function(n){return this.data+=n,this._optimizeConstructedString(n.length),this},i.ByteStringBuffer.prototype.putString=function(n){return this.putBytes(i.encodeUtf8(n))},i.ByteStringBuffer.prototype.putInt16=function(n){return this.putBytes(String.fromCharCode(n>>8&255)+String.fromCharCode(n&255))},i.ByteStringBuffer.prototype.putInt24=function(n){return this.putBytes(String.fromCharCode(n>>16&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n&255))},i.ByteStringBuffer.prototype.putInt32=function(n){return this.putBytes(String.fromCharCode(n>>24&255)+String.fromCharCode(n>>16&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n&255))},i.ByteStringBuffer.prototype.putInt16Le=function(n){return this.putBytes(String.fromCharCode(n&255)+String.fromCharCode(n>>8&255))},i.ByteStringBuffer.prototype.putInt24Le=function(n){return this.putBytes(String.fromCharCode(n&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n>>16&255))},i.ByteStringBuffer.prototype.putInt32Le=function(n){return this.putBytes(String.fromCharCode(n&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n>>16&255)+String.fromCharCode(n>>24&255))},i.ByteStringBuffer.prototype.putInt=function(n,f){C(f);var p="";do f-=8,p+=String.fromCharCode(n>>f&255);while(f>0);return this.putBytes(p)},i.ByteStringBuffer.prototype.putSignedInt=function(n,f){return n<0&&(n+=2<<f-1),this.putInt(n,f)},i.ByteStringBuffer.prototype.putBuffer=function(n){return this.putBytes(n.getBytes())},i.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},i.ByteStringBuffer.prototype.getInt16=function(){var n=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,n},i.ByteStringBuffer.prototype.getInt24=function(){var n=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,n},i.ByteStringBuffer.prototype.getInt32=function(){var n=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,n},i.ByteStringBuffer.prototype.getInt16Le=function(){var n=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,n},i.ByteStringBuffer.prototype.getInt24Le=function(){var n=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,n},i.ByteStringBuffer.prototype.getInt32Le=function(){var n=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,n},i.ByteStringBuffer.prototype.getInt=function(n){C(n);var f=0;do f=(f<<8)+this.data.charCodeAt(this.read++),n-=8;while(n>0);return f},i.ByteStringBuffer.prototype.getSignedInt=function(n){var f=this.getInt(n),p=2<<n-2;return f>=p&&(f-=p<<1),f},i.ByteStringBuffer.prototype.getBytes=function(n){var f;return n?(n=Math.min(this.length(),n),f=this.data.slice(this.read,this.read+n),this.read+=n):n===0?f="":(f=this.read===0?this.data:this.data.slice(this.read),this.clear()),f},i.ByteStringBuffer.prototype.bytes=function(n){return typeof n>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+n)},i.ByteStringBuffer.prototype.at=function(n){return this.data.charCodeAt(this.read+n)},i.ByteStringBuffer.prototype.setAt=function(n,f){return this.data=this.data.substr(0,this.read+n)+String.fromCharCode(f)+this.data.substr(this.read+n+1),this},i.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},i.ByteStringBuffer.prototype.copy=function(){var n=i.createBuffer(this.data);return n.read=this.read,n},i.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},i.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},i.ByteStringBuffer.prototype.truncate=function(n){var f=Math.max(0,this.length()-n);return this.data=this.data.substr(this.read,f),this.read=0,this},i.ByteStringBuffer.prototype.toHex=function(){for(var n="",f=this.read;f<this.data.length;++f){var p=this.data.charCodeAt(f);p<16&&(n+="0"),n+=p.toString(16)}return n},i.ByteStringBuffer.prototype.toString=function(){return i.decodeUtf8(this.bytes())};function c(n,f){f=f||{},this.read=f.readOffset||0,this.growSize=f.growSize||1024;var p=i.isArrayBuffer(n),A=i.isArrayBufferView(n);if(p||A){p?this.data=new DataView(n):this.data=new DataView(n.buffer,n.byteOffset,n.byteLength),this.write="writeOffset"in f?f.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,n!=null&&this.putBytes(n),"writeOffset"in f&&(this.write=f.writeOffset)}i.DataBuffer=c,i.DataBuffer.prototype.length=function(){return this.write-this.read},i.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},i.DataBuffer.prototype.accommodate=function(n,f){if(this.length()>=n)return this;f=Math.max(f||this.growSize,n);var p=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),A=new Uint8Array(this.length()+f);return A.set(p),this.data=new DataView(A.buffer),this},i.DataBuffer.prototype.putByte=function(n){return this.accommodate(1),this.data.setUint8(this.write++,n),this},i.DataBuffer.prototype.fillWithByte=function(n,f){this.accommodate(f);for(var p=0;p<f;++p)this.data.setUint8(n);return this},i.DataBuffer.prototype.putBytes=function(n,f){if(i.isArrayBufferView(n)){var p=new Uint8Array(n.buffer,n.byteOffset,n.byteLength),A=p.byteLength-p.byteOffset;this.accommodate(A);var R=new Uint8Array(this.data.buffer,this.write);return R.set(p),this.write+=A,this}if(i.isArrayBuffer(n)){var p=new Uint8Array(n);this.accommodate(p.byteLength);var R=new Uint8Array(this.data.buffer);return R.set(p,this.write),this.write+=p.byteLength,this}if(n instanceof i.DataBuffer||typeof n=="object"&&typeof n.read=="number"&&typeof n.write=="number"&&i.isArrayBufferView(n.data)){var p=new Uint8Array(n.data.byteLength,n.read,n.length());this.accommodate(p.byteLength);var R=new Uint8Array(n.data.byteLength,this.write);return R.set(p),this.write+=p.byteLength,this}if(n instanceof i.ByteStringBuffer&&(n=n.data,f="binary"),f=f||"binary",typeof n=="string"){var k;if(f==="hex")return this.accommodate(Math.ceil(n.length/2)),k=new Uint8Array(this.data.buffer,this.write),this.write+=i.binary.hex.decode(n,k,this.write),this;if(f==="base64")return this.accommodate(Math.ceil(n.length/4)*3),k=new Uint8Array(this.data.buffer,this.write),this.write+=i.binary.base64.decode(n,k,this.write),this;if(f==="utf8"&&(n=i.encodeUtf8(n),f="binary"),f==="binary"||f==="raw")return this.accommodate(n.length),k=new Uint8Array(this.data.buffer,this.write),this.write+=i.binary.raw.decode(k),this;if(f==="utf16")return this.accommodate(n.length*2),k=new Uint16Array(this.data.buffer,this.write),this.write+=i.text.utf16.encode(k),this;throw new Error("Invalid encoding: "+f)}throw Error("Invalid parameter: "+n)},i.DataBuffer.prototype.putBuffer=function(n){return this.putBytes(n),n.clear(),this},i.DataBuffer.prototype.putString=function(n){return this.putBytes(n,"utf16")},i.DataBuffer.prototype.putInt16=function(n){return this.accommodate(2),this.data.setInt16(this.write,n),this.write+=2,this},i.DataBuffer.prototype.putInt24=function(n){return this.accommodate(3),this.data.setInt16(this.write,n>>8&65535),this.data.setInt8(this.write,n>>16&255),this.write+=3,this},i.DataBuffer.prototype.putInt32=function(n){return this.accommodate(4),this.data.setInt32(this.write,n),this.write+=4,this},i.DataBuffer.prototype.putInt16Le=function(n){return this.accommodate(2),this.data.setInt16(this.write,n,!0),this.write+=2,this},i.DataBuffer.prototype.putInt24Le=function(n){return this.accommodate(3),this.data.setInt8(this.write,n>>16&255),this.data.setInt16(this.write,n>>8&65535,!0),this.write+=3,this},i.DataBuffer.prototype.putInt32Le=function(n){return this.accommodate(4),this.data.setInt32(this.write,n,!0),this.write+=4,this},i.DataBuffer.prototype.putInt=function(n,f){C(f),this.accommodate(f/8);do f-=8,this.data.setInt8(this.write++,n>>f&255);while(f>0);return this},i.DataBuffer.prototype.putSignedInt=function(n,f){return C(f),this.accommodate(f/8),n<0&&(n+=2<<f-1),this.putInt(n,f)},i.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},i.DataBuffer.prototype.getInt16=function(){var n=this.data.getInt16(this.read);return this.read+=2,n},i.DataBuffer.prototype.getInt24=function(){var n=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,n},i.DataBuffer.prototype.getInt32=function(){var n=this.data.getInt32(this.read);return this.read+=4,n},i.DataBuffer.prototype.getInt16Le=function(){var n=this.data.getInt16(this.read,!0);return this.read+=2,n},i.DataBuffer.prototype.getInt24Le=function(){var n=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,n},i.DataBuffer.prototype.getInt32Le=function(){var n=this.data.getInt32(this.read,!0);return this.read+=4,n},i.DataBuffer.prototype.getInt=function(n){C(n);var f=0;do f=(f<<8)+this.data.getInt8(this.read++),n-=8;while(n>0);return f},i.DataBuffer.prototype.getSignedInt=function(n){var f=this.getInt(n),p=2<<n-2;return f>=p&&(f-=p<<1),f},i.DataBuffer.prototype.getBytes=function(n){var f;return n?(n=Math.min(this.length(),n),f=this.data.slice(this.read,this.read+n),this.read+=n):n===0?f="":(f=this.read===0?this.data:this.data.slice(this.read),this.clear()),f},i.DataBuffer.prototype.bytes=function(n){return typeof n>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+n)},i.DataBuffer.prototype.at=function(n){return this.data.getUint8(this.read+n)},i.DataBuffer.prototype.setAt=function(n,f){return this.data.setUint8(n,f),this},i.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},i.DataBuffer.prototype.copy=function(){return new i.DataBuffer(this)},i.DataBuffer.prototype.compact=function(){if(this.read>0){var n=new Uint8Array(this.data.buffer,this.read),f=new Uint8Array(n.byteLength);f.set(n),this.data=new DataView(f),this.write-=this.read,this.read=0}return this},i.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},i.DataBuffer.prototype.truncate=function(n){return this.write=Math.max(0,this.length()-n),this.read=Math.min(this.read,this.write),this},i.DataBuffer.prototype.toHex=function(){for(var n="",f=this.read;f<this.data.byteLength;++f){var p=this.data.getUint8(f);p<16&&(n+="0"),n+=p.toString(16)}return n},i.DataBuffer.prototype.toString=function(n){var f=new Uint8Array(this.data,this.read,this.length());if(n=n||"utf8",n==="binary"||n==="raw")return i.binary.raw.encode(f);if(n==="hex")return i.binary.hex.encode(f);if(n==="base64")return i.binary.base64.encode(f);if(n==="utf8")return i.text.utf8.decode(f);if(n==="utf16")return i.text.utf16.decode(f);throw new Error("Invalid encoding: "+n)},i.createBuffer=function(n,f){return f=f||"raw",n!==void 0&&f==="utf8"&&(n=i.encodeUtf8(n)),new i.ByteBuffer(n)},i.fillString=function(n,f){for(var p="";f>0;)f&1&&(p+=n),f>>>=1,f>0&&(n+=n);return p},i.xorBytes=function(n,f,p){for(var A="",R="",k="",h=0,g=0;p>0;--p,++h)R=n.charCodeAt(h)^f.charCodeAt(h),g>=10&&(A+=k,k="",g=0),k+=String.fromCharCode(R),++g;return A+=k,A},i.hexToBytes=function(n){var f="",p=0;for(n.length&!0&&(p=1,f+=String.fromCharCode(parseInt(n[0],16)));p<n.length;p+=2)f+=String.fromCharCode(parseInt(n.substr(p,2),16));return f},i.bytesToHex=function(n){return i.createBuffer(n).toHex()},i.int32ToBytes=function(n){return String.fromCharCode(n>>24&255)+String.fromCharCode(n>>16&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n&255)};var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],u="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";i.encode64=function(n,f){for(var p="",A="",R,k,h,g=0;g<n.length;)R=n.charCodeAt(g++),k=n.charCodeAt(g++),h=n.charCodeAt(g++),p+=l.charAt(R>>2),p+=l.charAt((R&3)<<4|k>>4),isNaN(k)?p+="==":(p+=l.charAt((k&15)<<2|h>>6),p+=isNaN(h)?"=":l.charAt(h&63)),f&&p.length>f&&(A+=p.substr(0,f)+`\r
`,p=p.substr(f));return A+=p,A},i.decode64=function(n){n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var f="",p,A,R,k,h=0;h<n.length;)p=r[n.charCodeAt(h++)-43],A=r[n.charCodeAt(h++)-43],R=r[n.charCodeAt(h++)-43],k=r[n.charCodeAt(h++)-43],f+=String.fromCharCode(p<<2|A>>4),R!==64&&(f+=String.fromCharCode((A&15)<<4|R>>2),k!==64&&(f+=String.fromCharCode((R&3)<<6|k)));return f},i.encodeUtf8=function(n){return unescape(encodeURIComponent(n))},i.decodeUtf8=function(n){return decodeURIComponent(escape(n))},i.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:e.encode,decode:e.decode}},i.binary.raw.encode=function(n){return String.fromCharCode.apply(null,n)},i.binary.raw.decode=function(n,f,p){var A=f;A||(A=new Uint8Array(n.length)),p=p||0;for(var R=p,k=0;k<n.length;++k)A[R++]=n.charCodeAt(k);return f?R-p:A},i.binary.hex.encode=i.bytesToHex,i.binary.hex.decode=function(n,f,p){var A=f;A||(A=new Uint8Array(Math.ceil(n.length/2))),p=p||0;var R=0,k=p;for(n.length&1&&(R=1,A[k++]=parseInt(n[0],16));R<n.length;R+=2)A[k++]=parseInt(n.substr(R,2),16);return f?k-p:A},i.binary.base64.encode=function(n,f){for(var p="",A="",R,k,h,g=0;g<n.byteLength;)R=n[g++],k=n[g++],h=n[g++],p+=l.charAt(R>>2),p+=l.charAt((R&3)<<4|k>>4),isNaN(k)?p+="==":(p+=l.charAt((k&15)<<2|h>>6),p+=isNaN(h)?"=":l.charAt(h&63)),f&&p.length>f&&(A+=p.substr(0,f)+`\r
`,p=p.substr(f));return A+=p,A},i.binary.base64.decode=function(n,f,p){var A=f;A||(A=new Uint8Array(Math.ceil(n.length/4)*3)),n=n.replace(/[^A-Za-z0-9\+\/\=]/g,""),p=p||0;for(var R,k,h,g,N=0,t=p;N<n.length;)R=r[n.charCodeAt(N++)-43],k=r[n.charCodeAt(N++)-43],h=r[n.charCodeAt(N++)-43],g=r[n.charCodeAt(N++)-43],A[t++]=R<<2|k>>4,h!==64&&(A[t++]=(k&15)<<4|h>>2,g!==64&&(A[t++]=(h&3)<<6|g));return f?t-p:A.subarray(0,t)},i.binary.base58.encode=function(n,f){return i.binary.baseN.encode(n,u,f)},i.binary.base58.decode=function(n,f){return i.binary.baseN.decode(n,u,f)},i.text={utf8:{},utf16:{}},i.text.utf8.encode=function(n,f,p){n=i.encodeUtf8(n);var A=f;A||(A=new Uint8Array(n.length)),p=p||0;for(var R=p,k=0;k<n.length;++k)A[R++]=n.charCodeAt(k);return f?R-p:A},i.text.utf8.decode=function(n){return i.decodeUtf8(String.fromCharCode.apply(null,n))},i.text.utf16.encode=function(n,f,p){var A=f;A||(A=new Uint8Array(n.length*2));var R=new Uint16Array(A.buffer);p=p||0;for(var k=p,h=p,g=0;g<n.length;++g)R[h++]=n.charCodeAt(g),k+=2;return f?k-p:A},i.text.utf16.decode=function(n){return String.fromCharCode.apply(null,new Uint16Array(n.buffer))},i.deflate=function(n,f,p){if(f=i.decode64(n.deflate(i.encode64(f)).rval),p){var A=2,R=f.charCodeAt(1);R&32&&(A=6),f=f.substring(A,f.length-4)}return f},i.inflate=function(n,f,p){var A=n.inflate(i.encode64(f)).rval;return A===null?null:i.decode64(A)};var x=function(n,f,p){if(!n)throw new Error("WebStorage not available.");var A;if(p===null?A=n.removeItem(f):(p=i.encode64(JSON.stringify(p)),A=n.setItem(f,p)),typeof A<"u"&&A.rval!==!0){var R=new Error(A.error.message);throw R.id=A.error.id,R.name=A.error.name,R}},U=function(n,f){if(!n)throw new Error("WebStorage not available.");var p=n.getItem(f);if(n.init)if(p.rval===null){if(p.error){var A=new Error(p.error.message);throw A.id=p.error.id,A.name=p.error.name,A}p=null}else p=p.rval;return p!==null&&(p=JSON.parse(i.decode64(p))),p},m=function(n,f,p,A){var R=U(n,f);R===null&&(R={}),R[p]=A,x(n,f,R)},y=function(n,f,p){var A=U(n,f);return A!==null&&(A=p in A?A[p]:null),A},I=function(n,f,p){var A=U(n,f);if(A!==null&&p in A){delete A[p];var R=!0;for(var k in A){R=!1;break}R&&(A=null),x(n,f,A)}},d=function(n,f){x(n,f,null)},v=function(n,f,p){var A=null;typeof p>"u"&&(p=["web","flash"]);var R,k=!1,h=null;for(var g in p){R=p[g];try{if(R==="flash"||R==="both"){if(f[0]===null)throw new Error("Flash local storage not available.");A=n.apply(this,f),k=R==="flash"}(R==="web"||R==="both")&&(f[0]=localStorage,A=n.apply(this,f),k=!0)}catch(N){h=N}if(k)break}if(!k)throw h;return A};i.setItem=function(n,f,p,A,R){v(m,arguments,R)},i.getItem=function(n,f,p,A){return v(y,arguments,A)},i.removeItem=function(n,f,p,A){v(I,arguments,A)},i.clearItems=function(n,f,p){v(d,arguments,p)},i.isEmpty=function(n){for(var f in n)if(n.hasOwnProperty(f))return!1;return!0},i.format=function(n){for(var f=/%./g,p,A,R=0,k=[],h=0;p=f.exec(n);){A=n.substring(h,f.lastIndex-2),A.length>0&&k.push(A),h=f.lastIndex;var g=p[0][1];switch(g){case"s":case"o":R<arguments.length?k.push(arguments[R+++1]):k.push("<?>");break;case"%":k.push("%");break;default:k.push("<%"+g+"?>")}}return k.push(n.substring(h)),k.join("")},i.formatNumber=function(n,f,p,A){var R=n,k=isNaN(f=Math.abs(f))?2:f,h=p===void 0?",":p,g=A===void 0?".":A,N=R<0?"-":"",t=parseInt(R=Math.abs(+R||0).toFixed(k),10)+"",L=t.length>3?t.length%3:0;return N+(L?t.substr(0,L)+g:"")+t.substr(L).replace(/(\d{3})(?=\d)/g,"$1"+g)+(k?h+Math.abs(R-t).toFixed(k).slice(2):"")},i.formatSize=function(n){return n>=1073741824?n=i.formatNumber(n/1073741824,2,".","")+" GiB":n>=1048576?n=i.formatNumber(n/1048576,2,".","")+" MiB":n>=1024?n=i.formatNumber(n/1024,0)+" KiB":n=i.formatNumber(n,0)+" bytes",n},i.bytesFromIP=function(n){return n.indexOf(".")!==-1?i.bytesFromIPv4(n):n.indexOf(":")!==-1?i.bytesFromIPv6(n):null},i.bytesFromIPv4=function(n){if(n=n.split("."),n.length!==4)return null;for(var f=i.createBuffer(),p=0;p<n.length;++p){var A=parseInt(n[p],10);if(isNaN(A))return null;f.putByte(A)}return f.getBytes()},i.bytesFromIPv6=function(n){var f=0;n=n.split(":").filter(function(h){return h.length===0&&++f,!0});for(var p=(8-n.length+f)*2,A=i.createBuffer(),R=0;R<8;++R){if(!n[R]||n[R].length===0){A.fillWithByte(0,p),p=0;continue}var k=i.hexToBytes(n[R]);k.length<2&&A.putByte(0),A.putBytes(k)}return A.getBytes()},i.bytesToIP=function(n){return n.length===4?i.bytesToIPv4(n):n.length===16?i.bytesToIPv6(n):null},i.bytesToIPv4=function(n){if(n.length!==4)return null;for(var f=[],p=0;p<n.length;++p)f.push(n.charCodeAt(p));return f.join(".")},i.bytesToIPv6=function(n){if(n.length!==16)return null;for(var f=[],p=[],A=0,R=0;R<n.length;R+=2){for(var k=i.bytesToHex(n[R]+n[R+1]);k[0]==="0"&&k!=="0";)k=k.substr(1);if(k==="0"){var h=p[p.length-1],g=f.length;!h||g!==h.end+1?p.push({start:g,end:g}):(h.end=g,h.end-h.start>p[A].end-p[A].start&&(A=p.length-1))}f.push(k)}if(p.length>0){var N=p[A];N.end-N.start>0&&(f.splice(N.start,N.end-N.start+1,""),N.start===0&&f.unshift(""),N.end===7&&f.push(""))}return f.join(":")},i.estimateCores=function(n,f){if(typeof n=="function"&&(f=n,n={}),n=n||{},"cores"in i&&!n.update)return f(null,i.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return i.cores=navigator.hardwareConcurrency,f(null,i.cores);if(typeof Worker>"u")return i.cores=1,f(null,i.cores);if(typeof Blob>"u")return i.cores=2,f(null,i.cores);var p=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(h){for(var g=Date.now(),N=g+4;Date.now()<N;);self.postMessage({st:g,et:N})})}.toString(),")()"],{type:"application/javascript"}));A([],5,16);function A(h,g,N){if(g===0){var t=Math.floor(h.reduce(function(L,O){return L+O},0)/h.length);return i.cores=Math.max(1,t),URL.revokeObjectURL(p),f(null,i.cores)}R(N,function(L,O){h.push(k(N,O)),A(h,g-1,N)})}function R(h,g){for(var N=[],t=[],L=0;L<h;++L){var O=new Worker(p);O.addEventListener("message",function(w){if(t.push(w.data),t.length===h){for(var M=0;M<h;++M)N[M].terminate();g(null,t)}}),N.push(O)}for(var L=0;L<h;++L)N[L].postMessage(L)}function k(h,g){for(var N=[],t=0;t<h;++t)for(var L=g[t],O=N[t]=[],w=0;w<h;++w)if(t!==w){var M=g[w];(L.st>M.st&&L.st<M.et||M.st>L.st&&M.st<L.et)&&O.push(w)}return N.reduce(function(K,G){return Math.max(K,G.length)},0)}}},63543:(re,ce,V)=>{var a=V(96560);V(57220),V(19462),V(37187),V(31502),V(57361),V(4646),V(38813),V(42242),V(13865),V(64687);var e=a.asn1,i=re.exports=a.pki=a.pki||{},C=i.oids,E={};E.CN=C.commonName,E.commonName="CN",E.C=C.countryName,E.countryName="C",E.L=C.localityName,E.localityName="L",E.ST=C.stateOrProvinceName,E.stateOrProvinceName="ST",E.O=C.organizationName,E.organizationName="O",E.OU=C.organizationalUnitName,E.organizationalUnitName="OU",E.E=C.emailAddress,E.emailAddress="E";var S=a.pki.rsa.publicKeyValidator,c={name:"Certificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},S,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},l={name:"rsapss",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},r={name:"CertificationRequestInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},S,{name:"CertificationRequestInfo.attributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0}]}]}]},u={name:"CertificationRequest",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[r,{name:"CertificationRequest.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};i.RDNAttributesAsArray=function(h,g){for(var N=[],t,L,O,w=0;w<h.value.length;++w){t=h.value[w];for(var M=0;M<t.value.length;++M)O={},L=t.value[M],O.type=e.derToOid(L.value[0].value),O.value=L.value[1].value,O.valueTagClass=L.value[1].type,O.type in C&&(O.name=C[O.type],O.name in E&&(O.shortName=E[O.name])),g&&(g.update(O.type),g.update(O.value)),N.push(O)}return N},i.CRIAttributesAsArray=function(h){for(var g=[],N=0;N<h.length;++N)for(var t=h[N],L=e.derToOid(t.value[0].value),O=t.value[1].value,w=0;w<O.length;++w){var M={};if(M.type=L,M.value=O[w].value,M.valueTagClass=O[w].type,M.type in C&&(M.name=C[M.type],M.name in E&&(M.shortName=E[M.name])),M.type===C.extensionRequest){M.extensions=[];for(var K=0;K<M.value.length;++K)M.extensions.push(i.certificateExtensionFromAsn1(M.value[K]))}g.push(M)}return g};function x(h,g){typeof g=="string"&&(g={shortName:g});for(var N=null,t,L=0;N===null&&L<h.attributes.length;++L)t=h.attributes[L],(g.type&&g.type===t.type||g.name&&g.name===t.name||g.shortName&&g.shortName===t.shortName)&&(N=t);return N}var U=function(h,g,N){var t={};if(h!==C["RSASSA-PSS"])return t;N&&(t={hash:{algorithmOid:C.sha1},mgf:{algorithmOid:C.mgf1,hash:{algorithmOid:C.sha1}},saltLength:20});var L={},O=[];if(!e.validate(g,l,L,O)){var w=new Error("Cannot read RSASSA-PSS parameter block.");throw w.errors=O,w}return L.hashOid!==void 0&&(t.hash=t.hash||{},t.hash.algorithmOid=e.derToOid(L.hashOid)),L.maskGenOid!==void 0&&(t.mgf=t.mgf||{},t.mgf.algorithmOid=e.derToOid(L.maskGenOid),t.mgf.hash=t.mgf.hash||{},t.mgf.hash.algorithmOid=e.derToOid(L.maskGenHashOid)),L.saltLength!==void 0&&(t.saltLength=L.saltLength.charCodeAt(0)),t},m=function(h){switch(C[h.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return a.md.sha1.create();case"md5WithRSAEncryption":return a.md.md5.create();case"sha256WithRSAEncryption":return a.md.sha256.create();case"sha384WithRSAEncryption":return a.md.sha384.create();case"sha512WithRSAEncryption":return a.md.sha512.create();case"RSASSA-PSS":return a.md.sha256.create();default:var g=new Error("Could not compute "+h.type+" digest. Unknown signature OID.");throw g.signatureOid=h.signatureOid,g}},y=function(h){var g=h.certificate,N;switch(g.signatureOid){case C.sha1WithRSAEncryption:case C.sha1WithRSASignature:break;case C["RSASSA-PSS"]:var t,L;if(t=C[g.signatureParameters.mgf.hash.algorithmOid],t===void 0||a.md[t]===void 0){var O=new Error("Unsupported MGF hash function.");throw O.oid=g.signatureParameters.mgf.hash.algorithmOid,O.name=t,O}if(L=C[g.signatureParameters.mgf.algorithmOid],L===void 0||a.mgf[L]===void 0){var O=new Error("Unsupported MGF function.");throw O.oid=g.signatureParameters.mgf.algorithmOid,O.name=L,O}if(L=a.mgf[L].create(a.md[t].create()),t=C[g.signatureParameters.hash.algorithmOid],t===void 0||a.md[t]===void 0){var O=new Error("Unsupported RSASSA-PSS hash function.");throw O.oid=g.signatureParameters.hash.algorithmOid,O.name=t,O}N=a.pss.create(a.md[t].create(),L,g.signatureParameters.saltLength);break}return g.publicKey.verify(h.md.digest().getBytes(),h.signature,N)};i.certificateFromPem=function(h,g,N){var t=a.pem.decode(h)[0];if(t.type!=="CERTIFICATE"&&t.type!=="X509 CERTIFICATE"&&t.type!=="TRUSTED CERTIFICATE"){var L=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw L.headerType=t.type,L}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var O=e.fromDer(t.body,N);return i.certificateFromAsn1(O,g)},i.certificateToPem=function(h,g){var N={type:"CERTIFICATE",body:e.toDer(i.certificateToAsn1(h)).getBytes()};return a.pem.encode(N,{maxline:g})},i.publicKeyFromPem=function(h){var g=a.pem.decode(h)[0];if(g.type!=="PUBLIC KEY"&&g.type!=="RSA PUBLIC KEY"){var N=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw N.headerType=g.type,N}if(g.procType&&g.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var t=e.fromDer(g.body);return i.publicKeyFromAsn1(t)},i.publicKeyToPem=function(h,g){var N={type:"PUBLIC KEY",body:e.toDer(i.publicKeyToAsn1(h)).getBytes()};return a.pem.encode(N,{maxline:g})},i.publicKeyToRSAPublicKeyPem=function(h,g){var N={type:"RSA PUBLIC KEY",body:e.toDer(i.publicKeyToRSAPublicKey(h)).getBytes()};return a.pem.encode(N,{maxline:g})},i.getPublicKeyFingerprint=function(h,g){g=g||{};var N=g.md||a.md.sha1.create(),t=g.type||"RSAPublicKey",L;switch(t){case"RSAPublicKey":L=e.toDer(i.publicKeyToRSAPublicKey(h)).getBytes();break;case"SubjectPublicKeyInfo":L=e.toDer(i.publicKeyToAsn1(h)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+g.type+'".')}N.start(),N.update(L);var O=N.digest();if(g.encoding==="hex"){var w=O.toHex();return g.delimiter?w.match(/.{2}/g).join(g.delimiter):w}else{if(g.encoding==="binary")return O.getBytes();if(g.encoding)throw new Error('Unknown encoding "'+g.encoding+'".')}return O},i.certificationRequestFromPem=function(h,g,N){var t=a.pem.decode(h)[0];if(t.type!=="CERTIFICATE REQUEST"){var L=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw L.headerType=t.type,L}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var O=e.fromDer(t.body,N);return i.certificationRequestFromAsn1(O,g)},i.certificationRequestToPem=function(h,g){var N={type:"CERTIFICATE REQUEST",body:e.toDer(i.certificationRequestToAsn1(h)).getBytes()};return a.pem.encode(N,{maxline:g})},i.createCertificate=function(){var h={};return h.version=2,h.serialNumber="00",h.signatureOid=null,h.signature=null,h.siginfo={},h.siginfo.algorithmOid=null,h.validity={},h.validity.notBefore=new Date,h.validity.notAfter=new Date,h.issuer={},h.issuer.getField=function(g){return x(h.issuer,g)},h.issuer.addField=function(g){v([g]),h.issuer.attributes.push(g)},h.issuer.attributes=[],h.issuer.hash=null,h.subject={},h.subject.getField=function(g){return x(h.subject,g)},h.subject.addField=function(g){v([g]),h.subject.attributes.push(g)},h.subject.attributes=[],h.subject.hash=null,h.extensions=[],h.publicKey=null,h.md=null,h.setSubject=function(g,N){v(g),h.subject.attributes=g,delete h.subject.uniqueId,N&&(h.subject.uniqueId=N),h.subject.hash=null},h.setIssuer=function(g,N){v(g),h.issuer.attributes=g,delete h.issuer.uniqueId,N&&(h.issuer.uniqueId=N),h.issuer.hash=null},h.setExtensions=function(g){for(var N=0;N<g.length;++N)n(g[N],{cert:h});h.extensions=g},h.getExtension=function(g){typeof g=="string"&&(g={name:g});for(var N=null,t,L=0;N===null&&L<h.extensions.length;++L)t=h.extensions[L],(g.id&&t.id===g.id||g.name&&t.name===g.name)&&(N=t);return N},h.sign=function(g,N){h.md=N||a.md.sha1.create();var t=C[h.md.algorithm+"WithRSAEncryption"];if(!t){var L=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw L.algorithm=h.md.algorithm,L}h.signatureOid=h.siginfo.algorithmOid=t,h.tbsCertificate=i.getTBSCertificate(h);var O=e.toDer(h.tbsCertificate);h.md.update(O.getBytes()),h.signature=g.sign(h.md)},h.verify=function(g){var N=!1;if(!h.issued(g)){var t=g.issuer,L=h.subject,O=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw O.expectedIssuer=L.attributes,O.actualIssuer=t.attributes,O}var w=g.md;if(w===null){w=m({signatureOid:g.signatureOid,type:"certificate"});var M=g.tbsCertificate||i.getTBSCertificate(g),K=e.toDer(M);w.update(K.getBytes())}return w!==null&&(N=y({certificate:h,md:w,signature:g.signature})),N},h.isIssuer=function(g){var N=!1,t=h.issuer,L=g.subject;if(t.hash&&L.hash)N=t.hash===L.hash;else if(t.attributes.length===L.attributes.length){N=!0;for(var O,w,M=0;N&&M<t.attributes.length;++M)O=t.attributes[M],w=L.attributes[M],(O.type!==w.type||O.value!==w.value)&&(N=!1)}return N},h.issued=function(g){return g.isIssuer(h)},h.generateSubjectKeyIdentifier=function(){return i.getPublicKeyFingerprint(h.publicKey,{type:"RSAPublicKey"})},h.verifySubjectKeyIdentifier=function(){for(var g=C.subjectKeyIdentifier,N=0;N<h.extensions.length;++N){var t=h.extensions[N];if(t.id===g){var L=h.generateSubjectKeyIdentifier().getBytes();return a.util.hexToBytes(t.subjectKeyIdentifier)===L}}return!1},h},i.certificateFromAsn1=function(h,g){var N={},t=[];if(!e.validate(h,c,N,t)){var L=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw L.errors=t,L}var O=e.derToOid(N.publicKeyOid);if(O!==i.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var w=i.createCertificate();w.version=N.certVersion?N.certVersion.charCodeAt(0):0;var M=a.util.createBuffer(N.certSerialNumber);w.serialNumber=M.toHex(),w.signatureOid=a.asn1.derToOid(N.certSignatureOid),w.signatureParameters=U(w.signatureOid,N.certSignatureParams,!0),w.siginfo.algorithmOid=a.asn1.derToOid(N.certinfoSignatureOid),w.siginfo.parameters=U(w.siginfo.algorithmOid,N.certinfoSignatureParams,!1),w.signature=N.certSignature;var K=[];if(N.certValidity1UTCTime!==void 0&&K.push(e.utcTimeToDate(N.certValidity1UTCTime)),N.certValidity2GeneralizedTime!==void 0&&K.push(e.generalizedTimeToDate(N.certValidity2GeneralizedTime)),N.certValidity3UTCTime!==void 0&&K.push(e.utcTimeToDate(N.certValidity3UTCTime)),N.certValidity4GeneralizedTime!==void 0&&K.push(e.generalizedTimeToDate(N.certValidity4GeneralizedTime)),K.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(K.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(w.validity.notBefore=K[0],w.validity.notAfter=K[1],w.tbsCertificate=N.tbsCertificate,g){w.md=m({signatureOid:w.signatureOid,type:"certificate"});var G=e.toDer(w.tbsCertificate);w.md.update(G.getBytes())}var X=a.md.sha1.create(),W=e.toDer(N.certIssuer);X.update(W.getBytes()),w.issuer.getField=function(fe){return x(w.issuer,fe)},w.issuer.addField=function(fe){v([fe]),w.issuer.attributes.push(fe)},w.issuer.attributes=i.RDNAttributesAsArray(N.certIssuer),N.certIssuerUniqueId&&(w.issuer.uniqueId=N.certIssuerUniqueId),w.issuer.hash=X.digest().toHex();var q=a.md.sha1.create(),te=e.toDer(N.certSubject);return q.update(te.getBytes()),w.subject.getField=function(fe){return x(w.subject,fe)},w.subject.addField=function(fe){v([fe]),w.subject.attributes.push(fe)},w.subject.attributes=i.RDNAttributesAsArray(N.certSubject),N.certSubjectUniqueId&&(w.subject.uniqueId=N.certSubjectUniqueId),w.subject.hash=q.digest().toHex(),N.certExtensions?w.extensions=i.certificateExtensionsFromAsn1(N.certExtensions):w.extensions=[],w.publicKey=i.publicKeyFromAsn1(N.subjectPublicKeyInfo),w},i.certificateExtensionsFromAsn1=function(h){for(var g=[],N=0;N<h.value.length;++N)for(var t=h.value[N],L=0;L<t.value.length;++L)g.push(i.certificateExtensionFromAsn1(t.value[L]));return g},i.certificateExtensionFromAsn1=function(h){var g={};if(g.id=e.derToOid(h.value[0].value),g.critical=!1,h.value[1].type===e.Type.BOOLEAN?(g.critical=h.value[1].value.charCodeAt(0)!==0,g.value=h.value[2].value):g.value=h.value[1].value,g.id in C){if(g.name=C[g.id],g.name==="keyUsage"){var N=e.fromDer(g.value),t=0,L=0;N.value.length>1&&(t=N.value.charCodeAt(1),L=N.value.length>2?N.value.charCodeAt(2):0),g.digitalSignature=(t&128)===128,g.nonRepudiation=(t&64)===64,g.keyEncipherment=(t&32)===32,g.dataEncipherment=(t&16)===16,g.keyAgreement=(t&8)===8,g.keyCertSign=(t&4)===4,g.cRLSign=(t&2)===2,g.encipherOnly=(t&1)===1,g.decipherOnly=(L&128)===128}else if(g.name==="basicConstraints"){var N=e.fromDer(g.value);N.value.length>0&&N.value[0].type===e.Type.BOOLEAN?g.cA=N.value[0].value.charCodeAt(0)!==0:g.cA=!1;var O=null;N.value.length>0&&N.value[0].type===e.Type.INTEGER?O=N.value[0].value:N.value.length>1&&(O=N.value[1].value),O!==null&&(g.pathLenConstraint=e.derToInteger(O))}else if(g.name==="extKeyUsage")for(var N=e.fromDer(g.value),w=0;w<N.value.length;++w){var M=e.derToOid(N.value[w].value);M in C?g[C[M]]=!0:g[M]=!0}else if(g.name==="nsCertType"){var N=e.fromDer(g.value),t=0;N.value.length>1&&(t=N.value.charCodeAt(1)),g.client=(t&128)===128,g.server=(t&64)===64,g.email=(t&32)===32,g.objsign=(t&16)===16,g.reserved=(t&8)===8,g.sslCA=(t&4)===4,g.emailCA=(t&2)===2,g.objCA=(t&1)===1}else if(g.name==="subjectAltName"||g.name==="issuerAltName"){g.altNames=[];for(var K,N=e.fromDer(g.value),G=0;G<N.value.length;++G){K=N.value[G];var X={type:K.type,value:K.value};switch(g.altNames.push(X),K.type){case 1:case 2:case 6:break;case 7:X.ip=a.util.bytesToIP(K.value);break;case 8:X.oid=e.derToOid(K.value);break;default:}}}else if(g.name==="subjectKeyIdentifier"){var N=e.fromDer(g.value);g.subjectKeyIdentifier=a.util.bytesToHex(N.value)}}return g},i.certificationRequestFromAsn1=function(h,g){var N={},t=[];if(!e.validate(h,u,N,t)){var L=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw L.errors=t,L}var O=e.derToOid(N.publicKeyOid);if(O!==i.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var w=i.createCertificationRequest();if(w.version=N.csrVersion?N.csrVersion.charCodeAt(0):0,w.signatureOid=a.asn1.derToOid(N.csrSignatureOid),w.signatureParameters=U(w.signatureOid,N.csrSignatureParams,!0),w.siginfo.algorithmOid=a.asn1.derToOid(N.csrSignatureOid),w.siginfo.parameters=U(w.siginfo.algorithmOid,N.csrSignatureParams,!1),w.signature=N.csrSignature,w.certificationRequestInfo=N.certificationRequestInfo,g){w.md=m({signatureOid:w.signatureOid,type:"certification request"});var M=e.toDer(w.certificationRequestInfo);w.md.update(M.getBytes())}var K=a.md.sha1.create();return w.subject.getField=function(G){return x(w.subject,G)},w.subject.addField=function(G){v([G]),w.subject.attributes.push(G)},w.subject.attributes=i.RDNAttributesAsArray(N.certificationRequestInfoSubject,K),w.subject.hash=K.digest().toHex(),w.publicKey=i.publicKeyFromAsn1(N.subjectPublicKeyInfo),w.getAttribute=function(G){return x(w,G)},w.addAttribute=function(G){v([G]),w.attributes.push(G)},w.attributes=i.CRIAttributesAsArray(N.certificationRequestInfoAttributes||[]),w},i.createCertificationRequest=function(){var h={};return h.version=0,h.signatureOid=null,h.signature=null,h.siginfo={},h.siginfo.algorithmOid=null,h.subject={},h.subject.getField=function(g){return x(h.subject,g)},h.subject.addField=function(g){v([g]),h.subject.attributes.push(g)},h.subject.attributes=[],h.subject.hash=null,h.publicKey=null,h.attributes=[],h.getAttribute=function(g){return x(h,g)},h.addAttribute=function(g){v([g]),h.attributes.push(g)},h.md=null,h.setSubject=function(g){v(g),h.subject.attributes=g,h.subject.hash=null},h.setAttributes=function(g){v(g),h.attributes=g},h.sign=function(g,N){h.md=N||a.md.sha1.create();var t=C[h.md.algorithm+"WithRSAEncryption"];if(!t){var L=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw L.algorithm=h.md.algorithm,L}h.signatureOid=h.siginfo.algorithmOid=t,h.certificationRequestInfo=i.getCertificationRequestInfo(h);var O=e.toDer(h.certificationRequestInfo);h.md.update(O.getBytes()),h.signature=g.sign(h.md)},h.verify=function(){var g=!1,N=h.md;if(N===null){N=m({signatureOid:h.signatureOid,type:"certification request"});var t=h.certificationRequestInfo||i.getCertificationRequestInfo(h),L=e.toDer(t);N.update(L.getBytes())}return N!==null&&(g=y({certificate:h,md:N,signature:h.signature})),g},h};function I(h){for(var g=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),N,t,L=h.attributes,O=0;O<L.length;++O){N=L[O];var w=N.value,M=e.Type.PRINTABLESTRING;"valueTagClass"in N&&(M=N.valueTagClass,M===e.Type.UTF8&&(w=a.util.encodeUtf8(w))),t=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(N.type).getBytes()),e.create(e.Class.UNIVERSAL,M,!1,w)])]),g.value.push(t)}return g}function d(h){for(var g={},N=0;N<h.length;++N){var t=h[N];if(t.shortName&&(t.valueTagClass===e.Type.UTF8||t.valueTagClass===e.Type.PRINTABLESTRING||t.valueTagClass===e.Type.IA5STRING)){var L=t.value;t.valueTagClass===e.Type.UTF8&&(L=a.util.encodeUtf8(t.value)),t.shortName in g?a.util.isArray(g[t.shortName])?g[t.shortName].push(L):g[t.shortName]=[g[t.shortName],L]:g[t.shortName]=L}}return g}function v(h){for(var g,N=0;N<h.length;++N){if(g=h[N],typeof g.name>"u"&&(g.type&&g.type in i.oids?g.name=i.oids[g.type]:g.shortName&&g.shortName in E&&(g.name=i.oids[E[g.shortName]])),typeof g.type>"u")if(g.name&&g.name in i.oids)g.type=i.oids[g.name];else{var t=new Error("Attribute type not specified.");throw t.attribute=g,t}if(typeof g.shortName>"u"&&g.name&&g.name in E&&(g.shortName=E[g.name]),g.type===C.extensionRequest&&(g.valueConstructed=!0,g.valueTagClass=e.Type.SEQUENCE,!g.value&&g.extensions)){g.value=[];for(var L=0;L<g.extensions.length;++L)g.value.push(i.certificateExtensionToAsn1(n(g.extensions[L])))}if(typeof g.value>"u"){var t=new Error("Attribute value not specified.");throw t.attribute=g,t}}}function n(h,g){if(g=g||{},typeof h.name>"u"&&h.id&&h.id in i.oids&&(h.name=i.oids[h.id]),typeof h.id>"u")if(h.name&&h.name in i.oids)h.id=i.oids[h.name];else{var N=new Error("Extension ID not specified.");throw N.extension=h,N}if(typeof h.value<"u")return h;if(h.name==="keyUsage"){var t=0,L=0,O=0;h.digitalSignature&&(L|=128,t=7),h.nonRepudiation&&(L|=64,t=6),h.keyEncipherment&&(L|=32,t=5),h.dataEncipherment&&(L|=16,t=4),h.keyAgreement&&(L|=8,t=3),h.keyCertSign&&(L|=4,t=2),h.cRLSign&&(L|=2,t=1),h.encipherOnly&&(L|=1,t=0),h.decipherOnly&&(O|=128,t=7);var w=String.fromCharCode(t);O!==0?w+=String.fromCharCode(L)+String.fromCharCode(O):L!==0&&(w+=String.fromCharCode(L)),h.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,w)}else if(h.name==="basicConstraints")h.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),h.cA&&h.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"\xFF")),"pathLenConstraint"in h&&h.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(h.pathLenConstraint).getBytes()));else if(h.name==="extKeyUsage"){h.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var M=h.value.value;for(var K in h)h[K]===!0&&(K in C?M.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(C[K]).getBytes())):K.indexOf(".")!==-1&&M.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(K).getBytes())))}else if(h.name==="nsCertType"){var t=0,L=0;h.client&&(L|=128,t=7),h.server&&(L|=64,t=6),h.email&&(L|=32,t=5),h.objsign&&(L|=16,t=4),h.reserved&&(L|=8,t=3),h.sslCA&&(L|=4,t=2),h.emailCA&&(L|=2,t=1),h.objCA&&(L|=1,t=0);var w=String.fromCharCode(t);L!==0&&(w+=String.fromCharCode(L)),h.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,w)}else if(h.name==="subjectAltName"||h.name==="issuerAltName"){h.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var G,X=0;X<h.altNames.length;++X){G=h.altNames[X];var w=G.value;if(G.type===7&&G.ip){if(w=a.util.bytesFromIP(G.ip),w===null){var N=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw N.extension=h,N}}else G.type===8&&(G.oid?w=e.oidToDer(e.oidToDer(G.oid)):w=e.oidToDer(w));h.value.value.push(e.create(e.Class.CONTEXT_SPECIFIC,G.type,!1,w))}}else if(h.name==="nsComment"&&g.cert){if(!/^[\x00-\x7F]*$/.test(h.comment)||h.comment.length<1||h.comment.length>128)throw new Error('Invalid "nsComment" content.');h.value=e.create(e.Class.UNIVERSAL,e.Type.IA5STRING,!1,h.comment)}else if(h.name==="subjectKeyIdentifier"&&g.cert){var W=g.cert.generateSubjectKeyIdentifier();h.subjectKeyIdentifier=W.toHex(),h.value=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,W.getBytes())}else if(h.name==="authorityKeyIdentifier"&&g.cert){h.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var M=h.value.value;if(h.keyIdentifier){var q=h.keyIdentifier===!0?g.cert.generateSubjectKeyIdentifier().getBytes():h.keyIdentifier;M.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!1,q))}if(h.authorityCertIssuer){var te=[e.create(e.Class.CONTEXT_SPECIFIC,4,!0,[I(h.authorityCertIssuer===!0?g.cert.issuer:h.authorityCertIssuer)])];M.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,te))}if(h.serialNumber){var fe=a.util.hexToBytes(h.serialNumber===!0?g.cert.serialNumber:h.serialNumber);M.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!1,fe))}}else if(h.name==="cRLDistributionPoints"){h.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var M=h.value.value,he=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),pe=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]),G,X=0;X<h.altNames.length;++X){G=h.altNames[X];var w=G.value;if(G.type===7&&G.ip){if(w=a.util.bytesFromIP(G.ip),w===null){var N=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw N.extension=h,N}}else G.type===8&&(G.oid?w=e.oidToDer(e.oidToDer(G.oid)):w=e.oidToDer(w));pe.value.push(e.create(e.Class.CONTEXT_SPECIFIC,G.type,!1,w))}he.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[pe])),M.push(he)}if(typeof h.value>"u"){var N=new Error("Extension value not specified.");throw N.extension=h,N}return h}function f(h,g){switch(h){case C["RSASSA-PSS"]:var N=[];return g.hash.algorithmOid!==void 0&&N.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])),g.mgf.algorithmOid!==void 0&&N.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g.mgf.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g.mgf.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])])),g.saltLength!==void 0&&N.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(g.saltLength).getBytes())])),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,N);default:return e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")}}function p(h){var g=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);if(h.attributes.length===0)return g;for(var N=h.attributes,t=0;t<N.length;++t){var L=N[t],O=L.value,w=e.Type.UTF8;"valueTagClass"in L&&(w=L.valueTagClass),w===e.Type.UTF8&&(O=a.util.encodeUtf8(O));var M=!1;"valueConstructed"in L&&(M=L.valueConstructed);var K=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(L.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,w,M,O)])]);g.value.push(K)}return g}var A=new Date("1950-01-01T00:00:00Z"),R=new Date("2050-01-01T00:00:00Z");function k(h){return h>=A&&h<R?e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(h)):e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(h))}i.getTBSCertificate=function(h){var g=k(h.validity.notBefore),N=k(h.validity.notAfter),t=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(h.version).getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,a.util.hexToBytes(h.serialNumber)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.siginfo.algorithmOid).getBytes()),f(h.siginfo.algorithmOid,h.siginfo.parameters)]),I(h.issuer),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[g,N]),I(h.subject),i.publicKeyToAsn1(h.publicKey)]);return h.issuer.uniqueId&&t.value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+h.issuer.uniqueId)])),h.subject.uniqueId&&t.value.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+h.subject.uniqueId)])),h.extensions.length>0&&t.value.push(i.certificateExtensionsToAsn1(h.extensions)),t},i.getCertificationRequestInfo=function(h){var g=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(h.version).getBytes()),I(h.subject),i.publicKeyToAsn1(h.publicKey),p(h)]);return g},i.distinguishedNameToAsn1=function(h){return I(h)},i.certificateToAsn1=function(h){var g=h.tbsCertificate||i.getTBSCertificate(h);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[g,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.signatureOid).getBytes()),f(h.signatureOid,h.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+h.signature)])},i.certificateExtensionsToAsn1=function(h){var g=e.create(e.Class.CONTEXT_SPECIFIC,3,!0,[]),N=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);g.value.push(N);for(var t=0;t<h.length;++t)N.value.push(i.certificateExtensionToAsn1(h[t]));return g},i.certificateExtensionToAsn1=function(h){var g=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);g.value.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.id).getBytes())),h.critical&&g.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"\xFF"));var N=h.value;return typeof h.value!="string"&&(N=e.toDer(N).getBytes()),g.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,N)),g},i.certificationRequestToAsn1=function(h){var g=h.certificationRequestInfo||i.getCertificationRequestInfo(h);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[g,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.signatureOid).getBytes()),f(h.signatureOid,h.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+h.signature)])},i.createCaStore=function(h){var g={certs:{}};g.getIssuer=function(w){var M=N(w.issuer);return M},g.addCertificate=function(w){if(typeof w=="string"&&(w=a.pki.certificateFromPem(w)),t(w.subject),!g.hasCertificate(w))if(w.subject.hash in g.certs){var M=g.certs[w.subject.hash];a.util.isArray(M)||(M=[M]),M.push(w),g.certs[w.subject.hash]=M}else g.certs[w.subject.hash]=w},g.hasCertificate=function(w){typeof w=="string"&&(w=a.pki.certificateFromPem(w));var M=N(w.subject);if(!M)return!1;a.util.isArray(M)||(M=[M]);for(var K=e.toDer(i.certificateToAsn1(w)).getBytes(),G=0;G<M.length;++G){var X=e.toDer(i.certificateToAsn1(M[G])).getBytes();if(K===X)return!0}return!1},g.listAllCertificates=function(){var w=[];for(var M in g.certs)if(g.certs.hasOwnProperty(M)){var K=g.certs[M];if(!a.util.isArray(K))w.push(K);else for(var G=0;G<K.length;++G)w.push(K[G])}return w},g.removeCertificate=function(w){var M;if(typeof w=="string"&&(w=a.pki.certificateFromPem(w)),t(w.subject),!g.hasCertificate(w))return null;var K=N(w.subject);if(!a.util.isArray(K))return M=g.certs[w.subject.hash],delete g.certs[w.subject.hash],M;for(var G=e.toDer(i.certificateToAsn1(w)).getBytes(),X=0;X<K.length;++X){var W=e.toDer(i.certificateToAsn1(K[X])).getBytes();G===W&&(M=K[X],K.splice(X,1))}return K.length===0&&delete g.certs[w.subject.hash],M};function N(w){return t(w),g.certs[w.hash]||null}function t(w){if(!w.hash){var M=a.md.sha1.create();w.attributes=i.RDNAttributesAsArray(I(w),M),w.hash=M.digest().toHex()}}if(h)for(var L=0;L<h.length;++L){var O=h[L];g.addCertificate(O)}return g},i.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},i.verifyCertificateChain=function(h,g,N){typeof N=="function"&&(N={verify:N}),N=N||{},g=g.slice(0);var t=g.slice(0),L=N.validityCheckDate;typeof L>"u"&&(L=new Date);var O=!0,w=null,M=0;do{var K=g.shift(),G=null,X=!1;if(L&&(L<K.validity.notBefore||L>K.validity.notAfter)&&(w={message:"Certificate is not valid yet or has expired.",error:i.certificateError.certificate_expired,notBefore:K.validity.notBefore,notAfter:K.validity.notAfter,now:L}),w===null){if(G=g[0]||h.getIssuer(K),G===null&&K.isIssuer(K)&&(X=!0,G=K),G){var W=G;a.util.isArray(W)||(W=[W]);for(var q=!1;!q&&W.length>0;){G=W.shift();try{q=G.verify(K)}catch{}}q||(w={message:"Certificate signature is invalid.",error:i.certificateError.bad_certificate})}w===null&&(!G||X)&&!h.hasCertificate(K)&&(w={message:"Certificate is not trusted.",error:i.certificateError.unknown_ca})}if(w===null&&G&&!K.isIssuer(G)&&(w={message:"Certificate issuer is invalid.",error:i.certificateError.bad_certificate}),w===null)for(var te={keyUsage:!0,basicConstraints:!0},fe=0;w===null&&fe<K.extensions.length;++fe){var he=K.extensions[fe];he.critical&&!(he.name in te)&&(w={message:"Certificate has an unsupported critical extension.",error:i.certificateError.unsupported_certificate})}if(w===null&&(!O||g.length===0&&(!G||X))){var pe=K.getExtension("basicConstraints"),J=K.getExtension("keyUsage");if(J!==null&&(!J.keyCertSign||pe===null)&&(w={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:i.certificateError.bad_certificate}),w===null&&pe!==null&&!pe.cA&&(w={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:i.certificateError.bad_certificate}),w===null&&J!==null&&"pathLenConstraint"in pe){var me=M-1;me>pe.pathLenConstraint&&(w={message:"Certificate basicConstraints pathLenConstraint violated.",error:i.certificateError.bad_certificate})}}var ie=w===null?!0:w.error,ge=N.verify?N.verify(ie,M,t):ie;if(ge===!0)w=null;else throw ie===!0&&(w={message:"The application rejected the certificate.",error:i.certificateError.bad_certificate}),(ge||ge===0)&&(typeof ge=="object"&&!a.util.isArray(ge)?(ge.message&&(w.message=ge.message),ge.error&&(w.error=ge.error)):typeof ge=="string"&&(w.error=ge)),w;O=!1,++M}while(g.length>0);return!0}}}]);
