(self.webpackChunkapp_studio_enterprise_schema_view=self.webpackChunkapp_studio_enterprise_schema_view||[]).push([[89926,73308,50927,28546,6165,62832,40451,18070,95689,94260,71879,41421,63802,86183,8564,30945,53326,75707,98088,20469,42850,70422,48041,15184,92803,80898,58517,25660,3279,91374,68993,83231,67545],{67545:(S,p,n)=>{n.r(p),n.d(p,{BaseAudienceHandler:()=>f,BaseAudienceNotificationHandler:()=>s});var a=n(73308),l=n(38495),y=n(79772),v=n(59564),o=n(20822),d=n(28399),u=n(62278);class f extends l.BaseRequestHandler{constructor(e){super(),this.injector=e,this.injectDependencies()}injectDependencies(){this._notifyService=this.injector.get(v.NotifyService),this._translateService=this.injector.get(y.TranslateService),this._messageDialogProvider=this.injector.get(o.MessageDialogProvider)}getItemsCollection(e){return Array.isArray(e)?e.map(t=>typeof t=="string"?t:t.value):e?.value?[e.value]:[]}isValidFilter(e){return(0,d.isObject)(e)&&"items"in e&&!(0,d.isEmpty)(e.items)}isEmptyFilter(e){let t=!0;return Object.entries(e.items).forEach(([i,r])=>{r.isEnabled&&(r.filterType===l.FilterType.FilterGroup&&!this.isEmptyFilter(r)||r.filterType!==l.FilterType.FilterGroup)&&(t=!1)}),t}showNotification(e,t){var i=this;return(0,a.A)(function*(){yield i._notifyService.show({message:e,closeOnClickOutside:!1,duration:t})})()}showConfirmationDialog(e){var t=this;return(0,a.A)(function*(){return(yield(0,u.lastValueFrom)(t._messageDialogProvider.open({data:{message:e,actions:[o.DEFAULT_DIALOG_ACTIONS.NO,o.DEFAULT_DIALOG_ACTIONS.YES]}})))===o.DEFAULT_DIALOG_ACTIONS.YES.key})()}translate(e){return this._translateService.instant(`${this.translationPrefix}.${e}`)}}var h=n(21018),c=n(59131);class s extends l.BaseRequestHandler{constructor(e){super(),this.messageChannelService=e}_tryReloadAudienceDetail(e,t,i){var r=this;return(0,a.A)(function*(){if(e.toLowerCase()!==(yield t).toLowerCase())return;const m={type:"crt.LoadDataRequest",config:{loadType:l.DataSourceLoadType.Reload},$context:i,dataSourceName:r.audienceDataSourceName};yield r.handlerChain.process(m)})()}_subscribeOnChannelMessages(e){var t=this;return(0,a.A)(function*(){const i=yield e.getPrimaryModelName(),r=e.getViewModelAttributePath(i,"Id");t.channelSubscription=t.messageChannelService.messageEvent$.pipe((0,u.filter)(m=>{const g=m?.body?.Notifications;return g?.length>0?!!g[0].EntityId:!1})).subscribe(m=>{const g=e[r],D=m?.body?.Notifications[0]?.EntityId;t._tryReloadAudienceDetail(D,g,e)})})()}handle(e){var t=this;return(0,a.A)(function*(){const i=e.$context;yield t._subscribeOnChannelMessages(i),yield t.next?.handle(e)})()}ngOnDestroy(){this.channelSubscription?.unsubscribe()}static{this.\u0275fac=function(t){return new(t||s)(c.\u0275\u0275inject(h.MessageChannelService))}}static{this.\u0275prov=c.\u0275\u0275defineInjectable({token:s,factory:s.\u0275fac})}}},73308:(S,p,n)=>{n.d(p,{A:()=>l});function a(y,v,o,d,u,f,h){try{var c=y[f](h),s=c.value}catch(A){o(A);return}c.done?v(s):Promise.resolve(s).then(d,u)}function l(y){return function(){var v=this,o=arguments;return new Promise(function(d,u){var f=y.apply(v,o);function h(s){a(f,d,u,h,c,"next",s)}function c(s){a(f,d,u,h,c,"throw",s)}h(void 0)})}}}}]);
