(self.webpackChunkapp_studio_enterprise_forecast=self.webpackChunkapp_studio_enterprise_forecast||[]).push([[3475],{13475:(He,Be,C)=>{C.r(Be),C.d(Be,{AttributeBindingExpressionInterpreter:()=>x,AttributeControlBindingExpressionInterpreter:()=>F,AttributePropertyBindingExpressionInterpreter:()=>K,BINDING_CONTEXT:()=>B,BINDING_CONTEXT_DESIGN_TIME:()=>je,BaseDynamicModule:()=>ge,BaseViewElementComponentCreator:()=>tt,BindableDirective:()=>le,BindingContextMock:()=>Re,BindingExpressionInterpreter:()=>O,BindingPipe:()=>fe,COMPONENT_LOADER_VISIBILITY_DELAY:()=>D,ComponentViewElementRef:()=>et,ConverterExpressionInterpreter:()=>L,ConverterRegistryService:()=>ie,CrtAsyncPipe:()=>X,CrtBaseComponent:()=>R,DESIGNER_TOOL_GROUP_CONFIG:()=>Xt,DesignTimeViewElementTypeResolver:()=>ce,FixedValueBindingExpressionInterpreter:()=>Z,IGNORE_VIEW_ELEMENTS_NOT_FOUND_TOKEN:()=>_,JIT_MODULES:()=>We,ObjectPropBindingExpressionInterpreter:()=>k,RequestBindingConfigInterpreter:()=>U,RequestParamBindingExpressionInterpreter:()=>J,ResourceBindingExpressionInterpreter:()=>q,ReusableViewGeneratorCacheService:()=>_e,ReusableViewGeneratorDirective:()=>H,SCHEMA_BINDING_CACHE:()=>bt,ToolbarViewElementConfigResolver:()=>Ve,VIEW_ELEMENT_COMPONENT_CREATOR:()=>v,VIEW_ELEMENT_CONFIG:()=>j,ValidationStateBindingExpressionInterpreter:()=>W,ViewElementComponentCreator:()=>nt,ViewElementConfigUtils:()=>ke,ViewElementDirective:()=>M,ViewElementPlaceholderComponent:()=>z,ViewElementPlaceholderModule:()=>N,ViewElementTypeResolver:()=>A,ViewElementWebComponentCreator:()=>mt,ViewEventsNotifier:()=>ye,ViewGeneratorDirective:()=>Q,ViewGeneratorModule:()=>we,ViewInitDirective:()=>de,ViewModelDirective:()=>Y,ViewModule:()=>G,WebComponentViewElementRef:()=>gt,bindingExpressionInterpretersProviders:()=>Ee,changeAttributeValueFromUI:()=>Je,designTimeFactory:()=>Et,factory:()=>It,getAssociatedInputName:()=>pt,getAssociatedOutputName:()=>ae,getAssociatedValidationInputName:()=>qe,getAttributeLocation:()=>Ne,getRelativeAttributeBindingPath:()=>Ce,getRequestBindingConfigs:()=>Qt,getRootBindingContext:()=>ne,getTargetBindingContextInfo:()=>Ie,hasAssociatedInput:()=>Ot,hasAssociatedOutput:()=>jt,hasAssociatedValidationInput:()=>be,hasInput:()=>re,hasOutput:()=>oe,hasValidationInfo:()=>Bt,markControlAsTouched:()=>Xe,parseAttributePath:()=>ze,viewConfigLtrMock:()=>Jt,viewConfigRtlMock:()=>Yt});var V=C(5960),te=C(13053),s=C(59131),d=C(38495),y=C(22438),g=C(28399),h=C(62278),p=C(36486);const je=new s.InjectionToken("CRT_BINDING_CONTEXT_DESIGN_TIME"),B=new s.InjectionToken("CRT_BINDING_CONTEXT"),j=new s.InjectionToken("CRT_VIEW_ELEMENT_CONFIG"),_=new s.InjectionToken("Ignore view elements not found warning"),v=new s.InjectionToken("VIEW_ELEMENT_COMPONENT_CREATOR"),D=new s.InjectionToken("Add delay before enabling skeleton loader");class R extends y.CrtInjectorConstructor{set shape(e){this._shape=e;const t=this._classes.indexOf("crt-component-rounded");this.shape==="rounded"?t===-1&&this._classes.push("crt-component-rounded"):t>=0&&this._classes.splice(t,1)}get shape(){return this._shape}get classes(){return this.getClasses()}set classes(e){this.setClasses(e)}get loading(){return this._loading$.value}set loading(e){this._loading$.next(!!e),typeof e=="boolean"&&(e?this.handleStartLoadViewModelAttributes():this.handleFinishLoadViewModelAttributes())}constructor(e){super(e),this.injector=e,this._loading$=new h.BehaviorSubject(!1),this._classes=[],this.destroyed$=new h.Subject,this.loaderVisible=!1,this.documentDirection=null,this.documentDirection=e.get(te.Directionality)?.value==="rtl"?"rtl":null,this.changeDetectorRef=this.injector.get(s.ChangeDetectorRef),this.directionality=this.injector.get(te.Directionality),this.elementRef=this.injector.get(s.ElementRef),this._subscribeLoadingChanges()}_subscribeLoadingChanges(){const e=this.injector.get(D,0,{optional:!0});this._loading$.pipe((0,p.switchMap)(t=>t?(0,h.of)(t).pipe((0,h.delay)(e)):(0,h.of)(t)),(0,p.tap)(t=>{this.loaderVisible=t,this.changeDetectorRef.markForCheck()}),(0,p.takeUntil)(this.destroyed$)).subscribe()}handleStartLoadViewModelAttributes(){}handleFinishLoadViewModelAttributes(){}setClasses(e){this._classes=e||[]}getClasses(){return this._classes}toggleClass(e,t,n){const i=e.indexOf(n);t&&i===-1&&e.push(n),!t&&i>=0&&e.splice(i,1)}switchClass(e,t,n){n.forEach(([i,r])=>{this.toggleClass(e,i===t,r)})}setValuesFromConfig(e,t=[]){const n=(0,g.omit)(e,["id","name","type",...t]);Object.entries(n).forEach(([i,r])=>{this[i]=r})}detectChanges(){this.changeDetectorRef.detectChanges()}isRtl(){return this.directionality.value==="rtl"}focus(){this.elementRef?.nativeElement.focus()}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}static{this.\u0275fac=function(t){return new(t||R)(s.\u0275\u0275directiveInject(s.Injector))}}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:R,hostVars:2,hostBindings:function(t,n){t&2&&s.\u0275\u0275attribute("element-name",n.name)("dir",n.documentDirection)},inputs:{name:"name",id:"id",tabIndex:"tabIndex",styles:"styles",shape:"shape",classes:"classes",loading:"loading"},features:[s.\u0275\u0275InheritDefinitionFeature]})}}(0,V.__decorate)([(0,d.CrtInput)(),(0,V.__metadata)("design:type",String)],R.prototype,"name",void 0),(0,V.__decorate)([(0,d.CrtInput)(),(0,V.__metadata)("design:type",String)],R.prototype,"id",void 0),(0,V.__decorate)([(0,d.CrtInput)(),(0,V.__metadata)("design:type",Number)],R.prototype,"tabIndex",void 0),(0,V.__decorate)([(0,d.CrtInput)(),(0,V.__metadata)("design:type",Object)],R.prototype,"styles",void 0),(0,V.__decorate)([(0,d.CrtInput)(),(0,V.__metadata)("design:type",String),(0,V.__metadata)("design:paramtypes",[String])],R.prototype,"shape",null),(0,V.__decorate)([(0,d.CrtInput)(),(0,V.__metadata)("design:type",Array),(0,V.__metadata)("design:paramtypes",[Array])],R.prototype,"classes",null),(0,V.__decorate)([(0,d.CrtInput)(),(0,V.__metadata)("design:type",Boolean),(0,V.__metadata)("design:paramtypes",[Boolean])],R.prototype,"loading",null);var P=C(40297),Oe=C(52989),Tt=C(71252);class z{constructor(e,t){this.caption="",e.addSvgIconLiteral("placeholder",t.bypassSecurityTrustHtml(C(49967)))}static{this.\u0275fac=function(t){return new(t||z)(s.\u0275\u0275directiveInject(Oe.MatIconRegistry),s.\u0275\u0275directiveInject(Tt.DomSanitizer))}}static{this.\u0275cmp=s.\u0275\u0275defineComponent({type:z,selectors:[["crt-view-element-placeholder"]],inputs:{caption:"caption"},decls:4,vars:1,consts:[[1,"placeholder-container"],["svgIcon","placeholder",1,"icon"]],template:function(t,n){t&1&&(s.\u0275\u0275elementStart(0,"div",0),s.\u0275\u0275element(1,"mat-icon",1),s.\u0275\u0275elementStart(2,"span"),s.\u0275\u0275text(3),s.\u0275\u0275elementEnd()()),t&2&&(s.\u0275\u0275advance(3),s.\u0275\u0275textInterpolate(n.caption))},dependencies:[Oe.MatIcon],styles:[".placeholder-container[_ngcontent-%COMP%]{display:flex;width:100%;height:100%;align-content:center;justify-content:center;border-radius:8px;position:relative;overflow:hidden}.placeholder-container[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:100%;max-height:64px;width:72px;align-self:center}.placeholder-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;top:50%;left:8px;right:8px;transform:translateY(-50%);overflow:hidden;width:calc(100% - 16px);text-overflow:ellipsis}@supports (background: -webkit-named-image(i)){.placeholder-container[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:initial;height:initial}}"]})}}class N{static{this.\u0275fac=function(t){return new(t||N)}}static{this.\u0275mod=s.\u0275\u0275defineNgModule({type:N})}static{this.\u0275inj=s.\u0275\u0275defineInjector({imports:[P.CommonModule,Oe.MatIconModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&s.\u0275\u0275setNgModuleScope(N,{declarations:[z],imports:[P.CommonModule,Oe.MatIconModule],exports:[z]})})();var w=C(21018),De=C(56711),E=C(10850);class S{constructor(e=new h.Subscription,t=Promise.resolve()){this._subscription=e,this.ready=t}static all(e){const t=(0,w.joinSubscriptions)(e.map(i=>i._subscription)),n=Promise.all(e.map(i=>i.ready)).then(()=>{});return new S(t,n)}static subscribe(e,t,n=!1){e=e.pipe((0,p.share)());const i=e.subscribe({next:t}),r=n?(0,h.lastValueFrom)(e.pipe((0,p.first)(),(0,p.map)(()=>{})),{defaultValue:null}):Promise.resolve();return new S(i,r)}unsubscribe(){this._subscription.unsubscribe()}}var $=C(73308);function Ce(a,e){if(!a)return e;if(!e.startsWith(a))throw new Error(`Attribute path '${e}' should start with '${a}'`);return e.substring(a.length+1)}function ze(a){if(!(0,y.isBindingExpression)(a))throw new Error(`'${a}' is not binding expression`);const e=a.indexOf("|");return e>-1&&(a=a.substring(0,e).trimEnd()),a.substring(1)}function Ne(a,e){return Ke.apply(this,arguments)}function Ke(){return Ke=(0,$.A)(function*(a,e){const t=e.match(/^(?:(?<attributeHostPath>.+)\.)?(?<attributeName>[^.]+)$/),{attributeHostPath:n,attributeName:i}=t.groups,r=n?yield(0,E.get)(a,n):a;return{attributeName:i,attributeHost:r}}),Ke.apply(this,arguments)}function ne(a){for(;a.parent;)a=a.parent;return a}function Ie(a,e){const t=a.split(".").slice(0,-1),n=ct(e),i=n.map(r=>r.viewModel$.pipe((0,p.take)(1)));return(0,h.forkJoin)(i).pipe((0,p.map)(r=>{const o=[];let c=n.length-1,l=[];for(const u of t)if(o.push(u),xt(r[c],o)&&(l=[...o],c--,c<0))return null;return{context:n[c],contextPath:l.join(".")}}))}function ct(a){const e=[a];return a.parent&&e.push(...ct(a.parent)),e}function xt(a,e){let t=a;for(const n of e)t=t?.attributes?t.attributes[n]:t?.[n];return t instanceof E.BaseViewModelCollection}class lt{getAttributeValuesStream(e,t){return e?e.events$.pipe((0,p.filter)(n=>n.type===E.ViewModelEventType.ChangeAttributeValue),(0,p.filter)(n=>n?.payload?.attributeName===t),(0,p.switchMap)(n=>t in e?Promise.resolve(e[t]):Promise.resolve(n.payload.value)),(0,p.share)()):(0,h.of)(null)}getAttributeInitialValueStream(e,t,n){return e?(0,h.from)((0,E.get)(e,t)).pipe((0,p.takeUntil)(n)):(0,h.of)(null)}getAttributeLocationChanges(e,t){return Ie(e,t).pipe((0,p.tap)(n=>{if(!n)throw new Error(`Target binding context for attribute "${e} was not found"`)}),(0,p.switchMap)(({context:n,contextPath:i})=>(0,h.combineLatest)([n.viewModel$,(0,h.of)(Ce(i,e))])),(0,p.switchMap)(([n,i])=>n?Ne(n,i):(0,h.of)({attributeName:void 0,attributeHost:void 0})))}evaluate(e,t){const n=e.slice(1);return this.getAttributeLocationChanges(n,t).pipe((0,p.switchMap)(i=>this.getAttributeValueChanges(i)))}}class x extends lt{getAttributeValueChanges({attributeHost:e,attributeName:t}){const n=this.getAttributeValuesStream(e,t),i=this.getAttributeInitialValueStream(e,t,n);return(0,h.merge)(i,n)}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=s.\u0275\u0275getInheritedFactory(x)))(n||x)}})()}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:x,factory:x.\u0275fac})}}var ut=C(85638);const Mt="DisableAttributeDeactivationUntilBRulesExecution";class K extends lt{constructor(e){super(),this._featureService=e,this._readonlyProperties=["readonly","disabled"]}getAttributeValueChangesInHybridMode(e,t,n,i){const r=e.getControl(t),o=i.slice(1);return this._getValuesStream(e,t,n,()=>{const c=this.getAttributeValuesStream(e,o).pipe((0,p.tap)(f=>r.setPropertyValue(n,f))),l=this.getAttributeValuesStream(e,`${t}:${n}`).pipe((0,p.filter)(()=>{const f=Object.getOwnPropertyDescriptor(e,o),m=!!f?.get,b=!!f?.set;return!(m&&!b)}),(0,p.tap)(f=>e[o]=f)),u=(0,h.from)((0,E.get)(e,o)).pipe((0,p.tap)(f=>r.setPropertyValue(n,f,!0)),(0,p.takeUntil)(c));return(0,h.merge)(u,c,l)})}_getDefaultValue(e){if(!e)return null;try{return JSON.parse(e)}catch{return e}}_getValuesStream(e,t,n,i){return this._readonlyProperties.includes(n)?(0,h.forkJoin)({disableAttributeDeactivation:this._featureService.getFeatureState(Mt),hasBRulesAffectingAttribute:e._getIsAffectedByBusinessRules({name:t})}).pipe((0,p.switchMap)(({disableAttributeDeactivation:r,hasBRulesAffectingAttribute:o})=>r||o!==!0?i():e._businessRulesActivated$.pipe((0,p.switchMap)(c=>c?i():(0,h.of)(!0))))):i()}getAttributeValueChanges(e){const{attributeHost:t}=e;if(!t)return(0,h.of)(null);const[n,i]=e.attributeName.split(":"),[r,o]=i.split("="),c=t.getControl(n),l=this._getDefaultValue(o);if(typeof l=="string"&&l?.startsWith("$"))return this.getAttributeValueChangesInHybridMode(t,n,r,l);if(l!=null){const u=c.getPropertyByName(r,!0);u.hasInitialValue||u.setInitialValue(l)}return this._getValuesStream(t,n,r,()=>{const u=this.getAttributeValuesStream(t,`${n}:${r}`),f=(0,h.of)(c.getPropertyValue(r)).pipe((0,p.filter)(m=>m!=null),(0,p.takeUntil)(u));return(0,h.merge)(f,u)})}static{this.\u0275fac=function(t){return new(t||K)(s.\u0275\u0275inject(ut.FeatureService))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:K,factory:K.\u0275fac})}}class F extends x{removeConvertersFromExpression(e){const t=e.indexOf("|");return t===-1?e:(console.warn(`Cannot use converters in control binding expression: ${e}`),e.substring(0,t).trimEnd())}evaluate(e,t){e=this.removeConvertersFromExpression(e);const n=e.slice(1);return this.getAttributeLocationChanges(n,t).pipe((0,p.map)(({attributeHost:i,attributeName:r})=>i?i.getAttributeControl(r):new De.FormControl(null)))}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=s.\u0275\u0275getInheritedFactory(F)))(n||F)}})()}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:F,factory:F.\u0275fac})}}class Z{_getStringValue(e){return e.match(/^'(.*)'$/)[1]}_getBooleanValue(e){if(e==="true")return!0;if(e==="false")return!1;throw new Error(`${e} is not Boolean value`)}evaluate(e){if((0,y.isFixedStringValueExpression)(e))return(0,h.of)(this._getStringValue(e));if((0,y.isFixedNumberValueExpression)(e))return(0,h.of)(parseFloat(e));if((0,y.isFixedBooleanValueExpression)(e))return(0,h.of)(this._getBooleanValue(e));throw new Error(`Failed to parse primitive value binding expression: ${e}`)}static{this.\u0275fac=function(t){return new(t||Z)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:Z,factory:Z.\u0275fac})}}class k extends x{_getViewModelCollectionValue(e,t){if(!t.length)return Promise.resolve(e);const n=Array.from(e).map(i=>this._getObjectProp(i,t));return Promise.all(n)}_getObjectProp(e,t){var n=this;return(0,$.A)(function*(){const i=t.shift();return i?(e=yield e[i],e instanceof E.BaseViewModel?n._getObjectProp(e,t):e instanceof E.BaseViewModelCollection?n._getViewModelCollectionValue(e,t):n._getObjectProp(e,t)):e})()}evaluate(e,t){const n=e.slice(1);return Ie(n,t).pipe((0,p.map)(i=>i??{context:ne(t),contextPath:""}),(0,p.switchMap)(i=>(0,h.combineLatest)([i.context.viewModel$,(0,h.of)(Ce(i.contextPath,n))])),(0,p.switchMap)(([i,r])=>i?this._getObjectProp(i,r.split(".")):(0,h.of)(null)),(0,p.take)(1))}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=s.\u0275\u0275getInheritedFactory(k)))(n||k)}})()}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:k,factory:k.\u0275fac})}}class ie{constructor(){this._converterRegistry=d.ConverterRegistry,this._injector=(0,s.inject)(s.Injector)}get(e,t){return this._converterRegistry.get(e).instantiate(t)}register(e,t){throw new Error("NotImplemented")}clear(){this._converterRegistry.clear()}static{this.\u0275fac=function(t){return new(t||ie)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:ie,factory:ie.\u0275fac,providedIn:"root"})}}class L extends E.AbstractExpressionInterpreter{constructor(e,t,n,i=!1){super(),this._convertersRegistry=e,this._objectPropBindingExpressionInterpreter=t,this._fixedValueBindingExpressionInterpreter=n,this._isDesignTime=i}_evaluateParam(e,t){if((0,y.isFixedValueBindingExpression)(e))return this._fixedValueBindingExpressionInterpreter.evaluate(e);if((0,y.isBindingExpression)(e))return this._objectPropBindingExpressionInterpreter.evaluate(e,t);throw new Error(`Cannot parse parameter expression: ${e}`)}_evaluateParams(e,t){const n=e.map(i=>this._evaluateParam(i,t).pipe((0,p.first)()));return(0,h.forkJoin)(n).pipe((0,p.defaultIfEmpty)([]))}_getConverters(e,t){return e.split("|").map(i=>i.trim()).map(i=>{const[r,...o]=i.split(":").map(u=>u.trim()),c=this._evaluateParams(o,t),l=t.viewModel$.pipe((0,p.first)());return(0,h.forkJoin)([l,c]).pipe((0,p.map)(([u,f])=>m=>{if(!u)return null;const b=u._injectionContext;return this._convertersRegistry.get(r,b).convert(m,u,...f)}))})}_applyConverters(e,t){for(const[n,i]of Object.entries(t))if(e=i(e),e instanceof Promise){const r=parseInt(n,10)+1;return this._applyAsyncConverters(e,[...t].slice(r))}return e}_applyAsyncConverters(e,t){return(0,$.A)(function*(){let n=yield e;for(const i of t)n=i(n),n instanceof Promise&&(n=yield n);return n})()}evaluate(e,t){if(this._isDesignTime||(0,g.isEmpty)(e))return(0,h.of)(i=>i);const n=this._getConverters(e,t);return(0,h.forkJoin)(n).pipe((0,p.map)(i=>r=>this._applyConverters(r,i)))}static{this.\u0275fac=function(t){return new(t||L)(s.\u0275\u0275inject(ie),s.\u0275\u0275inject(k),s.\u0275\u0275inject(Z),s.\u0275\u0275inject(w.IS_DESIGN_TIME,8))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:L,factory:L.\u0275fac})}}class q{evaluate(e,t){const n=e.slice(1);return ne(t).viewModel$.pipe((0,p.switchMap)(i=>i?(0,E.get)(i,n):(0,h.of)(null)))}static{this.\u0275fac=function(t){return new(t||q)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:q,factory:q.\u0275fac})}}class O{constructor(e,t,n,i){this._attributeBindingExpressionInterpreter=e,this._attributePropertyBindingExpressionInterpreter=t,this._resourceBindingExpressionInterpreter=n,this._converterExpressionInterpreter=i}_applyConverter(e,t){return(0,$.A)(function*(){return e=t(e),e instanceof Promise&&(e=yield e),e})()}evaluateInputValueExpression(e,t){return(0,y.isResourceBindingExpression)(e)?this._resourceBindingExpressionInterpreter.evaluate(e,t):(0,y.isPropertyBindingExpression)(e)?this._attributePropertyBindingExpressionInterpreter.evaluate(e,t):this._attributeBindingExpressionInterpreter.evaluate(e,t)}evaluate(e,t){const n=/\|(.*)/,[i,r]=e.split(n).map(l=>l.trim()),o=this.evaluateInputValueExpression(i,t),c=this._converterExpressionInterpreter.evaluate(r,t);return o.pipe((0,p.switchMap)(l=>c.pipe((0,p.switchMap)(u=>this._applyConverter(l,u)))))}static{this.\u0275fac=function(t){return new(t||O)(s.\u0275\u0275inject(x),s.\u0275\u0275inject(K),s.\u0275\u0275inject(q),s.\u0275\u0275inject(L))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:O,factory:O.\u0275fac})}}class J extends O{constructor(e,t){super(null,null,null,t),this._objectPropBindingExpressionInterpreter=e}_evaluateEventBindingExpression(e,t){const n=t.initialEvent,i=e.replace(/@event\.?/,"");return(0,h.of)(i?(0,g.get)(n,i):n)}evaluateInputValueExpression(e,t){return(0,y.isEventBindingExpression)(e)?this._evaluateEventBindingExpression(e,t):this._objectPropBindingExpressionInterpreter.evaluate(e,t)}static{this.\u0275fac=function(t){return new(t||J)(s.\u0275\u0275inject(k),s.\u0275\u0275inject(L))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:J,factory:J.\u0275fac})}}class se{constructor(e){this._requestParamBindingExpressionInterceptor=e}_evaluate(e,t){var n=this;return(0,$.A)(function*(){const i={};for(const[r,o]of Object.entries(e))i[r]=yield n._evaluateConfigValue(o,t);return i})()}_evaluateConfigValue(e,t){return Array.isArray(e)?Promise.all(e.map(n=>this._evaluateConfigValue(n,t))):(0,y.isBindingExpression)(e)||(0,y.isEventBindingExpression)(e)?(0,h.lastValueFrom)(this._requestParamBindingExpressionInterceptor.evaluate(e,t),{defaultValue:null}):e&&typeof e=="object"?this._evaluate(e,t):Promise.resolve(e)}evaluate(e,t){return(0,h.from)(this._evaluate(e,t))}static{this.\u0275fac=function(t){return new(t||se)(s.\u0275\u0275inject(J))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:se,factory:se.\u0275fac})}}class U{constructor(e){this._requestParamsBindingConfigInterpreter=e}_evaluateParams(e,t){return e?this._requestParamsBindingConfigInterpreter.evaluate(e,t):(0,h.of)({})}_getRequestBindingContext(e,t){return e.useRelativeContext?t:ne(t)}evaluate(e,t){return this._evaluateParams(e.params,t).pipe((0,p.withLatestFrom)(this._getRequestBindingContext(e,t).viewModel$),(0,p.map)(([n,i])=>({type:e.request,$context:i,...n})),(0,p.first)())}static{this.\u0275fac=function(t){return new(t||U)(s.\u0275\u0275inject(se))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:U,factory:U.\u0275fac})}}class W extends x{_getValidationStateChanges(e,t){const n=t.attributeHost.getAttributeControl(t.attributeName);return(0,h.merge)(e,n.statusChanges).pipe((0,p.map)(()=>({value:n.value,validationInfo:(0,g.pick)(n,"valid","errors","dirty","touched")})),(0,p.distinctUntilChanged)(g.isEqual))}evaluate(e,t){const n=e.slice(1);return this.getAttributeLocationChanges(n,t).pipe((0,p.switchMap)(i=>i.attributeHost?this._getValidationStateChanges(super.evaluate(e,t),i):(0,h.of)({value:null,validationInfo:{valid:!0,errors:null,dirty:!1,touched:!1}})))}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=s.\u0275\u0275getInheritedFactory(W)))(n||W)}})()}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:W,factory:W.\u0275fac})}}var $e=C(96590);const Ee=[x,K,F,O,L,k,Z,U,J,se,q,W,$e.FactoryProvider.create({token:E.EXPRESSION_INTERPRETER_FACTORY,mappings:[{predicate:"converter",injectable:L}]})],Ze="Change",Fe="ValidationInfo";function re(a,e){return!!d.ViewElementRegistry.viewElements.get(a)?.inputs?.[e]}function oe(a,e){return!!d.ViewElementRegistry.viewElements.get(a)?.outputs?.[e]}function Bt(a,e){return!!d.ViewElementRegistry.viewElements.get(a)?.validationInputs?.[e]}function ae(a){return a+Ze}function jt(a,e){const t=ae(e);return oe(a,t)}function qe(a){return a+Fe}function be(a,e){const t=e+Fe;return!!d.ViewElementRegistry.viewElements.get(a)?.validationInputs?.[t]}function pt(a){let e=null;if(a.endsWith(Ze))e=a.replace(new RegExp(Ze+"$"),"");else if(a.endsWith(Fe))e=a.replace(new RegExp(Fe+"$"),"");else return null;return e}function Ot(a,e){const t=pt(e);return!!t&&re(a,t)}class ke{static _updateAttributeProperties(e,t,n,i){const r=e[t]||{},o={};i.forEach(u=>{let f=u.defaultValue;Object.prototype.hasOwnProperty.call(n,u.name)&&(f=n[u.name]??u.defaultValue),o[u.name]={defaultValue:f}});const c=d.ViewElementRegistry.getViewElementInputs(n.type);Object.entries(c).filter(([,u])=>u.propertyName!=null).forEach(([u,f])=>{o[f.propertyName]={defaultValue:u,locked:!0}}),r.properties={...r.properties??{},...o}}static updateAttributeProperties(e,t,n){const i=e.bindTo.replace("$",""),r=t?.viewModelConfig?.attributes||{};ke._updateAttributeProperties(r,i,e,n)}static updateCollectionAttributeProperties(e,t,n,i){const r=e.bindTo.replace(`${n}.`,""),o=n.replace("$",""),l=(t?.viewModelConfig?.attributes||{})[o];if(!l)return;const u=l?.viewModelConfig?.attributes;u&&ke._updateAttributeProperties(u,r,e,i)}}function Je(a,e,t){return Ye.apply(this,arguments)}function Ye(){return Ye=(0,$.A)(function*(a,e,t){const n=yield(0,h.firstValueFrom)(Ie(a,t)),i=yield(0,h.firstValueFrom)(n.context.viewModel$);if(!i)return;const r=Ce(n.contextPath,a),{attributeHost:o,attributeName:c}=yield Ne(i,r);o.getAttributeControl(c).markAsDirty(),o[c]=e}),Ye.apply(this,arguments)}function Xe(a,e){return Qe.apply(this,arguments)}function Qe(){return Qe=(0,$.A)(function*(a,e){const t=yield(0,h.firstValueFrom)(Ie(a,e)),n=yield(0,h.firstValueFrom)(t.context.viewModel$);if(!n)return;const i=Ce(t.contextPath,a),{attributeHost:r,attributeName:o}=yield Ne(n,i),c=r.getAttributeControl(o);c.touched||(c.markAsTouched(),c.updateValueAndValidity())}),Qe.apply(this,arguments)}const ht="bindTo";class dt{constructor(e){this.injector=e,this._loadingAttributeName="loading",this.bindingExpressionInterpreter=e.get(O),this.attrCtrlExpInterpreter=e.get(F),this.requestBindingConfigInterpreter=e.get(U),this.validationBindingInterpreter=e.get(W),this._bindingContext=e.get(B,null),this._macrosHandlerService=e.get(w.MacrosHandlerService),this._isDesignTime=e.get(w.IS_DESIGN_TIME,!1)}_useMacros(e,t){if(!this._bindingContext)return t(e);let n;const i=new h.Subject,r=this._bindingContext.viewModel$.pipe((0,p.switchMap)(o=>this._macrosHandlerService.handleResourceMacros(e,o)),(0,p.map)((o,c)=>{n?.unsubscribe(),n=t(o),c===0&&n.ready.then(()=>{i.next(),i.complete()})}),(0,p.finalize)(()=>n?.unsubscribe())).subscribe();return new S(r,(0,h.lastValueFrom)(i,{defaultValue:null}))}_bindLoadingProperty(e,t){if(Object.keys(e).some(c=>c===this._loadingAttributeName))return new S;const i=(0,g.chain)(e).entries().filter(([c,l])=>this.isInputBinding(c,l,t,e)&&(0,y.isBindingExpression)(l)).value();if(!i.length)return new S;const r=i.map(([c,l])=>ze(l)),o=ne(this._bindingContext).viewModel$.pipe((0,p.switchMap)(c=>{if(!c)return(0,h.of)();let l=[];const u=c.events$.pipe((0,p.filter)(m=>m.type===E.ViewModelEventType.StartLoadModelAttributes),(0,p.filter)(m=>{const b=Object.keys(m.payload);return r.some(T=>b.includes(T))}),(0,p.tap)(m=>{l=Object.keys(m.payload)}),(0,p.tap)(()=>t.setPropertyValue("loading",!0))),f=c.events$.pipe((0,p.filter)(m=>m.type===E.ViewModelEventType.FinishLoadModelAttributes),(0,p.filter)(m=>{const b=Object.keys(m.payload);return l.every(T=>b.includes(T))}),(0,p.tap)(()=>t.setPropertyValue("loading",!1)),(0,p.tap)(()=>l=[]));return(0,h.merge)(u,f)})).subscribe();return new S(o)}_isControlProperty(e,t){const n=d.ViewElementRegistry.getFormControlRelatesAttribute(t.type);return e===n}_getViewElementInputProperties(e){const t=d.ViewElementRegistry.viewElements.get(e.type);return t?[...Object.keys(t.inputs??{}).filter(n=>t.inputs[n].propertyBindable)]:["visible"]}_getViewElementEntries(e,t){const n=d.ViewElementRegistry.getFormControlRelatesAttribute(t.type),i=e.find(([o])=>o===ht);let r=e.filter(([o])=>o!==ht);if(i){const[,o]=i;if(!o)return r;this._getViewElementInputProperties(t).forEach(l=>{if(l!==n){let u=o;u=`${u}:${l}`;const f=t[l];f!=null&&(u+=`=${f}`),r=r.filter(([m])=>m!==l),r.push([l,u])}})}return r}_bindInputWithValidation(e,t,n){const i=this.validationBindingInterpreter.evaluate(t,this._bindingContext).pipe((0,p.startWith)(null),(0,h.pairwise)()),r=qe(e),o=([c,l])=>{c?.value!==l?.value&&n.setPropertyValue(e,l.value),n.setPropertyValue(r,l?.validationInfo)};return S.subscribe(i,o)}_bindFocusout(e,t){const n=t.getEvent("focusout"),i=e.slice(1),r=()=>Xe(i,this._bindingContext);return S.subscribe(n,r)}_bindInputs(e,t){const[n,i]=(0,g.chain)(e).entries().filter(([l,u])=>this.isInputBinding(l,u,t,e)&&!this.isTwoWayBinding(l,u,t,e)).partition(([,l])=>(0,y.isBindingExpression)(l)).value();i.forEach(([l,u])=>{u=this._isControlProperty(l,e)?new De.FormControl(u):u,t.setPropertyValue(l,u)});const o=this._getViewElementEntries(n,e).map(([l,u])=>{const b=(this._isControlProperty(l,e)?this.attrCtrlExpInterpreter:this.bindingExpressionInterpreter).evaluate(u,this._bindingContext);if(be(e.type,l)&&(0,y.isSimpleBindingExpression)(u))return this._bindInputWithValidation(l,u,t);{const T=ee=>t.setPropertyValue(l,ee);return S.subscribe(b,T,!1)}}),c=this._bindLoadingProperty(e,t);return S.all([...o,c])}_createRequest(e,t){const n={...this._bindingContext,initialEvent:t};return this.requestBindingConfigInterpreter.evaluate(e,n).pipe((0,p.map)(i=>({...i,$initialEvent:t})))}_bindOutputs(e,t){const i=Object.entries(e).filter(([r,o])=>this.isOutputBinding(r,o,t,e)).map(([r,o])=>{const c=t.getEvent(r).pipe((0,p.switchMap)(u=>this._createRequest(o,u))),l=u=>u.$context.executeRequest(u);return S.subscribe(c,l)});return S.all(i)}_bindTwoWays(e,t){const n=Object.entries(e).filter(([r,o])=>this.isTwoWayBinding(r,o,t,e)),i=[];return n.forEach(([r,o])=>{const c=this.bindingExpressionInterpreter.evaluate(o,this._bindingContext),l=at=>t.setPropertyValue(r,at);be(e.type,r)&&(0,y.isSimpleBindingExpression)(o)?i.push(this._bindInputWithValidation(r,o,t)):i.push(S.subscribe(c,l));const u=o.slice(1),f=ae(r),m=this.getViewEventsStream(t,f),b=at=>Je(u,at,this._bindingContext),T=S.subscribe(m,b);i.push(T);const ee=this._bindFocusout(o,t);i.push(ee)}),S.all(i)}isInputBinding(e,t,n,i){return re(i.type,e)}isOutputBinding(e,t,n,i){return oe(i.type,e)}isTwoWayBinding(e,t,n,i){const r=ae(e);return(0,y.isSimpleBindingExpression)(t)&&re(i.type,e)&&oe(i.type,r)&&!(r in i)}bind(e,t){const n=i=>S.all([this._bindInputs(i,e),this._bindOutputs(i,e),this._bindTwoWays(i,e)]);return this._isDesignTime?this._useMacros(t,n):n(t)}}class ft extends dt{isInputBinding(e,t,n,i){return super.isInputBinding(e,t,n,i)||!this.isOutputBinding(e,t,n,i)}isOutputBinding(e,t,n,i){return super.isOutputBinding(e,t,n,i)||n.getPropertyValue(e)instanceof s.EventEmitter}getViewEventsStream(e,t){return e.getEvent(t)}}class Dt extends dt{getViewEventsStream(e,t){return e.getEvent(t).pipe((0,h.map)(n=>n.detail))}}class et{constructor(e,t,n,i,r,o,c){this._componentRef=e,this._inputs=t,this._ngZone=i,this._changeDetectorRef=r,this.nativeElement=o,this.hostView=c,this._propertyValues=new Map,this.instance=n;const l=this._componentRef.injector.get(w.FEATURE_VALUES,null);this._enableInstanceValueSetFeature=l?.["ComponentViewElementRef.EnableInstanceValueSet"]}setValue(e,t){if(this._inputs?.[e])this._componentRef.setInput(e,t);else if(this._enableInstanceValueSetFeature)(0,g.set)(this.instance,e,t);else{const n=["selected","layoutConfig","dragging","currentLayoutConfig"];if(e in this.instance&&!n.includes(e)){const i=this._componentRef.componentType.name;let r=`Can't set value of the '${e}' input on the '${i}' component. `;r+=`Make sure that the '${e}' property is annotated with @Input() or a mapped @Input('${e}') exists.`,console.error(r)}}this._changeDetectorRef.detectChanges()}getPropertyValue(e){return(0,g.get)(this.instance,e)}getEvent(e){const t=this.getPropertyValue(e);return!t&&this.nativeElement?(0,h.fromEvent)(this.nativeElement,e):t}on(e,t){const i=this.getEvent(e).subscribe(t);return()=>{i.unsubscribe()}}setPropertyValue(e,t){(!this._propertyValues.has(e)||t!==this._propertyValues.get(e))&&(this._propertyValues.set(e,t),this._ngZone.run(()=>this.setValue(e,t)))}}class gt{constructor(e){this._propertyValues=new Map,this.instance=e}getPropertyValue(e){return this.instance[e]}getEvent(e){return(0,h.fromEvent)(this.instance,e)}on(e,t){return this.instance.addEventListener(e,t),()=>this.instance.removeEventListener(e,t)}setPropertyValue(e,t){(!this._propertyValues.has(e)||t!==this._propertyValues.get(e))&&(this._propertyValues.set(e,t),this.instance[e]=t)}}class Nt{constructor(e,t){this._ngZone=t,this._propertyValues=new Map,this.instance=e}setValue(e,t){(0,g.set)(this.instance,e,t)}getPropertyValue(e){return(0,g.get)(this.instance,e)}getEvent(e){return this.getPropertyValue(e)}on(e,t){const i=this.getPropertyValue(e).subscribe(t);return()=>{i.unsubscribe()}}setPropertyValue(e,t){(!this._propertyValues.has(e)||t!==this._propertyValues.get(e))&&(this._propertyValues.set(e,t),this._ngZone.run(()=>this.setValue(e,t)))}}class tt{constructor(e){this.injector=e}}class A{canResolve(e){return d.ViewElementRegistry.viewElements.has(e)}getViewElementRegistryItem(e){return d.ViewElementRegistry.viewElements.get(e)}getViewElementType(e){const t=this.getViewElementRegistryItem(e.type);return this.getViewElementTypeByRegistryItem(t)}getCrtInputs(e){return this.getViewElementRegistryItem(e)?.inputs}getSelector(e){const t=this.getViewElementRegistryItem(e);return this.getSelectorByRegistryItem(t)}getSelectorByRegistryItem(e){return e&&"selector"in e?e.selector:null}getViewElementTypeByRegistryItem(e){return e&&"typeRef"in e?e.typeRef:null}static{this.\u0275fac=function(t){return new(t||A)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:A,factory:A.\u0275fac})}}class ce extends A{canResolve(e){return d.ViewElementRegistry.viewElements.has(e)||d.DesignTimeViewElementRegistry.infos.has(e)}getViewElementType(e){const t=e.type,n=d.DesignTimeViewElementRegistry.getByOverriddenType(t);if(n&&!e?.sealed)return n.typeRef;const i=d.ViewElementRegistry.viewElements.get(t);return i&&"typeRef"in i?i.typeRef:d.DesignTimeViewElementRegistry.infos.has(t)?d.DesignTimeViewElementRegistry.infos.get(t).typeRef:null}getViewElementRegistryItem(e){const t=d.DesignTimeViewElementRegistry.getByOverriddenType(e);let n=null;return t&&(n=d.DesignTimeViewElementRegistry.infos.get(t.type)),n||(n=super.getViewElementRegistryItem(e)),n}getCrtInputs(e){const t=d.DesignTimeViewElementRegistry.getByOverriddenType(e);return t?t?.inputs:d.ViewElementRegistry.viewElements.get(e)?.inputs}getSelector(e){if(d.DesignTimeViewElementRegistry.getByOverriddenType(e))return null;const t=d.ViewElementRegistry.viewElements.get(e);return t&&"selector"in t?t.selector:null}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=s.\u0275\u0275getInheritedFactory(ce)))(n||ce)}})()}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:ce,factory:ce.\u0275fac})}}class Ve{_setDefaultToolbarConfigValues(e){const t=e.toolbarConfig;if(!t)return;(t instanceof Array?t:[t]).forEach(i=>{i.groupType||(i.groupType=e.viewElementGroupType),i.caption||(i.caption=e.typeCaption)})}getDesignViewElementConfigs(){const e=new Map;return d.InterfaceDesignerItemRegistry.interfaceDesignerItemRegistrationInfos.forEach((t,n)=>{const i=t.toolbarConfig;i&&(this._setDefaultToolbarConfigValues(t),e.set(n,i))}),e}static{this.\u0275fac=function(t){return new(t||Ve)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:Ve,factory:Ve.\u0275fac})}}class nt extends tt{createComponent(e){const t=this.injector.get(A),n=this.injector.get(s.ViewContainerRef),i=this.injector.get(j),r=this.injector.get(s.Renderer2),o=t.getViewElementType(i),c=t.getCrtInputs(i.type),l=n.createComponent(o,{index:0,injector:this.injector});e?.forEach(({name:b,value:T})=>{r.setAttribute(l.location.nativeElement,b,T)});const u=l.injector.get(s.ChangeDetectorRef),f=l.injector.get(s.ElementRef).nativeElement;l.changeDetectorRef.detectChanges();const m=this.injector.get(s.NgZone);return new et(l,c,l.instance,m,u,f,l.hostView)}}class mt extends tt{createComponent(e){const t=this.injector.get(A),n=this.injector.get(s.Renderer2),i=this.injector.get(s.ViewContainerRef),r=this.injector.get(j),o=t.getSelector(r.type),c=document.createElement(o);return e?.forEach(({name:l,value:u})=>{n.setAttribute(c,l,u)}),n.appendChild(i.element.nativeElement.parentElement,c),this._initDirectionality(c),new gt(c)}_initDirectionality(e){this.injector.get(te.Directionality)?.value==="rtl"&&e.setAttribute("dir","rtl")}}class $t{}class yt extends $t{constructor(e){super(),this.injector=e,this.viewElementConfig=this.injector.get(j),this.featureValues=this.injector.get(w.FEATURE_VALUES,{optional:!0}),this.measurePerformanceService=this.injector.get(w.MeasurePerformanceService),this._componentCreator=this.injector.get(v)}_getElementName(){return`${this.viewElementConfig.type.split(".")?.[1]} ${this.viewElementConfig.name}`}_getDOMAttributes(){const e=[];return this.featureValues?.UseViewElementDataItemMarker&&e.push({name:"data-item-marker",value:this.viewElementConfig.dataItemMarker||this.viewElementConfig.name}),e}createComponent(e){return this._componentCreator.createComponent(e)}getComponentRef(){const e=this._getElementName(),t=this._getDOMAttributes();return this.measurePerformanceService.measure(e,()=>this.createComponent(t))}show(){const e=this.getComponentRef();return(0,h.of)(e)}}class Ft extends yt{constructor(e,t,n){super(e),this.injector=e,this._creator=t,this._destroyed=n,this._renderer=this.injector.get(s.Renderer2),this._container=this.injector.get(s.ViewContainerRef),this._initMinHeight(),this._subscribeDestroyed()}get _parentElement(){return this._container.element.nativeElement.parentElement}_handleIntersection(e,t){if(this._parentElement){if(e&&!this._componentRef?.hostView){this._initResizeObservable(),t.next(this.getComponentRef()),t.complete();return}this._componentRef?.hostView&&(e?this._showElement():this._hideElement())}}_initIntersectionObserver(e){let t=this.viewElementConfig.selected;this._intersectionObserver=new IntersectionObserver(n=>{n.forEach(i=>{t?t=!1:this._handleIntersection(i.isIntersecting,e)})}),this._intersectionObserver.observe(this._parentElement),t&&this._handleIntersection(!0,e)}_initResizeObservable(){this._resizeObserver||(this._resizeObserver=new ResizeObserver(e=>{const{height:t,width:n}=e[0].contentRect;this._minHeight=`${t}px`,this._minWidth=`${n}px`}),this._resizeObserver.observe(this._parentElement))}_showElement(){this._display?this._renderer.setStyle(this._componentRef.nativeElement,"display",this._display):this._renderer.removeStyle(this._componentRef.nativeElement,"display"),this._removeMinSize()}_hideElement(){this._applyMinSize(),this._display=this._componentRef.nativeElement?.style.display,this._renderer.setStyle(this._componentRef.nativeElement,"display","none")}_removeMinSize(){this._renderer.removeStyle(this._parentElement,"min-height"),this._minWidth&&this._renderer.removeStyle(this._parentElement,"min-width")}_applyMinSize(){this._renderer.setStyle(this._parentElement,"min-height",this._minHeight),this._minWidth&&this._renderer.setStyle(this._parentElement,"min-width",this._minWidth)}_initMinHeight(){const e=d.ViewElementRegistry.viewElements.get(this.viewElementConfig.type);e?this._minHeight=e.placeholderSize.height:console.warn(`View element with type "${this.viewElementConfig.type}" not found`)}_subscribeDestroyed(){this._destroyed?.subscribe(()=>{const e=this._componentRef?.hostView;e&&!e.destroyed&&e.destroy()})}createComponent(e){return this._componentRef=this._creator.createComponent(e),this._removeMinSize(),this._componentRef}show(){return this._applyMinSize(),new h.Observable(e=>{this._initIntersectionObserver(e)})}}const _t=new s.InjectionToken("COMPONENT_PROPERTIES_BINDER"),vt=new s.InjectionToken("DIRECTIVE_PROPERTIES_BINDER"),wt=new s.InjectionToken("VIEW_ELEMENT_RENDER_STRATEGY"),it=new s.InjectionToken("VIEW_ELEMENT_RENDER_STRATEGY_VALUE"),kt=function(a){const e=a.get(j);return a.get(A).getSelector(e.type)},st=function(a){return!!kt(a)},Lt=function(a){return a.get(w.FEATURE_VALUES,{optional:!0})},Ut=function(a){return a.get(w.IS_DESIGN_TIME,!1)},Wt=function(a){return st(a)?new Dt(a):new ft(a)},Gt=function(a){return st(a)?new mt(a):new nt(a)},Ht=function(a,e){const t=a.get(it)||d.ViewElementRenderStrategy.Default,i={[d.ViewElementRenderStrategy.Default]:Ct,[d.ViewElementRenderStrategy.OnViewport]:qt}[t];if(!i)throw new Error(`Unsupported render strategy type: ${t}`);return i(a,e)},zt=function(a,e){return a||e},Ct=function(a){return new yt(a)},Kt=function(a){return Lt(a).UseLazyComponentCreationInDesignTime},Zt=function(a){const e=a.get(j);return a.get(A).getViewElementRegistryItem(e.type)?.renderStrategy===d.ViewElementRenderStrategy.Default},qt=function(a,e){const t=Zt(a),n=Kt(a),i=st(a),r=!Ut(a);return t||i||r||!n?Ct(a):new Ft(a,new nt(a),e)};class M{constructor(e,t,n,i,r,o){this._resolver=e,this.parentDirective=t,this.injector=n,this._container=i,this._isDesignTime=r,this._ngZone=o,this._ownProperties=[{property:"visible",defaultValue:!0,omitForViewModelBinding:!0},{property:"bindTo",defaultValue:null,omitForViewModelBinding:!1}],this._destroyed$=new h.Subject,this._showElementSubscription=new h.Subscription,this._isCreating=!1,this._visible=!1,this.nested=[],this.total=0,this.viewElementShow=new s.EventEmitter,this._featureValues=(0,s.inject)(w.FEATURE_VALUES,{optional:!0}),this._measurePerformanceService=(0,s.inject)(w.MeasurePerformanceService),this._directiveRef=new Nt(this,this._ngZone)}get visible(){return this._visible}set visible(e){this._visible=e,this._setViewElementVisibility(e||this._isDesignTime)}_bindSelfToViewModel(){const e=this._ownProperties.reduce((t,{property:n,defaultValue:i})=>({...t,[n]:this.viewElementConfig[n]??i}),{});this._ngZone.runOutsideAngular(()=>this.bindDirectiveProperties(e))}_bindComponentToViewModel(){const e=(0,g.omit)(this.viewElementConfig,...this._ownProperties.filter(({omitForViewModelBinding:t})=>t===!0).map(({property:t})=>t));this._ngZone.runOutsideAngular(()=>this.bindComponentProperties(e))}_setViewElementVisibility(e){e&&!this.componentRef?this._showViewElement():!e&&this.componentRef&&this._hideViewElement()}_showViewElement(){const e=this.viewElementConfig.type;if(this._typeName=e,!!this._typeName)if(this._resolver.canResolve(e))this._showComponent();else{if(this.injector.get(_,!1))return;const n=this._container.createComponent(z);n.instance.caption=e;const i=n.injector.get(s.ElementRef).nativeElement,r=this._resolver.getCrtInputs(e);console.warn(`View element with type "${e}" not found`),this.componentRef=new et(n,r,n.instance,this._ngZone,n.changeDetectorRef,i,n.hostView)}}_showComponent(){if(this._isCreating)return;this._isCreating=!0;const e=this.injector.get(wt);this._showElementSubscription.add(e.show().pipe((0,p.filter)(t=>!!t),(0,p.takeUntil)(this._destroyed$)).subscribe(t=>{this.componentRef=t,this._measurePerformanceService.measure(`binding ${this.viewElementConfig.name}`,()=>this._bindComponentToViewModel()),this.viewElementShow.emit(this),this._isCreating=!1,this._featureValues?.UseMeasurePerformanceTools&&this._measurePerformanceService.rendering$.next()}))}_hideViewElement(){this._componentBinding?.unsubscribe(),this._showElementSubscription.unsubscribe(),this._container.clear(),this.componentRef=null}bindDirectiveProperties(e){this._directiveBinding?.unsubscribe(),this._directiveBinding=this._directivePropertiesBinder.bind(this._directiveRef,e)}bindComponentProperties(e){this._componentBinding?.unsubscribe(),this.componentRef&&(this._componentBinding=this._componentPropertiesBinder.bind(this.componentRef,e))}updateViewElementConfig(e){this.viewElementConfig=e,this._bindSelfToViewModel(),this._bindComponentToViewModel()}ngOnInit(){this._directivePropertiesBinder=this.injector.get(vt),this._componentPropertiesBinder=this.injector.get(_t),this.parentDirective&&this.parentDirective.attachNested(this),this._bindSelfToViewModel()}attachNested(e){this.nested.push(e)}detachNested(e){this.nested.splice(this.nested.indexOf(e),1)}ngOnDestroy(){this.parentDirective&&this.parentDirective.detachNested(this),this._componentBinding?.unsubscribe(),this._directiveBinding?.unsubscribe(),this._destroyed$.next(),this._destroyed$.complete()}static{this.\u0275fac=function(t){return new(t||M)(s.\u0275\u0275directiveInject(A),s.\u0275\u0275directiveInject(M,12),s.\u0275\u0275directiveInject(s.Injector),s.\u0275\u0275directiveInject(s.ViewContainerRef),s.\u0275\u0275directiveInject(w.IS_DESIGN_TIME,8),s.\u0275\u0275directiveInject(s.NgZone))}}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:M,selectors:[["","crtViewElement",""]],inputs:{viewElementConfig:[s.\u0275\u0275InputFlags.None,"crtViewElement","viewElementConfig"],renderStrategy:"renderStrategy",visible:"visible"},outputs:{viewElementShow:"viewElementShow"},features:[s.\u0275\u0275ProvidersFeature([{provide:j,useFactory:e=>e.viewElementConfig,deps:[(0,s.forwardRef)(()=>M)],multi:!1},{provide:_t,useFactory:Wt,deps:[s.Injector],multi:!1},{provide:vt,useFactory:e=>new ft(e),deps:[s.Injector],multi:!1},{provide:v,useFactory:Gt,deps:[s.Injector],multi:!1},{provide:it,useFactory:(e,t)=>zt(e.renderStrategy,t),deps:[(0,s.forwardRef)(()=>M),[new s.Inject(it),new s.SkipSelf,new s.Optional]],multi:!1},{provide:wt,useFactory:(e,t)=>Ht(e,t._destroyed$),deps:[s.Injector,(0,s.forwardRef)(()=>M)],multi:!1},...Ee])]})}}const It=a=>({viewModel$:a.viewModel$,parent:a.parent}),Et=(a,e)=>{const t=new h.ReplaySubject(1);return t.next(null),(a.viewModel$??e?.viewModel$)?.subscribe(t),{viewModel$:t.asObservable(),parent:a.viewModel$?e:e?.parent,viewModelSubject:t}};class Y{constructor(e){this.injector=e}set viewModel(e){(e instanceof E.BaseViewModel||e===void 0||e===null)&&(this.viewModel$?this.viewModel$.next(e):(this.viewModel$=new h.ReplaySubject(1),this.viewModel$.next(e)))}ngOnDestroy(){this.viewModel=null,this.viewModel$?.complete()}static{this.\u0275fac=function(t){return new(t||Y)(s.\u0275\u0275directiveInject(s.Injector))}}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:Y,selectors:[["","crtViewModel",""]],inputs:{viewModel:[s.\u0275\u0275InputFlags.None,"crtViewModel","viewModel"]},exportAs:["crtViewModel"],features:[s.\u0275\u0275ProvidersFeature([{provide:B,useFactory:It,deps:[[new s.Inject(je),new s.Self]],multi:!1},{provide:je,useFactory:Et,deps:[(0,s.forwardRef)(()=>Y),[new s.Inject(B),new s.SkipSelf,new s.Optional]],multi:!1}])]})}}const Jt=[{name:"Root",type:"crt.GridContainer",rows:["min-content","auto"],columns:["200px","auto"],gap:{columnGap:5,rowGap:5},classes:["page"],styles:{background:"lightcoral",minHeight:"700px",alignItems:"stretch"},items:[{name:"Header",type:"crt.FlexContainer",classes:["container","header","fixed-top"],alignItems:"center",styles:{padding:"5px",background:"#e0ebeb",border:"1px solid #94b8b8",position:"sticky",top:"0px",height:"100%"},items:[{name:"SaveButton",type:"crt.Button",caption:"save",dataItemMarker:"save-button"},{name:"CancelButton",type:"crt.Button",caption:"cancel"},{name:"UserButton",type:"crt.Button",caption:"user"},{name:"NotRegisterComponent",type:"crt.NotRegisterComponent"}],layoutConfig:{column:1,colSpan:-1}},{name:"LeftPane",type:"crt.FlexContainer",classes:["container","left"],styles:{height:"100%",background:"lightblue",padding:"5px",border:"1px solid #94b8b8"},direction:"column",items:[{name:"LeftPaneElement",type:"crt.List",parent:"LeftPane",classes:["el"],id:"list1",styles:{border:"1px solid #94b8b8",background:"#c2d6d6",padding:"5px"},layoutConfig:{grow:1}},{name:"input1",type:"crt.DeprecatedInput",parent:"LeftPane",classes:["el"],id:"input1",styles:{},caption:"Full name",value:"Andrew Baker (sample)",layoutConfig:{grow:1}}]},{name:"RightPane",type:"crt.GridContainer",classes:["container","right"],columns:["1fr","1fr"],styles:{height:"100%"},gap:5,items:[{name:"ImageInput2",type:"crt.ImageInput",classes:["el"],id:"imageInput2",caption:"imageInput2"},{name:"Toolbar1",type:"crt.FlexContainer",id:"toolbar1",gap:"5px",direction:"row",justifyContent:"flex-end",alignItems:"center",styles:{height:"100%"},items:[{name:"RunProcessButton",type:"crt.Button",caption:"run process"},{name:"ExecRequestButton",type:"crt.Button",caption:"exec request"}],layoutConfig:{column:1,colSpan:-1}}]}]}],Yt=[{name:"Root",type:"crt.GridContainer",rows:["min-content","auto"],columns:["200px","auto"],gap:{columnGap:5,rowGap:5},classes:["page"],styles:{direction:"rtl"},items:[{name:"Header",type:"crt.FlexContainer",classes:["container","header"],styles:{padding:"5px",background:"#e0ebeb",border:"1px solid #94b8b8"},items:[{name:"SaveButton",type:"crt.Button",caption:"save"},{name:"CancelButton",type:"crt.Button",caption:"cancel"},{name:"UserButton",type:"crt.Button",caption:"user"}],layoutConfig:{colSpan:2}},{name:"LeftPane",type:"crt.FlexContainer",classes:["container","left"],styles:{height:"100%"},items:[{name:"LeftPaneElement",type:"crt.List",parent:"LeftPane",classes:["el"],id:"list1",styles:{border:"1px solid #94b8b8",background:"#c2d6d6",padding:"5px"},layoutConfig:{grow:1}}],layoutConfig:{colSpan:1}},{name:"RightPane",type:"crt.GridContainer",classes:["container","right"],rows:"min-content",columns:["1fr","1fr"],gap:2,items:[{name:"Toolbar1",type:"crt.FlexContainer",id:"toolbar1",gap:"5px",direction:"row",justifyContent:"flex-end",items:[{name:"RunProcessButton",type:"crt.Button",caption:"run process"},{name:"ExecRequestButton",type:"crt.Button",caption:"exec request"}],layoutConfig:{colSpan:2}}],layoutConfig:{colSpan:1}},{name:"Footer",type:"crt.FlexContainer",classes:["container","footer"],items:[{name:"FeedbackButton",type:"crt.Button",caption:"feedback"}],layoutConfig:{column:1,colSpan:2,row:3}}]}];class Re{constructor(){this._viewModel$=new h.BehaviorSubject(null),this.viewModel$=this._viewModel$.asObservable()}set viewModel(e){this._viewModel$.next(e)}get viewModel(){return this._viewModel$.getValue()}static{this.\u0275fac=function(t){return new(t||Re)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:Re,factory:Re.\u0275fac})}}const Xt=a=>{switch(a){case d.DesignerToolGroupType.Data:case d.DesignerToolGroupType.Inputs:return{styles:{caption:{height:20},icon:{width:72,height:40},tile:{width:72,height:60}}};default:return{styles:{caption:{height:20},icon:{width:72,height:64},tile:{width:72,height:84}}}}};class G{static{this.\u0275fac=function(t){return new(t||G)}}static{this.\u0275mod=s.\u0275\u0275defineNgModule({type:G})}static{this.\u0275inj=s.\u0275\u0275defineInjector({providers:[A,...Ee],imports:[P.CommonModule,w.MacrosModule,N,N]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&s.\u0275\u0275setNgModuleScope(G,{declarations:[Y,M],imports:[P.CommonModule,w.MacrosModule,N],exports:[Y,M,N]})})();function Qt(a,e,t){const n=[];return e===void 0||w.MetadataSchemaUtils.getViewConfigInfoByFilter(i=>{const r=Object.values(i).filter(o=>{const c=o;return c?.request===e&&(t?t(c):!0)});return n.push(...r),!1},a),n}var Le;(function(a){a.HIDE="hide",a.DESTROY="destroy"})(Le||(Le={}));const rt="crt-hide-visible",Pe="_instanceId",Ue="_instanceCache";class Se{constructor(e,t,n){this._view=e,this._template=t,this._featureValues=n,this._context={$implicit:null},this.visibilityStrategyMode=Le.DESTROY}_changeVisibilityByDestroyStrategy(){this.crtIf?this._ref||(this._ref=this._view.createEmbeddedView(this._template,this._context)):(this._view.clear(),this._ref=null)}_canUseHideStrategy(){return this.visibilityStrategyMode===Le.HIDE&&this._featureValues.UseHideVisibilityStrategy}_changeVisibilityByHideStrategy(){if(this.crtIf){if(this._ref){this._getRootNode().classList.remove(rt);return}this._ref=this._view.createEmbeddedView(this._template,this._context);return}this._ref&&this._getRootNode().classList.add(rt)}_getRootNode(){return this._ref.rootNodes[0]}ngOnChanges(e){this._context.$implicit=this.crtIf,this._canUseHideStrategy()?this._changeVisibilityByHideStrategy():this._changeVisibilityByDestroyStrategy()}ngOnDestroy(){this._ref?.destroy()}static{this.\u0275fac=function(t){return new(t||Se)(s.\u0275\u0275directiveInject(s.ViewContainerRef),s.\u0275\u0275directiveInject(s.TemplateRef),s.\u0275\u0275directiveInject(w.FEATURE_VALUES))}}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:Se,selectors:[["","crtIf",""]],inputs:{crtIf:"crtIf",visibilityStrategyMode:[s.\u0275\u0275InputFlags.None,"crtIfVisibilityStrategyMode","visibilityStrategyMode"]},features:[s.\u0275\u0275NgOnChangesFeature]})}}class le{constructor(e){this._injector=e,this._requestBindingConfigInterpreter=this._injector.get(U),this._crtNavigationLock=this._injector.get(w.CRT_NAVIGATION_LOCK_TOKEN)}_sendRequest(e,t){var n=this;return(0,$.A)(function*(){const r={...yield(0,h.lastValueFrom)(n._requestBindingConfigInterpreter.evaluate(e,{...n._bindingContext,initialEvent:t})),$initialEvent:t};return r.$context?.executeRequest(r)??null})()}_sendRequests(e,t){var n=this;return this._crtNavigationLock.wait((0,$.A)(function*(){let i=null,r=!1;for(const o of t)if(!(r&&o.skipOnError===!0))try{i=yield n._sendRequest(o,e)}catch{r=!0}return i}))}processOutputEvent(e,t){if(this._bindingContext=this._injector.get(B),e.action==="processRequest")this._sendRequests(t,e.requests);else if(e.action==="changeAttributeValue"){const i=t instanceof CustomEvent?t.detail:t;Je(e.attributePath,i,this._bindingContext)}else e.action==="markControlAsTouched"&&Xe(e.attributePath,this._bindingContext)}static{this.\u0275fac=function(t){return new(t||le)(s.\u0275\u0275directiveInject(s.Injector))}}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:le,selectors:[["","crtOutputBinding",""]],exportAs:["crtOutputBinding"],features:[s.\u0275\u0275ProvidersFeature([U])]})}}class ue{static{this.\u0275fac=function(t){return new(t||ue)}}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:ue,selectors:[["","crtViewElementConfig",""]],inputs:{crtViewElementConfig:"crtViewElementConfig"},features:[s.\u0275\u0275ProvidersFeature([{provide:j,useFactory:e=>(0,g.cloneDeep)(e.crtViewElementConfig),deps:[[ue,new s.Self]]}])]})}}class pe{constructor(e){this.parent=e,this.inputs={},this.outputs={},this.directives=[],this.attributes={},this.content=[]}}class Ae{static{this.\u0275fac=function(t){return new(t||Ae)}}static{this.\u0275cmp=s.\u0275\u0275defineComponent({type:Ae,selectors:[["crt-view-element-container"]],inputs:{viewElementConfig:"viewElementConfig"},decls:1,vars:1,consts:[[3,"crtViewElement"]],template:function(t,n){t&1&&s.\u0275\u0275elementContainer(0,0),t&2&&s.\u0275\u0275property("crtViewElement",n.viewElementConfig)},dependencies:[M],encapsulation:2})}}class Te{constructor(e,t){this._containerRef=e,this._template=t,this._subscription=new h.Subscription,this._crtAttachIf$=new h.Subject,this._bindingActivator=(0,s.inject)(y.PRESERVED_CONTENT_BINDING_ACTIVATOR,{optional:!0})??new y.BindingActivator,this._subscription=(0,h.combineLatest)([this._bindingActivator.active$,this._crtAttachIf$]).subscribe(([n,i])=>this._changeVisibilityByAttachDetachStrategy(n,i))}_changeVisibilityByAttachDetachStrategy(e,t){if(t){if(e){if(!this._viewRef){this._viewRef=this._containerRef.createEmbeddedView(this._template);return}this._containerRef.insert(this._viewRef)}}else{const n=this._containerRef.indexOf(this._viewRef);n>=0&&this._containerRef.detach(n)}}ngOnChanges(e){this._crtAttachIf$.next(this.crtAttachIf)}ngOnDestroy(){this._subscription.unsubscribe(),this._viewRef?.destroy()}static{this.\u0275fac=function(t){return new(t||Te)(s.\u0275\u0275directiveInject(s.ViewContainerRef),s.\u0275\u0275directiveInject(s.TemplateRef))}}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:Te,selectors:[["","crtAttachIf",""]],inputs:{crtAttachIf:"crtAttachIf"},features:[s.\u0275\u0275NgOnChangesFeature]})}}class he extends P.NgForOf{static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=s.\u0275\u0275getInheritedFactory(he)))(n||he)}})()}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:he,selectors:[["","crtNgFor",""]],features:[s.\u0275\u0275InheritDefinitionFeature]})}}class de{constructor(e,t){this.changeDetectorRef=e,this.containerRef=t,this.init=new s.EventEmitter}ngOnInit(){this.init.emit(this)}static{this.\u0275fac=function(t){return new(t||de)(s.\u0275\u0275directiveInject(s.ChangeDetectorRef),s.\u0275\u0275directiveInject(s.ViewContainerRef))}}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:de,selectors:[["","crtViewInit",""]],outputs:{init:"init"}})}}class X extends P.AsyncPipe{static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=s.\u0275\u0275getInheritedFactory(X)))(n||X)}})()}static{this.\u0275pipe=s.\u0275\u0275definePipe({name:"crtAsync",type:X,pure:!1})}}const We=new s.InjectionToken("CRT_JIT_MODULES"),bt=new s.InjectionToken("CRT_SCHEMA_BINDING_CACHE");class fe{constructor(e,t,n,i,r){this._injector=e,this._changeDetector=t,this._bindingExpressionInterpreter=n,this._attributeFormControlExpressionInterpreter=i,this._ngZone=r,this._cache=this._injector.get(bt,null),this._bindingActivator=this._injector.get(y.BINDING_ACTIVATOR,null),this._preservedContentBindingActivator=this._injector.get(y.PRESERVED_CONTENT_BINDING_ACTIVATOR,null),this._subscribeToActivator()}_subscribeToActivator(){this._bindingActivator&&(this._bindingActivatorSubscription=(0,h.combineLatest)([this._bindingActivator.active$,this._preservedContentBindingActivator?.active$??(0,h.of)(!0)]).pipe((0,p.map)(([e,t])=>e&&t),(0,p.distinctUntilChanged)(),(0,h.tap)(e=>{e&&this._stream$&&!this._subscription&&(this._subscription=this._stream$.subscribe()),e||(this._subscription?.unsubscribe(),this._subscription=null)})).subscribe())}_isControlProperty(e,t){const n=d.ViewElementRegistry.getFormControlRelatesAttribute(t.type);return e===n}_getInterpreter(e){return e?this._attributeFormControlExpressionInterpreter:this._bindingExpressionInterpreter}_restoreValueFromCache(e,t,n){if(this._cache&&t.name){const i=this._cache.get(e)?.get(t.name)?.get(n);typeof i<"u"&&(this._result=i)}}_canApplyValueFromCache(e,t,n){return!!(t.name&&this._cache&&typeof this._cache.get(e)?.get(t.name)?.get(n)<"u")}_saveToCache(e,t,n){if(!(!this._cache||!this._viewModelRef?.deref())&&e.name){const i=this._cache.get(this._viewModelRef.deref())||new Map,r=i.get(e.name)||new Map;this._cache.set(this._viewModelRef.deref(),i),i.set(e.name,r),r.set(t,n)}}transform(e,t,n){if(e!==this._oldValue){this._subscription?.unsubscribe(),this._oldValue=e,this._result=null,this._stream$=null;const i=this._isControlProperty(t,n);if(!(0,y.isBindingExpression)(e))this._result=i?new De.FormControl(e):e;else{this._bindingContext=this._injector.get(B);const r=this._bindingContext.viewModel$.pipe((0,h.tap)(l=>{const u=this._canApplyValueFromCache(l,n,t),f=(this._viewModelRef?.deref()||null)!==l,b=d.ViewElementRegistry.getViewElementInputs(n.type)[t];(!u&&f&&this._result instanceof E.BaseViewModelCollection||b?.reuseStrategy?.resetValue)&&(this._result=null),this._viewModelRef=l?new WeakRef(l):null,this._restoreValueFromCache(l,n,t)})),c=this._getInterpreter(i).evaluate(e,this._bindingContext).pipe((0,$e.runInZone)(this._ngZone),(0,h.tap)(l=>{this._result!==l&&(this._result=l,this._saveToCache(n,t,l),this._changeDetector.markForCheck())}));this._stream$=(0,h.merge)(r,c),this._subscription=this._stream$.subscribe()}}return this._result}ngOnDestroy(){this._subscription?.unsubscribe(),this._bindingActivatorSubscription?.unsubscribe()}static{this.\u0275fac=function(t){return new(t||fe)(s.\u0275\u0275directiveInject(s.Injector,16),s.\u0275\u0275directiveInject(s.ChangeDetectorRef,16),s.\u0275\u0275directiveInject(O,16),s.\u0275\u0275directiveInject(F,16),s.\u0275\u0275directiveInject(s.NgZone,16))}}static{this.\u0275pipe=s.\u0275\u0275definePipe({name:"crtBinding",type:fe,pure:!1})}}class Vt{create(e){const{attributes:t,content:n,directivesContent:i,inputs:r,outputs:o,parts:c}=e,{name:l="root",selector:u}=c;return`
			<${u} id="${l}" crtViewInit (init)="refs['${l}'] = $event"
				${r.join(" ")} ${i} ${o.join(" ")} ${t.join(" ")}
			>
				${n.join(" ")}
			</${u}>
		`}}class en extends Vt{_getPlaceholderTemplate(e,t){const n=t?.placeholderSize?.height;return`<div ${e.join(" ")}
					style="height: ${n}; background-color: transparent;">
				</div>`}create(e){const{attributes:t,parts:n}=e,i=super.create(e),r=this._getPlaceholderTemplate(t,n);return`
				<ng-container ${n.slot}>
					@defer (on viewport) {
						${i}
					} @placeholder {
						${r}
					}
				</ng-container>
			`}}class xe{constructor(){this._disableOnViewportRenderFeatureName="Runtime.DisableOnViewportRender",this._featureValues=(0,s.inject)(w.FEATURE_VALUES)}create(e){return!this._featureValues[this._disableOnViewportRenderFeatureName]&&e===d.ViewElementRenderStrategy.OnViewport?new en:new Vt}static{this.\u0275fac=function(t){return new(t||xe)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:xe,factory:xe.\u0275fac,providedIn:"root"})}}class tn extends Error{constructor(e,t){super(`Validation error. Cannot create ${e} with name ${t}. Incorrect format`)}}const nn=/^([#a-zA-Z_]+)([\w_.-]+)/gm;function Ge(a,e){const t=e.match(nn);if(!(t?.length&&t[0]===e))throw new tn(a,e)}class ge{static{this.\u0275fac=function(t){return new(t||ge)}}static{this.\u0275mod=s.\u0275\u0275defineNgModule({type:ge})}static{this.\u0275inj=s.\u0275\u0275defineInjector({imports:[P.CommonModule,G,P.CommonModule,G]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&s.\u0275\u0275setNgModuleScope(ge,{declarations:[X,fe,le,Se,ue,Ae,de,he,Te],imports:[P.CommonModule,G],exports:[P.CommonModule,G,Se,fe,le,ue,X,Ae,de,he,Te]})})();class me{constructor(e,t,n,i){this._injector=t,this._ngZone=n,this._componentTemplateFactory=i,this._featureValues=this._injector.get(w.FEATURE_VALUES),this._modules=me._flatModulesArrays(e)}static _flatModulesArrays(e){const t=e.flat(),n=t.filter((i,r)=>t.indexOf(i)!==r);if(n.length>0){const i=n.map(r=>r.name).join(", ");throw new Error(`There are module duplicates in "${We}" token: ${i}`)}return t}_getInputExpression(e,t,n){let i;const r=t.value;return this._featureValues.DisableDoNotUseBindingPipeForConstant?i=e?`"context['${e}']${n}"`:`"${r}${n}"`:e?i=t.pipes||typeof r=="string"?`"context['${e}']${n}"`:`'${r}'`:i=`"${r}${n}"`,i}_createInputDefinitions(e,t){const n=[];for(const[i,r]of Object.entries(e.inputs)){Ge("input",i);const o=r.propertyKey;o&&(t[o]=r.value);let c="";for(const f of r.pipes||[]){c+=` | ${f.name}`;for(const m of f.arguments||[])t[m.propertyKey]=m.value,c+=`:context['${m.propertyKey}']`}const l=this._getInputExpression(o,r,c),u=`[${i}]=${l}`;n.push(u)}return n}_createAttributeDefinitions(e,t){const n=[];for(const[i,r]of Object.entries(e.attributes))Ge("attribute",i),r.value?n.push(`${i}="${r.value}"`):n.push(`${i}`);return n}_createOutputDefinitions(e,t){const n=[],i="ref";Object.entries(e.outputs).length>0&&n.push(`crtOutputBinding #${i}="crtOutputBinding"`);for(const[r,o]of Object.entries(e.outputs)){Ge("output",r);const c=o.propertyKey;t[c]=o.fn,n.push(`(${r})="context['${c}'](${i}, $event)"`)}return n}_createDirectiveDefinitions(e,t){const n=[],i=[];for(const r of e.directives){const o=r.useAsterisk?`*${r.selector}`:`[${r.selector}]`,c=[];for(const f of r.values){const m=f.propertyKey;let b=`context['${m}']`;for(const T of f.pipes||[]){b+=` | ${T.name}`;for(const ee of T.arguments||[])t[ee.propertyKey]=ee.value,b+=`:context['${ee.propertyKey}']`}(0,h.isObservable)(f.value)?t[m]=f.value.pipe((0,$e.runInZone)(this._ngZone)):t[m]=f.value,c.push(b)}const{variableName:l}=r;let u="";r.additionalInputs?.length>0&&(r.useAsterisk?u=this._getAdditionalStructuredDirectiveInputs(r.additionalInputs):i.push(r.additionalInputs.map(f=>`[${f.propertyKey}]='${f.value}'`).join(";"))),r.rawValue&&c.push(r.rawValue),n.push(`${o}="${c.map(f=>`(${f})`).join(" && ")}${l?";let "+l:""+u}"`)}return{directives:n,directiveInputs:i}}_getAdditionalStructuredDirectiveInputs(e){return`; ${e.map(n=>`${n.propertyKey}: '${n.value}'`).join("; ")};`}_createContentDefinitions(e,t){const n=[],i=e.content;for(const r of i){const{componentContext:o,componentTemplate:c}=this.createTemplateAndContext(r);n.push(c),Object.assign(t,o)}return n}_isHostModule(e){return d.bootstrappedCrtModules.get(e)?.source==="host"}createTemplateAndContext(e){Ge("selector",e.selector);const t={},n=this._createInputDefinitions(e,t),i=this._createAttributeDefinitions(e,t),r=this._createOutputDefinitions(e,t),{directives:o,directiveInputs:c}=this._createDirectiveDefinitions(e,t),l=this._createContentDefinitions(e,t),u=`${o.join(" ")} ${c.join(" ")}`;return{componentTemplate:this._componentTemplateFactory.create(e.renderStrategy).create({parts:e,inputs:n,outputs:r,content:l,attributes:i,directivesContent:u}),componentContext:t}}create(e,t,n){const i=this._injector,o=i.get(E.CRT_METADATA_PREPROCESSOR).map(u=>({provide:E.CRT_METADATA_PREPROCESSOR,useValue:u,multi:!0})),c=(n??[]).filter(u=>this._isHostModule(u));return{componentType:(0,s.Component)({selector:e,template:t,host:{class:"flex-full-height fullscreen-class"},styles:[`
				:host > .stretch {
					flex-grow: 1;
				}
				.${rt} {
					display: none;
				}
			`],changeDetection:s.ChangeDetectionStrategy.OnPush,imports:[ge,...this._modules,...c],standalone:!0,providers:[...o,{provide:y.BINDING_ACTIVATOR,useValue:{active$:new h.BehaviorSubject(!0)}}]})(class{constructor(){this._bindingActivator=(0,s.inject)(y.BINDING_ACTIVATOR),this.ownChangeDetectorRef=(0,s.inject)(s.ChangeDetectorRef),this.injector=i,this.refs={}}activate(){this.ownChangeDetectorRef.reattach(),this._bindingActivator.active$.next(!0)}deactivate(){this.ownChangeDetectorRef.detach(),this._bindingActivator.active$.next(!1)}updateViewElementInput(u,f,m){this.context={...this.context,[u+":"+f]:m},this.refs[u]?.changeDetectorRef?.detectChanges(),this.refs[u]?.changeDetectorRef?.markForCheck()}})}}static{this.\u0275fac=function(t){return new(t||me)(s.\u0275\u0275inject(We),s.\u0275\u0275inject(s.Injector),s.\u0275\u0275inject(s.NgZone),s.\u0275\u0275inject(xe))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:me,factory:me.\u0275fac,providedIn:"root"})}}class Me{constructor(e){this._schemaChangeListenerService=e,this._componentInfoCache=new Map,this._destroyed$=new h.Subject,this._schemaChangeListenerService.schemaChanged$.pipe((0,p.takeUntil)(this._destroyed$)).subscribe(t=>{t.schemaType===w.SchemaTypes.ClientUnitSchema&&this._componentInfoCache.delete(t.name)})}get(e){return this._componentInfoCache.get(e)}set(e,t){this._componentInfoCache.set(e,t)}has(e){return this._componentInfoCache.has(e)}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}static{this.\u0275fac=function(t){return new(t||Me)(s.\u0275\u0275inject(w.SchemaChangeListenerService))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:Me,factory:Me.\u0275fac,providedIn:"root"})}}class ye{constructor(){this.viewAttached$=new h.BehaviorSubject(!0)}static{this.\u0275fac=function(t){return new(t||ye)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:ye,factory:ye.\u0275fac})}}class _e{constructor(){this._componentRefCache=new Map,this._viewConfigCache=new Map,this._instanceCache=new Map}invalidateInstance(e){const t=[],n=Array.from(this._componentRefCache.keys());for(const[i,r]of this._instanceCache.entries())r.delete(e),i.instance.ownChangeDetectorRef.detectChanges(),!r.size&&n.indexOf(i)<n.length-1&&t.push(i);t.forEach(i=>{this._componentRefCache.delete(i),this._viewConfigCache.delete(i),this._instanceCache.delete(i),i.destroy()})}saveView(e,t,n){const i=this._componentRefCache.get(e)||new Set;i.add(t),this._componentRefCache.set(e,i),this._viewConfigCache.set(e,n)}saveInstance(e,t){const n=this._instanceCache.get(e)||new Set;n.add(t),this._instanceCache.set(e,n)}getInstances(e){return this._instanceCache.get(e)}getView(e){for(const[t,n]of this._componentRefCache.entries())if(n.has(e))return t}getViewConfig(e){return this._viewConfigCache.get(e)}ngOnDestroy(){for(const e of this._componentRefCache.keys())e.destroy();this._componentRefCache.clear(),this._viewConfigCache.clear(),this._instanceCache.clear()}static{this.\u0275fac=function(t){return new(t||_e)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:_e,factory:_e.\u0275fac})}}var Rt=C(35293);const Pt="bindTo",sn="visible";class I{static _getViewElementInputProperties(e){const t=d.ViewElementRegistry.viewElements.get(e.type);return[...Object.keys(t.inputs??{}).filter(n=>t.inputs[n].propertyBindable),sn]}static createLayoutConfigComponentParts(e,t,n){for(const[i,r]of Object.entries(t))n.attributes["layout-config-"+(0,g.kebabCase)(i)]={value:r}}static createVisibleComponentPartsWrapper(e,t,n,i){const r=(0,y.isBindingExpression)(t);let o=t;const c=[];r&&(o=t,c.push({name:"crtBinding",arguments:[{value:e,propertyKey:I.getContextPropertyName(e+"|propertyName",n)},{value:i,propertyKey:I.getContextPropertyName(e+"|viewElementConfig",n)}]}));const l=n.directives.find(u=>u.selector==="crtIf");if(l)l.values.unshift({propertyKey:this.getContextPropertyName(e,n),value:o,pipes:c});else{const u={values:[{propertyKey:this.getContextPropertyName(e,n),value:o,pipes:c}],selector:"crtIf",useAsterisk:!0};I.addCrtIfDirectiveAdditionalInputs(u,i),n.directives.push(u)}return n}static getContextPropertyName(e,t){return t.name+":"+e}static getViewElementEntries(e){const t=d.ViewElementRegistry.getFormControlRelatesAttribute(e.type),n=Object.entries(e),i=n.find(([o])=>o===Pt);let r=n.filter(([o])=>o!==Pt);if(i){const o=this._getViewElementInputProperties(e),[,c]=i;o.forEach(l=>{if(l!==t){const u=e[l];if(u==null||typeof u!="string"||typeof u=="string"&&!u.includes("|")){let f=c;f=`${f}:${l}`,u!=null&&(f+=`=${JSON.stringify(u)}`),r=r.filter(([m])=>m!==l),r.push([l,f])}}})}return r}static addCrtIfDirectiveAdditionalInputs(e,{visibilityStrategyMode:t}){if(!t)return;const n=e.additionalInputs||[];n.push({propertyKey:"visibilityStrategyMode",value:t}),e.additionalInputs=[...n]}}class St{constructor(e,t){this.injector=e,this.componentPartsFactory=t,this._specialPropertiesList=[{property:"type",createComponentPart:()=>{}},{property:"layoutConfig",createComponentPart:I.createLayoutConfigComponentParts.bind(this)}],this._loadingAttributeName="loading",this._visibleAttributeName="visible",this.initDependencies()}_createViewElementConfigProviderComponentParts(e,t){t.directives.push({selector:"crtViewElementConfig",values:[{value:e,pipes:[],propertyKey:I.getContextPropertyName("viewElementConfig",t)}]})}_createDataItemMarkerComponentParts(e,t){t.attributes["data-item-marker"]={value:e.dataItemMarker||e.name}}_validateRenderStrategyConfig(e){const{renderStrategy:t,placeholderSize:n}=e;t===d.ViewElementRenderStrategy.OnViewport&&!n&&console.warn("The property placeholderSize must be specified for the OnViewport strategy to work correctly")}createLoadingComponentParts(e,t){Object.keys(e).some(i=>i===this._loadingAttributeName)?this._createInputComponentParts(this._loadingAttributeName,e[this._loadingAttributeName],e,t):this._createDefaultLoadingPropertyBinding(e,t)}_createDefaultLoadingPropertyBinding(e,t){const n=(0,g.chain)(e).entries().filter(([r,o])=>this.isInputBinding(r,o,e)&&(0,y.isBindingExpression)(o)).value();let i=(0,h.of)(!1);if(n.length){const r=n.map(([o,c])=>ze(c));i=this._createLoadingPropertyValueFromContextEvent(r)}t.inputs[this._loadingAttributeName]={propertyKey:I.getContextPropertyName(this._loadingAttributeName,t),pipes:[{name:"crtAsync",arguments:[]}],value:i}}_createLoadingPropertyValueFromContextEvent(e){const t=this.injector.get(s.NgZone);return ne(this._bindingContext).viewModel$.pipe((0,p.switchMap)(n=>{if(!n)return(0,h.of)(!1);let i=[];const r=n.events$.pipe((0,p.filter)(c=>c.type===E.ViewModelEventType.StartLoadModelAttributes),(0,p.map)(c=>c),(0,p.filter)(c=>{const l=Object.keys(c.payload);return e.some(u=>l.includes(u))}),(0,p.tap)(c=>{i=Object.keys(c.payload)}),(0,p.map)(()=>!0)),o=n.events$.pipe((0,p.filter)(c=>c.type===E.ViewModelEventType.FinishLoadModelAttributes),(0,p.map)(c=>c),(0,p.filter)(c=>{const l=Object.keys(c.payload);return i.every(u=>l.includes(u))}),(0,p.map)(()=>!1),(0,p.tap)(()=>i=[]));return(0,h.merge)(r,o).pipe((0,$e.runInZone)(t))}))}_createContentPropertyComponentParts(e,t,n,i,r){const o=this.getViewElementSlotDefinition(n,e);for(const c of t){const l=this.componentPartsFactory.create(this.injector,c);let u=l.create(c,i,r);o.lazy&&(u=this.createLazyContentComponentParts(u)),this.featureValues.UseSchemaOutletReuseViewStrategy&&this.isAngularHost&&!this.featureValues.DisableComponentPartsCreatorAddContentProperty?l.addContentProperty(e,u,n):this.addContentProperty(e,u,n),i.content.push(u)}o.input&&this._createInputComponentParts(e,t,n,i)}_isConstant(e){const t=typeof e;return t==="string"&&!(0,y.isBindingExpression)(e)||t==="number"||t==="boolean"||t==="bigint"}_getBindingPipeConfig(e,t,n){return[{name:"crtBinding",arguments:[{value:e,propertyKey:I.getContextPropertyName(e+"|propertyName",n)},{value:t,propertyKey:I.getContextPropertyName(e+"|viewElementConfig",n)}]}]}_createInputComponentParts(e,t,n,i){i.inputs[e]={propertyKey:I.getContextPropertyName(e,i),value:t},(this.featureValues.DisableDoNotUseBindingPipeForConstant||!this._isConstant(t))&&(i.inputs[e].pipes=this._getBindingPipeConfig(e,n,i))}_createControlInputComponentParts(e,t,n,i){const r={selector:"crtIf",variableName:"control",useAsterisk:!0,values:[{value:t,propertyKey:I.getContextPropertyName(e,i),pipes:[{name:"crtBinding",arguments:[{value:e,propertyKey:I.getContextPropertyName(e+"|propertyName",i)},{value:n,propertyKey:I.getContextPropertyName(e+"|viewElementConfig",i)}]}]}],additionalInputs:[]};I.addCrtIfDirectiveAdditionalInputs(r,n),i.directives.push(r),i.inputs[e]={value:"control"}}_createInputWithValidationComponentParts(e,t,n,i){const o=this.injector.get(W).evaluate(t,this._bindingContext).pipe((0,p.share)()),c=o.pipe((0,p.pluck)("value"),(0,p.distinctUntilChanged)());i.inputs[e]={propertyKey:I.getContextPropertyName(e,i),value:c,pipes:[{name:"crtAsync",arguments:[]}]};const l=qe(e),u=o.pipe((0,p.pluck)("validationInfo"),(0,p.distinctUntilChanged)());i.inputs[l]={propertyKey:I.getContextPropertyName(l,i),value:u,pipes:[{name:"crtAsync",arguments:[]}]}}_createOutputComponentParts(e,t,n){n.outputs[e]={propertyKey:I.getContextPropertyName(e,n),fn:(i,r)=>{i.processOutputEvent(t,r)}}}_createTwoWayBindingComponentParts(e,t,n,i){be(n.type,e)?this._createInputWithValidationComponentParts(e,t,n,i):this._createInputComponentParts(e,t,n,i);const r=t.slice(1),o=ae(e),c={action:"changeAttributeValue",attributePath:r};this._createOutputComponentParts(o,c,i);const l={action:"markControlAsTouched",attributePath:r};this._createOutputComponentParts("focusout",l,i)}_createSpecialPropertyComponentParts(e,t,n){return this._specialPropertiesList.find(r=>r.property===e)?.createComponentPart(e,t,n)}initDependencies(){this.bindingExpressionInterpreter=this.injector.get(O),this._bindingContext=this.injector.get(B),this.featureValues=this.injector.get(w.FEATURE_VALUES),this.isAngularHost=this.injector.get(w.IS_ANGULAR_HOST)}createLazyContentComponentParts(e){throw Error("View element type does not support lazy content projection.")}isSpecialPropertyBinding(e,t){return!!this._specialPropertiesList.find(n=>n.property===e)}isContentPropertyBinding(e,t,n){return!!this.getViewElementSlotDefinition(n,e)}getViewElementSlotDefinition(e,t){const i=d.ViewElementRegistry.viewElements.get(e.type)?.contentSlots?.find(r=>(typeof r=="string"?r:r.name)===t);return typeof i=="string"?{name:i,input:!1,lazy:!1}:i}isInputBinding(e,t,n){return re(n.type,e)}isControlBinding(e,t,n){return d.ViewElementRegistry.getFormControlRelatesAttribute(n.type)===e}isInputWithValidationBinding(e,t,n){return this.isInputBinding(e,t,n)&&(0,y.isSimpleBindingExpression)(t)&&be(n.type,e)}isOutputBinding(e,t,n){return oe(n.type,e)}isTwoWayBinding(e,t,n){const i=ae(e);return re(n.type,e)&&oe(n.type,i)&&!(i in n)&&(0,y.isBindingExpression)(t)?(0,y.isSimpleBindingExpression)(t)?!0:(console.warn(`Cannot use two way binding for '${e}' property of '${n.name}' view element. Expression '${t}' should not have converters, properties etc.`),!1):!1}_processViewElementConfigProperty(e,t,n,i,r){if(this.isContentPropertyBinding(e,t,n)&&Array.isArray(t))this._createContentPropertyComponentParts(e,t,n,i,r);else if(this.isSpecialPropertyBinding(e,t))this._createSpecialPropertyComponentParts(e,t,i);else if(this.isTwoWayBinding(e,t,n))this._createTwoWayBindingComponentParts(e,t,n,i);else if(this.isOutputBinding(e,t,n)){const c={action:"processRequest",requests:Array.isArray(t)?t:[t]};this._createOutputComponentParts(e,c,i)}else this.isInputWithValidationBinding(e,t,n)?this._createInputWithValidationComponentParts(e,t,n,i):this.isControlBinding(e,t,n)?this._createControlInputComponentParts(e,t,n,i):this.isInputBinding(e,t,n)&&this._createInputComponentParts(e,t,n,i)}addIsAttachedConditionInCrtIf(e){const t={propertyKey:I.getContextPropertyName("isViewAttached",e),value:this.injector.get(ye).viewAttached$.asObservable(),pipes:[{name:"crtAsync"}]},n=e.directives.find(({selector:i})=>i==="crtIf");n?n.values.push(t):e.directives.push({selector:"crtIf",useAsterisk:!0,values:[t]})}create(e,t,n){const i=new pe(t),r=this.getViewElementInfo(e);i.selector=r.selector,i.name=e.name??(0,Rt.A)(),i.type=e.type,i.renderStrategy=r.renderStrategy,i.placeholderSize=e.placeholderSize||r.placeholderSize,this._validateRenderStrategyConfig(i);const o=I.getViewElementEntries(e);for(const[l,u]of o)l!==this._visibleAttributeName&&this._processViewElementConfigProperty(l,u,e,i,n);this.createLoadingComponentParts(e,i),n?.useDataItemMarker&&this._createDataItemMarkerComponentParts(e,i),this._createViewElementConfigProviderComponentParts(e,i);const c=o.find(([l])=>l===this._visibleAttributeName);return c?.[0]?I.createVisibleComponentPartsWrapper(this._visibleAttributeName,c[1],i,e):i}}class At extends St{_getComponentMirror(e){return(0,s.reflectComponentType)(e)}_getSelector(e){const t=this._resolver.getViewElementTypeByRegistryItem(e);return this._getComponentMirror(t).selector}addContentProperty(e,t,n){d.ViewElementRegistry.viewElements.get(n.type)?.contentSlots?.length>1&&(t.attributes[e]={value:""}),t.slot=e,t.attributes["#"+e]={value:""}}initDependencies(){super.initDependencies(),this._resolver=this.injector.get(A)}createLazyContentComponentParts(e){const t=new pe;t.selector="ng-template",t.content.push(e);const n=e.directives.find(i=>i.selector==="crtIf");return n&&t.directives.push({selector:"crtIf",values:n.values,useAsterisk:!0}),t}createControl(e){return new De.FormControl(e)}getViewElementInfo(e){const t=this._resolver.getViewElementRegistryItem(e.type);return{selector:this._getSelector(t),placeholderSize:t.placeholderSize,renderStrategy:t.renderStrategy||d.ViewElementRenderStrategy.Default}}}class ot{}class rn extends At{addContentProperty(e,t,n){super.addContentProperty(e,t,n),this.featureValues.UseSchemaOutletReuseViewStrategy&&this.isAngularHost&&(this.featureValues.DisableComponentPartsRerenderCache||(t.content[0].content[0].attributes["#"+e]={value:""}))}create(e,t,n){const i=super.create(e,t,n);if(this.featureValues.UseSchemaOutletReuseViewStrategy&&this.isAngularHost)if(this.featureValues.DisableComponentPartsRerenderCache)this.addIsAttachedConditionInCrtIf(i);else{const r=new pe(t);r.selector="ng-template",r.attributes.crtNgFor={value:""},r.attributes["let-instanceId"]={value:""},r.inputs.ngForOf={value:`context['${Ue}']`};const o=new pe(r);return r.content=[o],o.selector="ng-container",o.directives.push({selector:"crtAttachIf",values:[],useAsterisk:!0,rawValue:`context['${Pe}'] === instanceId`}),o.content=[i],r}return i}}class on{constructor(e){this._injector=e}create(e,t,n){const i=new pe(t);return i.selector="crt-view-element-placeholder",i.name=e.name??(0,Rt.A)(),i.inputs.caption={value:e.type,propertyKey:I.getContextPropertyName("caption",i),pipes:[]},"layoutConfig"in e&&I.createLayoutConfigComponentParts("layoutConfig",e.layoutConfig,i),"visible"in e?I.createVisibleComponentPartsWrapper("visible",e.visible,i,e):i}addContentProperty(e,t,n){}}class an extends St{addContentProperty(e,t,n){this._resolver.getViewElementRegistryItem(n.type)?.contentSlots?.length>1&&(t.attributes[e]={value:""}),t.attributes["#"+e]={value:""}}initDependencies(){super.initDependencies(),this._resolver=this.injector.get(A)}getViewElementInfo(e){return{selector:this._resolver.getSelector(e.type),placeholderSize:null,renderStrategy:d.ViewElementRenderStrategy.Default}}createControl(e){return new E.BaseCrtControl(e)}createLoadingComponentParts(e,t){this._resolver.getViewElementRegistryItem(e.type).inputs?.loading&&super.createLoadingComponentParts(e,t)}create(e,t,n){const i=super.create(e,t,n);return this.addIsAttachedConditionInCrtIf(i),i}}class ve extends ot{create(e,t){const n=e.get(A);if(!t.type)throw new Error('"Type" property of view config can not be empty');return n.canResolve(t.type)?n.getSelector(t.type)?new an(e,this):d.ViewElementRegistry.viewElements.get(t.type)?.reuseStrategy===d.ViewElementReuseStrategy.Rerender?new rn(e,this):new At(e,this):(console.warn(`View element with type "${t.type}" not found`),new on(e))}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=s.\u0275\u0275getInheritedFactory(ve)))(n||ve)}})()}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:ve,factory:ve.\u0275fac})}}class cn{constructor(e){this._injector=e}create(e,t,n){const i=new ComponentParts(t);i.selector="crt-view-element-container",i.name=e.name??uuid(),i.inputs.viewElementConfig={value:e,propertyKey:ComponentPartsCreatorUtils.getContextPropertyName("viewElementConfig",i),pipes:[]},"layoutConfig"in e&&ComponentPartsCreatorUtils.createLayoutConfigComponentParts("layoutConfig",e.layoutConfig,i);const o=ComponentPartsCreatorUtils.getViewElementEntries(e).find(([c])=>c==="visible");return o?.[0]in e?ComponentPartsCreatorUtils.createVisibleComponentPartsWrapper("visible",o[1],i,e):i}addContentProperty(e,t,n){}}class Q{constructor(e,t,n,i,r,o,c){this.injector=e,this._featureService=t,this.containerRef=n,this._componentCreator=i,this._componentPartsFactory=r,this._componentStorage=o,this._measurePerformanceService=c,this._featureValues=(0,s.inject)(w.FEATURE_VALUES)}_getContentProperties(e){return d.ViewElementRegistry.viewElements.get(e.type)?.contentSlots?.map(t=>typeof t=="string"?t:t.name)||[]}_getInputProperties(e){const t=d.ViewElementRegistry.viewElements.get(e.type),n=t?.inputs||{};return t.contentSlots&&t.contentSlots.forEach(i=>{typeof i=="object"&&i.input&&(n[i.name]={})}),n}_getOutputProperties(e){return d.ViewElementRegistry.viewElements.get(e.type)?.outputs||{}}_getOutputPropertiesValues(e){const t=this._getOutputProperties(e);return(0,g.pick)(e,Object.keys(t))}_isViewConfigsDifferent(e,t){return e.name!==t.name||e.type!==t.type||this._isOutputPropertiesChanged(e,t)||this._isInputOrContentPropertiesLengthChanged(e,t)}_isInputOrContentPropertiesLengthChanged(e,t){const n=[...Object.keys(this._getInputProperties(e)),...Object.keys(this._getContentProperties(e))],i=[...Object.keys(this._getInputProperties(t)),...Object.keys(this._getContentProperties(t))];return!(0,g.isEqual)(new Set(n),new Set(i))}_isOutputPropertiesChanged(e,t){const n=this._getOutputPropertiesValues(e),i=this._getOutputPropertiesValues(t);return!(0,g.isEqual)(n,i)}_getComponentParts(e){const t=new pe;t.selector="ng-container";for(const n of(0,g.cloneDeep)(this.viewConfig)){const r=this._componentPartsFactory.create(this.injector,n).create(n,null,{useDataItemMarker:e});t.content.push(r)}return t}createComponent(e,t){let n;const i=this._measurePerformanceService.measure("ViewGenerator.getComponentParts",()=>this._getComponentParts(e)),{componentContext:r,componentTemplate:o}=this._measurePerformanceService.measure("ViewGenerator.createTemplateAndContext",()=>this._componentCreator.createTemplateAndContext(i));!t&&this.selector&&this._componentStorage.has(this.selector)?n=this._componentStorage.get(this.selector):(n=this._measurePerformanceService.measure(`ViewGenerator.createComponent.${this.selector}`,()=>this._componentCreator.create(this.selector,o,this.modules)),!t&&this.selector&&this._componentStorage.set(this.selector,n));const c=this.containerRef.createComponent(n.componentType,{index:0,injector:this.injector,environmentInjector:this.injector.get(s.EnvironmentInjector)});return c.instance.context=r,c}canUpdateView(e,t){if(this._featureValues.DisableUpdateWithoutSchemaReload||e.length!==t.length||!this.componentInstance)return!1;for(let n=0;n<e.length;n++){const i=e[n],r=t[n];if(this._isViewConfigsDifferent(i,r))return!1;const o=this._getContentProperties(i);for(const c of o)if(!this.canUpdateView(i[c]||[],r[c]||[]))return!1}return!0}_updateViewElementInputs(e,t){for(let n=0;n<e.length;n++){const i=t[n],r=e[n];for(const c of Object.keys(this._getInputProperties(i)))(0,g.isEqual)(i[c],r[c])||this.componentInstance.updateViewElementInput(i.name,c,i[c]);const o=this._getContentProperties(i);for(const c of o)this._updateViewElementInputs(r[c]||[],i[c]||[])}}updateView(e,t){this._measurePerformanceService.measure("ViewGenerator.updateView",()=>{this._updateViewElementInputs(e,t),this.componentInstance.changeDetectorRef.detectChanges()})}resetPreviousView(){this.containerRef.clear()}createView(){const e=this.createComponent(this._featureValues.UseViewElementDataItemMarker,this._featureValues.DisableComponentCacheFeature);return e.instance.changeDetectorRef=e.changeDetectorRef,this.componentInstance=e.instance,e}ngOnChanges(e){const t=e.viewConfig?.currentValue||[],n=e.viewConfig?.previousValue||[];t&&!(0,g.isEqual)(n,t)&&(this.canUpdateView(n,t)?this.updateView(n,t):(this.resetPreviousView(),this.createView()))}static{this.\u0275fac=function(t){return new(t||Q)(s.\u0275\u0275directiveInject(s.Injector),s.\u0275\u0275directiveInject(ut.FeatureService),s.\u0275\u0275directiveInject(s.ViewContainerRef),s.\u0275\u0275directiveInject(me),s.\u0275\u0275directiveInject(ot),s.\u0275\u0275directiveInject(Me),s.\u0275\u0275directiveInject(w.MeasurePerformanceService))}}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:Q,selectors:[["","crtViewGenerator",""]],inputs:{viewConfig:"viewConfig",selector:"selector",modules:"modules"},features:[s.\u0275\u0275ProvidersFeature([...Ee]),s.\u0275\u0275NgOnChangesFeature]})}}class H extends Q{constructor(){super(...arguments),this._cacheService=(0,s.inject)(_e),this._viewModel$=new h.ReplaySubject(1),this._bindingContext={viewModel$:this._viewModel$.asObservable()}}resetPreviousView(){if(this.componentInstance?.deactivate(),this._componentRef){const e=this.containerRef.indexOf(this._componentRef.hostView);this.containerRef.detach(e)}}createView(){return this._viewModel$.next(this.viewModel),super.createView()}_restoreView(e){this.resetPreviousView(),this._componentRef=e,this.componentInstance=this._componentRef.instance,this._viewModel$.next(this.viewModel),this.componentInstance.activate(),this.containerRef.insert(e.hostView,0)}_createOrUpdateViewWithoutCaching(e){if("instanceId"in e){this.resetPreviousView(),this._componentRef=this.createView(),this._componentRef.instance.context[Pe]=this.instanceId,this._componentRef.instance.context[Ue]=[this.instanceId];return}const t=this.viewConfig||[],n=e.viewConfig?.previousValue||[];"viewConfigId"in e&&(this.canUpdateView(n,t)?this.updateView(n,t):(this.resetPreviousView(),this._componentRef.destroy(),this._componentRef=this.createView(),this._componentRef.instance.context[Pe]=this.instanceId,this._componentRef.instance.context[Ue]=[this.instanceId]))}_createOrUpdateView(e){const t=this.viewConfig||[],n=e.viewConfig?.previousValue||[];if("instanceId"in e||"viewConfigId"in e){const i=this._cacheService.getView(this.viewConfigId),o=this._cacheService.getViewConfig(i)||n;this.canUpdateView(o,t)?(i&&this._restoreView(i),this._componentRef.instance.context[Pe]=this.instanceId,this.updateView(o,t)):(this.resetPreviousView(),this._componentRef=this.createView(),this._cacheService.invalidateInstance(this.instanceId),this._componentRef.instance.context[Pe]=this.instanceId),this._cacheService.saveView(this._componentRef,this.viewConfigId,this.viewConfig),this._cacheService.saveInstance(this._componentRef,this.instanceId),this._componentRef.instance.context[Ue]=this._cacheService.getInstances(this._componentRef)}}_resetPreviousViewWithoutCaching(e){const t="skipCache"in e?e.skipCache.previousValue:this.skipCache;"instanceId"in e&&t&&(this.resetPreviousView(),this._componentRef.destroy(),this._componentRef=null)}ngOnChanges(e){if(this._resetPreviousViewWithoutCaching(e),this.skipCache){this._createOrUpdateViewWithoutCaching(e);return}this._createOrUpdateView(e)}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=s.\u0275\u0275getInheritedFactory(H)))(n||H)}})()}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:H,selectors:[["","crtReusableViewGenerator",""]],inputs:{instanceId:"instanceId",viewModel:"viewModel",viewConfigId:"viewConfigId",skipCache:"skipCache"},features:[s.\u0275\u0275ProvidersFeature([{provide:B,useFactory:e=>e._bindingContext,deps:[(0,s.forwardRef)(()=>H)]},...Ee]),s.\u0275\u0275InheritDefinitionFeature,s.\u0275\u0275NgOnChangesFeature]})}}class we{static forRoot(e){return{ngModule:we,providers:[{provide:We,useValue:e}]}}static{this.\u0275fac=function(t){return new(t||we)}}static{this.\u0275mod=s.\u0275\u0275defineNgModule({type:we})}static{this.\u0275inj=s.\u0275\u0275defineInjector({providers:[{provide:ot,useClass:ve}],imports:[P.CommonModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&s.\u0275\u0275setNgModuleScope(we,{declarations:[Q,H],imports:[P.CommonModule],exports:[Q,H]})})()},35293:(He,Be,C)=>{C.d(Be,{A:()=>j});const te={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let s;const d=new Uint8Array(16);function y(){if(!s&&(s=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!s))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(d)}const g=[];for(let _=0;_<256;++_)g.push((_+256).toString(16).slice(1));function h(_,v=0){return g[_[v+0]]+g[_[v+1]]+g[_[v+2]]+g[_[v+3]]+"-"+g[_[v+4]]+g[_[v+5]]+"-"+g[_[v+6]]+g[_[v+7]]+"-"+g[_[v+8]]+g[_[v+9]]+"-"+g[_[v+10]]+g[_[v+11]]+g[_[v+12]]+g[_[v+13]]+g[_[v+14]]+g[_[v+15]]}function p(_,v=0){const D=h(_,v);if(!validate(D))throw TypeError("Stringified UUID is invalid");return D}const je=null;function B(_,v,D){if(te.randomUUID&&!v&&!_)return te.randomUUID();_=_||{};const R=_.random||(_.rng||y)();if(R[6]=R[6]&15|64,R[8]=R[8]&63|128,v){D=D||0;for(let P=0;P<16;++P)v[D+P]=R[P];return v}return h(R)}const j=B},49967:He=>{He.exports=`<svg xmlns="http://www.w3.org/2000/svg" width="65.898" height="50" viewBox="0 0 65.898 50">
  <g id="Group_10554" data-name="Group 10554" transform="translate(-630.824 -282)">
    <g id="Group_10553" data-name="Group 10553" transform="translate(-8 4)">
      <rect id="Rectangle_23319" data-name="Rectangle 23319" width="24" height="8" transform="translate(640 311) rotate(-90)" fill="#757575" opacity="0.15"/>
      <rect id="Rectangle_23320" data-name="Rectangle 23320" width="15" height="8" transform="translate(655 313) rotate(-90)" fill="#757575" opacity="0.36"/>
      <rect id="Rectangle_23321" data-name="Rectangle 23321" width="50" height="8" transform="translate(671 328) rotate(-90)" fill="#757575" opacity="0.16"/>
      <rect id="Rectangle_23326" data-name="Rectangle 23326" width="20" height="8" transform="translate(671 298) rotate(-90)" fill="#757575" opacity="0.36"/>
      <rect id="Rectangle_23322" data-name="Rectangle 23322" width="30" height="8" transform="translate(687 311) rotate(-90)" fill="#757575" opacity="0.12"/>
      <rect id="Rectangle_23327" data-name="Rectangle 23327" width="17" height="8" transform="translate(687 298) rotate(-90)" fill="#757575" opacity="0.36"/>
      <rect id="Rectangle_23323" data-name="Rectangle 23323" width="11" height="8" transform="translate(640 298) rotate(-90)" fill="#757575" opacity="0.15"/>
      <rect id="Rectangle_23324" data-name="Rectangle 23324" width="25" height="8" transform="translate(655 313) rotate(-90)" fill="#757575" opacity="0.19"/>
      <path id="Path_9959" data-name="Path 9959" d="M223.923,2054c8.8,1.753,9.21,7.979,18.455,7.661s19.38-15.618,29.076-15.618,13.109-8.362,16.091-8.043" transform="translate(416.077 -1753.707)" fill="none" stroke="#757575" stroke-linecap="round" stroke-width="2" opacity="0.36"/>
    </g>
  </g>
</svg>
`}}]);
