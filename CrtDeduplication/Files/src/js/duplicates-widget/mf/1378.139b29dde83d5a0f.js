(self.webpackChunkapp_studio_enterprise_duplicates_widget=self.webpackChunkapp_studio_enterprise_duplicates_widget||[]).push([[1378,8997],{98997:(V,v,t)=>{t.r(v),t.d(v,{ErrorListDialogService:()=>s,RestValidationErrorHandler:()=>n,WorkspaceErrorsDialogModule:()=>l});var E=t(40297),d=t(59564),S=t(71252),o=t(38495),D=t(79772),y=t(33e3),p=t(50456),m=t(21018),f=t(36486),i=t(59131);class s{constructor(r,e,a,h){this._dialogService=r,this._translateService=e,this._academyHelpUrlService=a,this._domSanitizer=h,this._codeErrorDataSchema={columns:[new p.ErrorTypeIconColumnSchema({name:"errorTypeIcon",formatter:(g,c)=>c.warning?m.MessageType.Warning:m.MessageType.Error}),{name:"fileName",caption:this._translateService.instant("ErrorListDialogService.FileNameColumn"),valueType:o.DataValueType.Text},{name:"errorText",caption:this._translateService.instant("ErrorListDialogService.ErrorTextColumn"),valueType:o.DataValueType.Text},{name:"errorNumber",caption:this._translateService.instant("ErrorListDialogService.ErrorNumberColumn"),valueType:o.DataValueType.Text},{name:"line",caption:this._translateService.instant("ErrorListDialogService.LineColumn"),valueType:o.DataValueType.Text}]},this._codeValidationErrorDataSchema={columns:[{name:"source",caption:this._translateService.instant("ErrorListDialogService.SourceColumn"),valueType:o.DataValueType.Text},{name:"reference",caption:this._translateService.instant("ErrorListDialogService.ReferenceColumn"),valueType:o.DataValueType.Text},{name:"package",caption:this._translateService.instant("ErrorListDialogService.PackageColumn"),valueType:o.DataValueType.Text}]}}_getCompilationErrorsDialogData(r){return{title:this._translateService.instant("ErrorListDialogService.CodeErrorListDialogCaption"),dataSchema:this._codeErrorDataSchema,data:r,sortColumn:"fileName"}}_getValidationErrorsDialogData(r,e){return{title:this._translateService.instant("ErrorListDialogService.CodeValidationErrorListDialogCaption"),dataSchema:this._codeValidationErrorDataSchema,data:e,sortColumn:"source",additionalText:r,helpLinkUrl:this._getHelpLinkUrl()}}_getHelpLinkUrl(){return{url:this._domSanitizer.bypassSecurityTrustUrl(this._academyUrl),caption:this._translateService.instant("ErrorListDialogService.AcademyHelpUrlCaption")}}_getAcademyHelpUrl(){return this._academyHelpUrlService.getAcademyHelpUrl("PackageHierarchyLoops")}showCompilationErrors(r){return this._dialogService.open(p.TableDialogComponent,{data:this._getCompilationErrorsDialogData(r),panelClass:"compilation-error-dialog",disableClose:!0})}showValidationErrors(r,e){return this._getAcademyHelpUrl().pipe((0,f.switchMap)(a=>(this._academyUrl=a,this._dialogService.open(p.TableDialogComponent,{data:this._getValidationErrorsDialogData(r,e),panelClass:"validation-error-dialog",disableClose:!0}))))}static{this.\u0275fac=function(e){return new(e||s)(i.\u0275\u0275inject(d.DialogService),i.\u0275\u0275inject(D.TranslateService),i.\u0275\u0275inject(y.AcademyService),i.\u0275\u0275inject(S.DomSanitizer))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:s,factory:s.\u0275fac})}}var u=t(28399),T=t(62278);class n extends m.RestAccumulatingErrorHandler{constructor(r,e){super(),this._dialogService=r,this._errorListDialogService=e,this._subscription=new T.Subscription}_showValidationErrors(r,e){this._subscription.add(this._errorListDialogService.showValidationErrors(r,e).subscribe())}processAccumulatedResponse(r){const e=r;e.success=!0,delete e.errorInfo,delete e.validationErrors}canAccumulate(r){return r?.errorInfo?.errorCode==="AutoAddPackageDependenciesValidateException"}showAccumulatedErrors(){const r=(0,u.cloneDeep)(this.accumulatedErrorResponses),e=r.shift();if(r.forEach(a=>{const h=a,g=e.validationErrors??[],c=h.validationErrors,C=g.some(x=>c?.find(L=>(0,u.isEqual)(L,x)));!(0,u.isEmpty)(c)&&!C&&(e.validationErrors=[...g,...c])}),e){const a=e.errorInfo?.message;this._showValidationErrors(a,e.validationErrors)}}processSeparatedResponse(r){const{validationErrors:e,errorInfo:a}=r||{};e?.length>0?this._showValidationErrors(a.message,e):a&&a.message&&this.processErrorMessage(a.message)}processErrorMessage(r){this._dialogService.openInfoDialog(r)}ngOnDestroy(){this._subscription.unsubscribe()}static{this.\u0275fac=function(e){return new(e||n)(i.\u0275\u0275inject(d.DialogService),i.\u0275\u0275inject(s))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac})}}class l{static{this.\u0275fac=function(e){return new(e||l)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:l})}static{this.\u0275inj=i.\u0275\u0275defineInjector({providers:[s,n],imports:[E.CommonModule,d.DialogModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(l,{imports:[E.CommonModule,d.DialogModule]})})()}}]);
