(self.webpackChunkapp_studio_enterprise_relationship_diagram=self.webpackChunkapp_studio_enterprise_relationship_diagram||[]).push([[4318,3308,927,8546,6165,2832,451,8070,5689,4260,1879,1937],{1937:(h,E,r)=>{r.r(E),r.d(E,{ExpressionEngine:()=>x.t,ExpressionEngineModule:()=>c.D,ExpressionMetadataAdapter:()=>x.X});var c=r(73113),x=r(37577),n=r(52972),i=r.n(n),l={};for(const u in n)["default","ExpressionEngineModule","ExpressionEngine","ExpressionMetadataAdapter"].indexOf(u)<0&&(l[u]=()=>n[u]);r.d(E,l)},73113:(h,E,r)=>{r.d(E,{D:()=>a});var c=r(5960),x=r(40297),n=r(38495),i=r(52972);let l=class{convert(o,d){const m={type:"crt.ExecuteExpressionRequest",$context:d,metadata:o};return n.HandlerChainService.instance.process(m).then(y=>y?.result).catch(y=>(console.warn(y),null))}};l=(0,c.__decorate)([(0,n.CrtConverter)({type:"crt.ExecuteExpression"})],l);let u=class{convert(o,d){const m={type:"crt.ExecuteExpressionRequest",$context:d,metadata:o};return n.HandlerChainService.instance.process(m).then(y=>y).catch(y=>({success:!1,result:null,errorInfo:y}))}};u=(0,c.__decorate)([(0,n.CrtConverter)({type:"crt.ToExpressionResult"})],u);var p=r(37577);let _=class extends n.BaseRequest{constructor(){super(...arguments),this.type="crt.ExecuteExpressionRequest"}};_=(0,c.__decorate)([(0,n.CrtRequest)({type:"crt.ExecuteExpressionRequest"})],_);let e=class extends n.BaseRequestHandler{constructor(o){super(),this._engine=o}handle(o){return this._engine.execute(o.metadata)}};e=(0,c.__decorate)([(0,n.CrtRequestHandler)({type:"crt.ExecuteExpressionHandler",requestType:"crt.ExecuteExpressionRequest"}),(0,c.__metadata)("design:paramtypes",[p.t])],e);var t=r(59131);let a=class T{static{this.\u0275fac=function(d){return new(d||T)}}static{this.\u0275mod=t.\u0275\u0275defineNgModule({type:T})}static{this.\u0275inj=t.\u0275\u0275defineInjector({providers:[p.t,p.X],imports:[x.CommonModule,i.ExpressionSchemaModule,i.ExpressionSchemaModule]})}};a=(0,c.__decorate)([(0,n.CrtModule)({converters:[l,u],requestHandlers:[e]})],a),function(){(typeof ngJitMode>"u"||ngJitMode)&&t.\u0275\u0275setNgModuleScope(a,{imports:[x.CommonModule,i.ExpressionSchemaModule],exports:[i.ExpressionSchemaModule]})}()},37577:(h,E,r)=>{r.d(E,{t:()=>p,X:()=>u});var c=r(73308),x=r(63721),n=r(38495),i=r(62278),l=r(59131);class u{_getDataValueTypeName(e){switch(e){case n.DataValueType.FLOAT1:return"Float1";case n.DataValueType.FLOAT2:return"Float2";case n.DataValueType.FLOAT3:return"Float3";case n.DataValueType.FLOAT4:return"Float4";case n.DataValueType.FLOAT8:return"Float8";case n.DataValueType.CUSTOM_OBJECT:return"Object";case n.DataValueType.COMPOSITE_OBJECT_LIST:return"CompositeObjectList";default:return n.DataValueType[e]}}_getRequestParameterValueDto(e){const t=e.value;if(Array.isArray(t)){const a=t[0];return Array.isArray(a)?t.map(s=>s.map(o=>({...o,value:this._encodeValue(o.value,o.dataValueType),dataValueType:this._getDataValueTypeName(o.dataValueType)}))):t.map(s=>({...s,value:this._encodeValue(s.value,s.dataValueType),dataValueType:this._getDataValueTypeName(s.dataValueType)}))}return this._encodeValue(t,e.dataValueType)}_encodeValue(e,t){return[n.DataValueType.Date,n.DataValueType.Time,n.DataValueType.DateTime].includes(t)?(0,n.toLocalISOString)(e):e}decodeValue(e,t){return[n.DataValueType.Date,n.DataValueType.Time,n.DataValueType.DateTime].includes(t)?new Date(e):e}getExecutionMetadata(e){const t=e.parameters.map(s=>({...s,dataValueType:this._getDataValueTypeName(s.dataValueType),value:this._getRequestParameterValueDto(s)})),a=e.expressionVariables.map(s=>({...s,dataValueType:this._getDataValueTypeName(s.dataValueType)}));return JSON.stringify({...e,parameters:t,expressionVariables:a,resultDataValueType:this._getDataValueTypeName(e.resultDataValueType)})}static{this.\u0275fac=function(t){return new(t||u)}}static{this.\u0275prov=l.\u0275\u0275defineInjectable({token:u,factory:u.\u0275fac,providedIn:"root"})}}class p{constructor(e,t,a,s){this._httpClient=e,this._featureService=t,this._sysSettingsService=a,this._expressionMetadataAdapter=s,this._expressionEngineEndpoint="ServiceModel/ExpressionService.svc/Execute",this._expressionsEngineEndpoint="ServiceModel/ExpressionService.svc/ExecuteMany",this._defaultDebounceTime=200,this._defaultBundleCount=20,this._debounceTimeSysSettingName="ExpressionEngineDebounceTime",this._bundleCountSysSettingName="ExpressionEngineBundleCount",this._requests=new i.Subject}_executeImmediate(e){const t={metadata:e};return(0,i.lastValueFrom)(this._httpClient.post(this._expressionEngineEndpoint,t,{headers:new x.HttpHeaders({"Content-Type":"application/json"})}))}_getBundleSettings(){var e=this;return(0,c.A)(function*(){const t=yield e._sysSettingsService.getByCodes([e._debounceTimeSysSettingName,e._bundleCountSysSettingName]),a=t.values[e._debounceTimeSysSettingName]?.value||e._defaultDebounceTime,s=t.values[e._bundleCountSysSettingName]?.value||e._defaultBundleCount;return{executionDebounceTime:a,bundleCount:s}})()}_prepareDebouncedResponsesStream(){var e=this;return(0,c.A)(function*(){const{executionDebounceTime:t,bundleCount:a}=yield e._getBundleSettings();if(e._responses)return;const s=new i.BehaviorSubject(0),o=(0,i.merge)(s.pipe((0,i.filter)(d=>d>=a)),e._requests.pipe((0,i.tap)(()=>{s.next(s.value+1)}),(0,i.debounceTime)(t)));e._responses=e._requests.pipe((0,i.buffer)(o),(0,i.filter)(d=>!!d.length),(0,i.mergeMap)(d=>(s.next(0),e._httpClient.post(e._expressionsEngineEndpoint,d,{headers:new x.HttpHeaders({"Content-Type":"application/json"})}))),(0,i.share)())})()}_executeThrottled(e){var t=this;return(0,c.A)(function*(){yield t._prepareDebouncedResponsesStream();const a=(0,n.generateGuid)(),s=(0,i.firstValueFrom)(t._responses.pipe((0,i.filter)(o=>o.some(d=>d.executionId===a)),(0,i.map)(o=>o.find(d=>d.executionId===a).result)));return t._requests.next({executionId:a,metadata:e}),s})()}safeExecute(e,t={immediate:!1}){var a=this;return(0,c.A)(function*(){try{return yield a.execute(e,t)}catch(s){return{success:!1,errorInfo:s,result:null}}})()}execute(e,t={immediate:!1}){var a=this;return(0,c.A)(function*(){let s;const o=a._expressionMetadataAdapter.getExecutionMetadata(e),d=yield a._featureService.getFeatureState("ExpressionEngineDisableBundling");if(t.immediate||d?s=yield a._executeImmediate(o):s=yield a._executeThrottled(o),!s.success){const m=s.errorInfo;return Promise.reject(`${m.message}`)}return{...s,result:a._expressionMetadataAdapter.decodeValue(s.result,e.resultDataValueType)}})()}static{this.\u0275fac=function(t){return new(t||p)(l.\u0275\u0275inject(x.HttpClient),l.\u0275\u0275inject(n.FeatureService),l.\u0275\u0275inject(n.SysSettingsService),l.\u0275\u0275inject(u))}}static{this.\u0275prov=l.\u0275\u0275defineInjectable({token:p,factory:p.\u0275fac,providedIn:"root"})}}},73308:(h,E,r)=>{r.d(E,{A:()=>x});function c(n,i,l,u,p,_,e){try{var t=n[_](e),a=t.value}catch(s){l(s);return}t.done?i(a):Promise.resolve(a).then(u,p)}function x(n){return function(){var i=this,l=arguments;return new Promise(function(u,p){var _=n.apply(i,l);function e(a){c(_,u,p,e,t,"next",a)}function t(a){c(_,u,p,e,t,"throw",a)}e(void 0)})}}}}]);
